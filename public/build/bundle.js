var app=function(){"use strict";function noop(){}function run(e){return e()}function blank_object(){return Object.create(null)}function run_all(e){e.forEach(run)}function is_function(e){return"function"==typeof e}function safe_not_equal(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function is_empty(e){return 0===Object.keys(e).length}function append(e,t){e.appendChild(t)}function insert(e,t,r){e.insertBefore(t,r||null)}function detach(e){e.parentNode.removeChild(e)}function destroy_each(e,t){for(let r=0;r<e.length;r+=1)e[r]&&e[r].d(t)}function element(e){return document.createElement(e)}function text(e){return document.createTextNode(e)}function space(){return text(" ")}function empty(){return text("")}function listen(e,t,r,n){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r,n)}function attr(e,t,r){null==r?e.removeAttribute(t):e.getAttribute(t)!==r&&e.setAttribute(t,r)}function children(e){return Array.from(e.childNodes)}function set_data(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function set_style(e,t,r,n){e.style.setProperty(t,r,n?"important":"")}let current_component;function set_current_component(e){current_component=e}const dirty_components=[],binding_callbacks=[],render_callbacks=[],flush_callbacks=[],resolved_promise=Promise.resolve();let update_scheduled=!1;function schedule_update(){update_scheduled||(update_scheduled=!0,resolved_promise.then(flush))}function tick(){return schedule_update(),resolved_promise}function add_render_callback(e){render_callbacks.push(e)}let flushing=!1;const seen_callbacks=new Set;function flush(){if(!flushing){flushing=!0;do{for(let e=0;e<dirty_components.length;e+=1){const t=dirty_components[e];set_current_component(t),update(t.$$)}for(set_current_component(null),dirty_components.length=0;binding_callbacks.length;)binding_callbacks.pop()();for(let e=0;e<render_callbacks.length;e+=1){const t=render_callbacks[e];seen_callbacks.has(t)||(seen_callbacks.add(t),t())}render_callbacks.length=0}while(dirty_components.length);for(;flush_callbacks.length;)flush_callbacks.pop()();update_scheduled=!1,flushing=!1,seen_callbacks.clear()}}function update(e){if(null!==e.fragment){e.update(),run_all(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(add_render_callback)}}const outroing=new Set;let outros;function group_outros(){outros={r:0,c:[],p:outros}}function check_outros(){outros.r||run_all(outros.c),outros=outros.p}function transition_in(e,t){e&&e.i&&(outroing.delete(e),e.i(t))}function transition_out(e,t,r,n){if(e&&e.o){if(outroing.has(e))return;outroing.add(e),outros.c.push((()=>{outroing.delete(e),n&&(r&&e.d(1),n())})),e.o(t)}}function create_component(e){e&&e.c()}function mount_component(e,t,r){const{fragment:n,on_mount:o,on_destroy:i,after_update:a}=e.$$;n&&n.m(t,r),add_render_callback((()=>{const t=o.map(run).filter(is_function);i?i.push(...t):run_all(t),e.$$.on_mount=[]})),a.forEach(add_render_callback)}function destroy_component(e,t){const r=e.$$;null!==r.fragment&&(run_all(r.on_destroy),r.fragment&&r.fragment.d(t),r.on_destroy=r.fragment=null,r.ctx=[])}function make_dirty(e,t){-1===e.$$.dirty[0]&&(dirty_components.push(e),schedule_update(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function init(e,t,r,n,o,i,a=[-1]){const s=current_component;set_current_component(e);const l=t.props||{},u=e.$$={fragment:null,ctx:null,props:i,update:noop,not_equal:o,bound:blank_object(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(s?s.$$.context:[]),callbacks:blank_object(),dirty:a,skip_bound:!1};let c=!1;if(u.ctx=r?r(e,l,((t,r,...n)=>{const i=n.length?n[0]:r;return u.ctx&&o(u.ctx[t],u.ctx[t]=i)&&(!u.skip_bound&&u.bound[t]&&u.bound[t](i),c&&make_dirty(e,t)),r})):[],u.update(),c=!0,run_all(u.before_update),u.fragment=!!n&&n(u.ctx),t.target){if(t.hydrate){const e=children(t.target);u.fragment&&u.fragment.l(e),e.forEach(detach)}else u.fragment&&u.fragment.c();t.intro&&transition_in(e.$$.fragment),mount_component(e,t.target,t.anchor),flush()}set_current_component(s)}class SvelteComponent{$destroy(){destroy_component(this,1),this.$destroy=noop}$on(e,t){const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(t),()=>{const e=r.indexOf(t);-1!==e&&r.splice(e,1)}}$set(e){this.$$set&&!is_empty(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return commonjsRequire(e,null==t?r.path:t)}},r.exports),r.exports}function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var marked=createCommonjsModule((function(e,t){e.exports=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}function r(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function i(e,t){return e(t={exports:{}},t.exports),t.exports}var a=i((function(e){function t(){return{baseUrl:null,breaks:!1,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}function r(t){e.exports.defaults=t}e.exports={defaults:t(),getDefaults:t,changeDefaults:r}})),s=(a.defaults,a.getDefaults,a.changeDefaults,/[&<>"']/),l=/[&<>"']/g,u=/[<>"']|&(?!#?\w+;)/,c=/[<>"']|&(?!#?\w+;)/g,f={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},h=function(e){return f[e]};function d(e,t){if(t){if(s.test(e))return e.replace(l,h)}else if(u.test(e))return e.replace(c,h);return e}var p=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function y(e){return e.replace(p,(function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""}))}var g=/(^|[^\[])\^/g;function m(e,t){e=e.source||e,t=t||"";var r={replace:function(t,n){return n=(n=n.source||n).replace(g,"$1"),e=e.replace(t,n),r},getRegex:function(){return new RegExp(e,t)}};return r}var v=/[^\w:]/g,_=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function b(e,t,r){if(e){var n;try{n=decodeURIComponent(y(r)).replace(v,"").toLowerCase()}catch(e){return null}if(0===n.indexOf("javascript:")||0===n.indexOf("vbscript:")||0===n.indexOf("data:"))return null}t&&!_.test(r)&&(r=O(t,r));try{r=encodeURI(r).replace(/%25/g,"%")}catch(e){return null}return r}var C={},w=/^[^:]+:\/*[^/]*$/,E=/^([^:]+:)[\s\S]*$/,S=/^([^:]+:\/*[^/]*)[\s\S]*$/;function O(e,t){C[" "+e]||(w.test(e)?C[" "+e]=e+"/":C[" "+e]=$(e,"/",!0));var r=-1===(e=C[" "+e]).indexOf(":");return"//"===t.substring(0,2)?r?t:e.replace(E,"$1")+t:"/"===t.charAt(0)?r?t:e.replace(S,"$1")+t:e+t}function T(e){for(var t,r,n=1;n<arguments.length;n++)for(r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}function R(e,t){var r=e.replace(/\|/g,(function(e,t,r){for(var n=!1,o=t;--o>=0&&"\\"===r[o];)n=!n;return n?"|":" |"})).split(/ \|/),n=0;if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;n<r.length;n++)r[n]=r[n].trim().replace(/\\\|/g,"|");return r}function $(e,t,r){var n=e.length;if(0===n)return"";for(var o=0;o<n;){var i=e.charAt(n-o-1);if(i!==t||r){if(i===t||!r)break;o++}else o++}return e.substr(0,n-o)}function I(e,t){if(-1===e.indexOf(t[1]))return-1;for(var r=e.length,n=0,o=0;o<r;o++)if("\\"===e[o])o++;else if(e[o]===t[0])n++;else if(e[o]===t[1]&&--n<0)return o;return-1}function A(e){e&&e.sanitize&&!e.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}var P={escape:d,unescape:y,edit:m,cleanUrl:b,resolveUrl:O,noopTest:{exec:function(){}},merge:T,splitCells:R,rtrim:$,findClosingBracket:I,checkSanitizeDeprecation:A},k=a.defaults,N=P.rtrim,M=P.splitCells,D=P.escape,L=P.findClosingBracket;function x(e,t,r){var n=t.href,o=t.title?D(t.title):null,i=e[1].replace(/\\([\[\]])/g,"$1");return"!"!==e[0].charAt(0)?{type:"link",raw:r,href:n,title:o,text:i}:{type:"image",raw:r,href:n,title:o,text:D(i)}}function H(e,t){var r=e.match(/^(\s+)(?:```)/);if(null===r)return t;var n=r[1];return t.split("\n").map((function(e){var t=e.match(/^\s+/);return null===t?e:t[0].length>=n.length?e.slice(n.length):e})).join("\n")}var j=function(){function e(e){this.options=e||k}var t=e.prototype;return t.space=function(e){var t=this.rules.block.newline.exec(e);if(t)return t[0].length>1?{type:"space",raw:t[0]}:{raw:"\n"}},t.code=function(e,t){var r=this.rules.block.code.exec(e);if(r){var n=t[t.length-1];if(n&&"paragraph"===n.type)return{raw:r[0],text:r[0].trimRight()};var o=r[0].replace(/^ {4}/gm,"");return{type:"code",raw:r[0],codeBlockStyle:"indented",text:this.options.pedantic?o:N(o,"\n")}}},t.fences=function(e){var t=this.rules.block.fences.exec(e);if(t){var r=t[0],n=H(r,t[3]||"");return{type:"code",raw:r,lang:t[2]?t[2].trim():t[2],text:n}}},t.heading=function(e){var t=this.rules.block.heading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[1].length,text:t[2]}},t.nptable=function(e){var t=this.rules.block.nptable.exec(e);if(t){var r={type:"table",header:M(t[1].replace(/^ *| *\| *$/g,"")),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:t[3]?t[3].replace(/\n$/,"").split("\n"):[],raw:t[0]};if(r.header.length===r.align.length){var n,o=r.align.length;for(n=0;n<o;n++)/^ *-+: *$/.test(r.align[n])?r.align[n]="right":/^ *:-+: *$/.test(r.align[n])?r.align[n]="center":/^ *:-+ *$/.test(r.align[n])?r.align[n]="left":r.align[n]=null;for(o=r.cells.length,n=0;n<o;n++)r.cells[n]=M(r.cells[n],r.header.length);return r}}},t.hr=function(e){var t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}},t.blockquote=function(e){var t=this.rules.block.blockquote.exec(e);if(t){var r=t[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:t[0],text:r}}},t.list=function(e){var t=this.rules.block.list.exec(e);if(t){for(var r,n,o,i,a,s,l,u=t[0],c=t[2],f=c.length>1,h=")"===c[c.length-1],d={type:"list",raw:u,ordered:f,start:f?+c.slice(0,-1):"",loose:!1,items:[]},p=t[0].match(this.rules.block.item),y=!1,g=p.length,m=0;m<g;m++)u=r=p[m],n=r.length,~(r=r.replace(/^ *([*+-]|\d+[.)]) */,"")).indexOf("\n ")&&(n-=r.length,r=this.options.pedantic?r.replace(/^ {1,4}/gm,""):r.replace(new RegExp("^ {1,"+n+"}","gm"),"")),m!==g-1&&(o=this.rules.block.bullet.exec(p[m+1])[0],(f?1===o.length||!h&&")"===o[o.length-1]:o.length>1||this.options.smartLists&&o!==c)&&(i=p.slice(m+1).join("\n"),d.raw=d.raw.substring(0,d.raw.length-i.length),m=g-1)),a=y||/\n\n(?!\s*$)/.test(r),m!==g-1&&(y="\n"===r.charAt(r.length-1),a||(a=y)),a&&(d.loose=!0),l=void 0,(s=/^\[[ xX]\] /.test(r))&&(l=" "!==r[1],r=r.replace(/^\[[ xX]\] +/,"")),d.items.push({type:"list_item",raw:u,task:s,checked:l,loose:a,text:r});return d}},t.html=function(e){var t=this.rules.block.html.exec(e);if(t)return{type:this.options.sanitize?"paragraph":"html",raw:t[0],pre:!this.options.sanitizer&&("pre"===t[1]||"script"===t[1]||"style"===t[1]),text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):D(t[0]):t[0]}},t.def=function(e){var t=this.rules.block.def.exec(e);if(t)return t[3]&&(t[3]=t[3].substring(1,t[3].length-1)),{tag:t[1].toLowerCase().replace(/\s+/g," "),raw:t[0],href:t[2],title:t[3]}},t.table=function(e){var t=this.rules.block.table.exec(e);if(t){var r={type:"table",header:M(t[1].replace(/^ *| *\| *$/g,"")),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:t[3]?t[3].replace(/\n$/,"").split("\n"):[]};if(r.header.length===r.align.length){r.raw=t[0];var n,o=r.align.length;for(n=0;n<o;n++)/^ *-+: *$/.test(r.align[n])?r.align[n]="right":/^ *:-+: *$/.test(r.align[n])?r.align[n]="center":/^ *:-+ *$/.test(r.align[n])?r.align[n]="left":r.align[n]=null;for(o=r.cells.length,n=0;n<o;n++)r.cells[n]=M(r.cells[n].replace(/^ *\| *| *\| *$/g,""),r.header.length);return r}}},t.lheading=function(e){var t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1]}},t.paragraph=function(e){var t=this.rules.block.paragraph.exec(e);if(t)return{type:"paragraph",raw:t[0],text:"\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1]}},t.text=function(e,t){var r=this.rules.block.text.exec(e);if(r){var n=t[t.length-1];return n&&"text"===n.type?{raw:r[0],text:r[0]}:{type:"text",raw:r[0],text:r[0]}}},t.escape=function(e){var t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:D(t[1])}},t.tag=function(e,t,r){var n=this.rules.inline.tag.exec(e);if(n)return!t&&/^<a /i.test(n[0])?t=!0:t&&/^<\/a>/i.test(n[0])&&(t=!1),!r&&/^<(pre|code|kbd|script)(\s|>)/i.test(n[0])?r=!0:r&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(n[0])&&(r=!1),{type:this.options.sanitize?"text":"html",raw:n[0],inLink:t,inRawBlock:r,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):D(n[0]):n[0]}},t.link=function(e){var t=this.rules.inline.link.exec(e);if(t){var r=L(t[2],"()");if(r>-1){var n=(0===t[0].indexOf("!")?5:4)+t[1].length+r;t[2]=t[2].substring(0,r),t[0]=t[0].substring(0,n).trim(),t[3]=""}var o=t[2],i="";if(this.options.pedantic){var a=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(o);a?(o=a[1],i=a[3]):i=""}else i=t[3]?t[3].slice(1,-1):"";return x(t,{href:(o=o.trim().replace(/^<([\s\S]*)>$/,"$1"))?o.replace(this.rules.inline._escapes,"$1"):o,title:i?i.replace(this.rules.inline._escapes,"$1"):i},t[0])}},t.reflink=function(e,t){var r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){var n=(r[2]||r[1]).replace(/\s+/g," ");if(!(n=t[n.toLowerCase()])||!n.href){var o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return x(r,n,r[0])}},t.strong=function(e,t,r){void 0===r&&(r="");var n=this.rules.inline.strong.start.exec(e);if(n&&(!n[1]||n[1]&&(""===r||this.rules.inline.punctuation.exec(r)))){t=t.slice(-1*e.length);var o,i="**"===n[0]?this.rules.inline.strong.endAst:this.rules.inline.strong.endUnd;for(i.lastIndex=0;null!=(n=i.exec(t));)if(o=this.rules.inline.strong.middle.exec(t.slice(0,n.index+3)))return{type:"strong",raw:e.slice(0,o[0].length),text:e.slice(2,o[0].length-2)}}},t.em=function(e,t,r){void 0===r&&(r="");var n=this.rules.inline.em.start.exec(e);if(n&&(!n[1]||n[1]&&(""===r||this.rules.inline.punctuation.exec(r)))){t=t.slice(-1*e.length);var o,i="*"===n[0]?this.rules.inline.em.endAst:this.rules.inline.em.endUnd;for(i.lastIndex=0;null!=(n=i.exec(t));)if(o=this.rules.inline.em.middle.exec(t.slice(0,n.index+2)))return{type:"em",raw:e.slice(0,o[0].length),text:e.slice(1,o[0].length-1)}}},t.codespan=function(e){var t=this.rules.inline.code.exec(e);if(t){var r=t[2].replace(/\n/g," "),n=/[^ ]/.test(r),o=r.startsWith(" ")&&r.endsWith(" ");return n&&o&&(r=r.substring(1,r.length-1)),r=D(r,!0),{type:"codespan",raw:t[0],text:r}}},t.br=function(e){var t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}},t.del=function(e){var t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[1]}},t.autolink=function(e,t){var r,n,o=this.rules.inline.autolink.exec(e);if(o)return n="@"===o[2]?"mailto:"+(r=D(this.options.mangle?t(o[1]):o[1])):r=D(o[1]),{type:"link",raw:o[0],text:r,href:n,tokens:[{type:"text",raw:r,text:r}]}},t.url=function(e,t){var r;if(r=this.rules.inline.url.exec(e)){var n,o;if("@"===r[2])o="mailto:"+(n=D(this.options.mangle?t(r[0]):r[0]));else{var i;do{i=r[0],r[0]=this.rules.inline._backpedal.exec(r[0])[0]}while(i!==r[0]);n=D(r[0]),o="www."===r[1]?"http://"+n:n}return{type:"link",raw:r[0],text:n,href:o,tokens:[{type:"text",raw:n,text:n}]}}},t.inlineText=function(e,t,r){var n,o=this.rules.inline.text.exec(e);if(o)return n=t?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(o[0]):D(o[0]):o[0]:D(this.options.smartypants?r(o[0]):o[0]),{type:"text",raw:o[0],text:n}},e}(),F=P.noopTest,U=P.edit,B=P.merge,V={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6}) +([^\n]*?)(?: +#+)? *(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:\\n{2,}|$)|<(?!script|pre|style)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$)|</(?!script|pre|style)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,nptable:F,table:F,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};V.def=U(V.def).replace("label",V._label).replace("title",V._title).getRegex(),V.bullet=/(?:[*+-]|\d{1,9}[.)])/,V.item=/^( *)(bull) ?[^\n]*(?:\n(?!\1bull ?)[^\n]*)*/,V.item=U(V.item,"gm").replace(/bull/g,V.bullet).getRegex(),V.list=U(V.list).replace(/bull/g,V.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+V.def.source+")").getRegex(),V._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",V._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,V.html=U(V.html,"i").replace("comment",V._comment).replace("tag",V._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),V.paragraph=U(V._paragraph).replace("hr",V.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",V._tag).getRegex(),V.blockquote=U(V.blockquote).replace("paragraph",V.paragraph).getRegex(),V.normal=B({},V),V.gfm=B({},V.normal,{nptable:"^ *([^|\\n ].*\\|.*)\\n {0,3}([-:]+ *\\|[-| :]*)(?:\\n((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)",table:"^ *\\|(.+)\\n {0,3}\\|?( *[-:]+[-| :]*)(?:\\n *((?:(?!\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),V.gfm.nptable=U(V.gfm.nptable).replace("hr",V.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",V._tag).getRegex(),V.gfm.table=U(V.gfm.table).replace("hr",V.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",V._tag).getRegex(),V.pedantic=B({},V.normal,{html:U("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",V._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *(?:#+ *)?(?:\n+|$)/,fences:F,paragraph:U(V.normal._paragraph).replace("hr",V.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",V.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var W={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:F,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",strong:{start:/^(?:(\*\*(?=[*punctuation]))|\*\*)(?![\s])|__/,middle:/^\*\*(?:(?:(?!overlapSkip)(?:[^*]|\\\*)|overlapSkip)|\*(?:(?!overlapSkip)(?:[^*]|\\\*)|overlapSkip)*?\*)+?\*\*$|^__(?![\s])((?:(?:(?!overlapSkip)(?:[^_]|\\_)|overlapSkip)|_(?:(?!overlapSkip)(?:[^_]|\\_)|overlapSkip)*?_)+?)__$/,endAst:/[^punctuation\s]\*\*(?!\*)|[punctuation]\*\*(?!\*)(?:(?=[punctuation_\s]|$))/,endUnd:/[^\s]__(?!_)(?:(?=[punctuation*\s])|$)/},em:{start:/^(?:(\*(?=[punctuation]))|\*)(?![*\s])|_/,middle:/^\*(?:(?:(?!overlapSkip)(?:[^*]|\\\*)|overlapSkip)|\*(?:(?!overlapSkip)(?:[^*]|\\\*)|overlapSkip)*?\*)+?\*$|^_(?![_\s])(?:(?:(?!overlapSkip)(?:[^_]|\\_)|overlapSkip)|_(?:(?!overlapSkip)(?:[^_]|\\_)|overlapSkip)*?_)+?_$/,endAst:/[^punctuation\s]\*(?!\*)|[punctuation]\*(?!\*)(?:(?=[punctuation_\s]|$))/,endUnd:/[^\s]_(?!_)(?:(?=[punctuation*\s])|$)/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:F,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\s*punctuation])/,_punctuation:"!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~"};W.punctuation=U(W.punctuation).replace(/punctuation/g,W._punctuation).getRegex(),W._blockSkip="\\[[^\\]]*?\\]\\([^\\)]*?\\)|`[^`]*?`|<[^>]*?>",W._overlapSkip="__[^_]*?__|\\*\\*\\[^\\*\\]*?\\*\\*",W._comment=U(V._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),W.em.start=U(W.em.start).replace(/punctuation/g,W._punctuation).getRegex(),W.em.middle=U(W.em.middle).replace(/punctuation/g,W._punctuation).replace(/overlapSkip/g,W._overlapSkip).getRegex(),W.em.endAst=U(W.em.endAst,"g").replace(/punctuation/g,W._punctuation).getRegex(),W.em.endUnd=U(W.em.endUnd,"g").replace(/punctuation/g,W._punctuation).getRegex(),W.strong.start=U(W.strong.start).replace(/punctuation/g,W._punctuation).getRegex(),W.strong.middle=U(W.strong.middle).replace(/punctuation/g,W._punctuation).replace(/overlapSkip/g,W._overlapSkip).getRegex(),W.strong.endAst=U(W.strong.endAst,"g").replace(/punctuation/g,W._punctuation).getRegex(),W.strong.endUnd=U(W.strong.endUnd,"g").replace(/punctuation/g,W._punctuation).getRegex(),W.blockSkip=U(W._blockSkip,"g").getRegex(),W.overlapSkip=U(W._overlapSkip,"g").getRegex(),W._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,W._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,W._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,W.autolink=U(W.autolink).replace("scheme",W._scheme).replace("email",W._email).getRegex(),W._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,W.tag=U(W.tag).replace("comment",W._comment).replace("attribute",W._attribute).getRegex(),W._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,W._href=/<(?:\\[<>]?|[^\s<>\\])*>|[^\s\x00-\x1f]*/,W._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,W.link=U(W.link).replace("label",W._label).replace("href",W._href).replace("title",W._title).getRegex(),W.reflink=U(W.reflink).replace("label",W._label).getRegex(),W.reflinkSearch=U(W.reflinkSearch,"g").replace("reflink",W.reflink).replace("nolink",W.nolink).getRegex(),W.normal=B({},W),W.pedantic=B({},W.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:U(/^!?\[(label)\]\((.*?)\)/).replace("label",W._label).getRegex(),reflink:U(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",W._label).getRegex()}),W.gfm=B({},W.normal,{escape:U(W.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^~+(?=\S)([\s\S]*?\S)~+/,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*~]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@))|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@))/}),W.gfm.url=U(W.gfm.url,"i").replace("email",W.gfm._extended_email).getRegex(),W.breaks=B({},W.gfm,{br:U(W.br).replace("{2,}","*").getRegex(),text:U(W.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var G={block:V,inline:W},z=a.defaults,Y=G.block,K=G.inline;function X(e){return e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function q(e){var t,r,n="",o=e.length;for(t=0;t<o;t++)r=e.charCodeAt(t),Math.random()>.5&&(r="x"+r.toString(16)),n+="&#"+r+";";return n}var Q=function(){function e(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||z,this.options.tokenizer=this.options.tokenizer||new j,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options;var t={block:Y.normal,inline:K.normal};this.options.pedantic?(t.block=Y.pedantic,t.inline=K.pedantic):this.options.gfm&&(t.block=Y.gfm,this.options.breaks?t.inline=K.breaks:t.inline=K.gfm),this.tokenizer.rules=t}e.lex=function(t,r){return new e(r).lex(t)},e.lexInline=function(t,r){return new e(r).inlineTokens(t)};var r=e.prototype;return r.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(e,this.tokens,!0),this.inline(this.tokens),this.tokens},r.blockTokens=function(e,t,r){var n,o,i,a;for(void 0===t&&(t=[]),void 0===r&&(r=!0),e=e.replace(/^ +$/gm,"");e;)if(n=this.tokenizer.space(e))e=e.substring(n.raw.length),n.type&&t.push(n);else if(n=this.tokenizer.code(e,t))e=e.substring(n.raw.length),n.type?t.push(n):((a=t[t.length-1]).raw+="\n"+n.raw,a.text+="\n"+n.text);else if(n=this.tokenizer.fences(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.heading(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.nptable(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.hr(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.blockquote(e))e=e.substring(n.raw.length),n.tokens=this.blockTokens(n.text,[],r),t.push(n);else if(n=this.tokenizer.list(e)){for(e=e.substring(n.raw.length),i=n.items.length,o=0;o<i;o++)n.items[o].tokens=this.blockTokens(n.items[o].text,[],!1);t.push(n)}else if(n=this.tokenizer.html(e))e=e.substring(n.raw.length),t.push(n);else if(r&&(n=this.tokenizer.def(e)))e=e.substring(n.raw.length),this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title});else if(n=this.tokenizer.table(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.lheading(e))e=e.substring(n.raw.length),t.push(n);else if(r&&(n=this.tokenizer.paragraph(e)))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.text(e,t))e=e.substring(n.raw.length),n.type?t.push(n):((a=t[t.length-1]).raw+="\n"+n.raw,a.text+="\n"+n.text);else if(e){var s="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(s);break}throw new Error(s)}return t},r.inline=function(e){var t,r,n,o,i,a,s=e.length;for(t=0;t<s;t++)switch((a=e[t]).type){case"paragraph":case"text":case"heading":a.tokens=[],this.inlineTokens(a.text,a.tokens);break;case"table":for(a.tokens={header:[],cells:[]},o=a.header.length,r=0;r<o;r++)a.tokens.header[r]=[],this.inlineTokens(a.header[r],a.tokens.header[r]);for(o=a.cells.length,r=0;r<o;r++)for(i=a.cells[r],a.tokens.cells[r]=[],n=0;n<i.length;n++)a.tokens.cells[r][n]=[],this.inlineTokens(i[n],a.tokens.cells[r][n]);break;case"blockquote":this.inline(a.tokens);break;case"list":for(o=a.items.length,r=0;r<o;r++)this.inline(a.items[r].tokens)}return e},r.inlineTokens=function(e,t,r,n,o){var i;void 0===t&&(t=[]),void 0===r&&(r=!1),void 0===n&&(n=!1),void 0===o&&(o="");var a,s=e;if(this.tokens.links){var l=Object.keys(this.tokens.links);if(l.length>0)for(;null!=(a=this.tokenizer.rules.inline.reflinkSearch.exec(s));)l.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(s=s.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(a=this.tokenizer.rules.inline.blockSkip.exec(s));)s=s.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;e;)if(i=this.tokenizer.escape(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.tag(e,r,n))e=e.substring(i.raw.length),r=i.inLink,n=i.inRawBlock,t.push(i);else if(i=this.tokenizer.link(e))e=e.substring(i.raw.length),"link"===i.type&&(i.tokens=this.inlineTokens(i.text,[],!0,n)),t.push(i);else if(i=this.tokenizer.reflink(e,this.tokens.links))e=e.substring(i.raw.length),"link"===i.type&&(i.tokens=this.inlineTokens(i.text,[],!0,n)),t.push(i);else if(i=this.tokenizer.strong(e,s,o))e=e.substring(i.raw.length),i.tokens=this.inlineTokens(i.text,[],r,n),t.push(i);else if(i=this.tokenizer.em(e,s,o))e=e.substring(i.raw.length),i.tokens=this.inlineTokens(i.text,[],r,n),t.push(i);else if(i=this.tokenizer.codespan(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.br(e))e=e.substring(i.raw.length),t.push(i);else if(i=this.tokenizer.del(e))e=e.substring(i.raw.length),i.tokens=this.inlineTokens(i.text,[],r,n),t.push(i);else if(i=this.tokenizer.autolink(e,q))e=e.substring(i.raw.length),t.push(i);else if(r||!(i=this.tokenizer.url(e,q))){if(i=this.tokenizer.inlineText(e,n,X))e=e.substring(i.raw.length),o=i.raw.slice(-1),t.push(i);else if(e){var u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}throw new Error(u)}}else e=e.substring(i.raw.length),t.push(i);return t},t(e,null,[{key:"rules",get:function(){return{block:Y,inline:K}}}]),e}(),Z=a.defaults,J=P.cleanUrl,ee=P.escape,te=function(){function e(e){this.options=e||Z}var t=e.prototype;return t.code=function(e,t,r){var n=(t||"").match(/\S*/)[0];if(this.options.highlight){var o=this.options.highlight(e,n);null!=o&&o!==e&&(r=!0,e=o)}return n?'<pre><code class="'+this.options.langPrefix+ee(n,!0)+'">'+(r?e:ee(e,!0))+"</code></pre>\n":"<pre><code>"+(r?e:ee(e,!0))+"</code></pre>\n"},t.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},t.html=function(e){return e},t.heading=function(e,t,r,n){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+n.slug(r)+'">'+e+"</h"+t+">\n":"<h"+t+">"+e+"</h"+t+">\n"},t.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},t.list=function(e,t,r){var n=t?"ol":"ul";return"<"+n+(t&&1!==r?' start="'+r+'"':"")+">\n"+e+"</"+n+">\n"},t.listitem=function(e){return"<li>"+e+"</li>\n"},t.checkbox=function(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},t.paragraph=function(e){return"<p>"+e+"</p>\n"},t.table=function(e,t){return t&&(t="<tbody>"+t+"</tbody>"),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"},t.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},t.tablecell=function(e,t){var r=t.header?"th":"td";return(t.align?"<"+r+' align="'+t.align+'">':"<"+r+">")+e+"</"+r+">\n"},t.strong=function(e){return"<strong>"+e+"</strong>"},t.em=function(e){return"<em>"+e+"</em>"},t.codespan=function(e){return"<code>"+e+"</code>"},t.br=function(){return this.options.xhtml?"<br/>":"<br>"},t.del=function(e){return"<del>"+e+"</del>"},t.link=function(e,t,r){if(null===(e=J(this.options.sanitize,this.options.baseUrl,e)))return r;var n='<a href="'+ee(e)+'"';return t&&(n+=' title="'+t+'"'),n+=">"+r+"</a>"},t.image=function(e,t,r){if(null===(e=J(this.options.sanitize,this.options.baseUrl,e)))return r;var n='<img src="'+e+'" alt="'+r+'"';return t&&(n+=' title="'+t+'"'),n+=this.options.xhtml?"/>":">"},t.text=function(e){return e},e}(),re=function(){function e(){}var t=e.prototype;return t.strong=function(e){return e},t.em=function(e){return e},t.codespan=function(e){return e},t.del=function(e){return e},t.html=function(e){return e},t.text=function(e){return e},t.link=function(e,t,r){return""+r},t.image=function(e,t,r){return""+r},t.br=function(){return""},e}(),ne=function(){function e(){this.seen={}}var t=e.prototype;return t.serialize=function(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},t.getNextSafeSlug=function(e,t){var r=e,n=0;if(this.seen.hasOwnProperty(r)){n=this.seen[e];do{r=e+"-"+ ++n}while(this.seen.hasOwnProperty(r))}return t||(this.seen[e]=n,this.seen[r]=0),r},t.slug=function(e,t){void 0===t&&(t={});var r=this.serialize(e);return this.getNextSafeSlug(r,t.dryrun)},e}(),oe=a.defaults,ie=P.unescape,ae=function(){function e(e){this.options=e||oe,this.options.renderer=this.options.renderer||new te,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new re,this.slugger=new ne}e.parse=function(t,r){return new e(r).parse(t)},e.parseInline=function(t,r){return new e(r).parseInline(t)};var t=e.prototype;return t.parse=function(e,t){void 0===t&&(t=!0);var r,n,o,i,a,s,l,u,c,f,h,d,p,y,g,m,v,_,b="",C=e.length;for(r=0;r<C;r++)switch((f=e[r]).type){case"space":continue;case"hr":b+=this.renderer.hr();continue;case"heading":b+=this.renderer.heading(this.parseInline(f.tokens),f.depth,ie(this.parseInline(f.tokens,this.textRenderer)),this.slugger);continue;case"code":b+=this.renderer.code(f.text,f.lang,f.escaped);continue;case"table":for(u="",l="",i=f.header.length,n=0;n<i;n++)l+=this.renderer.tablecell(this.parseInline(f.tokens.header[n]),{header:!0,align:f.align[n]});for(u+=this.renderer.tablerow(l),c="",i=f.cells.length,n=0;n<i;n++){for(l="",a=(s=f.tokens.cells[n]).length,o=0;o<a;o++)l+=this.renderer.tablecell(this.parseInline(s[o]),{header:!1,align:f.align[o]});c+=this.renderer.tablerow(l)}b+=this.renderer.table(u,c);continue;case"blockquote":c=this.parse(f.tokens),b+=this.renderer.blockquote(c);continue;case"list":for(h=f.ordered,d=f.start,p=f.loose,i=f.items.length,c="",n=0;n<i;n++)m=(g=f.items[n]).checked,v=g.task,y="",g.task&&(_=this.renderer.checkbox(m),p?g.tokens.length>0&&"text"===g.tokens[0].type?(g.tokens[0].text=_+" "+g.tokens[0].text,g.tokens[0].tokens&&g.tokens[0].tokens.length>0&&"text"===g.tokens[0].tokens[0].type&&(g.tokens[0].tokens[0].text=_+" "+g.tokens[0].tokens[0].text)):g.tokens.unshift({type:"text",text:_}):y+=_),y+=this.parse(g.tokens,p),c+=this.renderer.listitem(y,v,m);b+=this.renderer.list(c,h,d);continue;case"html":b+=this.renderer.html(f.text);continue;case"paragraph":b+=this.renderer.paragraph(this.parseInline(f.tokens));continue;case"text":for(c=f.tokens?this.parseInline(f.tokens):f.text;r+1<C&&"text"===e[r+1].type;)c+="\n"+((f=e[++r]).tokens?this.parseInline(f.tokens):f.text);b+=t?this.renderer.paragraph(c):c;continue;default:var w='Token with "'+f.type+'" type was not found.';if(this.options.silent)return void console.error(w);throw new Error(w)}return b},t.parseInline=function(e,t){t=t||this.renderer;var r,n,o="",i=e.length;for(r=0;r<i;r++)switch((n=e[r]).type){case"escape":o+=t.text(n.text);break;case"html":o+=t.html(n.text);break;case"link":o+=t.link(n.href,n.title,this.parseInline(n.tokens,t));break;case"image":o+=t.image(n.href,n.title,n.text);break;case"strong":o+=t.strong(this.parseInline(n.tokens,t));break;case"em":o+=t.em(this.parseInline(n.tokens,t));break;case"codespan":o+=t.codespan(n.text);break;case"br":o+=t.br();break;case"del":o+=t.del(this.parseInline(n.tokens,t));break;case"text":o+=t.text(n.text);break;default:var a='Token with "'+n.type+'" type was not found.';if(this.options.silent)return void console.error(a);throw new Error(a)}return o},e}(),se=P.merge,le=P.checkSanitizeDeprecation,ue=P.escape,ce=a.getDefaults,fe=a.changeDefaults,he=a.defaults;function de(e,t,r){if(null==e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if("function"==typeof t&&(r=t,t=null),t=se({},de.defaults,t||{}),le(t),r){var n,o=t.highlight;try{n=Q.lex(e,t)}catch(e){return r(e)}var i=function(e){var i;if(!e)try{i=ae.parse(n,t)}catch(t){e=t}return t.highlight=o,e?r(e):r(null,i)};if(!o||o.length<3)return i();if(delete t.highlight,!n.length)return i();var a=0;return de.walkTokens(n,(function(e){"code"===e.type&&(a++,setTimeout((function(){o(e.text,e.lang,(function(t,r){if(t)return i(t);null!=r&&r!==e.text&&(e.text=r,e.escaped=!0),0==--a&&i()}))}),0))})),void(0===a&&i())}try{var s=Q.lex(e,t);return t.walkTokens&&de.walkTokens(s,t.walkTokens),ae.parse(s,t)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+ue(e.message+"",!0)+"</pre>";throw e}}return de.options=de.setOptions=function(e){return se(de.defaults,e),fe(de.defaults),de},de.getDefaults=ce,de.defaults=he,de.use=function(e){var t=se({},e);if(e.renderer&&function(){var r=de.defaults.renderer||new te,n=function(t){var n=r[t];r[t]=function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var s=e.renderer[t].apply(r,i);return!1===s&&(s=n.apply(r,i)),s}};for(var o in e.renderer)n(o);t.renderer=r}(),e.tokenizer&&function(){var r=de.defaults.tokenizer||new j,n=function(t){var n=r[t];r[t]=function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var s=e.tokenizer[t].apply(r,i);return!1===s&&(s=n.apply(r,i)),s}};for(var o in e.tokenizer)n(o);t.tokenizer=r}(),e.walkTokens){var r=de.defaults.walkTokens;t.walkTokens=function(t){e.walkTokens(t),r&&r(t)}}de.setOptions(t)},de.walkTokens=function(e,t){for(var r,n=o(e);!(r=n()).done;){var i=r.value;switch(t(i),i.type){case"table":for(var a,s=o(i.tokens.header);!(a=s()).done;){var l=a.value;de.walkTokens(l,t)}for(var u,c=o(i.tokens.cells);!(u=c()).done;)for(var f,h=o(u.value);!(f=h()).done;){var d=f.value;de.walkTokens(d,t)}break;case"list":de.walkTokens(i.items,t);break;default:i.tokens&&de.walkTokens(i.tokens,t)}}},de.parseInline=function(e,t){if(null==e)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");t=se({},de.defaults,t||{}),le(t);try{var r=Q.lexInline(e,t);return t.walkTokens&&de.walkTokens(r,t.walkTokens),ae.parseInline(r,t)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+ue(e.message+"",!0)+"</pre>";throw e}},de.Parser=ae,de.parser=ae.parse,de.Renderer=te,de.TextRenderer=re,de.Lexer=Q,de.lexer=Q.lex,de.Tokenizer=j,de.Slugger=ne,de.parse=de,de}()})),check=function(e){return e&&e.Math==Math&&e},global_1=check("object"==typeof globalThis&&globalThis)||check("object"==typeof window&&window)||check("object"==typeof self&&self)||check("object"==typeof commonjsGlobal&&commonjsGlobal)||Function("return this")(),fails=function(e){try{return!!e()}catch(e){return!0}},descriptors=!fails((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),nativePropertyIsEnumerable={}.propertyIsEnumerable,getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,NASHORN_BUG=getOwnPropertyDescriptor&&!nativePropertyIsEnumerable.call({1:2},1),f=NASHORN_BUG?function(e){var t=getOwnPropertyDescriptor(this,e);return!!t&&t.enumerable}:nativePropertyIsEnumerable,objectPropertyIsEnumerable={f:f},createPropertyDescriptor=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},toString={}.toString,classofRaw=function(e){return toString.call(e).slice(8,-1)},split="".split,indexedObject=fails((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==classofRaw(e)?split.call(e,""):Object(e)}:Object,requireObjectCoercible=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},toIndexedObject=function(e){return indexedObject(requireObjectCoercible(e))},isObject=function(e){return"object"==typeof e?null!==e:"function"==typeof e},toPrimitive=function(e,t){if(!isObject(e))return e;var r,n;if(t&&"function"==typeof(r=e.toString)&&!isObject(n=r.call(e)))return n;if("function"==typeof(r=e.valueOf)&&!isObject(n=r.call(e)))return n;if(!t&&"function"==typeof(r=e.toString)&&!isObject(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")},hasOwnProperty={}.hasOwnProperty,has=function(e,t){return hasOwnProperty.call(e,t)},document$1=global_1.document,EXISTS=isObject(document$1)&&isObject(document$1.createElement),documentCreateElement=function(e){return EXISTS?document$1.createElement(e):{}},ie8DomDefine=!descriptors&&!fails((function(){return 7!=Object.defineProperty(documentCreateElement("div"),"a",{get:function(){return 7}}).a})),nativeGetOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,f$1=descriptors?nativeGetOwnPropertyDescriptor:function(e,t){if(e=toIndexedObject(e),t=toPrimitive(t,!0),ie8DomDefine)try{return nativeGetOwnPropertyDescriptor(e,t)}catch(e){}if(has(e,t))return createPropertyDescriptor(!objectPropertyIsEnumerable.f.call(e,t),e[t])},objectGetOwnPropertyDescriptor={f:f$1},anObject=function(e){if(!isObject(e))throw TypeError(String(e)+" is not an object");return e},nativeDefineProperty=Object.defineProperty,f$2=descriptors?nativeDefineProperty:function(e,t,r){if(anObject(e),t=toPrimitive(t,!0),anObject(r),ie8DomDefine)try{return nativeDefineProperty(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(e[t]=r.value),e},objectDefineProperty={f:f$2},createNonEnumerableProperty=descriptors?function(e,t,r){return objectDefineProperty.f(e,t,createPropertyDescriptor(1,r))}:function(e,t,r){return e[t]=r,e},setGlobal=function(e,t){try{createNonEnumerableProperty(global_1,e,t)}catch(r){global_1[e]=t}return t},SHARED="__core-js_shared__",store=global_1[SHARED]||setGlobal(SHARED,{}),sharedStore=store,functionToString=Function.toString;"function"!=typeof sharedStore.inspectSource&&(sharedStore.inspectSource=function(e){return functionToString.call(e)});var inspectSource=sharedStore.inspectSource,WeakMap$1=global_1.WeakMap,nativeWeakMap="function"==typeof WeakMap$1&&/native code/.test(inspectSource(WeakMap$1)),shared=createCommonjsModule((function(e){(e.exports=function(e,t){return sharedStore[e]||(sharedStore[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.6.5",mode:"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})})),id=0,postfix=Math.random(),uid=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++id+postfix).toString(36)},keys=shared("keys"),sharedKey=function(e){return keys[e]||(keys[e]=uid(e))},hiddenKeys={},WeakMap$2=global_1.WeakMap,set,get,has$1,enforce=function(e){return has$1(e)?get(e):set(e,{})},getterFor=function(e){return function(t){var r;if(!isObject(t)||(r=get(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return r}};if(nativeWeakMap){var store$1=new WeakMap$2,wmget=store$1.get,wmhas=store$1.has,wmset=store$1.set;set=function(e,t){return wmset.call(store$1,e,t),t},get=function(e){return wmget.call(store$1,e)||{}},has$1=function(e){return wmhas.call(store$1,e)}}else{var STATE=sharedKey("state");hiddenKeys[STATE]=!0,set=function(e,t){return createNonEnumerableProperty(e,STATE,t),t},get=function(e){return has(e,STATE)?e[STATE]:{}},has$1=function(e){return has(e,STATE)}}var internalState={set:set,get:get,has:has$1,enforce:enforce,getterFor:getterFor},redefine=createCommonjsModule((function(e){var t=internalState.get,r=internalState.enforce,n=String(String).split("String");(e.exports=function(e,t,o,i){var a=!!i&&!!i.unsafe,s=!!i&&!!i.enumerable,l=!!i&&!!i.noTargetGet;"function"==typeof o&&("string"!=typeof t||has(o,"name")||createNonEnumerableProperty(o,"name",t),r(o).source=n.join("string"==typeof t?t:"")),e!==global_1?(a?!l&&e[t]&&(s=!0):delete e[t],s?e[t]=o:createNonEnumerableProperty(e,t,o)):s?e[t]=o:setGlobal(t,o)})(Function.prototype,"toString",(function(){return"function"==typeof this&&t(this).source||inspectSource(this)}))})),path=global_1,aFunction=function(e){return"function"==typeof e?e:void 0},getBuiltIn=function(e,t){return arguments.length<2?aFunction(path[e])||aFunction(global_1[e]):path[e]&&path[e][t]||global_1[e]&&global_1[e][t]},ceil=Math.ceil,floor=Math.floor,toInteger=function(e){return isNaN(e=+e)?0:(e>0?floor:ceil)(e)},min=Math.min,toLength=function(e){return e>0?min(toInteger(e),9007199254740991):0},max=Math.max,min$1=Math.min,toAbsoluteIndex=function(e,t){var r=toInteger(e);return r<0?max(r+t,0):min$1(r,t)},createMethod=function(e){return function(t,r,n){var o,i=toIndexedObject(t),a=toLength(i.length),s=toAbsoluteIndex(n,a);if(e&&r!=r){for(;a>s;)if((o=i[s++])!=o)return!0}else for(;a>s;s++)if((e||s in i)&&i[s]===r)return e||s||0;return!e&&-1}},arrayIncludes={includes:createMethod(!0),indexOf:createMethod(!1)},indexOf=arrayIncludes.indexOf,objectKeysInternal=function(e,t){var r,n=toIndexedObject(e),o=0,i=[];for(r in n)!has(hiddenKeys,r)&&has(n,r)&&i.push(r);for(;t.length>o;)has(n,r=t[o++])&&(~indexOf(i,r)||i.push(r));return i},enumBugKeys=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],hiddenKeys$1=enumBugKeys.concat("length","prototype"),f$3=Object.getOwnPropertyNames||function(e){return objectKeysInternal(e,hiddenKeys$1)},objectGetOwnPropertyNames={f:f$3},f$4=Object.getOwnPropertySymbols,objectGetOwnPropertySymbols={f:f$4},ownKeys=getBuiltIn("Reflect","ownKeys")||function(e){var t=objectGetOwnPropertyNames.f(anObject(e)),r=objectGetOwnPropertySymbols.f;return r?t.concat(r(e)):t},copyConstructorProperties=function(e,t){for(var r=ownKeys(t),n=objectDefineProperty.f,o=objectGetOwnPropertyDescriptor.f,i=0;i<r.length;i++){var a=r[i];has(e,a)||n(e,a,o(t,a))}},replacement=/#|\.prototype\./,isForced=function(e,t){var r=data[normalize(e)];return r==POLYFILL||r!=NATIVE&&("function"==typeof t?fails(t):!!t)},normalize=isForced.normalize=function(e){return String(e).replace(replacement,".").toLowerCase()},data=isForced.data={},NATIVE=isForced.NATIVE="N",POLYFILL=isForced.POLYFILL="P",isForced_1=isForced,getOwnPropertyDescriptor$1=objectGetOwnPropertyDescriptor.f,_export=function(e,t){var r,n,o,i,a,s=e.target,l=e.global,u=e.stat;if(r=l?global_1:u?global_1[s]||setGlobal(s,{}):(global_1[s]||{}).prototype)for(n in t){if(i=t[n],o=e.noTargetGet?(a=getOwnPropertyDescriptor$1(r,n))&&a.value:r[n],!isForced_1(l?n:s+(u?".":"#")+n,e.forced)&&void 0!==o){if(typeof i==typeof o)continue;copyConstructorProperties(i,o)}(e.sham||o&&o.sham)&&createNonEnumerableProperty(i,"sham",!0),redefine(r,n,i,e)}},nativeGetOwnPropertyNames=objectGetOwnPropertyNames.f,toString$1={}.toString,windowNames="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],getWindowNames=function(e){try{return nativeGetOwnPropertyNames(e)}catch(e){return windowNames.slice()}},f$5=function(e){return windowNames&&"[object Window]"==toString$1.call(e)?getWindowNames(e):nativeGetOwnPropertyNames(toIndexedObject(e))},objectGetOwnPropertyNamesExternal={f:f$5},nativeGetOwnPropertyNames$1=objectGetOwnPropertyNamesExternal.f,FAILS_ON_PRIMITIVES=fails((function(){return!Object.getOwnPropertyNames(1)}));_export({target:"Object",stat:!0,forced:FAILS_ON_PRIMITIVES},{getOwnPropertyNames:nativeGetOwnPropertyNames$1});var nativeSymbol=!!Object.getOwnPropertySymbols&&!fails((function(){return!String(Symbol())})),useSymbolAsUid=nativeSymbol&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,WellKnownSymbolsStore=shared("wks"),Symbol$1=global_1.Symbol,createWellKnownSymbol=useSymbolAsUid?Symbol$1:Symbol$1&&Symbol$1.withoutSetter||uid,wellKnownSymbol=function(e){return has(WellKnownSymbolsStore,e)||(nativeSymbol&&has(Symbol$1,e)?WellKnownSymbolsStore[e]=Symbol$1[e]:WellKnownSymbolsStore[e]=createWellKnownSymbol("Symbol."+e)),WellKnownSymbolsStore[e]},objectKeys=Object.keys||function(e){return objectKeysInternal(e,enumBugKeys)},objectDefineProperties=descriptors?Object.defineProperties:function(e,t){anObject(e);for(var r,n=objectKeys(t),o=n.length,i=0;o>i;)objectDefineProperty.f(e,r=n[i++],t[r]);return e},html=getBuiltIn("document","documentElement"),GT=">",LT="<",PROTOTYPE="prototype",SCRIPT="script",IE_PROTO=sharedKey("IE_PROTO"),EmptyConstructor=function(){},scriptTag=function(e){return LT+SCRIPT+GT+e+LT+"/"+SCRIPT+GT},NullProtoObjectViaActiveX=function(e){e.write(scriptTag("")),e.close();var t=e.parentWindow.Object;return e=null,t},NullProtoObjectViaIFrame=function(){var e,t=documentCreateElement("iframe"),r="java"+SCRIPT+":";return t.style.display="none",html.appendChild(t),t.src=String(r),(e=t.contentWindow.document).open(),e.write(scriptTag("document.F=Object")),e.close(),e.F},activeXDocument,NullProtoObject=function(){try{activeXDocument=document.domain&&new ActiveXObject("htmlfile")}catch(e){}NullProtoObject=activeXDocument?NullProtoObjectViaActiveX(activeXDocument):NullProtoObjectViaIFrame();for(var e=enumBugKeys.length;e--;)delete NullProtoObject[PROTOTYPE][enumBugKeys[e]];return NullProtoObject()};hiddenKeys[IE_PROTO]=!0;var objectCreate=Object.create||function(e,t){var r;return null!==e?(EmptyConstructor[PROTOTYPE]=anObject(e),r=new EmptyConstructor,EmptyConstructor[PROTOTYPE]=null,r[IE_PROTO]=e):r=NullProtoObject(),void 0===t?r:objectDefineProperties(r,t)},UNSCOPABLES=wellKnownSymbol("unscopables"),ArrayPrototype=Array.prototype;null==ArrayPrototype[UNSCOPABLES]&&objectDefineProperty.f(ArrayPrototype,UNSCOPABLES,{configurable:!0,value:objectCreate(null)});var addToUnscopables=function(e){ArrayPrototype[UNSCOPABLES][e]=!0},iterators={},toObject=function(e){return Object(requireObjectCoercible(e))},correctPrototypeGetter=!fails((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),IE_PROTO$1=sharedKey("IE_PROTO"),ObjectPrototype=Object.prototype,objectGetPrototypeOf=correctPrototypeGetter?Object.getPrototypeOf:function(e){return e=toObject(e),has(e,IE_PROTO$1)?e[IE_PROTO$1]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?ObjectPrototype:null},ITERATOR=wellKnownSymbol("iterator"),BUGGY_SAFARI_ITERATORS=!1,returnThis=function(){return this},IteratorPrototype,PrototypeOfArrayIteratorPrototype,arrayIterator;[].keys&&(arrayIterator=[].keys(),"next"in arrayIterator?(PrototypeOfArrayIteratorPrototype=objectGetPrototypeOf(objectGetPrototypeOf(arrayIterator)),PrototypeOfArrayIteratorPrototype!==Object.prototype&&(IteratorPrototype=PrototypeOfArrayIteratorPrototype)):BUGGY_SAFARI_ITERATORS=!0),null==IteratorPrototype&&(IteratorPrototype={}),has(IteratorPrototype,ITERATOR)||createNonEnumerableProperty(IteratorPrototype,ITERATOR,returnThis);var iteratorsCore={IteratorPrototype:IteratorPrototype,BUGGY_SAFARI_ITERATORS:BUGGY_SAFARI_ITERATORS},defineProperty=objectDefineProperty.f,TO_STRING_TAG=wellKnownSymbol("toStringTag"),setToStringTag=function(e,t,r){e&&!has(e=r?e:e.prototype,TO_STRING_TAG)&&defineProperty(e,TO_STRING_TAG,{configurable:!0,value:t})},IteratorPrototype$1=iteratorsCore.IteratorPrototype,returnThis$1=function(){return this},createIteratorConstructor=function(e,t,r){var n=t+" Iterator";return e.prototype=objectCreate(IteratorPrototype$1,{next:createPropertyDescriptor(1,r)}),setToStringTag(e,n,!1),iterators[n]=returnThis$1,e},aPossiblePrototype=function(e){if(!isObject(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e},objectSetPrototypeOf=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),t=r instanceof Array}catch(e){}return function(r,n){return anObject(r),aPossiblePrototype(n),t?e.call(r,n):r.__proto__=n,r}}():void 0),IteratorPrototype$2=iteratorsCore.IteratorPrototype,BUGGY_SAFARI_ITERATORS$1=iteratorsCore.BUGGY_SAFARI_ITERATORS,ITERATOR$1=wellKnownSymbol("iterator"),KEYS="keys",VALUES="values",ENTRIES="entries",returnThis$2=function(){return this},defineIterator=function(e,t,r,n,o,i,a){createIteratorConstructor(r,t,n);var s,l,u,c=function(e){if(e===o&&y)return y;if(!BUGGY_SAFARI_ITERATORS$1&&e in d)return d[e];switch(e){case KEYS:case VALUES:case ENTRIES:return function(){return new r(this,e)}}return function(){return new r(this)}},f=t+" Iterator",h=!1,d=e.prototype,p=d[ITERATOR$1]||d["@@iterator"]||o&&d[o],y=!BUGGY_SAFARI_ITERATORS$1&&p||c(o),g="Array"==t&&d.entries||p;if(g&&(s=objectGetPrototypeOf(g.call(new e)),IteratorPrototype$2!==Object.prototype&&s.next&&(objectGetPrototypeOf(s)!==IteratorPrototype$2&&(objectSetPrototypeOf?objectSetPrototypeOf(s,IteratorPrototype$2):"function"!=typeof s[ITERATOR$1]&&createNonEnumerableProperty(s,ITERATOR$1,returnThis$2)),setToStringTag(s,f,!0))),o==VALUES&&p&&p.name!==VALUES&&(h=!0,y=function(){return p.call(this)}),d[ITERATOR$1]!==y&&createNonEnumerableProperty(d,ITERATOR$1,y),iterators[t]=y,o)if(l={values:c(VALUES),keys:i?y:c(KEYS),entries:c(ENTRIES)},a)for(u in l)(BUGGY_SAFARI_ITERATORS$1||h||!(u in d))&&redefine(d,u,l[u]);else _export({target:t,proto:!0,forced:BUGGY_SAFARI_ITERATORS$1||h},l);return l},ARRAY_ITERATOR="Array Iterator",setInternalState=internalState.set,getInternalState=internalState.getterFor(ARRAY_ITERATOR),es_array_iterator=defineIterator(Array,"Array",(function(e,t){setInternalState(this,{type:ARRAY_ITERATOR,target:toIndexedObject(e),index:0,kind:t})}),(function(){var e=getInternalState(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}}),"values");iterators.Arguments=iterators.Array,addToUnscopables("keys"),addToUnscopables("values"),addToUnscopables("entries");var TO_STRING_TAG$1=wellKnownSymbol("toStringTag"),test={};test[TO_STRING_TAG$1]="z";var toStringTagSupport="[object z]"===String(test),TO_STRING_TAG$2=wellKnownSymbol("toStringTag"),CORRECT_ARGUMENTS="Arguments"==classofRaw(function(){return arguments}()),tryGet=function(e,t){try{return e[t]}catch(e){}},classof=toStringTagSupport?classofRaw:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=tryGet(t=Object(e),TO_STRING_TAG$2))?r:CORRECT_ARGUMENTS?classofRaw(t):"Object"==(n=classofRaw(t))&&"function"==typeof t.callee?"Arguments":n},objectToString=toStringTagSupport?{}.toString:function(){return"[object "+classof(this)+"]"};toStringTagSupport||redefine(Object.prototype,"toString",objectToString,{unsafe:!0});var createMethod$1=function(e){return function(t,r){var n,o,i=String(requireObjectCoercible(t)),a=toInteger(r),s=i.length;return a<0||a>=s?e?"":void 0:(n=i.charCodeAt(a))<55296||n>56319||a+1===s||(o=i.charCodeAt(a+1))<56320||o>57343?e?i.charAt(a):n:e?i.slice(a,a+2):o-56320+(n-55296<<10)+65536}},stringMultibyte={codeAt:createMethod$1(!1),charAt:createMethod$1(!0)},charAt=stringMultibyte.charAt,STRING_ITERATOR="String Iterator",setInternalState$1=internalState.set,getInternalState$1=internalState.getterFor(STRING_ITERATOR);defineIterator(String,"String",(function(e){setInternalState$1(this,{type:STRING_ITERATOR,string:String(e),index:0})}),(function(){var e,t=getInternalState$1(this),r=t.string,n=t.index;return n>=r.length?{value:void 0,done:!0}:(e=charAt(r,n),t.index+=e.length,{value:e,done:!1})}));var redefineAll=function(e,t,r){for(var n in t)redefine(e,n,t[n],r);return e},freezing=!fails((function(){return Object.isExtensible(Object.preventExtensions({}))})),internalMetadata=createCommonjsModule((function(e){var t=objectDefineProperty.f,r=uid("meta"),n=0,o=Object.isExtensible||function(){return!0},i=function(e){t(e,r,{value:{objectID:"O"+ ++n,weakData:{}}})},a=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!isObject(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!has(e,r)){if(!o(e))return"F";if(!t)return"E";i(e)}return e[r].objectID},getWeakData:function(e,t){if(!has(e,r)){if(!o(e))return!0;if(!t)return!1;i(e)}return e[r].weakData},onFreeze:function(e){return freezing&&a.REQUIRED&&o(e)&&!has(e,r)&&i(e),e}};hiddenKeys[r]=!0})),ITERATOR$2=wellKnownSymbol("iterator"),ArrayPrototype$1=Array.prototype,isArrayIteratorMethod=function(e){return void 0!==e&&(iterators.Array===e||ArrayPrototype$1[ITERATOR$2]===e)},aFunction$1=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},functionBindContext=function(e,t,r){if(aFunction$1(e),void 0===t)return e;switch(r){case 0:return function(){return e.call(t)};case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}},ITERATOR$3=wellKnownSymbol("iterator"),getIteratorMethod=function(e){if(null!=e)return e[ITERATOR$3]||e["@@iterator"]||iterators[classof(e)]},callWithSafeIterationClosing=function(e,t,r,n){try{return n?t(anObject(r)[0],r[1]):t(r)}catch(t){var o=e.return;throw void 0!==o&&anObject(o.call(e)),t}},iterate_1=createCommonjsModule((function(e){var t=function(e,t){this.stopped=e,this.result=t};(e.exports=function(e,r,n,o,i){var a,s,l,u,c,f,h,d=functionBindContext(r,n,o?2:1);if(i)a=e;else{if("function"!=typeof(s=getIteratorMethod(e)))throw TypeError("Target is not iterable");if(isArrayIteratorMethod(s)){for(l=0,u=toLength(e.length);u>l;l++)if((c=o?d(anObject(h=e[l])[0],h[1]):d(e[l]))&&c instanceof t)return c;return new t(!1)}a=s.call(e)}for(f=a.next;!(h=f.call(a)).done;)if("object"==typeof(c=callWithSafeIterationClosing(a,d,h.value,o))&&c&&c instanceof t)return c;return new t(!1)}).stop=function(e){return new t(!0,e)}})),anInstance=function(e,t,r){if(!(e instanceof t))throw TypeError("Incorrect "+(r?r+" ":"")+"invocation");return e},ITERATOR$4=wellKnownSymbol("iterator"),SAFE_CLOSING=!1;try{var called=0,iteratorWithReturn={next:function(){return{done:!!called++}},return:function(){SAFE_CLOSING=!0}};iteratorWithReturn[ITERATOR$4]=function(){return this},Array.from(iteratorWithReturn,(function(){throw 2}))}catch(error){}var checkCorrectnessOfIteration=function(e,t){if(!t&&!SAFE_CLOSING)return!1;var r=!1;try{var n={};n[ITERATOR$4]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch(e){}return r},inheritIfRequired=function(e,t,r){var n,o;return objectSetPrototypeOf&&"function"==typeof(n=t.constructor)&&n!==r&&isObject(o=n.prototype)&&o!==r.prototype&&objectSetPrototypeOf(e,o),e},collection=function(e,t,r){var n=-1!==e.indexOf("Map"),o=-1!==e.indexOf("Weak"),i=n?"set":"add",a=global_1[e],s=a&&a.prototype,l=a,u={},c=function(e){var t=s[e];redefine(s,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(o&&!isObject(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return o&&!isObject(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(o&&!isObject(e))&&t.call(this,0===e?0:e)}:function(e,r){return t.call(this,0===e?0:e,r),this})};if(isForced_1(e,"function"!=typeof a||!(o||s.forEach&&!fails((function(){(new a).entries().next()})))))l=r.getConstructor(t,e,n,i),internalMetadata.REQUIRED=!0;else if(isForced_1(e,!0)){var f=new l,h=f[i](o?{}:-0,1)!=f,d=fails((function(){f.has(1)})),p=checkCorrectnessOfIteration((function(e){new a(e)})),y=!o&&fails((function(){for(var e=new a,t=5;t--;)e[i](t,t);return!e.has(-0)}));p||((l=t((function(t,r){anInstance(t,l,e);var o=inheritIfRequired(new a,t,l);return null!=r&&iterate_1(r,o[i],o,n),o}))).prototype=s,s.constructor=l),(d||y)&&(c("delete"),c("has"),n&&c("get")),(y||h)&&c(i),o&&s.clear&&delete s.clear}return u[e]=l,_export({global:!0,forced:l!=a},u),setToStringTag(l,e),o||r.setStrong(l,e,n),l},isArray=Array.isArray||function(e){return"Array"==classofRaw(e)},SPECIES=wellKnownSymbol("species"),arraySpeciesCreate=function(e,t){var r;return isArray(e)&&("function"!=typeof(r=e.constructor)||r!==Array&&!isArray(r.prototype)?isObject(r)&&null===(r=r[SPECIES])&&(r=void 0):r=void 0),new(void 0===r?Array:r)(0===t?0:t)},push=[].push,createMethod$2=function(e){var t=1==e,r=2==e,n=3==e,o=4==e,i=6==e,a=5==e||i;return function(s,l,u,c){for(var f,h,d=toObject(s),p=indexedObject(d),y=functionBindContext(l,u,3),g=toLength(p.length),m=0,v=c||arraySpeciesCreate,_=t?v(s,g):r?v(s,0):void 0;g>m;m++)if((a||m in p)&&(h=y(f=p[m],m,d),e))if(t)_[m]=h;else if(h)switch(e){case 3:return!0;case 5:return f;case 6:return m;case 2:push.call(_,f)}else if(o)return!1;return i?-1:n||o?o:_}},arrayIteration={forEach:createMethod$2(0),map:createMethod$2(1),filter:createMethod$2(2),some:createMethod$2(3),every:createMethod$2(4),find:createMethod$2(5),findIndex:createMethod$2(6)},getWeakData=internalMetadata.getWeakData,setInternalState$2=internalState.set,internalStateGetterFor=internalState.getterFor,find=arrayIteration.find,findIndex=arrayIteration.findIndex,id$1=0,uncaughtFrozenStore=function(e){return e.frozen||(e.frozen=new UncaughtFrozenStore)},UncaughtFrozenStore=function(){this.entries=[]},findUncaughtFrozen=function(e,t){return find(e.entries,(function(e){return e[0]===t}))};UncaughtFrozenStore.prototype={get:function(e){var t=findUncaughtFrozen(this,e);if(t)return t[1]},has:function(e){return!!findUncaughtFrozen(this,e)},set:function(e,t){var r=findUncaughtFrozen(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=findIndex(this.entries,(function(t){return t[0]===e}));return~t&&this.entries.splice(t,1),!!~t}};var collectionWeak={getConstructor:function(e,t,r,n){var o=e((function(e,i){anInstance(e,o,t),setInternalState$2(e,{type:t,id:id$1++,frozen:void 0}),null!=i&&iterate_1(i,e[n],e,r)})),i=internalStateGetterFor(t),a=function(e,t,r){var n=i(e),o=getWeakData(anObject(t),!0);return!0===o?uncaughtFrozenStore(n).set(t,r):o[n.id]=r,e};return redefineAll(o.prototype,{delete:function(e){var t=i(this);if(!isObject(e))return!1;var r=getWeakData(e);return!0===r?uncaughtFrozenStore(t).delete(e):r&&has(r,t.id)&&delete r[t.id]},has:function(e){var t=i(this);if(!isObject(e))return!1;var r=getWeakData(e);return!0===r?uncaughtFrozenStore(t).has(e):r&&has(r,t.id)}}),redefineAll(o.prototype,r?{get:function(e){var t=i(this);if(isObject(e)){var r=getWeakData(e);return!0===r?uncaughtFrozenStore(t).get(e):r?r[t.id]:void 0}},set:function(e,t){return a(this,e,t)}}:{add:function(e){return a(this,e,!0)}}),o}},es_weakMap=createCommonjsModule((function(e){var t,r=internalState.enforce,n=!global_1.ActiveXObject&&"ActiveXObject"in global_1,o=Object.isExtensible,i=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},a=e.exports=collection("WeakMap",i,collectionWeak);if(nativeWeakMap&&n){t=collectionWeak.getConstructor(i,"WeakMap",!0),internalMetadata.REQUIRED=!0;var s=a.prototype,l=s.delete,u=s.has,c=s.get,f=s.set;redefineAll(s,{delete:function(e){if(isObject(e)&&!o(e)){var n=r(this);return n.frozen||(n.frozen=new t),l.call(this,e)||n.frozen.delete(e)}return l.call(this,e)},has:function(e){if(isObject(e)&&!o(e)){var n=r(this);return n.frozen||(n.frozen=new t),u.call(this,e)||n.frozen.has(e)}return u.call(this,e)},get:function(e){if(isObject(e)&&!o(e)){var n=r(this);return n.frozen||(n.frozen=new t),u.call(this,e)?c.call(this,e):n.frozen.get(e)}return c.call(this,e)},set:function(e,n){if(isObject(e)&&!o(e)){var i=r(this);i.frozen||(i.frozen=new t),u.call(this,e)?f.call(this,e,n):i.frozen.set(e,n)}else f.call(this,e,n);return this}})}})),domIterables={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},ITERATOR$5=wellKnownSymbol("iterator"),TO_STRING_TAG$3=wellKnownSymbol("toStringTag"),ArrayValues=es_array_iterator.values;for(var COLLECTION_NAME in domIterables){var Collection=global_1[COLLECTION_NAME],CollectionPrototype=Collection&&Collection.prototype;if(CollectionPrototype){if(CollectionPrototype[ITERATOR$5]!==ArrayValues)try{createNonEnumerableProperty(CollectionPrototype,ITERATOR$5,ArrayValues)}catch(error){CollectionPrototype[ITERATOR$5]=ArrayValues}if(CollectionPrototype[TO_STRING_TAG$3]||createNonEnumerableProperty(CollectionPrototype,TO_STRING_TAG$3,COLLECTION_NAME),domIterables[COLLECTION_NAME])for(var METHOD_NAME in es_array_iterator)if(CollectionPrototype[METHOD_NAME]!==es_array_iterator[METHOD_NAME])try{createNonEnumerableProperty(CollectionPrototype,METHOD_NAME,es_array_iterator[METHOD_NAME])}catch(error){CollectionPrototype[METHOD_NAME]=es_array_iterator[METHOD_NAME]}}}var f$6=wellKnownSymbol,wellKnownSymbolWrapped={f:f$6},defineProperty$1=objectDefineProperty.f,defineWellKnownSymbol=function(e){var t=path.Symbol||(path.Symbol={});has(t,e)||defineProperty$1(t,e,{value:wellKnownSymbolWrapped.f(e)})},$forEach=arrayIteration.forEach,HIDDEN=sharedKey("hidden"),SYMBOL="Symbol",PROTOTYPE$1="prototype",TO_PRIMITIVE=wellKnownSymbol("toPrimitive"),setInternalState$3=internalState.set,getInternalState$2=internalState.getterFor(SYMBOL),ObjectPrototype$1=Object[PROTOTYPE$1],$Symbol=global_1.Symbol,$stringify=getBuiltIn("JSON","stringify"),nativeGetOwnPropertyDescriptor$1=objectGetOwnPropertyDescriptor.f,nativeDefineProperty$1=objectDefineProperty.f,nativeGetOwnPropertyNames$2=objectGetOwnPropertyNamesExternal.f,nativePropertyIsEnumerable$1=objectPropertyIsEnumerable.f,AllSymbols=shared("symbols"),ObjectPrototypeSymbols=shared("op-symbols"),StringToSymbolRegistry=shared("string-to-symbol-registry"),SymbolToStringRegistry=shared("symbol-to-string-registry"),WellKnownSymbolsStore$1=shared("wks"),QObject=global_1.QObject,USE_SETTER=!QObject||!QObject[PROTOTYPE$1]||!QObject[PROTOTYPE$1].findChild,setSymbolDescriptor=descriptors&&fails((function(){return 7!=objectCreate(nativeDefineProperty$1({},"a",{get:function(){return nativeDefineProperty$1(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=nativeGetOwnPropertyDescriptor$1(ObjectPrototype$1,t);n&&delete ObjectPrototype$1[t],nativeDefineProperty$1(e,t,r),n&&e!==ObjectPrototype$1&&nativeDefineProperty$1(ObjectPrototype$1,t,n)}:nativeDefineProperty$1,wrap=function(e,t){var r=AllSymbols[e]=objectCreate($Symbol[PROTOTYPE$1]);return setInternalState$3(r,{type:SYMBOL,tag:e,description:t}),descriptors||(r.description=t),r},isSymbol=useSymbolAsUid?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof $Symbol},$defineProperty=function(e,t,r){e===ObjectPrototype$1&&$defineProperty(ObjectPrototypeSymbols,t,r),anObject(e);var n=toPrimitive(t,!0);return anObject(r),has(AllSymbols,n)?(r.enumerable?(has(e,HIDDEN)&&e[HIDDEN][n]&&(e[HIDDEN][n]=!1),r=objectCreate(r,{enumerable:createPropertyDescriptor(0,!1)})):(has(e,HIDDEN)||nativeDefineProperty$1(e,HIDDEN,createPropertyDescriptor(1,{})),e[HIDDEN][n]=!0),setSymbolDescriptor(e,n,r)):nativeDefineProperty$1(e,n,r)},$defineProperties=function(e,t){anObject(e);var r=toIndexedObject(t),n=objectKeys(r).concat($getOwnPropertySymbols(r));return $forEach(n,(function(t){descriptors&&!$propertyIsEnumerable.call(r,t)||$defineProperty(e,t,r[t])})),e},$create=function(e,t){return void 0===t?objectCreate(e):$defineProperties(objectCreate(e),t)},$propertyIsEnumerable=function(e){var t=toPrimitive(e,!0),r=nativePropertyIsEnumerable$1.call(this,t);return!(this===ObjectPrototype$1&&has(AllSymbols,t)&&!has(ObjectPrototypeSymbols,t))&&(!(r||!has(this,t)||!has(AllSymbols,t)||has(this,HIDDEN)&&this[HIDDEN][t])||r)},$getOwnPropertyDescriptor=function(e,t){var r=toIndexedObject(e),n=toPrimitive(t,!0);if(r!==ObjectPrototype$1||!has(AllSymbols,n)||has(ObjectPrototypeSymbols,n)){var o=nativeGetOwnPropertyDescriptor$1(r,n);return!o||!has(AllSymbols,n)||has(r,HIDDEN)&&r[HIDDEN][n]||(o.enumerable=!0),o}},$getOwnPropertyNames=function(e){var t=nativeGetOwnPropertyNames$2(toIndexedObject(e)),r=[];return $forEach(t,(function(e){has(AllSymbols,e)||has(hiddenKeys,e)||r.push(e)})),r},$getOwnPropertySymbols=function(e){var t=e===ObjectPrototype$1,r=nativeGetOwnPropertyNames$2(t?ObjectPrototypeSymbols:toIndexedObject(e)),n=[];return $forEach(r,(function(e){!has(AllSymbols,e)||t&&!has(ObjectPrototype$1,e)||n.push(AllSymbols[e])})),n};if(nativeSymbol||($Symbol=function(){if(this instanceof $Symbol)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=uid(e),r=function(e){this===ObjectPrototype$1&&r.call(ObjectPrototypeSymbols,e),has(this,HIDDEN)&&has(this[HIDDEN],t)&&(this[HIDDEN][t]=!1),setSymbolDescriptor(this,t,createPropertyDescriptor(1,e))};return descriptors&&USE_SETTER&&setSymbolDescriptor(ObjectPrototype$1,t,{configurable:!0,set:r}),wrap(t,e)},redefine($Symbol[PROTOTYPE$1],"toString",(function(){return getInternalState$2(this).tag})),redefine($Symbol,"withoutSetter",(function(e){return wrap(uid(e),e)})),objectPropertyIsEnumerable.f=$propertyIsEnumerable,objectDefineProperty.f=$defineProperty,objectGetOwnPropertyDescriptor.f=$getOwnPropertyDescriptor,objectGetOwnPropertyNames.f=objectGetOwnPropertyNamesExternal.f=$getOwnPropertyNames,objectGetOwnPropertySymbols.f=$getOwnPropertySymbols,wellKnownSymbolWrapped.f=function(e){return wrap(wellKnownSymbol(e),e)},descriptors&&(nativeDefineProperty$1($Symbol[PROTOTYPE$1],"description",{configurable:!0,get:function(){return getInternalState$2(this).description}}),redefine(ObjectPrototype$1,"propertyIsEnumerable",$propertyIsEnumerable,{unsafe:!0}))),_export({global:!0,wrap:!0,forced:!nativeSymbol,sham:!nativeSymbol},{Symbol:$Symbol}),$forEach(objectKeys(WellKnownSymbolsStore$1),(function(e){defineWellKnownSymbol(e)})),_export({target:SYMBOL,stat:!0,forced:!nativeSymbol},{for:function(e){var t=String(e);if(has(StringToSymbolRegistry,t))return StringToSymbolRegistry[t];var r=$Symbol(t);return StringToSymbolRegistry[t]=r,SymbolToStringRegistry[r]=t,r},keyFor:function(e){if(!isSymbol(e))throw TypeError(e+" is not a symbol");if(has(SymbolToStringRegistry,e))return SymbolToStringRegistry[e]},useSetter:function(){USE_SETTER=!0},useSimple:function(){USE_SETTER=!1}}),_export({target:"Object",stat:!0,forced:!nativeSymbol,sham:!descriptors},{create:$create,defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor}),_export({target:"Object",stat:!0,forced:!nativeSymbol},{getOwnPropertyNames:$getOwnPropertyNames,getOwnPropertySymbols:$getOwnPropertySymbols}),_export({target:"Object",stat:!0,forced:fails((function(){objectGetOwnPropertySymbols.f(1)}))},{getOwnPropertySymbols:function(e){return objectGetOwnPropertySymbols.f(toObject(e))}}),$stringify){var FORCED_JSON_STRINGIFY=!nativeSymbol||fails((function(){var e=$Symbol();return"[null]"!=$stringify([e])||"{}"!=$stringify({a:e})||"{}"!=$stringify(Object(e))}));_export({target:"JSON",stat:!0,forced:FORCED_JSON_STRINGIFY},{stringify:function(e,t,r){for(var n,o=[e],i=1;arguments.length>i;)o.push(arguments[i++]);if(n=t,(isObject(t)||void 0!==e)&&!isSymbol(e))return isArray(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!isSymbol(t))return t}),o[1]=t,$stringify.apply(null,o)}})}$Symbol[PROTOTYPE$1][TO_PRIMITIVE]||createNonEnumerableProperty($Symbol[PROTOTYPE$1],TO_PRIMITIVE,$Symbol[PROTOTYPE$1].valueOf),setToStringTag($Symbol,SYMBOL),hiddenKeys[HIDDEN]=!0;var defineProperty$2=objectDefineProperty.f,NativeSymbol=global_1.Symbol;if(descriptors&&"function"==typeof NativeSymbol&&(!("description"in NativeSymbol.prototype)||void 0!==NativeSymbol().description)){var EmptyStringDescriptionStore={},SymbolWrapper=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof SymbolWrapper?new NativeSymbol(e):void 0===e?NativeSymbol():NativeSymbol(e);return""===e&&(EmptyStringDescriptionStore[t]=!0),t};copyConstructorProperties(SymbolWrapper,NativeSymbol);var symbolPrototype=SymbolWrapper.prototype=NativeSymbol.prototype;symbolPrototype.constructor=SymbolWrapper;var symbolToString=symbolPrototype.toString,native="Symbol(test)"==String(NativeSymbol("test")),regexp=/^Symbol\((.*)\)[^)]+$/;defineProperty$2(symbolPrototype,"description",{configurable:!0,get:function(){var e=isObject(this)?this.valueOf():this,t=symbolToString.call(e);if(has(EmptyStringDescriptionStore,e))return"";var r=native?t.slice(7,-1):t.replace(regexp,"$1");return""===r?void 0:r}}),_export({global:!0,forced:!0},{Symbol:SymbolWrapper})}defineWellKnownSymbol("iterator");var createProperty=function(e,t,r){var n=toPrimitive(t);n in e?objectDefineProperty.f(e,n,createPropertyDescriptor(0,r)):e[n]=r},arrayFrom=function(e){var t,r,n,o,i,a,s=toObject(e),l="function"==typeof this?this:Array,u=arguments.length,c=u>1?arguments[1]:void 0,f=void 0!==c,h=getIteratorMethod(s),d=0;if(f&&(c=functionBindContext(c,u>2?arguments[2]:void 0,2)),null==h||l==Array&&isArrayIteratorMethod(h))for(r=new l(t=toLength(s.length));t>d;d++)a=f?c(s[d],d):s[d],createProperty(r,d,a);else for(i=(o=h.call(s)).next,r=new l;!(n=i.call(o)).done;d++)a=f?callWithSafeIterationClosing(o,c,[n.value,d],!0):n.value,createProperty(r,d,a);return r.length=d,r},INCORRECT_ITERATION=!checkCorrectnessOfIteration((function(e){Array.from(e)}));_export({target:"Array",stat:!0,forced:INCORRECT_ITERATION},{from:arrayFrom});var engineUserAgent=getBuiltIn("navigator","userAgent")||"",process=global_1.process,versions=process&&process.versions,v8=versions&&versions.v8,match,version;v8?(match=v8.split("."),version=match[0]+match[1]):engineUserAgent&&(match=engineUserAgent.match(/Edge\/(\d+)/),(!match||match[1]>=74)&&(match=engineUserAgent.match(/Chrome\/(\d+)/),match&&(version=match[1])));var engineV8Version=version&&+version,SPECIES$1=wellKnownSymbol("species"),arrayMethodHasSpeciesSupport=function(e){return engineV8Version>=51||!fails((function(){var t=[];return(t.constructor={})[SPECIES$1]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},defineProperty$3=Object.defineProperty,cache={},thrower=function(e){throw e},arrayMethodUsesToLength=function(e,t){if(has(cache,e))return cache[e];t||(t={});var r=[][e],n=!!has(t,"ACCESSORS")&&t.ACCESSORS,o=has(t,0)?t[0]:thrower,i=has(t,1)?t[1]:void 0;return cache[e]=!!r&&!fails((function(){if(n&&!descriptors)return!0;var e={length:-1};n?defineProperty$3(e,1,{enumerable:!0,get:thrower}):e[1]=1,r.call(e,o,i)}))},HAS_SPECIES_SUPPORT=arrayMethodHasSpeciesSupport("slice"),USES_TO_LENGTH=arrayMethodUsesToLength("slice",{ACCESSORS:!0,0:0,1:2}),SPECIES$2=wellKnownSymbol("species"),nativeSlice=[].slice,max$1=Math.max;_export({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT||!USES_TO_LENGTH},{slice:function(e,t){var r,n,o,i=toIndexedObject(this),a=toLength(i.length),s=toAbsoluteIndex(e,a),l=toAbsoluteIndex(void 0===t?a:t,a);if(isArray(i)&&("function"!=typeof(r=i.constructor)||r!==Array&&!isArray(r.prototype)?isObject(r)&&null===(r=r[SPECIES$2])&&(r=void 0):r=void 0,r===Array||void 0===r))return nativeSlice.call(i,s,l);for(n=new(void 0===r?Array:r)(max$1(l-s,0)),o=0;s<l;s++,o++)s in i&&createProperty(n,o,i[s]);return n.length=o,n}});var defineProperty$4=objectDefineProperty.f,FunctionPrototype=Function.prototype,FunctionPrototypeToString=FunctionPrototype.toString,nameRE=/^\s*function ([^ (]*)/,NAME="name";descriptors&&!(NAME in FunctionPrototype)&&defineProperty$4(FunctionPrototype,NAME,{configurable:!0,get:function(){try{return FunctionPrototypeToString.call(this).match(nameRE)[1]}catch(e){return""}}});var SPECIES$3=wellKnownSymbol("species"),setSpecies=function(e){var t=getBuiltIn(e),r=objectDefineProperty.f;descriptors&&t&&!t[SPECIES$3]&&r(t,SPECIES$3,{configurable:!0,get:function(){return this}})},defineProperty$5=objectDefineProperty.f,fastKey=internalMetadata.fastKey,setInternalState$4=internalState.set,internalStateGetterFor$1=internalState.getterFor,collectionStrong={getConstructor:function(e,t,r,n){var o=e((function(e,i){anInstance(e,o,t),setInternalState$4(e,{type:t,index:objectCreate(null),first:void 0,last:void 0,size:0}),descriptors||(e.size=0),null!=i&&iterate_1(i,e[n],e,r)})),i=internalStateGetterFor$1(t),a=function(e,t,r){var n,o,a=i(e),l=s(e,t);return l?l.value=r:(a.last=l={index:o=fastKey(t,!0),key:t,value:r,previous:n=a.last,next:void 0,removed:!1},a.first||(a.first=l),n&&(n.next=l),descriptors?a.size++:e.size++,"F"!==o&&(a.index[o]=l)),e},s=function(e,t){var r,n=i(e),o=fastKey(t);if("F"!==o)return n.index[o];for(r=n.first;r;r=r.next)if(r.key==t)return r};return redefineAll(o.prototype,{clear:function(){for(var e=i(this),t=e.index,r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete t[r.index],r=r.next;e.first=e.last=void 0,descriptors?e.size=0:this.size=0},delete:function(e){var t=this,r=i(t),n=s(t,e);if(n){var o=n.next,a=n.previous;delete r.index[n.index],n.removed=!0,a&&(a.next=o),o&&(o.previous=a),r.first==n&&(r.first=o),r.last==n&&(r.last=a),descriptors?r.size--:t.size--}return!!n},forEach:function(e){for(var t,r=i(this),n=functionBindContext(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:r.first;)for(n(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!s(this,e)}}),redefineAll(o.prototype,r?{get:function(e){var t=s(this,e);return t&&t.value},set:function(e,t){return a(this,0===e?0:e,t)}}:{add:function(e){return a(this,e=0===e?0:e,e)}}),descriptors&&defineProperty$5(o.prototype,"size",{get:function(){return i(this).size}}),o},setStrong:function(e,t,r){var n=t+" Iterator",o=internalStateGetterFor$1(t),i=internalStateGetterFor$1(n);defineIterator(e,t,(function(e,t){setInternalState$4(this,{type:n,target:e,state:o(e),kind:t,last:void 0})}),(function(){for(var e=i(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),setSpecies(t)}},es_map=collection("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),collectionStrong),regexpFlags=function(){var e=anObject(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},TO_STRING="toString",RegExpPrototype=RegExp.prototype,nativeToString=RegExpPrototype[TO_STRING],NOT_GENERIC=fails((function(){return"/a/b"!=nativeToString.call({source:"a",flags:"b"})})),INCORRECT_NAME=nativeToString.name!=TO_STRING;function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}(NOT_GENERIC||INCORRECT_NAME)&&redefine(RegExp.prototype,TO_STRING,(function(){var e=anObject(this),t=String(e.source),r=e.flags;return"/"+t+"/"+String(void 0===r&&e instanceof RegExp&&!("flags"in RegExpPrototype)?regexpFlags.call(e):r)}),{unsafe:!0});var collection$1=new Map;function staticRegister(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";collection$1.has(e)||collection$1.set(e,new Map);var t=collection$1.get(e);function r(e,r){t.set(e,r)}function n(e){return t.get(e)}function o(e){return t.has(e)}function i(){return _toConsumableArray(t.keys())}function a(){return _toConsumableArray(t.values())}return{register:r,getItem:n,hasItem:o,getNames:i,getValues:a}}var arrayMethodIsStrict=function(e,t){var r=[][e];return!!r&&fails((function(){r.call(null,t||function(){throw 1},1)}))},$indexOf=arrayIncludes.indexOf,nativeIndexOf=[].indexOf,NEGATIVE_ZERO=!!nativeIndexOf&&1/[1].indexOf(1,-0)<0,STRICT_METHOD=arrayMethodIsStrict("indexOf"),USES_TO_LENGTH$1=arrayMethodUsesToLength("indexOf",{ACCESSORS:!0,1:0});_export({target:"Array",proto:!0,forced:NEGATIVE_ZERO||!STRICT_METHOD||!USES_TO_LENGTH$1},{indexOf:function(e){return NEGATIVE_ZERO?nativeIndexOf.apply(this,arguments)||0:$indexOf(this,e,arguments.length>1?arguments[1]:void 0)}});var HAS_SPECIES_SUPPORT$1=arrayMethodHasSpeciesSupport("splice"),USES_TO_LENGTH$2=arrayMethodUsesToLength("splice",{ACCESSORS:!0,0:0,1:2}),max$2=Math.max,min$2=Math.min,MAX_SAFE_INTEGER=9007199254740991,MAXIMUM_ALLOWED_LENGTH_EXCEEDED="Maximum allowed length exceeded";_export({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT$1||!USES_TO_LENGTH$2},{splice:function(e,t){var r,n,o,i,a,s,l=toObject(this),u=toLength(l.length),c=toAbsoluteIndex(e,u),f=arguments.length;if(0===f?r=n=0:1===f?(r=0,n=u-c):(r=f-2,n=min$2(max$2(toInteger(t),0),u-c)),u+r-n>MAX_SAFE_INTEGER)throw TypeError(MAXIMUM_ALLOWED_LENGTH_EXCEEDED);for(o=arraySpeciesCreate(l,n),i=0;i<n;i++)(a=c+i)in l&&createProperty(o,i,l[a]);if(o.length=n,r<n){for(i=c;i<u-n;i++)s=i+r,(a=i+n)in l?l[s]=l[a]:delete l[s];for(i=u;i>u-n+r;i--)delete l[i-1]}else if(r>n)for(i=u-n;i>c;i--)s=i+r-1,(a=i+n-1)in l?l[s]=l[a]:delete l[s];for(i=0;i<r;i++)l[i+c]=arguments[i+2];return l.length=u-n+r,o}});var onFreeze=internalMetadata.onFreeze,nativeFreeze=Object.freeze,FAILS_ON_PRIMITIVES$1=fails((function(){nativeFreeze(1)}));_export({target:"Object",stat:!0,forced:FAILS_ON_PRIMITIVES$1,sham:!freezing},{freeze:function(e){return nativeFreeze&&isObject(e)?nativeFreeze(onFreeze(e)):e}});var IS_CONCAT_SPREADABLE=wellKnownSymbol("isConcatSpreadable"),MAX_SAFE_INTEGER$1=9007199254740991,MAXIMUM_ALLOWED_INDEX_EXCEEDED="Maximum allowed index exceeded",IS_CONCAT_SPREADABLE_SUPPORT=engineV8Version>=51||!fails((function(){var e=[];return e[IS_CONCAT_SPREADABLE]=!1,e.concat()[0]!==e})),SPECIES_SUPPORT=arrayMethodHasSpeciesSupport("concat"),isConcatSpreadable=function(e){if(!isObject(e))return!1;var t=e[IS_CONCAT_SPREADABLE];return void 0!==t?!!t:isArray(e)},FORCED=!IS_CONCAT_SPREADABLE_SUPPORT||!SPECIES_SUPPORT;_export({target:"Array",proto:!0,forced:FORCED},{concat:function(e){var t,r,n,o,i,a=toObject(this),s=arraySpeciesCreate(a,0),l=0;for(t=-1,n=arguments.length;t<n;t++)if(isConcatSpreadable(i=-1===t?a:arguments[t])){if(l+(o=toLength(i.length))>MAX_SAFE_INTEGER$1)throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);for(r=0;r<o;r++,l++)r in i&&createProperty(s,l,i[r])}else{if(l>=MAX_SAFE_INTEGER$1)throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);createProperty(s,l++,i)}return s.length=l,s}});var $filter=arrayIteration.filter,HAS_SPECIES_SUPPORT$2=arrayMethodHasSpeciesSupport("filter"),USES_TO_LENGTH$3=arrayMethodUsesToLength("filter");_export({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT$2||!USES_TO_LENGTH$3},{filter:function(e){return $filter(this,e,arguments.length>1?arguments[1]:void 0)}});var $includes=arrayIncludes.includes,USES_TO_LENGTH$4=arrayMethodUsesToLength("indexOf",{ACCESSORS:!0,1:0});function RE(e,t){return RegExp(e,t)}_export({target:"Array",proto:!0,forced:!USES_TO_LENGTH$4},{includes:function(e){return $includes(this,e,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables("includes");var UNSUPPORTED_Y=fails((function(){var e=RE("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),BROKEN_CARET=fails((function(){var e=RE("^r","gy");return e.lastIndex=2,null!=e.exec("str")})),regexpStickyHelpers={UNSUPPORTED_Y:UNSUPPORTED_Y,BROKEN_CARET:BROKEN_CARET},nativeExec=RegExp.prototype.exec,nativeReplace=String.prototype.replace,patchedExec=nativeExec,UPDATES_LAST_INDEX_WRONG=function(){var e=/a/,t=/b*/g;return nativeExec.call(e,"a"),nativeExec.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),UNSUPPORTED_Y$1=regexpStickyHelpers.UNSUPPORTED_Y||regexpStickyHelpers.BROKEN_CARET,NPCG_INCLUDED=void 0!==/()??/.exec("")[1],PATCH=UPDATES_LAST_INDEX_WRONG||NPCG_INCLUDED||UNSUPPORTED_Y$1;PATCH&&(patchedExec=function(e){var t,r,n,o,i=this,a=UNSUPPORTED_Y$1&&i.sticky,s=regexpFlags.call(i),l=i.source,u=0,c=e;return a&&(-1===(s=s.replace("y","")).indexOf("g")&&(s+="g"),c=String(e).slice(i.lastIndex),i.lastIndex>0&&(!i.multiline||i.multiline&&"\n"!==e[i.lastIndex-1])&&(l="(?: "+l+")",c=" "+c,u++),r=new RegExp("^(?:"+l+")",s)),NPCG_INCLUDED&&(r=new RegExp("^"+l+"$(?!\\s)",s)),UPDATES_LAST_INDEX_WRONG&&(t=i.lastIndex),n=nativeExec.call(a?r:i,c),a?n?(n.input=n.input.slice(u),n[0]=n[0].slice(u),n.index=i.lastIndex,i.lastIndex+=n[0].length):i.lastIndex=0:UPDATES_LAST_INDEX_WRONG&&n&&(i.lastIndex=i.global?n.index+n[0].length:t),NPCG_INCLUDED&&n&&n.length>1&&nativeReplace.call(n[0],r,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(n[o]=void 0)})),n});var regexpExec=patchedExec;_export({target:"RegExp",proto:!0,forced:/./.exec!==regexpExec},{exec:regexpExec});var es_set=collection("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),collectionStrong),MATCH=wellKnownSymbol("match"),isRegexp=function(e){var t;return isObject(e)&&(void 0!==(t=e[MATCH])?!!t:"RegExp"==classofRaw(e))},notARegexp=function(e){if(isRegexp(e))throw TypeError("The method doesn't accept regular expressions");return e},MATCH$1=wellKnownSymbol("match"),correctIsRegexpLogic=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[MATCH$1]=!1,"/./"[e](t)}catch(e){}}return!1};_export({target:"String",proto:!0,forced:!correctIsRegexpLogic("includes")},{includes:function(e){return!!~String(requireObjectCoercible(this)).indexOf(notARegexp(e),arguments.length>1?arguments[1]:void 0)}});var SPECIES$4=wellKnownSymbol("species"),REPLACE_SUPPORTS_NAMED_GROUPS=!fails((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),REPLACE_KEEPS_$0="$0"==="a".replace(/./,"$0"),REPLACE=wellKnownSymbol("replace"),REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE=!!/./[REPLACE]&&""===/./[REPLACE]("a","$0"),SPLIT_WORKS_WITH_OVERWRITTEN_EXEC=!fails((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2!==r.length||"a"!==r[0]||"b"!==r[1]})),fixRegexpWellKnownSymbolLogic=function(e,t,r,n){var o=wellKnownSymbol(e),i=!fails((function(){var t={};return t[o]=function(){return 7},7!=""[e](t)})),a=i&&!fails((function(){var t=!1,r=/a/;return"split"===e&&((r={}).constructor={},r.constructor[SPECIES$4]=function(){return r},r.flags="",r[o]=/./[o]),r.exec=function(){return t=!0,null},r[o](""),!t}));if(!i||!a||"replace"===e&&(!REPLACE_SUPPORTS_NAMED_GROUPS||!REPLACE_KEEPS_$0||REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE)||"split"===e&&!SPLIT_WORKS_WITH_OVERWRITTEN_EXEC){var s=/./[o],l=r(o,""[e],(function(e,t,r,n,o){return t.exec===regexpExec?i&&!o?{done:!0,value:s.call(t,r,n)}:{done:!0,value:e.call(r,t,n)}:{done:!1}}),{REPLACE_KEEPS_$0:REPLACE_KEEPS_$0,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE}),u=l[0],c=l[1];redefine(String.prototype,e,u),redefine(RegExp.prototype,o,2==t?function(e,t){return c.call(e,this,t)}:function(e){return c.call(e,this)})}n&&createNonEnumerableProperty(RegExp.prototype[o],"sham",!0)},SPECIES$5=wellKnownSymbol("species"),speciesConstructor=function(e,t){var r,n=anObject(e).constructor;return void 0===n||null==(r=anObject(n)[SPECIES$5])?t:aFunction$1(r)},charAt$1=stringMultibyte.charAt,advanceStringIndex=function(e,t,r){return t+(r?charAt$1(e,t).length:1)},regexpExecAbstract=function(e,t){var r=e.exec;if("function"==typeof r){var n=r.call(e,t);if("object"!=typeof n)throw TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==classofRaw(e))throw TypeError("RegExp#exec called on incompatible receiver");return regexpExec.call(e,t)},arrayPush=[].push,min$3=Math.min,MAX_UINT32=4294967295,SUPPORTS_Y=!fails((function(){return!RegExp(MAX_UINT32,"y")}));function to2dArray(e){for(var t=e.length,r=0;r<t;)e[r]=[e[r]],r+=1}function extendArray(e,t){for(var r=t.length,n=0;n<r;)e.push(t[n]),n+=1}function pivot(e){var t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;for(var r=e.length,n=e[0].length,o=0;o<r;o++)for(var i=0;i<n;i++)t[i]||(t[i]=[]),t[i][o]=e[o][i];return t}function arrayReduce(e,t,r,n){var o=-1,i=e,a=r;Array.isArray(e)||(i=Array.from(e));var s=i.length;for(n&&s&&(a=i[o+=1]),o+=1;o<s;)a=t(a,i[o],o,i),o+=1;return a}function arrayFilter(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var s=n[r];t(s,r,n)&&(i[a+=1]=s),r+=1}return i}function arrayMap(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length,i=[],a=-1;r<o;){var s=n[r];i[a+=1]=t(s,r,n),r+=1}return i}function arrayEach(e,t){var r=0,n=e;Array.isArray(e)||(n=Array.from(e));for(var o=n.length;r<o&&!1!==t(n[r],r,n);)r+=1;return e}function arraySum(e){return arrayReduce(e,(function(e,t){return e+t}),0)}function arrayMax(e){return arrayReduce(e,(function(e,t){return e>t?e:t}),Array.isArray(e)?e[0]:void 0)}function arrayMin(e){return arrayReduce(e,(function(e,t){return e<t?e:t}),Array.isArray(e)?e[0]:void 0)}function arrayAvg(e){return e.length?arraySum(e)/e.length:0}function arrayFlatten(e){return arrayReduce(e,(function(e,t){return e.concat(Array.isArray(t)?arrayFlatten(t):t)}),[])}function arrayUnique(e){var t=[];return arrayEach(e,(function(e){-1===t.indexOf(e)&&t.push(e)})),t}function getDifferenceOfArrays(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return arrayEach(i,(function(e){a=a.filter((function(t){return!e.includes(t)}))})),a}function getIntersectionOfArrays(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=o;return arrayEach(i,(function(e){a=a.filter((function(t){return e.includes(t)}))})),a}function getUnionOfArrays(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[].concat(t),o=n[0],i=n.slice(1),a=new Set(o);return arrayEach(i,(function(e){arrayEach(e,(function(e){a.has(e)||a.add(e)}))})),Array.from(a)}function stringToArray(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e.split(t)}fixRegexpWellKnownSymbolLogic("split",2,(function(e,t,r){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var n=String(requireObjectCoercible(this)),o=void 0===r?MAX_UINT32:r>>>0;if(0===o)return[];if(void 0===e)return[n];if(!isRegexp(e))return t.call(n,e,o);for(var i,a,s,l=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),c=0,f=new RegExp(e.source,u+"g");(i=regexpExec.call(f,n))&&!((a=f.lastIndex)>c&&(l.push(n.slice(c,i.index)),i.length>1&&i.index<n.length&&arrayPush.apply(l,i.slice(1)),s=i[0].length,c=a,l.length>=o));)f.lastIndex===i.index&&f.lastIndex++;return c===n.length?!s&&f.test("")||l.push(""):l.push(n.slice(c)),l.length>o?l.slice(0,o):l}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:t.call(this,e,r)}:t,[function(t,r){var o=requireObjectCoercible(this),i=null==t?void 0:t[e];return void 0!==i?i.call(t,o,r):n.call(String(o),t,r)},function(e,o){var i=r(n,e,this,o,n!==t);if(i.done)return i.value;var a=anObject(e),s=String(this),l=speciesConstructor(a,RegExp),u=a.unicode,c=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(SUPPORTS_Y?"y":"g"),f=new l(SUPPORTS_Y?a:"^(?:"+a.source+")",c),h=void 0===o?MAX_UINT32:o>>>0;if(0===h)return[];if(0===s.length)return null===regexpExecAbstract(f,s)?[s]:[];for(var d=0,p=0,y=[];p<s.length;){f.lastIndex=SUPPORTS_Y?p:0;var g,m=regexpExecAbstract(f,SUPPORTS_Y?s:s.slice(p));if(null===m||(g=min$3(toLength(f.lastIndex+(SUPPORTS_Y?0:p)),s.length))===d)p=advanceStringIndex(s,p,u);else{if(y.push(s.slice(d,p)),y.length===h)return y;for(var v=1;v<=m.length-1;v++)if(y.push(m[v]),y.length===h)return y;p=d=g}}return y.push(s.slice(d)),y}]}),!SUPPORTS_Y);var arrayHelpers=Object.freeze({__proto__:null,to2dArray:to2dArray,extendArray:extendArray,pivot:pivot,arrayReduce:arrayReduce,arrayFilter:arrayFilter,arrayMap:arrayMap,arrayEach:arrayEach,arraySum:arraySum,arrayMax:arrayMax,arrayMin:arrayMin,arrayAvg:arrayAvg,arrayFlatten:arrayFlatten,arrayUnique:arrayUnique,getDifferenceOfArrays:getDifferenceOfArrays,getIntersectionOfArrays:getIntersectionOfArrays,getUnionOfArrays:getUnionOfArrays,stringToArray:stringToArray}),$forEach$1=arrayIteration.forEach,STRICT_METHOD$1=arrayMethodIsStrict("forEach"),USES_TO_LENGTH$5=arrayMethodUsesToLength("forEach"),arrayForEach=STRICT_METHOD$1&&USES_TO_LENGTH$5?[].forEach:function(e){return $forEach$1(this,e,arguments.length>1?arguments[1]:void 0)};for(var COLLECTION_NAME$1 in _export({target:"Array",proto:!0,forced:[].forEach!=arrayForEach},{forEach:arrayForEach}),domIterables){var Collection$1=global_1[COLLECTION_NAME$1],CollectionPrototype$1=Collection$1&&Collection$1.prototype;if(CollectionPrototype$1&&CollectionPrototype$1.forEach!==arrayForEach)try{createNonEnumerableProperty(CollectionPrototype$1,"forEach",arrayForEach)}catch(error){CollectionPrototype$1.forEach=arrayForEach}}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function duckSchema(e){var t;return Array.isArray(e)?t=[]:(t={},objectEach(e,(function(e,r){"__children"!==r&&(e&&"object"===_typeof(e)&&!Array.isArray(e)?t[r]=duckSchema(e):Array.isArray(e)?e.length&&"object"===_typeof(e[0])&&!Array.isArray(e[0])?t[r]=[duckSchema(e[0])]:t[r]=[]:t[r]=null)}))),t}function inherit(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function extend(e,t,r){var n=Array.isArray(r);return objectEach(t,(function(t,o){(!1===n||r.includes(o))&&(e[o]=t)})),e}function deepExtend(e,t){objectEach(t,(function(r,n){t[n]&&"object"===_typeof(t[n])?(e[n]||(Array.isArray(t[n])?e[n]=[]:"[object Date]"===Object.prototype.toString.call(t[n])?e[n]=t[n]:e[n]={}),deepExtend(e[n],t[n])):e[n]=t[n]}))}function deepClone(e){return"object"===_typeof(e)?JSON.parse(JSON.stringify(e)):e}function clone(e){var t={};return objectEach(e,(function(e,r){t[r]=e})),t}function mixin(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return arrayEach(r,(function(t){e.MIXINS.push(t.MIXIN_NAME),objectEach(t,(function(t,r){if(void 0!==e.prototype[r])throw new Error("Mixin conflict. Property '".concat(r,"' already exist and cannot be overwritten."));if("function"==typeof t)e.prototype[r]=t;else{Object.defineProperty(e.prototype,r,{get:(n=r,o=t,i="_".concat(n),function(){var e;return void 0===this[i]&&(this[i]=(e=o,(Array.isArray(e)||isObject$1(e))&&(e=deepClone(e)),e)),this[i]}),set:function(e){var t="_".concat(e);return function(e){this[t]=e}}(r),configurable:!0})}var n,o,i}))})),e}function isObjectEqual(e,t){return JSON.stringify(e)===JSON.stringify(t)}function isObject$1(e){return"[object Object]"===Object.prototype.toString.call(e)}function defineGetter(e,t,r,n){n.value=r,n.writable=!1!==n.writable,n.enumerable=!1!==n.enumerable,n.configurable=!1!==n.configurable,Object.defineProperty(e,t,n)}function objectEach(e,t){for(var r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&!1===t(e[r],r,e))break;return e}function getProperty(e,t){var r=t.split("."),n=e;return objectEach(r,(function(e){if(void 0===(n=n[e]))return n=void 0,!1})),n}function setProperty(e,t,r){var n=t.split("."),o=e;n.forEach((function(e,t){t!==n.length-1?(hasOwnProperty$1(o,e)||(o[e]={}),o=o[e]):o[e]=r}))}function deepObjectSize(e){if(!isObject$1(e))return 0;return function e(t){var r=0;return isObject$1(t)?objectEach(t,(function(t,n){"__children"!==n&&(r+=e(t))})):r+=1,r}(e)}function createObjectPropListener(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",n="_".concat(r),o=(_defineProperty(t={_touched:!1},n,e),_defineProperty(t,"isTouched",(function(){return this._touched})),t);return Object.defineProperty(o,r,{get:function(){return this[n]},set:function(e){this._touched=!0,this[n]=e},enumerable:!0,configurable:!0}),o}function hasOwnProperty$1(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var objectHelpers=Object.freeze({__proto__:null,duckSchema:duckSchema,inherit:inherit,extend:extend,deepExtend:deepExtend,deepClone:deepClone,clone:clone,mixin:mixin,isObjectEqual:isObjectEqual,isObject:isObject$1,defineGetter:defineGetter,objectEach:objectEach,getProperty:getProperty,setProperty:setProperty,deepObjectSize:deepObjectSize,createObjectPropListener:createObjectPropListener,hasOwnProperty:hasOwnProperty$1}),max$3=Math.max,min$4=Math.min,floor$1=Math.floor,SUBSTITUTION_SYMBOLS=/\$([$&'`]|\d\d?|<[^>]*>)/g,SUBSTITUTION_SYMBOLS_NO_NAMED=/\$([$&'`]|\d\d?)/g,maybeToString=function(e){return void 0===e?e:String(e)};fixRegexpWellKnownSymbolLogic("replace",2,(function(e,t,r,n){var o=n.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,i=n.REPLACE_KEEPS_$0,a=o?"$":"$0";return[function(r,n){var o=requireObjectCoercible(this),i=null==r?void 0:r[e];return void 0!==i?i.call(r,o,n):t.call(String(o),r,n)},function(e,n){if(!o&&i||"string"==typeof n&&-1===n.indexOf(a)){var l=r(t,e,this,n);if(l.done)return l.value}var u=anObject(e),c=String(this),f="function"==typeof n;f||(n=String(n));var h=u.global;if(h){var d=u.unicode;u.lastIndex=0}for(var p=[];;){var y=regexpExecAbstract(u,c);if(null===y)break;if(p.push(y),!h)break;""===String(y[0])&&(u.lastIndex=advanceStringIndex(c,toLength(u.lastIndex),d))}for(var g="",m=0,v=0;v<p.length;v++){y=p[v];for(var _=String(y[0]),b=max$3(min$4(toInteger(y.index),c.length),0),C=[],w=1;w<y.length;w++)C.push(maybeToString(y[w]));var E=y.groups;if(f){var S=[_].concat(C,b,c);void 0!==E&&S.push(E);var O=String(n.apply(void 0,S))}else O=s(_,c,b,C,E,n);b>=m&&(g+=c.slice(m,b)+O,m=b+_.length)}return g+c.slice(m)}];function s(e,r,n,o,i,a){var s=n+e.length,l=o.length,u=SUBSTITUTION_SYMBOLS_NO_NAMED;return void 0!==i&&(i=toObject(i),u=SUBSTITUTION_SYMBOLS),t.call(a,u,(function(t,a){var u;switch(a.charAt(0)){case"$":return"$";case"&":return e;case"`":return r.slice(0,n);case"'":return r.slice(s);case"<":u=i[a.slice(1,-1)];break;default:var c=+a;if(0===c)return t;if(c>l){var f=floor$1(c/10);return 0===f?t:f<=l?void 0===o[f-1]?a.charAt(1):o[f-1]+a.charAt(1):t}u=o[c-1]}return void 0===u?"":u}))}}));var codeAt=stringMultibyte.codeAt;_export({target:"String",proto:!0},{codePointAt:function(e){return codeAt(this,e)}});var stringRepeat="".repeat||function(e){var t=String(requireObjectCoercible(this)),r="",n=toInteger(e);if(n<0||n==1/0)throw RangeError("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(t+=t))1&n&&(r+=t);return r},ceil$1=Math.ceil,createMethod$3=function(e){return function(t,r,n){var o,i,a=String(requireObjectCoercible(t)),s=a.length,l=void 0===n?" ":String(n),u=toLength(r);return u<=s||""==l?a:(o=u-s,(i=stringRepeat.call(l,ceil$1(o/l.length))).length>o&&(i=i.slice(0,o)),e?a+i:i+a)}},stringPad={start:createMethod$3(!1),end:createMethod$3(!0)},stringPadWebkitBug=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(engineUserAgent),$padStart=stringPad.start;_export({target:"String",proto:!0,forced:stringPadWebkitBug},{padStart:function(e){return $padStart(this,e,arguments.length>1?arguments[1]:void 0)}});var moment=createCommonjsModule((function(e,t){e.exports=function(){var t,r;function n(){return t.apply(null,arguments)}function o(e){t=e}function i(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function a(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function s(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}function l(e){return void 0===e}function u(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function c(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function f(e,t){var r,n=[];for(r=0;r<e.length;++r)n.push(t(e[r],r));return n}function h(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function d(e,t){for(var r in t)h(t,r)&&(e[r]=t[r]);return h(t,"toString")&&(e.toString=t.toString),h(t,"valueOf")&&(e.valueOf=t.valueOf),e}function p(e,t,r,n){return zr(e,t,r,n,!0).utc()}function y(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function g(e){return null==e._pf&&(e._pf=y()),e._pf}function m(e){if(null==e._isValid){var t=g(e),n=r.call(t.parsedDateParts,(function(e){return null!=e})),o=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(o=o&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return o;e._isValid=o}return e._isValid}function v(e){var t=p(NaN);return null!=e?d(g(t),e):g(t).userInvalidated=!0,t}r=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),r=t.length>>>0,n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};var _=n.momentProperties=[];function b(e,t){var r,n,o;if(l(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),l(t._i)||(e._i=t._i),l(t._f)||(e._f=t._f),l(t._l)||(e._l=t._l),l(t._strict)||(e._strict=t._strict),l(t._tzm)||(e._tzm=t._tzm),l(t._isUTC)||(e._isUTC=t._isUTC),l(t._offset)||(e._offset=t._offset),l(t._pf)||(e._pf=g(t)),l(t._locale)||(e._locale=t._locale),_.length>0)for(r=0;r<_.length;r++)l(o=t[n=_[r]])||(e[n]=o);return e}var C=!1;function w(e){b(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===C&&(C=!0,n.updateOffset(this),C=!1)}function E(e){return e instanceof w||null!=e&&null!=e._isAMomentObject}function S(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function O(e){var t=+e,r=0;return 0!==t&&isFinite(t)&&(r=S(t)),r}function T(e,t,r){var n,o=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),a=0;for(n=0;n<o;n++)(r&&e[n]!==t[n]||!r&&O(e[n])!==O(t[n]))&&a++;return a+i}function R(e){!1===n.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function $(e,t){var r=!0;return d((function(){if(null!=n.deprecationHandler&&n.deprecationHandler(null,e),r){for(var o,i=[],a=0;a<arguments.length;a++){if(o="","object"==typeof arguments[a]){for(var s in o+="\n["+a+"] ",arguments[0])o+=s+": "+arguments[0][s]+", ";o=o.slice(0,-2)}else o=arguments[a];i.push(o)}R(e+"\nArguments: "+Array.prototype.slice.call(i).join("")+"\n"+(new Error).stack),r=!1}return t.apply(this,arguments)}),t)}var I,A={};function P(e,t){null!=n.deprecationHandler&&n.deprecationHandler(e,t),A[e]||(R(t),A[e]=!0)}function k(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function N(e){var t,r;for(r in e)k(t=e[r])?this[r]=t:this["_"+r]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function M(e,t){var r,n=d({},e);for(r in t)h(t,r)&&(a(e[r])&&a(t[r])?(n[r]={},d(n[r],e[r]),d(n[r],t[r])):null!=t[r]?n[r]=t[r]:delete n[r]);for(r in e)h(e,r)&&!h(t,r)&&a(e[r])&&(n[r]=d({},n[r]));return n}function D(e){null!=e&&this.set(e)}n.suppressDeprecationWarnings=!1,n.deprecationHandler=null,I=Object.keys?Object.keys:function(e){var t,r=[];for(t in e)h(e,t)&&r.push(t);return r};var L={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function x(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return k(n)?n.call(t,r):n}var H={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function j(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.replace(/MMMM|MM|DD|dddd/g,(function(e){return e.slice(1)})),this._longDateFormat[e])}var F="Invalid date";function U(){return this._invalidDate}var B="%d",V=/\d{1,2}/;function W(e){return this._ordinal.replace("%d",e)}var G={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function z(e,t,r,n){var o=this._relativeTime[r];return k(o)?o(e,t,r,n):o.replace(/%d/i,e)}function Y(e,t){var r=this._relativeTime[e>0?"future":"past"];return k(r)?r(t):r.replace(/%s/i,t)}var K={};function X(e,t){var r=e.toLowerCase();K[r]=K[r+"s"]=K[t]=e}function q(e){return"string"==typeof e?K[e]||K[e.toLowerCase()]:void 0}function Q(e){var t,r,n={};for(r in e)h(e,r)&&(t=q(r))&&(n[t]=e[r]);return n}var Z={};function J(e,t){Z[e]=t}function ee(e){var t=[];for(var r in e)t.push({unit:r,priority:Z[r]});return t.sort((function(e,t){return e.priority-t.priority})),t}function te(e,t,r){var n=""+Math.abs(e),o=t-n.length;return(e>=0?r?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+n}var re=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ne=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,oe={},ie={};function ae(e,t,r,n){var o=n;"string"==typeof n&&(o=function(){return this[n]()}),e&&(ie[e]=o),t&&(ie[t[0]]=function(){return te(o.apply(this,arguments),t[1],t[2])}),r&&(ie[r]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function se(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function le(e){var t,r,n=e.match(re);for(t=0,r=n.length;t<r;t++)ie[n[t]]?n[t]=ie[n[t]]:n[t]=se(n[t]);return function(t){var o,i="";for(o=0;o<r;o++)i+=k(n[o])?n[o].call(t,e):n[o];return i}}function ue(e,t){return e.isValid()?(t=ce(t,e.localeData()),oe[t]=oe[t]||le(t),oe[t](e)):e.localeData().invalidDate()}function ce(e,t){var r=5;function n(e){return t.longDateFormat(e)||e}for(ne.lastIndex=0;r>=0&&ne.test(e);)e=e.replace(ne,n),ne.lastIndex=0,r-=1;return e}var fe=/\d/,he=/\d\d/,de=/\d{3}/,pe=/\d{4}/,ye=/[+-]?\d{6}/,ge=/\d\d?/,me=/\d\d\d\d?/,ve=/\d\d\d\d\d\d?/,_e=/\d{1,3}/,be=/\d{1,4}/,Ce=/[+-]?\d{1,6}/,we=/\d+/,Ee=/[+-]?\d+/,Se=/Z|[+-]\d\d:?\d\d/gi,Oe=/Z|[+-]\d\d(?::?\d\d)?/gi,Te=/[+-]?\d+(\.\d{1,3})?/,Re=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,$e={};function Ie(e,t,r){$e[e]=k(t)?t:function(e,n){return e&&r?r:t}}function Ae(e,t){return h($e,e)?$e[e](t._strict,t._locale):new RegExp(Pe(e))}function Pe(e){return ke(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,t,r,n,o){return t||r||n||o})))}function ke(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var Ne={};function Me(e,t){var r,n=t;for("string"==typeof e&&(e=[e]),u(t)&&(n=function(e,r){r[t]=O(e)}),r=0;r<e.length;r++)Ne[e[r]]=n}function De(e,t){Me(e,(function(e,r,n,o){n._w=n._w||{},t(e,n._w,n,o)}))}function Le(e,t,r){null!=t&&h(Ne,e)&&Ne[e](t,r._a,r,e)}var xe=0,He=1,je=2,Fe=3,Ue=4,Be=5,Ve=6,We=7,Ge=8;function ze(e){return Ye(e)?366:365}function Ye(e){return e%4==0&&e%100!=0||e%400==0}ae("Y",0,0,(function(){var e=this.year();return e<=9999?""+e:"+"+e})),ae(0,["YY",2],0,(function(){return this.year()%100})),ae(0,["YYYY",4],0,"year"),ae(0,["YYYYY",5],0,"year"),ae(0,["YYYYYY",6,!0],0,"year"),X("year","y"),J("year",1),Ie("Y",Ee),Ie("YY",ge,he),Ie("YYYY",be,pe),Ie("YYYYY",Ce,ye),Ie("YYYYYY",Ce,ye),Me(["YYYYY","YYYYYY"],xe),Me("YYYY",(function(e,t){t[xe]=2===e.length?n.parseTwoDigitYear(e):O(e)})),Me("YY",(function(e,t){t[xe]=n.parseTwoDigitYear(e)})),Me("Y",(function(e,t){t[xe]=parseInt(e,10)})),n.parseTwoDigitYear=function(e){return O(e)+(O(e)>68?1900:2e3)};var Ke,Xe=Qe("FullYear",!0);function qe(){return Ye(this.year())}function Qe(e,t){return function(r){return null!=r?(Je(this,e,r),n.updateOffset(this,t),this):Ze(this,e)}}function Ze(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function Je(e,t,r){e.isValid()&&!isNaN(r)&&("FullYear"===t&&Ye(e.year())&&1===e.month()&&29===e.date()?e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),nt(r,e.month())):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function et(e){return k(this[e=q(e)])?this[e]():this}function tt(e,t){if("object"==typeof e)for(var r=ee(e=Q(e)),n=0;n<r.length;n++)this[r[n].unit](e[r[n].unit]);else if(k(this[e=q(e)]))return this[e](t);return this}function rt(e,t){return(e%t+t)%t}function nt(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=rt(t,12);return e+=(t-r)/12,1===r?Ye(e)?29:28:31-r%7%2}Ke=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},ae("M",["MM",2],"Mo",(function(){return this.month()+1})),ae("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),ae("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),X("month","M"),J("month",8),Ie("M",ge),Ie("MM",ge,he),Ie("MMM",(function(e,t){return t.monthsShortRegex(e)})),Ie("MMMM",(function(e,t){return t.monthsRegex(e)})),Me(["M","MM"],(function(e,t){t[He]=O(e)-1})),Me(["MMM","MMMM"],(function(e,t,r,n){var o=r._locale.monthsParse(e,n,r._strict);null!=o?t[He]=o:g(r).invalidMonth=e}));var ot=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,it="January_February_March_April_May_June_July_August_September_October_November_December".split("_");function at(e,t){return e?i(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||ot).test(t)?"format":"standalone"][e.month()]:i(this._months)?this._months:this._months.standalone}var st="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function lt(e,t){return e?i(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[ot.test(t)?"format":"standalone"][e.month()]:i(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ut(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)i=p([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase();return r?"MMM"===t?-1!==(o=Ke.call(this._shortMonthsParse,a))?o:null:-1!==(o=Ke.call(this._longMonthsParse,a))?o:null:"MMM"===t?-1!==(o=Ke.call(this._shortMonthsParse,a))||-1!==(o=Ke.call(this._longMonthsParse,a))?o:null:-1!==(o=Ke.call(this._longMonthsParse,a))||-1!==(o=Ke.call(this._shortMonthsParse,a))?o:null}function ct(e,t,r){var n,o,i;if(this._monthsParseExact)return ut.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(o=p([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),r||this._monthsParse[n]||(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),r&&"MMMM"===t&&this._longMonthsParse[n].test(e))return n;if(r&&"MMM"===t&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function ft(e,t){var r;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=O(t);else if(!u(t=e.localeData().monthsParse(t)))return e;return r=Math.min(e.date(),nt(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function ht(e){return null!=e?(ft(this,e),n.updateOffset(this,!0),this):Ze(this,"Month")}function dt(){return nt(this.year(),this.month())}var pt=Re;function yt(e){return this._monthsParseExact?(h(this,"_monthsRegex")||vt.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(h(this,"_monthsShortRegex")||(this._monthsShortRegex=pt),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}var gt=Re;function mt(e){return this._monthsParseExact?(h(this,"_monthsRegex")||vt.call(this),e?this._monthsStrictRegex:this._monthsRegex):(h(this,"_monthsRegex")||(this._monthsRegex=gt),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function vt(){function e(e,t){return t.length-e.length}var t,r,n=[],o=[],i=[];for(t=0;t<12;t++)r=p([2e3,t]),n.push(this.monthsShort(r,"")),o.push(this.months(r,"")),i.push(this.months(r,"")),i.push(this.monthsShort(r,""));for(n.sort(e),o.sort(e),i.sort(e),t=0;t<12;t++)n[t]=ke(n[t]),o[t]=ke(o[t]);for(t=0;t<24;t++)i[t]=ke(i[t]);this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+n.join("|")+")","i")}function _t(e,t,r,n,o,i,a){var s;return e<100&&e>=0?(s=new Date(e+400,t,r,n,o,i,a),isFinite(s.getFullYear())&&s.setFullYear(e)):s=new Date(e,t,r,n,o,i,a),s}function bt(e){var t;if(e<100&&e>=0){var r=Array.prototype.slice.call(arguments);r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)}else t=new Date(Date.UTC.apply(null,arguments));return t}function Ct(e,t,r){var n=7+t-r;return-(7+bt(e,0,n).getUTCDay()-t)%7+n-1}function wt(e,t,r,n,o){var i,a,s=1+7*(t-1)+(7+r-n)%7+Ct(e,n,o);return s<=0?a=ze(i=e-1)+s:s>ze(e)?(i=e+1,a=s-ze(e)):(i=e,a=s),{year:i,dayOfYear:a}}function Et(e,t,r){var n,o,i=Ct(e.year(),t,r),a=Math.floor((e.dayOfYear()-i-1)/7)+1;return a<1?n=a+St(o=e.year()-1,t,r):a>St(e.year(),t,r)?(n=a-St(e.year(),t,r),o=e.year()+1):(o=e.year(),n=a),{week:n,year:o}}function St(e,t,r){var n=Ct(e,t,r),o=Ct(e+1,t,r);return(ze(e)-n+o)/7}function Ot(e){return Et(e,this._week.dow,this._week.doy).week}ae("w",["ww",2],"wo","week"),ae("W",["WW",2],"Wo","isoWeek"),X("week","w"),X("isoWeek","W"),J("week",5),J("isoWeek",5),Ie("w",ge),Ie("ww",ge,he),Ie("W",ge),Ie("WW",ge,he),De(["w","ww","W","WW"],(function(e,t,r,n){t[n.substr(0,1)]=O(e)}));var Tt={dow:0,doy:6};function Rt(){return this._week.dow}function $t(){return this._week.doy}function It(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function At(e){var t=Et(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function Pt(e,t){return"string"!=typeof e?e:isNaN(e)?"number"==typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}function kt(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function Nt(e,t){return e.slice(t,7).concat(e.slice(0,t))}ae("d",0,"do","day"),ae("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),ae("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),ae("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),ae("e",0,0,"weekday"),ae("E",0,0,"isoWeekday"),X("day","d"),X("weekday","e"),X("isoWeekday","E"),J("day",11),J("weekday",11),J("isoWeekday",11),Ie("d",ge),Ie("e",ge),Ie("E",ge),Ie("dd",(function(e,t){return t.weekdaysMinRegex(e)})),Ie("ddd",(function(e,t){return t.weekdaysShortRegex(e)})),Ie("dddd",(function(e,t){return t.weekdaysRegex(e)})),De(["dd","ddd","dddd"],(function(e,t,r,n){var o=r._locale.weekdaysParse(e,n,r._strict);null!=o?t.d=o:g(r).invalidWeekday=e})),De(["d","e","E"],(function(e,t,r,n){t[n]=O(e)}));var Mt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");function Dt(e,t){var r=i(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?Nt(r,this._week.dow):e?r[e.day()]:r}var Lt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");function xt(e){return!0===e?Nt(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}var Ht="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function jt(e){return!0===e?Nt(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Ft(e,t,r){var n,o,i,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)i=p([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase();return r?"dddd"===t?-1!==(o=Ke.call(this._weekdaysParse,a))?o:null:"ddd"===t?-1!==(o=Ke.call(this._shortWeekdaysParse,a))?o:null:-1!==(o=Ke.call(this._minWeekdaysParse,a))?o:null:"dddd"===t?-1!==(o=Ke.call(this._weekdaysParse,a))||-1!==(o=Ke.call(this._shortWeekdaysParse,a))||-1!==(o=Ke.call(this._minWeekdaysParse,a))?o:null:"ddd"===t?-1!==(o=Ke.call(this._shortWeekdaysParse,a))||-1!==(o=Ke.call(this._weekdaysParse,a))||-1!==(o=Ke.call(this._minWeekdaysParse,a))?o:null:-1!==(o=Ke.call(this._minWeekdaysParse,a))||-1!==(o=Ke.call(this._weekdaysParse,a))||-1!==(o=Ke.call(this._shortWeekdaysParse,a))?o:null}function Ut(e,t,r){var n,o,i;if(this._weekdaysParseExact)return Ft.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(o=p([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),r&&"dddd"===t&&this._fullWeekdaysParse[n].test(e))return n;if(r&&"ddd"===t&&this._shortWeekdaysParse[n].test(e))return n;if(r&&"dd"===t&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function Bt(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=Pt(e,this.localeData()),this.add(e-t,"d")):t}function Vt(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function Wt(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=kt(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}var Gt=Re;function zt(e){return this._weekdaysParseExact?(h(this,"_weekdaysRegex")||Qt.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(h(this,"_weekdaysRegex")||(this._weekdaysRegex=Gt),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}var Yt=Re;function Kt(e){return this._weekdaysParseExact?(h(this,"_weekdaysRegex")||Qt.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(h(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Yt),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}var Xt=Re;function qt(e){return this._weekdaysParseExact?(h(this,"_weekdaysRegex")||Qt.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(h(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Xt),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Qt(){function e(e,t){return t.length-e.length}var t,r,n,o,i,a=[],s=[],l=[],u=[];for(t=0;t<7;t++)r=p([2e3,1]).day(t),n=this.weekdaysMin(r,""),o=this.weekdaysShort(r,""),i=this.weekdays(r,""),a.push(n),s.push(o),l.push(i),u.push(n),u.push(o),u.push(i);for(a.sort(e),s.sort(e),l.sort(e),u.sort(e),t=0;t<7;t++)s[t]=ke(s[t]),l[t]=ke(l[t]),u[t]=ke(u[t]);this._weekdaysRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function Zt(){return this.hours()%12||12}function Jt(){return this.hours()||24}function er(e,t){ae(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)}))}function tr(e,t){return t._meridiemParse}function rr(e){return"p"===(e+"").toLowerCase().charAt(0)}ae("H",["HH",2],0,"hour"),ae("h",["hh",2],0,Zt),ae("k",["kk",2],0,Jt),ae("hmm",0,0,(function(){return""+Zt.apply(this)+te(this.minutes(),2)})),ae("hmmss",0,0,(function(){return""+Zt.apply(this)+te(this.minutes(),2)+te(this.seconds(),2)})),ae("Hmm",0,0,(function(){return""+this.hours()+te(this.minutes(),2)})),ae("Hmmss",0,0,(function(){return""+this.hours()+te(this.minutes(),2)+te(this.seconds(),2)})),er("a",!0),er("A",!1),X("hour","h"),J("hour",13),Ie("a",tr),Ie("A",tr),Ie("H",ge),Ie("h",ge),Ie("k",ge),Ie("HH",ge,he),Ie("hh",ge,he),Ie("kk",ge,he),Ie("hmm",me),Ie("hmmss",ve),Ie("Hmm",me),Ie("Hmmss",ve),Me(["H","HH"],Fe),Me(["k","kk"],(function(e,t,r){var n=O(e);t[Fe]=24===n?0:n})),Me(["a","A"],(function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e})),Me(["h","hh"],(function(e,t,r){t[Fe]=O(e),g(r).bigHour=!0})),Me("hmm",(function(e,t,r){var n=e.length-2;t[Fe]=O(e.substr(0,n)),t[Ue]=O(e.substr(n)),g(r).bigHour=!0})),Me("hmmss",(function(e,t,r){var n=e.length-4,o=e.length-2;t[Fe]=O(e.substr(0,n)),t[Ue]=O(e.substr(n,2)),t[Be]=O(e.substr(o)),g(r).bigHour=!0})),Me("Hmm",(function(e,t,r){var n=e.length-2;t[Fe]=O(e.substr(0,n)),t[Ue]=O(e.substr(n))})),Me("Hmmss",(function(e,t,r){var n=e.length-4,o=e.length-2;t[Fe]=O(e.substr(0,n)),t[Ue]=O(e.substr(n,2)),t[Be]=O(e.substr(o))}));var nr=/[ap]\.?m?\.?/i;function or(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var ir,ar=Qe("Hours",!0),sr={calendar:L,longDateFormat:H,invalidDate:F,ordinal:B,dayOfMonthOrdinalParse:V,relativeTime:G,months:it,monthsShort:st,week:Tt,weekdays:Mt,weekdaysMin:Ht,weekdaysShort:Lt,meridiemParse:nr},lr={},ur={};function cr(e){return e?e.toLowerCase().replace("_","-"):e}function fr(e){for(var t,r,n,o,i=0;i<e.length;){for(t=(o=cr(e[i]).split("-")).length,r=(r=cr(e[i+1]))?r.split("-"):null;t>0;){if(n=hr(o.slice(0,t).join("-")))return n;if(r&&r.length>=t&&T(o,r,!0)>=t-1)break;t--}i++}return ir}function hr(t){var r=null;if(!lr[t]&&e&&e.exports)try{r=ir._abbr,commonjsRequire("./locale/"+t),dr(r)}catch(e){}return lr[t]}function dr(e,t){var r;return e&&((r=l(t)?gr(e):pr(e,t))?ir=r:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),ir._abbr}function pr(e,t){if(null!==t){var r,n=sr;if(t.abbr=e,null!=lr[e])P("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=lr[e]._config;else if(null!=t.parentLocale)if(null!=lr[t.parentLocale])n=lr[t.parentLocale]._config;else{if(null==(r=hr(t.parentLocale)))return ur[t.parentLocale]||(ur[t.parentLocale]=[]),ur[t.parentLocale].push({name:e,config:t}),null;n=r._config}return lr[e]=new D(M(n,t)),ur[e]&&ur[e].forEach((function(e){pr(e.name,e.config)})),dr(e),lr[e]}return delete lr[e],null}function yr(e,t){if(null!=t){var r,n,o=sr;null!=(n=hr(e))&&(o=n._config),(r=new D(t=M(o,t))).parentLocale=lr[e],lr[e]=r,dr(e)}else null!=lr[e]&&(null!=lr[e].parentLocale?lr[e]=lr[e].parentLocale:null!=lr[e]&&delete lr[e]);return lr[e]}function gr(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return ir;if(!i(e)){if(t=hr(e))return t;e=[e]}return fr(e)}function mr(){return I(lr)}function vr(e){var t,r=e._a;return r&&-2===g(e).overflow&&(t=r[He]<0||r[He]>11?He:r[je]<1||r[je]>nt(r[xe],r[He])?je:r[Fe]<0||r[Fe]>24||24===r[Fe]&&(0!==r[Ue]||0!==r[Be]||0!==r[Ve])?Fe:r[Ue]<0||r[Ue]>59?Ue:r[Be]<0||r[Be]>59?Be:r[Ve]<0||r[Ve]>999?Ve:-1,g(e)._overflowDayOfYear&&(t<xe||t>je)&&(t=je),g(e)._overflowWeeks&&-1===t&&(t=We),g(e)._overflowWeekday&&-1===t&&(t=Ge),g(e).overflow=t),e}function _r(e,t,r){return null!=e?e:null!=t?t:r}function br(e){var t=new Date(n.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function Cr(e){var t,r,n,o,i,a=[];if(!e._d){for(n=br(e),e._w&&null==e._a[je]&&null==e._a[He]&&wr(e),null!=e._dayOfYear&&(i=_r(e._a[xe],n[xe]),(e._dayOfYear>ze(i)||0===e._dayOfYear)&&(g(e)._overflowDayOfYear=!0),r=bt(i,0,e._dayOfYear),e._a[He]=r.getUTCMonth(),e._a[je]=r.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=a[t]=n[t];for(;t<7;t++)e._a[t]=a[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[Fe]&&0===e._a[Ue]&&0===e._a[Be]&&0===e._a[Ve]&&(e._nextDay=!0,e._a[Fe]=0),e._d=(e._useUTC?bt:_t).apply(null,a),o=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Fe]=24),e._w&&void 0!==e._w.d&&e._w.d!==o&&(g(e).weekdayMismatch=!0)}}function wr(e){var t,r,n,o,i,a,s,l;if(null!=(t=e._w).GG||null!=t.W||null!=t.E)i=1,a=4,r=_r(t.GG,e._a[xe],Et(Yr(),1,4).year),n=_r(t.W,1),((o=_r(t.E,1))<1||o>7)&&(l=!0);else{i=e._locale._week.dow,a=e._locale._week.doy;var u=Et(Yr(),i,a);r=_r(t.gg,e._a[xe],u.year),n=_r(t.w,u.week),null!=t.d?((o=t.d)<0||o>6)&&(l=!0):null!=t.e?(o=t.e+i,(t.e<0||t.e>6)&&(l=!0)):o=i}n<1||n>St(r,i,a)?g(e)._overflowWeeks=!0:null!=l?g(e)._overflowWeekday=!0:(s=wt(r,n,o,i,a),e._a[xe]=s.year,e._dayOfYear=s.dayOfYear)}var Er=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Sr=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Or=/Z|[+-]\d\d(?::?\d\d)?/,Tr=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Rr=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],$r=/^\/?Date\((\-?\d+)/i;function Ir(e){var t,r,n,o,i,a,s=e._i,l=Er.exec(s)||Sr.exec(s);if(l){for(g(e).iso=!0,t=0,r=Tr.length;t<r;t++)if(Tr[t][1].exec(l[1])){o=Tr[t][0],n=!1!==Tr[t][2];break}if(null==o)return void(e._isValid=!1);if(l[3]){for(t=0,r=Rr.length;t<r;t++)if(Rr[t][1].exec(l[3])){i=(l[2]||" ")+Rr[t][0];break}if(null==i)return void(e._isValid=!1)}if(!n&&null!=i)return void(e._isValid=!1);if(l[4]){if(!Or.exec(l[4]))return void(e._isValid=!1);a="Z"}e._f=o+(i||"")+(a||""),jr(e)}else e._isValid=!1}var Ar=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function Pr(e,t,r,n,o,i){var a=[kr(e),st.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(o,10)];return i&&a.push(parseInt(i,10)),a}function kr(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function Nr(e){return e.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Mr(e,t,r){return!e||Lt.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(g(r).weekdayMismatch=!0,r._isValid=!1,!1)}var Dr={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Lr(e,t,r){if(e)return Dr[e];if(t)return 0;var n=parseInt(r,10),o=n%100;return(n-o)/100*60+o}function xr(e){var t=Ar.exec(Nr(e._i));if(t){var r=Pr(t[4],t[3],t[2],t[5],t[6],t[7]);if(!Mr(t[1],r,e))return;e._a=r,e._tzm=Lr(t[8],t[9],t[10]),e._d=bt.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),g(e).rfc2822=!0}else e._isValid=!1}function Hr(e){var t=$r.exec(e._i);null===t?(Ir(e),!1===e._isValid&&(delete e._isValid,xr(e),!1===e._isValid&&(delete e._isValid,n.createFromInputFallback(e)))):e._d=new Date(+t[1])}function jr(e){if(e._f!==n.ISO_8601)if(e._f!==n.RFC_2822){e._a=[],g(e).empty=!0;var t,r,o,i,a,s=""+e._i,l=s.length,u=0;for(o=ce(e._f,e._locale).match(re)||[],t=0;t<o.length;t++)i=o[t],(r=(s.match(Ae(i,e))||[])[0])&&((a=s.substr(0,s.indexOf(r))).length>0&&g(e).unusedInput.push(a),s=s.slice(s.indexOf(r)+r.length),u+=r.length),ie[i]?(r?g(e).empty=!1:g(e).unusedTokens.push(i),Le(i,r,e)):e._strict&&!r&&g(e).unusedTokens.push(i);g(e).charsLeftOver=l-u,s.length>0&&g(e).unusedInput.push(s),e._a[Fe]<=12&&!0===g(e).bigHour&&e._a[Fe]>0&&(g(e).bigHour=void 0),g(e).parsedDateParts=e._a.slice(0),g(e).meridiem=e._meridiem,e._a[Fe]=Fr(e._locale,e._a[Fe],e._meridiem),Cr(e),vr(e)}else xr(e);else Ir(e)}function Fr(e,t,r){var n;return null==r?t:null!=e.meridiemHour?e.meridiemHour(t,r):null!=e.isPM?((n=e.isPM(r))&&t<12&&(t+=12),n||12!==t||(t=0),t):t}function Ur(e){var t,r,n,o,i;if(0===e._f.length)return g(e).invalidFormat=!0,void(e._d=new Date(NaN));for(o=0;o<e._f.length;o++)i=0,t=b({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[o],jr(t),m(t)&&(i+=g(t).charsLeftOver,i+=10*g(t).unusedTokens.length,g(t).score=i,(null==n||i<n)&&(n=i,r=t));d(e,r||t)}function Br(e){if(!e._d){var t=Q(e._i);e._a=f([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],(function(e){return e&&parseInt(e,10)})),Cr(e)}}function Vr(e){var t=new w(vr(Wr(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function Wr(e){var t=e._i,r=e._f;return e._locale=e._locale||gr(e._l),null===t||void 0===r&&""===t?v({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),E(t)?new w(vr(t)):(c(t)?e._d=t:i(r)?Ur(e):r?jr(e):Gr(e),m(e)||(e._d=null),e))}function Gr(e){var t=e._i;l(t)?e._d=new Date(n.now()):c(t)?e._d=new Date(t.valueOf()):"string"==typeof t?Hr(e):i(t)?(e._a=f(t.slice(0),(function(e){return parseInt(e,10)})),Cr(e)):a(t)?Br(e):u(t)?e._d=new Date(t):n.createFromInputFallback(e)}function zr(e,t,r,n,o){var l={};return!0!==r&&!1!==r||(n=r,r=void 0),(a(e)&&s(e)||i(e)&&0===e.length)&&(e=void 0),l._isAMomentObject=!0,l._useUTC=l._isUTC=o,l._l=r,l._i=e,l._f=t,l._strict=n,Vr(l)}function Yr(e,t,r,n){return zr(e,t,r,n,!1)}n.createFromInputFallback=$("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),n.ISO_8601=function(){},n.RFC_2822=function(){};var Kr=$("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Yr.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:v()})),Xr=$("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Yr.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:v()}));function qr(e,t){var r,n;if(1===t.length&&i(t[0])&&(t=t[0]),!t.length)return Yr();for(r=t[0],n=1;n<t.length;++n)t[n].isValid()&&!t[n][e](r)||(r=t[n]);return r}function Qr(){return qr("isBefore",[].slice.call(arguments,0))}function Zr(){return qr("isAfter",[].slice.call(arguments,0))}var Jr=function(){return Date.now?Date.now():+new Date},en=["year","quarter","month","week","day","hour","minute","second","millisecond"];function tn(e){for(var t in e)if(-1===Ke.call(en,t)||null!=e[t]&&isNaN(e[t]))return!1;for(var r=!1,n=0;n<en.length;++n)if(e[en[n]]){if(r)return!1;parseFloat(e[en[n]])!==O(e[en[n]])&&(r=!0)}return!0}function rn(){return this._isValid}function nn(){return Tn(NaN)}function on(e){var t=Q(e),r=t.year||0,n=t.quarter||0,o=t.month||0,i=t.week||t.isoWeek||0,a=t.day||0,s=t.hour||0,l=t.minute||0,u=t.second||0,c=t.millisecond||0;this._isValid=tn(t),this._milliseconds=+c+1e3*u+6e4*l+1e3*s*60*60,this._days=+a+7*i,this._months=+o+3*n+12*r,this._data={},this._locale=gr(),this._bubble()}function an(e){return e instanceof on}function sn(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function ln(e,t){ae(e,0,0,(function(){var e=this.utcOffset(),r="+";return e<0&&(e=-e,r="-"),r+te(~~(e/60),2)+t+te(~~e%60,2)}))}ln("Z",":"),ln("ZZ",""),Ie("Z",Oe),Ie("ZZ",Oe),Me(["Z","ZZ"],(function(e,t,r){r._useUTC=!0,r._tzm=cn(Oe,e)}));var un=/([\+\-]|\d\d)/gi;function cn(e,t){var r=(t||"").match(e);if(null===r)return null;var n=((r[r.length-1]||[])+"").match(un)||["-",0,0],o=60*n[1]+O(n[2]);return 0===o?0:"+"===n[0]?o:-o}function fn(e,t){var r,o;return t._isUTC?(r=t.clone(),o=(E(e)||c(e)?e.valueOf():Yr(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+o),n.updateOffset(r,!1),r):Yr(e).local()}function hn(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function dn(e,t,r){var o,i=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=cn(Oe,e)))return this}else Math.abs(e)<16&&!r&&(e*=60);return!this._isUTC&&t&&(o=hn(this)),this._offset=e,this._isUTC=!0,null!=o&&this.add(o,"m"),i!==e&&(!t||this._changeInProgress?Pn(this,Tn(e-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,n.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?i:hn(this)}function pn(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function yn(e){return this.utcOffset(0,e)}function gn(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(hn(this),"m")),this}function mn(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=cn(Se,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function vn(e){return!!this.isValid()&&(e=e?Yr(e).utcOffset():0,(this.utcOffset()-e)%60==0)}function _n(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function bn(){if(!l(this._isDSTShifted))return this._isDSTShifted;var e={};if(b(e,this),(e=Wr(e))._a){var t=e._isUTC?p(e._a):Yr(e._a);this._isDSTShifted=this.isValid()&&T(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Cn(){return!!this.isValid()&&!this._isUTC}function wn(){return!!this.isValid()&&this._isUTC}function En(){return!!this.isValid()&&this._isUTC&&0===this._offset}n.updateOffset=function(){};var Sn=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,On=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Tn(e,t){var r,n,o,i=e,a=null;return an(e)?i={ms:e._milliseconds,d:e._days,M:e._months}:u(e)?(i={},t?i[t]=e:i.milliseconds=e):(a=Sn.exec(e))?(r="-"===a[1]?-1:1,i={y:0,d:O(a[je])*r,h:O(a[Fe])*r,m:O(a[Ue])*r,s:O(a[Be])*r,ms:O(sn(1e3*a[Ve]))*r}):(a=On.exec(e))?(r="-"===a[1]?-1:1,i={y:Rn(a[2],r),M:Rn(a[3],r),w:Rn(a[4],r),d:Rn(a[5],r),h:Rn(a[6],r),m:Rn(a[7],r),s:Rn(a[8],r)}):null==i?i={}:"object"==typeof i&&("from"in i||"to"in i)&&(o=In(Yr(i.from),Yr(i.to)),(i={}).ms=o.milliseconds,i.M=o.months),n=new on(i),an(e)&&h(e,"_locale")&&(n._locale=e._locale),n}function Rn(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function $n(e,t){var r={};return r.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function In(e,t){var r;return e.isValid()&&t.isValid()?(t=fn(t,e),e.isBefore(t)?r=$n(e,t):((r=$n(t,e)).milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function An(e,t){return function(r,n){var o;return null===n||isNaN(+n)||(P(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=r,r=n,n=o),Pn(this,Tn(r="string"==typeof r?+r:r,n),e),this}}function Pn(e,t,r,o){var i=t._milliseconds,a=sn(t._days),s=sn(t._months);e.isValid()&&(o=null==o||o,s&&ft(e,Ze(e,"Month")+s*r),a&&Je(e,"Date",Ze(e,"Date")+a*r),i&&e._d.setTime(e._d.valueOf()+i*r),o&&n.updateOffset(e,a||s))}Tn.fn=on.prototype,Tn.invalid=nn;var kn=An(1,"add"),Nn=An(-1,"subtract");function Mn(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function Dn(e,t){var r=e||Yr(),o=fn(r,this).startOf("day"),i=n.calendarFormat(this,o)||"sameElse",a=t&&(k(t[i])?t[i].call(this,r):t[i]);return this.format(a||this.localeData().calendar(i,this,Yr(r)))}function Ln(){return new w(this)}function xn(e,t){var r=E(e)?e:Yr(e);return!(!this.isValid()||!r.isValid())&&("millisecond"===(t=q(t)||"millisecond")?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf())}function Hn(e,t){var r=E(e)?e:Yr(e);return!(!this.isValid()||!r.isValid())&&("millisecond"===(t=q(t)||"millisecond")?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf())}function jn(e,t,r,n){var o=E(e)?e:Yr(e),i=E(t)?t:Yr(t);return!!(this.isValid()&&o.isValid()&&i.isValid())&&("("===(n=n||"()")[0]?this.isAfter(o,r):!this.isBefore(o,r))&&(")"===n[1]?this.isBefore(i,r):!this.isAfter(i,r))}function Fn(e,t){var r,n=E(e)?e:Yr(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=q(t)||"millisecond")?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(t).valueOf()<=r&&r<=this.clone().endOf(t).valueOf()))}function Un(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function Bn(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function Vn(e,t,r){var n,o,i;if(!this.isValid())return NaN;if(!(n=fn(e,this)).isValid())return NaN;switch(o=6e4*(n.utcOffset()-this.utcOffset()),t=q(t)){case"year":i=Wn(this,n)/12;break;case"month":i=Wn(this,n);break;case"quarter":i=Wn(this,n)/3;break;case"second":i=(this-n)/1e3;break;case"minute":i=(this-n)/6e4;break;case"hour":i=(this-n)/36e5;break;case"day":i=(this-n-o)/864e5;break;case"week":i=(this-n-o)/6048e5;break;default:i=this-n}return r?i:S(i)}function Wn(e,t){var r=12*(t.year()-e.year())+(t.month()-e.month()),n=e.clone().add(r,"months");return-(r+(t-n<0?(t-n)/(n-e.clone().add(r-1,"months")):(t-n)/(e.clone().add(r+1,"months")-n)))||0}function Gn(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function zn(e){if(!this.isValid())return null;var t=!0!==e,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?ue(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):k(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",ue(r,"Z")):ue(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Yn(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o="-MM-DD[T]HH:mm:ss.SSS",i=t+'[")]';return this.format(r+n+o+i)}function Kn(e){e||(e=this.isUtc()?n.defaultFormatUtc:n.defaultFormat);var t=ue(this,e);return this.localeData().postformat(t)}function Xn(e,t){return this.isValid()&&(E(e)&&e.isValid()||Yr(e).isValid())?Tn({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function qn(e){return this.from(Yr(),e)}function Qn(e,t){return this.isValid()&&(E(e)&&e.isValid()||Yr(e).isValid())?Tn({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Zn(e){return this.to(Yr(),e)}function Jn(e){var t;return void 0===e?this._locale._abbr:(null!=(t=gr(e))&&(this._locale=t),this)}n.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",n.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var eo=$("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)}));function to(){return this._locale}var ro=1e3,no=60*ro,oo=60*no,io=3506328*oo;function ao(e,t){return(e%t+t)%t}function so(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-io:new Date(e,t,r).valueOf()}function lo(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-io:Date.UTC(e,t,r)}function uo(e){var t;if(void 0===(e=q(e))||"millisecond"===e||!this.isValid())return this;var r=this._isUTC?lo:so;switch(e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=ao(t+(this._isUTC?0:this.utcOffset()*no),oo);break;case"minute":t=this._d.valueOf(),t-=ao(t,no);break;case"second":t=this._d.valueOf(),t-=ao(t,ro)}return this._d.setTime(t),n.updateOffset(this,!0),this}function co(e){var t;if(void 0===(e=q(e))||"millisecond"===e||!this.isValid())return this;var r=this._isUTC?lo:so;switch(e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=oo-ao(t+(this._isUTC?0:this.utcOffset()*no),oo)-1;break;case"minute":t=this._d.valueOf(),t+=no-ao(t,no)-1;break;case"second":t=this._d.valueOf(),t+=ro-ao(t,ro)-1}return this._d.setTime(t),n.updateOffset(this,!0),this}function fo(){return this._d.valueOf()-6e4*(this._offset||0)}function ho(){return Math.floor(this.valueOf()/1e3)}function po(){return new Date(this.valueOf())}function yo(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function go(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function mo(){return this.isValid()?this.toISOString():null}function vo(){return m(this)}function _o(){return d({},g(this))}function bo(){return g(this).overflow}function Co(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function wo(e,t){ae(0,[e,e.length],0,t)}function Eo(e){return Ro.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function So(e){return Ro.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Oo(){return St(this.year(),1,4)}function To(){var e=this.localeData()._week;return St(this.year(),e.dow,e.doy)}function Ro(e,t,r,n,o){var i;return null==e?Et(this,n,o).year:(t>(i=St(e,n,o))&&(t=i),$o.call(this,e,t,r,n,o))}function $o(e,t,r,n,o){var i=wt(e,t,r,n,o),a=bt(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}function Io(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}ae(0,["gg",2],0,(function(){return this.weekYear()%100})),ae(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),wo("gggg","weekYear"),wo("ggggg","weekYear"),wo("GGGG","isoWeekYear"),wo("GGGGG","isoWeekYear"),X("weekYear","gg"),X("isoWeekYear","GG"),J("weekYear",1),J("isoWeekYear",1),Ie("G",Ee),Ie("g",Ee),Ie("GG",ge,he),Ie("gg",ge,he),Ie("GGGG",be,pe),Ie("gggg",be,pe),Ie("GGGGG",Ce,ye),Ie("ggggg",Ce,ye),De(["gggg","ggggg","GGGG","GGGGG"],(function(e,t,r,n){t[n.substr(0,2)]=O(e)})),De(["gg","GG"],(function(e,t,r,o){t[o]=n.parseTwoDigitYear(e)})),ae("Q",0,"Qo","quarter"),X("quarter","Q"),J("quarter",7),Ie("Q",fe),Me("Q",(function(e,t){t[He]=3*(O(e)-1)})),ae("D",["DD",2],"Do","date"),X("date","D"),J("date",9),Ie("D",ge),Ie("DD",ge,he),Ie("Do",(function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient})),Me(["D","DD"],je),Me("Do",(function(e,t){t[je]=O(e.match(ge)[0])}));var Ao=Qe("Date",!0);function Po(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}ae("DDD",["DDDD",3],"DDDo","dayOfYear"),X("dayOfYear","DDD"),J("dayOfYear",4),Ie("DDD",_e),Ie("DDDD",de),Me(["DDD","DDDD"],(function(e,t,r){r._dayOfYear=O(e)})),ae("m",["mm",2],0,"minute"),X("minute","m"),J("minute",14),Ie("m",ge),Ie("mm",ge,he),Me(["m","mm"],Ue);var ko=Qe("Minutes",!1);ae("s",["ss",2],0,"second"),X("second","s"),J("second",15),Ie("s",ge),Ie("ss",ge,he),Me(["s","ss"],Be);var No,Mo=Qe("Seconds",!1);for(ae("S",0,0,(function(){return~~(this.millisecond()/100)})),ae(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),ae(0,["SSS",3],0,"millisecond"),ae(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),ae(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),ae(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),ae(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),ae(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),ae(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),X("millisecond","ms"),J("millisecond",16),Ie("S",_e,fe),Ie("SS",_e,he),Ie("SSS",_e,de),No="SSSS";No.length<=9;No+="S")Ie(No,we);function Do(e,t){t[Ve]=O(1e3*("0."+e))}for(No="S";No.length<=9;No+="S")Me(No,Do);var Lo=Qe("Milliseconds",!1);function xo(){return this._isUTC?"UTC":""}function Ho(){return this._isUTC?"Coordinated Universal Time":""}ae("z",0,0,"zoneAbbr"),ae("zz",0,0,"zoneName");var jo=w.prototype;function Fo(e){return Yr(1e3*e)}function Uo(){return Yr.apply(null,arguments).parseZone()}function Bo(e){return e}jo.add=kn,jo.calendar=Dn,jo.clone=Ln,jo.diff=Vn,jo.endOf=co,jo.format=Kn,jo.from=Xn,jo.fromNow=qn,jo.to=Qn,jo.toNow=Zn,jo.get=et,jo.invalidAt=bo,jo.isAfter=xn,jo.isBefore=Hn,jo.isBetween=jn,jo.isSame=Fn,jo.isSameOrAfter=Un,jo.isSameOrBefore=Bn,jo.isValid=vo,jo.lang=eo,jo.locale=Jn,jo.localeData=to,jo.max=Xr,jo.min=Kr,jo.parsingFlags=_o,jo.set=tt,jo.startOf=uo,jo.subtract=Nn,jo.toArray=yo,jo.toObject=go,jo.toDate=po,jo.toISOString=zn,jo.inspect=Yn,jo.toJSON=mo,jo.toString=Gn,jo.unix=ho,jo.valueOf=fo,jo.creationData=Co,jo.year=Xe,jo.isLeapYear=qe,jo.weekYear=Eo,jo.isoWeekYear=So,jo.quarter=jo.quarters=Io,jo.month=ht,jo.daysInMonth=dt,jo.week=jo.weeks=It,jo.isoWeek=jo.isoWeeks=At,jo.weeksInYear=To,jo.isoWeeksInYear=Oo,jo.date=Ao,jo.day=jo.days=Bt,jo.weekday=Vt,jo.isoWeekday=Wt,jo.dayOfYear=Po,jo.hour=jo.hours=ar,jo.minute=jo.minutes=ko,jo.second=jo.seconds=Mo,jo.millisecond=jo.milliseconds=Lo,jo.utcOffset=dn,jo.utc=yn,jo.local=gn,jo.parseZone=mn,jo.hasAlignedHourOffset=vn,jo.isDST=_n,jo.isLocal=Cn,jo.isUtcOffset=wn,jo.isUtc=En,jo.isUTC=En,jo.zoneAbbr=xo,jo.zoneName=Ho,jo.dates=$("dates accessor is deprecated. Use date instead.",Ao),jo.months=$("months accessor is deprecated. Use month instead",ht),jo.years=$("years accessor is deprecated. Use year instead",Xe),jo.zone=$("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",pn),jo.isDSTShifted=$("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",bn);var Vo=D.prototype;function Wo(e,t,r,n){var o=gr(),i=p().set(n,t);return o[r](i,e)}function Go(e,t,r){if(u(e)&&(t=e,e=void 0),e=e||"",null!=t)return Wo(e,t,r,"month");var n,o=[];for(n=0;n<12;n++)o[n]=Wo(e,n,r,"month");return o}function zo(e,t,r,n){"boolean"==typeof e?(u(t)&&(r=t,t=void 0),t=t||""):(r=t=e,e=!1,u(t)&&(r=t,t=void 0),t=t||"");var o,i=gr(),a=e?i._week.dow:0;if(null!=r)return Wo(t,(r+a)%7,n,"day");var s=[];for(o=0;o<7;o++)s[o]=Wo(t,(o+a)%7,n,"day");return s}function Yo(e,t){return Go(e,t,"months")}function Ko(e,t){return Go(e,t,"monthsShort")}function Xo(e,t,r){return zo(e,t,r,"weekdays")}function qo(e,t,r){return zo(e,t,r,"weekdaysShort")}function Qo(e,t,r){return zo(e,t,r,"weekdaysMin")}Vo.calendar=x,Vo.longDateFormat=j,Vo.invalidDate=U,Vo.ordinal=W,Vo.preparse=Bo,Vo.postformat=Bo,Vo.relativeTime=z,Vo.pastFuture=Y,Vo.set=N,Vo.months=at,Vo.monthsShort=lt,Vo.monthsParse=ct,Vo.monthsRegex=mt,Vo.monthsShortRegex=yt,Vo.week=Ot,Vo.firstDayOfYear=$t,Vo.firstDayOfWeek=Rt,Vo.weekdays=Dt,Vo.weekdaysMin=jt,Vo.weekdaysShort=xt,Vo.weekdaysParse=Ut,Vo.weekdaysRegex=zt,Vo.weekdaysShortRegex=Kt,Vo.weekdaysMinRegex=qt,Vo.isPM=rr,Vo.meridiem=or,dr("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===O(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),n.lang=$("moment.lang is deprecated. Use moment.locale instead.",dr),n.langData=$("moment.langData is deprecated. Use moment.localeData instead.",gr);var Zo=Math.abs;function Jo(){var e=this._data;return this._milliseconds=Zo(this._milliseconds),this._days=Zo(this._days),this._months=Zo(this._months),e.milliseconds=Zo(e.milliseconds),e.seconds=Zo(e.seconds),e.minutes=Zo(e.minutes),e.hours=Zo(e.hours),e.months=Zo(e.months),e.years=Zo(e.years),this}function ei(e,t,r,n){var o=Tn(t,r);return e._milliseconds+=n*o._milliseconds,e._days+=n*o._days,e._months+=n*o._months,e._bubble()}function ti(e,t){return ei(this,e,t,1)}function ri(e,t){return ei(this,e,t,-1)}function ni(e){return e<0?Math.floor(e):Math.ceil(e)}function oi(){var e,t,r,n,o,i=this._milliseconds,a=this._days,s=this._months,l=this._data;return i>=0&&a>=0&&s>=0||i<=0&&a<=0&&s<=0||(i+=864e5*ni(ai(s)+a),a=0,s=0),l.milliseconds=i%1e3,e=S(i/1e3),l.seconds=e%60,t=S(e/60),l.minutes=t%60,r=S(t/60),l.hours=r%24,a+=S(r/24),s+=o=S(ii(a)),a-=ni(ai(o)),n=S(s/12),s%=12,l.days=a,l.months=s,l.years=n,this}function ii(e){return 4800*e/146097}function ai(e){return 146097*e/4800}function si(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if("month"===(e=q(e))||"quarter"===e||"year"===e)switch(t=this._days+n/864e5,r=this._months+ii(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(ai(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return 24*t+n/36e5;case"minute":return 1440*t+n/6e4;case"second":return 86400*t+n/1e3;case"millisecond":return Math.floor(864e5*t)+n;default:throw new Error("Unknown unit "+e)}}function li(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*O(this._months/12):NaN}function ui(e){return function(){return this.as(e)}}var ci=ui("ms"),fi=ui("s"),hi=ui("m"),di=ui("h"),pi=ui("d"),yi=ui("w"),gi=ui("M"),mi=ui("Q"),vi=ui("y");function _i(){return Tn(this)}function bi(e){return e=q(e),this.isValid()?this[e+"s"]():NaN}function Ci(e){return function(){return this.isValid()?this._data[e]:NaN}}var wi=Ci("milliseconds"),Ei=Ci("seconds"),Si=Ci("minutes"),Oi=Ci("hours"),Ti=Ci("days"),Ri=Ci("months"),$i=Ci("years");function Ii(){return S(this.days()/7)}var Ai=Math.round,Pi={ss:44,s:45,m:45,h:22,d:26,M:11};function ki(e,t,r,n,o){return o.relativeTime(t||1,!!r,e,n)}function Ni(e,t,r){var n=Tn(e).abs(),o=Ai(n.as("s")),i=Ai(n.as("m")),a=Ai(n.as("h")),s=Ai(n.as("d")),l=Ai(n.as("M")),u=Ai(n.as("y")),c=o<=Pi.ss&&["s",o]||o<Pi.s&&["ss",o]||i<=1&&["m"]||i<Pi.m&&["mm",i]||a<=1&&["h"]||a<Pi.h&&["hh",a]||s<=1&&["d"]||s<Pi.d&&["dd",s]||l<=1&&["M"]||l<Pi.M&&["MM",l]||u<=1&&["y"]||["yy",u];return c[2]=t,c[3]=+e>0,c[4]=r,ki.apply(null,c)}function Mi(e){return void 0===e?Ai:"function"==typeof e&&(Ai=e,!0)}function Di(e,t){return void 0!==Pi[e]&&(void 0===t?Pi[e]:(Pi[e]=t,"s"===e&&(Pi.ss=t-1),!0))}function Li(e){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),r=Ni(this,!e,t);return e&&(r=t.pastFuture(+this,r)),t.postformat(r)}var xi=Math.abs;function Hi(e){return(e>0)-(e<0)||+e}function ji(){if(!this.isValid())return this.localeData().invalidDate();var e,t,r=xi(this._milliseconds)/1e3,n=xi(this._days),o=xi(this._months);e=S(r/60),t=S(e/60),r%=60,e%=60;var i=S(o/12),a=o%=12,s=n,l=t,u=e,c=r?r.toFixed(3).replace(/\.?0+$/,""):"",f=this.asSeconds();if(!f)return"P0D";var h=f<0?"-":"",d=Hi(this._months)!==Hi(f)?"-":"",p=Hi(this._days)!==Hi(f)?"-":"",y=Hi(this._milliseconds)!==Hi(f)?"-":"";return h+"P"+(i?d+i+"Y":"")+(a?d+a+"M":"")+(s?p+s+"D":"")+(l||u||c?"T":"")+(l?y+l+"H":"")+(u?y+u+"M":"")+(c?y+c+"S":"")}var Fi=on.prototype;return Fi.isValid=rn,Fi.abs=Jo,Fi.add=ti,Fi.subtract=ri,Fi.as=si,Fi.asMilliseconds=ci,Fi.asSeconds=fi,Fi.asMinutes=hi,Fi.asHours=di,Fi.asDays=pi,Fi.asWeeks=yi,Fi.asMonths=gi,Fi.asQuarters=mi,Fi.asYears=vi,Fi.valueOf=li,Fi._bubble=oi,Fi.clone=_i,Fi.get=bi,Fi.milliseconds=wi,Fi.seconds=Ei,Fi.minutes=Si,Fi.hours=Oi,Fi.days=Ti,Fi.weeks=Ii,Fi.months=Ri,Fi.years=$i,Fi.humanize=Li,Fi.toISOString=ji,Fi.toString=ji,Fi.toJSON=ji,Fi.locale=Jn,Fi.localeData=to,Fi.toIsoString=$("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",ji),Fi.lang=eo,ae("X",0,0,"unix"),ae("x",0,0,"valueOf"),Ie("x",Ee),Ie("X",Te),Me("X",(function(e,t,r){r._d=new Date(1e3*parseFloat(e,10))})),Me("x",(function(e,t,r){r._d=new Date(O(e))})),n.version="2.24.0",o(Yr),n.fn=jo,n.min=Qr,n.max=Zr,n.now=Jr,n.utc=p,n.unix=Fo,n.months=Yo,n.isDate=c,n.locale=dr,n.invalid=v,n.duration=Tn,n.isMoment=E,n.weekdays=Xo,n.parseZone=Uo,n.localeData=gr,n.isDuration=an,n.monthsShort=Ko,n.weekdaysMin=Qo,n.defineLocale=pr,n.updateLocale=yr,n.locales=mr,n.weekdaysShort=qo,n.normalizeUnits=q,n.relativeTimeRounding=Mi,n.relativeTimeThreshold=Di,n.calendarFormat=Mn,n.prototype=jo,n.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},n}()})),whitespaces="\t\n\v\f\r                　\u2028\u2029\ufeff",whitespace="["+whitespaces+"]",ltrim=RegExp("^"+whitespace+whitespace+"*"),rtrim=RegExp(whitespace+whitespace+"*$"),createMethod$4=function(e){return function(t){var r=String(requireObjectCoercible(t));return 1&e&&(r=r.replace(ltrim,"")),2&e&&(r=r.replace(rtrim,"")),r}},stringTrim={start:createMethod$4(1),end:createMethod$4(2),trim:createMethod$4(3)},non="​᠎",stringTrimForced=function(e){return fails((function(){return!!whitespaces[e]()||non[e]()!=non||whitespaces[e].name!==e}))},$trim=stringTrim.trim;function toSingleLine(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=arrayReduce(e,(function(e,t,n){return e+t.replace(/\r?\n\s*/g,"")+(r[n]?r[n]:"")}),"");return o.trim()}function _templateObject6(){var e=_taggedTemplateLiteral(['\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: \'non-commercial-and-evaluation\'. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in \n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: \'non-commercial-and-evaluation\'.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20\n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.']);return _templateObject6=function(){return e},e}function _templateObject5(){var e=_taggedTemplateLiteral(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your \n    license key or downgrade to a version released prior to ','. If you need any \n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20\n    license key or downgrade to a version released prior to ','. If you need any\\x20\n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.']);return _templateObject5=function(){return e},e}function _templateObject4(){var e=_taggedTemplateLiteral(['\n    The license key for Handsontable is invalid. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to \n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is invalid.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20\n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.']);return _templateObject4=function(){return e},e}function _templateObject3(){var e=_taggedTemplateLiteral(["\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact \n    us at support@handsontable.com."],["\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20\n    us at support@handsontable.com."]);return _templateObject3=function(){return e},e}function _templateObject2(){var e=_taggedTemplateLiteral(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior \n    to ",". If you need any help, contact us at sales@handsontable.com."],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior\\x20\n    to ",". If you need any help, contact us at sales@handsontable.com."]);return _templateObject2=function(){return e},e}function _templateObject(){var e=_taggedTemplateLiteral(["\n    The license key for Handsontable is invalid. \n    If you need any help, contact us at support@handsontable.com."],["\n    The license key for Handsontable is invalid.\\x20\n    If you need any help, contact us at support@handsontable.com."]);return _templateObject=function(){return e},e}function _taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _typeof$1(e){return(_typeof$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function stringify(e){var t;switch(_typeof$1(e)){case"string":case"number":t="".concat(e);break;case"object":t=null===e?"":e.toString();break;case"undefined":t="";break;default:t=e.toString()}return t}function isDefined(e){return void 0!==e}function isUndefined(e){return void 0===e}function isEmpty(e){return null===e||""===e||isUndefined(e)}function isRegExp(e){return"[object RegExp]"===Object.prototype.toString.call(e)}_export({target:"String",proto:!0,forced:stringTrimForced("trim")},{trim:function(){return $trim(this)}});var _m="length",_hd=function(e){return parseInt(e,16)},_pi=function(e){return parseInt(e,10)},_ss=function(e,t,r){return e.substr(t,r)},_cp=function(e){return e.codePointAt(0)-65},_norm=function(e){return"".concat(e).replace(/\-/g,"")},_extractTime=function(e){return _hd(_ss(_norm(e),_hd("12"),_cp("F")))/(_hd(_ss(_norm(e),_cp("B"),~~![][_m]))||9)},_ignored=function(){return"undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},_notified=!1,consoleMessages={invalid:function(){return toSingleLine(_templateObject())},expired:function(e){var t=e.keyValidityDate,r=e.hotVersion;return toSingleLine(_templateObject2(),t,r,t)},missing:function(){return toSingleLine(_templateObject3())},non_commercial:function(){return""}},domMessages={invalid:function(){return toSingleLine(_templateObject4())},expired:function(e){var t=e.keyValidityDate,r=e.hotVersion;return toSingleLine(_templateObject5(),t,r,t)},missing:function(){return toSingleLine(_templateObject6())},non_commercial:function(){return""}};function _injectProductInfo(e,t){var r,n=!isEmpty(e),o="string"==typeof e&&"non-commercial-and-evaluation"===e.toLowerCase(),i="8.1.0",a="invalid",s="invalid",l=_checkKeySchema(e=_norm(e||""));if(n||o||l)if(l){var u=moment("01/10/2020","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),f=_extractTime(e);if(r=moment(864e5*(f+1),"x").format("MMMM DD, YYYY"),c>f){var h=moment().diff(u,"days");a=h<=1?"valid":"expired",s=h<=15?"valid":"expired"}else a="valid",s="valid"}else o?(a="non_commercial",s="valid"):(a="invalid",s="invalid");else a="missing",s="missing";(_ignored()&&(a="valid",s="valid"),_notified||"valid"===a)||(consoleMessages[a]({keyValidityDate:r,hotVersion:i})&&console["non_commercial"===a?"info":"warn"](consoleMessages[a]({keyValidityDate:r,hotVersion:i})),_notified=!0);if("valid"!==s&&t.parentNode&&domMessages[s]({keyValidityDate:r,hotVersion:i})){var d=document.createElement("div");d.id="hot-display-license-info",d.innerHTML=domMessages[s]({keyValidityDate:r,hotVersion:i}),t.parentNode.insertBefore(d,t.nextSibling)}}function _checkKeySchema(e){var t=[][_m],r=t;if(e[_m]!==_cp("Z"))return!1;for(var n="",o="B<H4P+".split(""),i=_cp(o.shift());i;i=_cp(o.shift()||"A"))--i<""[_m]?r|=(_pi("".concat(_pi(_hd(n)+(_hd(_ss(e,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:n=_ss(e,i,i?1===o[_m]?9:8:6);return r===t}var mixedHelpers=Object.freeze({__proto__:null,stringify:stringify,isDefined:isDefined,isUndefined:isUndefined,isEmpty:isEmpty,isRegExp:isRegExp,_injectProductInfo:_injectProductInfo});function toUpperCaseFirst(e){return e[0].toUpperCase()+e.substr(1)}function equalsIgnoreCase(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var o=r.length;o;){var i=stringify(r[o-=1]).toLowerCase();-1===e.indexOf(i)&&e.push(i)}return 1===e.length}function randomString(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function isPercentValue(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function substitute(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,(function(e,r){return"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===t[r]?"":t[r]}))}var STRIP_TAGS_REGEX=/<\/?\w+\/?>|<\w+[\s|/][^>]*>/gi;function stripTags(e){return"".concat(e).replace(STRIP_TAGS_REGEX,"")}var stringHelpers=Object.freeze({__proto__:null,toUpperCaseFirst:toUpperCaseFirst,equalsIgnoreCase:equalsIgnoreCase,randomString:randomString,isPercentValue:isPercentValue,substitute:substitute,stripTags:stripTags});function warn(){var e;isDefined(console)&&(e=console).warn.apply(e,arguments)}function error(){var e;isDefined(console)&&(e=console).error.apply(e,arguments)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _templateObject$1(){var e=_taggedTemplateLiteral$1(['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. \n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to \n  learn about the migration path.'],['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20\n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20\n  learn about the migration path.']);return _templateObject$1=function(){return e},e}function _taggedTemplateLiteral$1(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var REGISTERED_HOOKS=["afterCellMetaReset","afterChange","afterChangesObserved","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","afterRender","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","modifyColumnHeaderHeight","beforeUndo","afterUndo","beforeRedo","afterRedo","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand"],REMOVED_MESSAGE=toSingleLine(_templateObject$1()),REMOVED_HOOKS=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),DEPRECATED_HOOKS=new Map([]),Hooks=function(){function e(){_classCallCheck(this,e),this.globalBucket=this.createEmptyBucket()}return _createClass(e,null,[{key:"getSingleton",value:function(){return getGlobalSingleton()}}]),_createClass(e,[{key:"createEmptyBucket",value:function(){var e=Object.create(null);return arrayEach(REGISTERED_HOOKS,(function(t){return e[t]=[]})),e}},{key:"getBucket",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}},{key:"add",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))arrayEach(t,(function(t){return r.add(e,t,n)}));else{REMOVED_HOOKS.has(e)&&warn(substitute(REMOVED_MESSAGE,{hookName:e,removedInVersion:REMOVED_HOOKS.get(e)})),DEPRECATED_HOOKS.has(e)&&warn(DEPRECATED_HOOKS.get(e));var o=this.getBucket(n);if(void 0===o[e]&&(this.register(e),o[e]=[]),t.skip=!1,-1===o[e].indexOf(t)){var i=!1;t.initialHook&&arrayEach(o[e],(function(r,n){if(r.initialHook)return o[e][n]=t,i=!0,!1})),i||o[e].push(t)}}return this}},{key:"once",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(t)?arrayEach(t,(function(t){return r.once(e,t,n)})):(t.runOnce=!0,this.add(e,t,n))}},{key:"remove",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=this.getBucket(r);return void 0!==n[e]&&n[e].indexOf(t)>=0&&(t.skip=!0,!0)}},{key:"has",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.getBucket(t);return!(void 0===r[e]||!r[e].length)}},{key:"run",value:function(e,t,r,n,o,i,a,s){var l=this.globalBucket[t],u=l?l.length:0,c=0;if(u)for(;c<u;)if(l[c]&&!l[c].skip){var f=l[c].call(e,r,n,o,i,a,s);void 0!==f&&(r=f),l[c]&&l[c].runOnce&&this.remove(t,l[c]),c+=1}else c+=1;var h=this.getBucket(e)[t],d=h?h.length:0,p=0;if(d)for(;p<d;)if(h[p]&&!h[p].skip){var y=h[p].call(e,r,n,o,i,a,s);void 0!==y&&(r=y),h[p]&&h[p].runOnce&&this.remove(t,h[p],e),p+=1}else p+=1;return r}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;objectEach(this.getBucket(e),(function(e,t,r){return r[t].length=0}))}},{key:"register",value:function(e){this.isRegistered(e)||REGISTERED_HOOKS.push(e)}},{key:"deregister",value:function(e){this.isRegistered(e)&&REGISTERED_HOOKS.splice(REGISTERED_HOOKS.indexOf(e),1)}},{key:"isDeprecated",value:function(e){return DEPRECATED_HOOKS.has(e)||REMOVED_HOOKS.has(e)}},{key:"isRegistered",value:function(e){return REGISTERED_HOOKS.indexOf(e)>=0}},{key:"getRegistered",value:function(){return REGISTERED_HOOKS}}]),e}(),globalSingleton=new Hooks;function getGlobalSingleton(){return globalSingleton}var FAILS_ON_PRIMITIVES$2=fails((function(){objectGetPrototypeOf(1)}));_export({target:"Object",stat:!0,forced:FAILS_ON_PRIMITIVES$2,sham:!correctPrototypeGetter},{getPrototypeOf:function(e){return objectGetPrototypeOf(toObject(e))}}),_export({target:"Object",stat:!0},{setPrototypeOf:objectSetPrototypeOf});var slice=[].slice,factories={},construct=function(e,t,r){if(!(t in factories)){for(var n=[],o=0;o<t;o++)n[o]="a["+o+"]";factories[t]=Function("C,a","return new C("+n.join(",")+")")}return factories[t](e,r)},functionBind=Function.bind||function(e){var t=aFunction$1(this),r=slice.call(arguments,1),n=function(){var o=r.concat(slice.call(arguments));return this instanceof n?construct(t,o.length,o):t.apply(e,o)};return isObject(t.prototype)&&(n.prototype=t.prototype),n},nativeConstruct=getBuiltIn("Reflect","construct"),NEW_TARGET_BUG=fails((function(){function e(){}return!(nativeConstruct((function(){}),[],e)instanceof e)})),ARGS_BUG=!fails((function(){nativeConstruct((function(){}))})),FORCED$1=NEW_TARGET_BUG||ARGS_BUG;_export({target:"Reflect",stat:!0,forced:FORCED$1,sham:FORCED$1},{construct:function(e,t){aFunction$1(e),anObject(t);var r=arguments.length<3?e:aFunction$1(arguments[2]);if(ARGS_BUG&&!NEW_TARGET_BUG)return nativeConstruct(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(functionBind.apply(e,n))}var o=r.prototype,i=objectCreate(isObject(o)?o:Object.prototype),a=Function.apply.call(e,i,t);return isObject(a)?a:i}});var RENDER_TYPE=1,FULLY_VISIBLE_TYPE=2;function _classCallCheck$1(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1(e,t,r){return t&&_defineProperties$1(e.prototype,t),r&&_defineProperties$1(e,r),e}var privatePool=new WeakMap,ViewportColumnsCalculator=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,s=t.calculationType,l=t.stretchMode,u=t.stretchingItemWidthFn,c=void 0===u?function(e){return e}:u;_classCallCheck$1(this,e),privatePool.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:o,columnWidthFn:i,overrideFn:a,calculationType:s,stretchingColumnWidthFn:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=l,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return _createClass$1(e,null,[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),_createClass$1(e,[{key:"calculate",value:function(){for(var e,t=0,r=!0,n=[],o=privatePool.get(this),i=o.calculationType,a=o.overrideFn,s=o.scrollOffset,l=o.totalColumns,u=o.viewportWidth,c=0;c<l;c++){if(e=this._getColumnWidth(c),t<=s&&i!==FULLY_VISIBLE_TYPE&&(this.startColumn=c),t>=s&&t+(i===FULLY_VISIBLE_TYPE?e:0)<=s+(s>0?u+1:u)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=c),this.endColumn=c),n.push(t),t+=e,i!==FULLY_VISIBLE_TYPE&&(this.endColumn=c),t>=s+u){r=!1;break}}if(this.endColumn===l-1&&r)for(this.startColumn=this.endColumn;this.startColumn>0;){var f=n[this.endColumn]+e-n[this.startColumn-1];if((f<=u||i!==FULLY_VISIBLE_TYPE)&&(this.startColumn-=1),f>u)break}i===RENDER_TYPE&&null!==this.startColumn&&a&&a(this),this.startPosition=n[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),l<this.endColumn&&(this.endColumn=l-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(e){if("none"!==this.stretch){var t=e;this.totalTargetWidth=t;for(var r=privatePool.get(this),n=r.totalColumns,o=0,i=0;i<n;i++){var a=this._getColumnWidth(i),s=r.stretchingColumnWidthFn(void 0,i);"number"==typeof s?t-=s:o+=a}var l=t-o;if("all"===this.stretch&&l>0)this.stretchAllRatio=t/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&t!==1/0){var u=this._getColumnWidth(n-1),c=l+u;this.stretchLastWidth=c>=0?c:u}}}},{key:"getStretchedColumnWidth",value:function(e,t){var r=null;return"all"===this.stretch&&0!==this.stretchAllRatio?r=this._getStretchedAllColumnWidth(e,t):"last"===this.stretch&&0!==this.stretchLastWidth&&(r=this._getStretchedLastColumnWidth(e)),r}},{key:"_getStretchedAllColumnWidth",value:function(e,t){var r=0,n=privatePool.get(this),o=n.totalColumns;if(!this.stretchAllColumnsWidth[e]){var i=Math.round(t*this.stretchAllRatio),a=n.stretchingColumnWidthFn(i,e);this.stretchAllColumnsWidth[e]=void 0===a?i:isNaN(a)?this._getColumnWidth(e):a}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var s=0;s<this.stretchAllColumnsWidth.length;s++)r+=this.stretchAllColumnsWidth[s];r!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-r)}return this.stretchAllColumnsWidth[e]}},{key:"_getStretchedLastColumnWidth",value:function(e){return e===privatePool.get(this).totalColumns-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(t){var r=privatePool.get(this).columnWidthFn(t);return isNaN(r)&&(r=e.DEFAULT_WIDTH),r}}]),e}();function _classCallCheck$2(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2(e,t,r){return t&&_defineProperties$2(e.prototype,t),r&&_defineProperties$2(e,r),e}var privatePool$1=new WeakMap,ViewportRowsCalculator=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.viewportSize,n=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,s=t.calculationType,l=t.scrollbarHeight;_classCallCheck$2(this,e),privatePool$1.set(this,{viewportHeight:r,scrollOffset:n,totalRows:o,rowHeightFn:i,overrideFn:a,calculationType:s,horizontalScrollbarHeight:l}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}return _createClass$2(e,null,[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),_createClass$2(e,[{key:"calculate",value:function(){for(var t,r=0,n=!0,o=[],i=privatePool$1.get(this),a=i.calculationType,s=i.overrideFn,l=i.rowHeightFn,u=i.scrollOffset,c=i.totalRows,f=i.viewportHeight,h=i.horizontalScrollbarHeight||0,d=0;d<c;d++)if(t=l(d),isNaN(t)&&(t=e.DEFAULT_HEIGHT),r<=u&&a!==FULLY_VISIBLE_TYPE&&(this.startRow=d),r>=u&&r+(a===FULLY_VISIBLE_TYPE?t:0)<=u+f-h&&(null===this.startRow&&(this.startRow=d),this.endRow=d),o.push(r),r+=t,a!==FULLY_VISIBLE_TYPE&&(this.endRow=d),r>=u+f-h){n=!1;break}if(this.endRow===c-1&&n)for(this.startRow=this.endRow;this.startRow>0;){var p=o[this.endRow]+t-o[this.startRow-1];if((p<=f-h||a!==FULLY_VISIBLE_TYPE)&&(this.startRow-=1),p>=f-h)break}a===RENDER_TYPE&&null!==this.startRow&&s&&s(this),this.startPosition=o[this.startRow],void 0===this.startPosition&&(this.startPosition=null),c<this.endRow&&(this.endRow=c-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}]),e}();function _classCallCheck$3(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$3(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$3(e,t,r){return t&&_defineProperties$3(e.prototype,t),r&&_defineProperties$3(e,r),e}var CellCoords=function(){function e(t,r){_classCallCheck$3(this,e),this.row=null,this.col=null,void 0!==t&&void 0!==r&&(this.row=t,this.col=r)}return _createClass$3(e,[{key:"isValid",value:function(e){return!(this.row<0||this.col<0)&&!(this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}},{key:"isEqual",value:function(e){return e===this||this.row===e.row&&this.col===e.col}},{key:"isSouthEastOf",value:function(e){return this.row>=e.row&&this.col>=e.col}},{key:"isNorthWestOf",value:function(e){return this.row<=e.row&&this.col<=e.col}},{key:"isSouthWestOf",value:function(e){return this.row>=e.row&&this.col<=e.col}},{key:"isNorthEastOf",value:function(e){return this.row<=e.row&&this.col>=e.col}},{key:"normalize",value:function(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col)}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}();function _classCallCheck$4(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$4(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$4(e,t,r){return t&&_defineProperties$4(e.prototype,t),r&&_defineProperties$4(e,r),e}var CellRange=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;_classCallCheck$4(this,e),this.highlight=t.clone().normalize(),this.from=r.clone(),this.to=n.clone()}return _createClass$4(e,[{key:"setHighlight",value:function(e){return this.highlight=e.clone().normalize(),this}},{key:"setFrom",value:function(e){return this.from=e.clone(),this}},{key:"setTo",value:function(e){return this.to=e.clone(),this}},{key:"isValid",value:function(e){return this.from.isValid(e)&&this.to.isValid(e)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){var e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}},{key:"getWidth",value:function(){var e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}},{key:"includes",value:function(e){var t=e.row,r=e.col,n=this.getOuterTopLeftCorner(),o=this.getOuterBottomRightCorner();return n.row<=t&&o.row>=t&&n.col<=r&&o.col>=r}},{key:"includesRange",value:function(e){return this.includes(e.getOuterTopLeftCorner())&&this.includes(e.getOuterBottomRightCorner())}},{key:"isEqual",value:function(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}},{key:"overlaps",value:function(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}},{key:"isNorthWestOf",value:function(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}},{key:"isOverlappingHorizontally",value:function(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}},{key:"expand",value:function(e){var t=this.getOuterTopLeftCorner(),r=this.getOuterBottomRightCorner();return(e.row<t.row||e.col<t.col||e.row>r.row||e.col>r.col)&&(this.from=new CellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=new CellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0)}},{key:"expandByRange",value:function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var t=this.getOuterTopLeftCorner(),r=this.getOuterBottomRightCorner(),n=this.getDirection(),o=e.getOuterTopLeftCorner(),i=e.getOuterBottomRightCorner(),a=Math.min(t.row,o.row),s=Math.min(t.col,o.col),l=Math.max(r.row,i.row),u=Math.max(r.col,i.col),c=new CellCoords(a,s),f=new CellCoords(l,u);return this.from=c,this.to=f,this.setDirection(n),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"setDirection",value:function(e){switch(e){case"NW-SE":var t=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=t[0],this.to=t[1];break;case"NE-SW":var r=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=r[0],this.to=r[1];break;case"SE-NW":var n=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=n[0],this.to=n[1];break;case"SW-NE":var o=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=o[0],this.to=o[1]}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}},{key:"flipDirectionHorizontally",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}},{key:"getTopLeftCorner",value:function(){return new CellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return new CellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return new CellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return new CellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getOuterTopLeftCorner",value:function(){return new CellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return new CellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return new CellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return new CellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"isCorner",value:function(e,t){return!!(t&&t.includes(e)&&(this.getOuterTopLeftCorner().isEqual(new CellCoords(t.from.row,t.from.col))||this.getOuterTopRightCorner().isEqual(new CellCoords(t.from.row,t.to.col))||this.getOuterBottomLeftCorner().isEqual(new CellCoords(t.to.row,t.from.col))||this.getOuterBottomRightCorner().isEqual(new CellCoords(t.to.row,t.to.col))))||(e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner()))}},{key:"getOppositeCorner",value:function(e,t){if(!(e instanceof CellCoords))return!1;if(t&&t.includes(e)){if(this.getOuterTopLeftCorner().isEqual(new CellCoords(t.from.row,t.from.col)))return this.getOuterBottomRightCorner();if(this.getOuterTopRightCorner().isEqual(new CellCoords(t.from.row,t.to.col)))return this.getOuterBottomLeftCorner();if(this.getOuterBottomLeftCorner().isEqual(new CellCoords(t.to.row,t.from.col)))return this.getOuterTopRightCorner();if(this.getOuterBottomRightCorner().isEqual(new CellCoords(t.to.row,t.to.col)))return this.getOuterTopLeftCorner()}return e.isEqual(this.getOuterBottomRightCorner())?this.getOuterTopLeftCorner():e.isEqual(this.getOuterTopLeftCorner())?this.getOuterBottomRightCorner():e.isEqual(this.getOuterTopRightCorner())?this.getOuterBottomLeftCorner():e.isEqual(this.getOuterBottomLeftCorner())?this.getOuterTopRightCorner():void 0}},{key:"getBordersSharedWith",value:function(e){if(!this.includesRange(e))return[];var t=Math.min(this.from.row,this.to.row),r=Math.max(this.from.row,this.to.row),n=Math.min(this.from.col,this.to.col),o=Math.max(this.from.col,this.to.col),i=Math.min(e.from.row,e.to.row),a=Math.max(e.from.row,e.to.row),s=Math.min(e.from.col,e.to.col),l=Math.max(e.from.col,e.to.col),u=[];return t===i&&u.push("top"),o===l&&u.push("right"),r===a&&u.push("bottom"),n===s&&u.push("left"),u}},{key:"getInner",value:function(){for(var e=this.getOuterTopLeftCorner(),t=this.getOuterBottomRightCorner(),r=[],n=e.row;n<=t.row;n++)for(var o=e.col;o<=t.col;o++)this.from.row===n&&this.from.col===o||this.to.row===n&&this.to.col===o||r.push(new CellCoords(n,o));return r}},{key:"getAll",value:function(){for(var e=this.getOuterTopLeftCorner(),t=this.getOuterBottomRightCorner(),r=[],n=e.row;n<=t.row;n++)for(var o=e.col;o<=t.col;o++)e.row===n&&e.col===o?r.push(e):t.row===n&&t.col===o?r.push(t):r.push(new CellCoords(n,o));return r}},{key:"forAll",value:function(e){for(var t=this.getOuterTopLeftCorner(),r=this.getOuterBottomRightCorner(),n=t.row;n<=r.row;n++)for(var o=t.col;o<=r.col;o++){if(!1===e(n,o))return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to)}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}}]),e}();function _classCallCheck$5(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$5(e,t,r){return t&&_defineProperties$5(e.prototype,t),r&&_defineProperties$5(e,r),e}var ColumnFilter=function(){function e(t,r,n){_classCallCheck$5(this,e),this.offset=t,this.total=r,this.countTH=n}return _createClass$5(e,[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}]),e}();function _classCallCheck$6(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$6(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$6(e,t,r){return t&&_defineProperties$6(e.prototype,t),r&&_defineProperties$6(e,r),e}var RowFilter=function(){function e(t,r,n){_classCallCheck$6(this,e),this.offset=t,this.total=r,this.countTH=n}return _createClass$6(e,[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceRowToVisibleColHeadedRow",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}]),e}(),nativeJoin=[].join,ES3_STRINGS=indexedObject!=Object,STRICT_METHOD$2=arrayMethodIsStrict("join",",");_export({target:"Array",proto:!0,forced:ES3_STRINGS||!STRICT_METHOD$2},{join:function(e){return nativeJoin.call(toIndexedObject(this),void 0===e?",":e)}});var defineProperty$6=objectDefineProperty.f,getOwnPropertyNames=objectGetOwnPropertyNames.f,setInternalState$5=internalState.set,MATCH$2=wellKnownSymbol("match"),NativeRegExp=global_1.RegExp,RegExpPrototype$1=NativeRegExp.prototype,re1=/a/g,re2=/a/g,CORRECT_NEW=new NativeRegExp(re1)!==re1,UNSUPPORTED_Y$2=regexpStickyHelpers.UNSUPPORTED_Y,FORCED$2=descriptors&&isForced_1("RegExp",!CORRECT_NEW||UNSUPPORTED_Y$2||fails((function(){return re2[MATCH$2]=!1,NativeRegExp(re1)!=re1||NativeRegExp(re2)==re2||"/a/i"!=NativeRegExp(re1,"i")})));if(FORCED$2){for(var RegExpWrapper=function(e,t){var r,n=this instanceof RegExpWrapper,o=isRegexp(e),i=void 0===t;if(!n&&o&&e.constructor===RegExpWrapper&&i)return e;CORRECT_NEW?o&&!i&&(e=e.source):e instanceof RegExpWrapper&&(i&&(t=regexpFlags.call(e)),e=e.source),UNSUPPORTED_Y$2&&(r=!!t&&t.indexOf("y")>-1)&&(t=t.replace(/y/g,""));var a=inheritIfRequired(CORRECT_NEW?new NativeRegExp(e,t):NativeRegExp(e,t),n?this:RegExpPrototype$1,RegExpWrapper);return UNSUPPORTED_Y$2&&r&&setInternalState$5(a,{sticky:r}),a},proxy=function(e){e in RegExpWrapper||defineProperty$6(RegExpWrapper,e,{configurable:!0,get:function(){return NativeRegExp[e]},set:function(t){NativeRegExp[e]=t}})},keys$1=getOwnPropertyNames(NativeRegExp),index=0;keys$1.length>index;)proxy(keys$1[index++]);RegExpPrototype$1.constructor=RegExpWrapper,RegExpWrapper.prototype=RegExpPrototype$1,redefine(global_1,"RegExp",RegExpWrapper)}setSpecies("RegExp");var slice$1=[].slice,MSIE=/MSIE .\./.test(engineUserAgent),wrap$1=function(e){return function(t,r){var n=arguments.length>2,o=n?slice$1.call(arguments,2):void 0;return e(n?function(){("function"==typeof t?t:Function(t)).apply(this,o)}:t,r)}};function _typeof$2(e){return(_typeof$2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}_export({global:!0,bind:!0,forced:MSIE},{setTimeout:wrap$1(global_1.setTimeout),setInterval:wrap$1(global_1.setInterval)});for(var lastTime=0,vendors=["ms","moz","webkit","o"],_requestAnimationFrame=window.requestAnimationFrame,_cancelAnimationFrame=window.cancelAnimationFrame,x=0,_hasCaptionProblem,comparisonFunction,passiveSupported;x<vendors.length&&!_requestAnimationFrame;++x)_requestAnimationFrame=window["".concat(vendors[x],"RequestAnimationFrame")],_cancelAnimationFrame=window["".concat(vendors[x],"CancelAnimationFrame")]||window["".concat(vendors[x],"CancelRequestAnimationFrame")];function requestAnimationFrame(e){return _requestAnimationFrame.call(window,e)}function isClassListSupported(){return!!document.documentElement.classList}function isTextContentSupported(){return!!document.createTextNode("test").textContent}function isGetComputedStyleSupported(){return!!window.getComputedStyle}function cancelAnimationFrame(e){_cancelAnimationFrame.call(window,e)}function isTouchSupported(){return"ontouchstart"in window}function detectCaptionProblem(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",e.insertBefore(r,t),document.body.appendChild(e),_hasCaptionProblem=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function hasCaptionProblem(){return void 0===_hasCaptionProblem&&detectCaptionProblem(),_hasCaptionProblem}function getComparisonFunction(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return comparisonFunction||(comparisonFunction="object"===("undefined"==typeof Intl?"undefined":_typeof$2(Intl))?new Intl.Collator(e,t).compare:"function"==typeof String.prototype.localeCompare?function(e,t){return"".concat(e).localeCompare(t)}:function(e,t){return e===t?0:e>t?-1:1})}function isPassiveEventSupported(){if(void 0!==passiveSupported)return passiveSupported;try{var e={get passive(){passiveSupported=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){passiveSupported=!1}return passiveSupported}_requestAnimationFrame||(_requestAnimationFrame=function(e){var t=(new Date).getTime(),r=Math.max(0,16-(t-lastTime)),n=window.setTimeout((function(){e(t+r)}),r);return lastTime=t+r,n}),_cancelAnimationFrame||(_cancelAnimationFrame=function(e){clearTimeout(e)});var featureHelpers=Object.freeze({__proto__:null,requestAnimationFrame:requestAnimationFrame,isClassListSupported:isClassListSupported,isTextContentSupported:isTextContentSupported,isGetComputedStyleSupported:isGetComputedStyleSupported,cancelAnimationFrame:cancelAnimationFrame,isTouchSupported:isTouchSupported,hasCaptionProblem:hasCaptionProblem,getComparisonFunction:getComparisonFunction,isPassiveEventSupported:isPassiveEventSupported}),tester=function(e){var t={value:!1,test:function(r,n){t.value=e(r,n)}};return t},browsers={chrome:tester((function(e,t){return/Chrome/.test(e)&&/Google/.test(t)})),edge:tester((function(e){return/Edge/.test(e)})),firefox:tester((function(e){return/Firefox/.test(e)})),ie:tester((function(e){return/Trident/.test(e)})),ie9:tester((function(){return!!document.documentMode})),mobile:tester((function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)})),safari:tester((function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)}))},platforms={mac:tester((function(e){return/^Mac/.test(e)})),win:tester((function(e){return/^Win/.test(e)})),linux:tester((function(e){return/^Linux/.test(e)}))};function setBrowserMeta(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userAgent,r=void 0===t?navigator.userAgent:t,n=e.vendor,o=void 0===n?navigator.vendor:n;objectEach(browsers,(function(e){(0,e.test)(r,o)}))}function setPlatformMeta(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.platform,r=void 0===t?navigator.platform:t;objectEach(platforms,(function(e){(0,e.test)(r)}))}function isChrome(){return browsers.chrome.value}function isEdge(){return browsers.edge.value}function isIE(){return browsers.ie.value}function isIE9(){return browsers.ie9.value}function isMSBrowser(){return browsers.ie.value||browsers.edge.value}function isMobileBrowser(){return browsers.mobile.value}function isSafari(){return browsers.safari.value}function isFirefox(){return browsers.firefox.value}function isWindowsOS(){return platforms.win.value}function isMacOS(){return platforms.mac.value}function isLinuxOS(){return platforms.linux.value}setBrowserMeta(),setPlatformMeta();var browserHelpers=Object.freeze({__proto__:null,setBrowserMeta:setBrowserMeta,setPlatformMeta:setPlatformMeta,isChrome:isChrome,isEdge:isEdge,isIE:isIE,isIE9:isIE9,isMSBrowser:isMSBrowser,isMobileBrowser:isMobileBrowser,isSafari:isSafari,isFirefox:isFirefox,isWindowsOS:isWindowsOS,isMacOS:isMacOS,isLinuxOS:isLinuxOS}),_hasClass,_addClass,_removeClass;function _toConsumableArray$1(e){return _arrayWithoutHoles$1(e)||_iterableToArray$1(e)||_unsupportedIterableToArray$1(e)||_nonIterableSpread$1()}function _nonIterableSpread$1(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$1(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$1(e,t):void 0}}function _iterableToArray$1(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$1(e){if(Array.isArray(e))return _arrayLikeToArray$1(e)}function _arrayLikeToArray$1(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function getParent(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=-1,n=null,o=e;null!==o;){if(r===t){n=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(r+=1,o=o.parentNode)}return n}function getFrameElement(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function getParentWindow(e){return getFrameElement(e)&&e.parent}function hasAccessToParentWindow(e){return!!Object.getPrototypeOf(e.parent)}function closest(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,o=n.ELEMENT_NODE,i=n.DOCUMENT_FRAGMENT_NODE,a=e;null!=a&&a!==r;){var s=a,l=s.nodeType,u=s.nodeName;if(l===o&&(t.includes(u)||t.includes(a)))return a;var c=a,f=c.host;a=f&&l===i?f:a.parentNode}return null}function closestDown(e,t,r){for(var n=[],o=e;o&&(o=closest(o,t,r))&&(!r||r.contains(o));)n.push(o),o=o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o.host:o.parentNode;var i=n.length;return i?n[i-1]:null}function isChildOf(e,t){var r=e.parentNode,n=[];for("string"==typeof t?n=e.defaultView?Array.prototype.slice.call(e.querySelectorAll(t),0):Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);null!==r;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function index$1(e){var t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}function overlayContainsElement(e,t,r){var n=r.parentElement.querySelector(".ht_clone_".concat(e));return n?n.contains(t):null}function filterEmptyClassNames(e){return e&&e.length?e.filter((function(e){return!!e})):[]}if(isClassListSupported()){var isSupportMultipleClassesArg=function(e){var t=e.createElement("div");return t.classList.add("test","test2"),t.classList.contains("test2")};_hasClass=function(e,t){return void 0!==e.classList&&"string"==typeof t&&""!==t&&e.classList.contains(t)},_addClass=function(e,t){var r,n=e.ownerDocument,o=t;if("string"==typeof o&&(o=o.split(" ")),(o=filterEmptyClassNames(o)).length>0)if(isSupportMultipleClassesArg(n))(r=e.classList).add.apply(r,_toConsumableArray$1(o));else for(var i=0;o&&o[i];)e.classList.add(o[i]),i+=1},_removeClass=function(e,t){var r,n=t;if("string"==typeof n&&(n=n.split(" ")),(n=filterEmptyClassNames(n)).length>0)if(isSupportMultipleClassesArg)(r=e.classList).remove.apply(r,_toConsumableArray$1(n));else for(var o=0;n&&n[o];)e.classList.remove(n[o]),o+=1}}else{var createClassNameRegExp=function(e){return new RegExp("(\\s|^)".concat(e,"(\\s|$)"))};_hasClass=function(e,t){return void 0!==e.className&&createClassNameRegExp(t).test(e.className)},_addClass=function(e,t){var r=e.className,n=t;if("string"==typeof n&&(n=n.split(" ")),n=filterEmptyClassNames(n),""===r)r=n.join(" ");else for(var o=0;o<n.length;o++)n[o]&&!createClassNameRegExp(n[o]).test(r)&&(r+=" ".concat(n[o]));e.className=r},_removeClass=function(e,t){var r=0,n=e.className,o=t;for("string"==typeof o&&(o=o.split(" ")),o=filterEmptyClassNames(o);o&&o[r];)n=n.replace(createClassNameRegExp(o[r])," ").trim(),r+=1;e.className!==n&&(e.className=n)}}function hasClass(e,t){return _hasClass(e,t)}function addClass(e,t){_addClass(e,t)}function removeClass(e,t){_removeClass(e,t)}function removeTextNodes(e){if(3===e.nodeType)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,r=t.length-1;r>=0;r--)removeTextNodes(t[r])}function empty$1(e){for(var t;t=e.lastChild;)e.removeChild(t)}var HTML_CHARACTERS=/(<(.*)>|&(.*);)/,cachedScrollbarWidth;function fastInnerHTML(e,t){HTML_CHARACTERS.test(t)?e.innerHTML=t:fastInnerText(e,t)}function fastInnerText(e,t){var r=e.firstChild;r&&3===r.nodeType&&null===r.nextSibling?isTextContentSupported?r.textContent=t:r.data=t:(empty$1(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function isVisible(e){for(var t=e.ownerDocument.documentElement,r=e;r!==t;){if(null===r)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(r.host){if(r.host.impl)return isVisible(r.host.impl);if(r.host)return isVisible(r.host);throw new Error("Lost in Web Components world")}return!1}if(r.style&&"none"===r.style.display)return!1;r=r.parentNode}return!0}function offset(e){var t,r,n,o,i=e.ownerDocument,a=i.defaultView,s=i.documentElement,l=e;if(hasCaptionProblem()&&l.firstChild&&"CAPTION"===l.firstChild.nodeName)return{top:(o=l.getBoundingClientRect()).top+(a.pageYOffset||s.scrollTop)-(s.clientTop||0),left:o.left+(a.pageXOffset||s.scrollLeft)-(s.clientLeft||0)};for(t=l.offsetLeft,r=l.offsetTop,n=l;(l=l.offsetParent)&&l!==i.body;)t+=l.offsetLeft,r+=l.offsetTop,n=l;return n&&"fixed"===n.style.position&&(t+=a.pageXOffset||s.scrollLeft,r+=a.pageYOffset||s.scrollTop),{left:t,top:r}}function getWindowScrollTop(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.scrollY;return void 0===t&&(t=e.document.documentElement.scrollTop),t}function getWindowScrollLeft(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.scrollX;return void 0===t&&(t=e.document.documentElement.scrollLeft),t}function getScrollTop(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?getWindowScrollTop(t):e.scrollTop}function getScrollLeft(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?getWindowScrollLeft(t):e.scrollLeft}function getScrollableElement(e){var t=e.ownerDocument,r=t?t.defaultView:void 0;t||(r=(t=e.document?e.document:e).defaultView);for(var n=["auto","scroll"],o=isGetComputedStyleSupported(),i=e.parentNode;i&&i.style&&t.body!==i;){var a=i.style,s=a.overflow,l=a.overflowX,u=a.overflowY;if([s,l,u].includes("scroll"))return i;if(o){var c=r.getComputedStyle(i);if(s=c.overflow,l=c.overflowX,u=c.overflowY,n.includes(s)||n.includes(l)||n.includes(u))return i}if(i.clientHeight<=i.scrollHeight+1&&(n.includes(u)||n.includes(s)))return i;if(i.clientWidth<=i.scrollWidth+1&&(n.includes(l)||n.includes(s)))return i;i=i.parentNode}return r}function getTrimmingContainer(e){for(var t=e.ownerDocument,r=t.defaultView,n=e.parentNode;n&&n.style&&t.body!==n;){if("visible"!==n.style.overflow&&""!==n.style.overflow)return n;var o=getComputedStyle(n,r),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),s=o.getPropertyValue("overflow-y"),l=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(s)||i.includes(l))return n;n=n.parentNode}return r}function getStyle(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(e){if(e===r)return"width"===t?"".concat(r.innerWidth,"px"):"height"===t?"".concat(r.innerHeight,"px"):void 0;var n=e.style[t];if(""!==n&&void 0!==n)return n;var o=getComputedStyle(e,r);return""!==o[t]&&void 0!==o[t]?o[t]:void 0}}function matchesCSSRules(e,t){var r=t.selectorText,n=!1;return t.type===CSSRule.STYLE_RULE&&r&&(e.msMatchesSelector?n=e.msMatchesSelector(r):e.matches&&(n=e.matches(r))),n}function getComputedStyle(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function outerWidth(e){return Math.ceil(e.getBoundingClientRect().width)}function outerHeight(e){return hasCaptionProblem()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function innerHeight(e){return e.clientHeight||e.innerHeight}function innerWidth(e){return e.clientWidth||e.innerWidth}function addEvent(e,t,r){e.addEventListener(t,r,!1)}function removeEvent(e,t,r){e.removeEventListener(t,r,!1)}function getCaretPosition(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var r=t.selection.createRange();if(null===r)return 0;var n=e.createTextRange(),o=n.duplicate();return n.moveToBookmark(r.getBookmark()),o.setEndPoint("EndToStart",n),o.text.length}return 0}function getSelectionEndPosition(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var r=t.selection.createRange();return null===r?0:e.createTextRange().text.indexOf(r.text)+r.text.length}return 0}function getSelectionText(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.document,r="";return e.getSelection?r=e.getSelection().toString():t.selection&&"Control"!==t.selection.type&&(r=t.selection.createRange().text),r}function clearTextSelection(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function setCaretPosition(e,t,r){if(void 0===r&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch(i){var n=e.parentNode,o=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=o}}}function walkontableCalculateScrollbarWidth(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);var n=t.offsetWidth;r.style.overflow="scroll";var o=t.offsetWidth;return n===o&&(o=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-o}function getScrollbarWidth(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===cachedScrollbarWidth&&(cachedScrollbarWidth=walkontableCalculateScrollbarWidth(e)),cachedScrollbarWidth}function hasVerticalScrollbar(e){return e.offsetWidth!==e.clientWidth}function hasHorizontalScrollbar(e){return e.offsetHeight!==e.clientHeight}function setOverlayPosition(e,t,r){isIE9()?(e.style.top=r,e.style.left=t):isSafari()?(e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)"),e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(r,",0)")):e.style.transform="translate3d(".concat(t,",").concat(r,",0)")}function getCssTransform(e){var t;return e.style.transform&&""!==(t=e.style.transform)?["transform",t]:e.style["-webkit-transform"]&&""!==(t=e.style["-webkit-transform"])?["-webkit-transform",t]:-1}function resetCssTransform(e){e.style.transform&&""!==e.style.transform?e.style.transform="":e.style["-webkit-transform"]&&""!==e.style["-webkit-transform"]&&(e.style["-webkit-transform"]="")}function isInput(e){return e&&(["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)>-1||"true"===e.contentEditable)}function isOutsideInput(e){return isInput(e)&&!1===e.hasAttribute("data-hot-input")}function selectElementIfAllowed(e){isOutsideInput(e.ownerDocument.activeElement)||e.select()}var domHelpers=Object.freeze({__proto__:null,getParent:getParent,getFrameElement:getFrameElement,getParentWindow:getParentWindow,hasAccessToParentWindow:hasAccessToParentWindow,closest:closest,closestDown:closestDown,isChildOf:isChildOf,index:index$1,overlayContainsElement:overlayContainsElement,hasClass:hasClass,addClass:addClass,removeClass:removeClass,removeTextNodes:removeTextNodes,empty:empty$1,HTML_CHARACTERS:HTML_CHARACTERS,fastInnerHTML:fastInnerHTML,fastInnerText:fastInnerText,isVisible:isVisible,offset:offset,getWindowScrollTop:getWindowScrollTop,getWindowScrollLeft:getWindowScrollLeft,getScrollTop:getScrollTop,getScrollLeft:getScrollLeft,getScrollableElement:getScrollableElement,getTrimmingContainer:getTrimmingContainer,getStyle:getStyle,matchesCSSRules:matchesCSSRules,getComputedStyle:getComputedStyle,outerWidth:outerWidth,outerHeight:outerHeight,innerHeight:innerHeight,innerWidth:innerWidth,addEvent:addEvent,removeEvent:removeEvent,getCaretPosition:getCaretPosition,getSelectionEndPosition:getSelectionEndPosition,getSelectionText:getSelectionText,clearTextSelection:clearTextSelection,setCaretPosition:setCaretPosition,getScrollbarWidth:getScrollbarWidth,hasVerticalScrollbar:hasVerticalScrollbar,hasHorizontalScrollbar:hasHorizontalScrollbar,setOverlayPosition:setOverlayPosition,getCssTransform:getCssTransform,resetCssTransform:resetCssTransform,isInput:isInput,isOutsideInput:isOutsideInput,selectElementIfAllowed:selectElementIfAllowed}),nativeReverse=[].reverse,test$1=[1,2];function isFunction(e){return"function"==typeof e}function throttle(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=0,n={lastCallThrottled:!0},o=null;function i(){for(var i=this,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];var u=Date.now(),c=!1;n.lastCallThrottled=!0,r||(r=u,c=!0);var f=t-(u-r);return c?(n.lastCallThrottled=!1,e.apply(this,s)):(o&&clearTimeout(o),o=setTimeout((function(){n.lastCallThrottled=!1,e.apply(i,s),r=0,o=void 0}),f)),n}return i}function throttleAfterHits(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,n=throttle(e,t),o=r;function i(){o=r}function a(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return o?(o-=1,e.apply(this,r)):n.apply(this,r)}return a.clearHits=i,a}function debounce(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=null;function o(){for(var o=this,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return n&&clearTimeout(n),n=setTimeout((function(){t=e.apply(o,a)}),r),t}return o}function pipe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],o=t.slice(1);return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return arrayReduce(o,(function(e,t){return t(e)}),n.apply(this,t))}}function partial(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e.apply(this,r.concat(n))}}function curry(e){var t=e.length;return function r(n){return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var s=n.concat(i);return s.length>=t?e.apply(this,s):r(s)}}([])}function curryRight(e){var t=e.length;return function r(n){return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var s=n.concat(i.reverse());return s.length>=t?e.apply(this,s):r(s)}}([])}_export({target:"Array",proto:!0,forced:String(test$1)===String(test$1.reverse())},{reverse:function(){return isArray(this)&&(this.length=this.length),nativeReverse.call(this)}});var functionHelpers=Object.freeze({__proto__:null,isFunction:isFunction,throttle:throttle,throttleAfterHits:throttleAfterHits,debounce:debounce,pipe:pipe,partial:partial,curry:curry,curryRight:curryRight}),WORKING_SPACE_ALL=0,WORKING_SPACE_TOP=1,WORKING_SPACE_BOTTOM=2;function _classCallCheck$7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$7(e,t,r){return t&&_defineProperties$7(e.prototype,t),r&&_defineProperties$7(e,r),e}var ViewSize=function(){function e(){_classCallCheck$7(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return _createClass$7(e,[{key:"setSize",value:function(e){this.currentSize=this.nextSize,this.nextSize=e}},{key:"setOffset",value:function(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}]),e}();function _classCallCheck$8(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$8(e,t,r){return t&&_defineProperties$8(e.prototype,t),r&&_defineProperties$8(e,r),e}var ViewSizeSet=function(){function e(){_classCallCheck$8(this,e),this.size=new ViewSize,this.workingSpace=WORKING_SPACE_ALL,this.sharedSize=null}return _createClass$8(e,[{key:"setSize",value:function(e){this.size.setSize(e)}},{key:"setOffset",value:function(e){this.size.setOffset(e)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof ViewSize}},{key:"isPlaceOn",value:function(e){return this.workingSpace===e}},{key:"append",value:function(e){this.workingSpace=WORKING_SPACE_TOP,e.workingSpace=WORKING_SPACE_BOTTOM,this.sharedSize=e.getViewSize()}},{key:"prepend",value:function(e){this.workingSpace=WORKING_SPACE_BOTTOM,e.workingSpace=WORKING_SPACE_TOP,this.sharedSize=e.getViewSize()}}]),e}();function _classCallCheck$9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$9(e,t,r){return t&&_defineProperties$9(e.prototype,t),r&&_defineProperties$9(e,r),e}var OrderView=function(){function e(t,r,n){_classCallCheck$9(this,e),this.rootNode=t,this.nodesPool=r,this.sizeSet=new ViewSizeSet,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return _createClass$9(e,[{key:"setSize",value:function(e){return this.sizeSet.setSize(e),this}},{key:"setOffset",value:function(e){return this.sizeSet.setOffset(e),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}},{key:"getCurrentNode",value:function(){var e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}},{key:"getRenderedChildCount",value:function(){var e=this.rootNode,t=this.sizeSet,r=0;if(this.isSharedViewSet())for(var n=e.firstElementChild;n;){if(n.tagName===this.childNodeType)r+=1;else if(t.isPlaceOn(WORKING_SPACE_TOP))break;n=n.nextElementSibling}else r=e.childElementCount;return r}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var e=this.rootNode,t=this.sizeSet,r=this.isSharedViewSet(),n=t.getViewSize().nextSize,o=this.getRenderedChildCount();o<n;){var i=this.nodesPool();!r||r&&t.isPlaceOn(WORKING_SPACE_BOTTOM)?e.appendChild(i):e.insertBefore(i,e.firstChild),o+=1}for(var a=r&&t.isPlaceOn(WORKING_SPACE_TOP);o>n;)e.removeChild(a?e.firstChild:e.lastChild),o-=1}},{key:"render",value:function(){var e=this.rootNode,t=this.sizeSet,r=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(WORKING_SPACE_BOTTOM)&&(r+=t.sharedSize.nextSize);var n=e.childNodes[r];if(n.tagName!==this.childNodeType){var o=this.nodesPool();e.replaceChild(o,n),n=o}this.collectedNodes.push(n),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}();function _typeof$3(e){return(_typeof$3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$a(e,t,r){return t&&_defineProperties$a(e.prototype,t),r&&_defineProperties$a(e,r),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof$3(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var SharedOrderView=function(e){_inherits(r,e);var t=_createSuper(r);function r(){return _classCallCheck$a(this,r),t.apply(this,arguments)}return _createClass$a(r,[{key:"prependView",value:function(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}]),r}(OrderView);function _classCallCheck$b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$b(e,t,r){return t&&_defineProperties$b(e.prototype,t),r&&_defineProperties$b(e,r),e}var NodesPool=function(){function e(t){_classCallCheck$b(this,e),this.nodeType=t.toUpperCase()}return _createClass$b(e,[{key:"setRootDocument",value:function(e){this.rootDocument=e}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}();function _classCallCheck$c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$c(e,t,r){return t&&_defineProperties$c(e.prototype,t),r&&_defineProperties$c(e,r),e}var BaseRenderer=function(){function e(t,r){_classCallCheck$c(this,e),this.nodesPool="string"==typeof t?new NodesPool(t):null,this.nodeType=t,this.rootNode=r,this.table=null,this.renderedNodes=0}return _createClass$c(e,[{key:"setTable",value:function(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}();function _typeof$4(e){return(_typeof$4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$d(e,t,r){return t&&_defineProperties$d(e.prototype,t),r&&_defineProperties$d(e,r),e}function _inherits$1(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$1(e,t)}function _setPrototypeOf$1(e,t){return(_setPrototypeOf$1=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$1(e){var t=_isNativeReflectConstruct$1();return function(){var r,n=_getPrototypeOf$1(e);if(t){var o=_getPrototypeOf$1(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$1(this,r)}}function _possibleConstructorReturn$1(e,t){return!t||"object"!==_typeof$4(t)&&"function"!=typeof t?_assertThisInitialized$1(e):t}function _assertThisInitialized$1(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$1(e){return(_getPrototypeOf$1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var RowHeadersRenderer=function(e){_inherits$1(r,e);var t=_createSuper$1(r);function r(){var e;return _classCallCheck$d(this,r),(e=t.call(this,"TH")).orderViews=new WeakMap,e.sourceRowIndex=0,e}return _createClass$d(r,[{key:"obtainOrderView",value:function(e){var t,r=this;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new SharedOrderView(e,(function(e){return r.nodesPool.obtain(r.sourceRowIndex,e)}),this.nodeType),this.orderViews.set(e,t)),t}},{key:"render",value:function(){for(var e=this.table,t=e.rowsToRender,r=e.rowHeaderFunctions,n=e.rowHeadersCount,o=e.rows,i=e.cells,a=0;a<t;a++){var s=this.table.renderedRowToSource(a),l=o.getRenderedNode(a);this.sourceRowIndex=s;var u=this.obtainOrderView(l),c=i.obtainOrderView(l);u.appendView(c).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(var f=0;f<n;f++){u.render();var h=u.getCurrentNode();h.className="",h.removeAttribute("style"),r[f](s,h,f)}u.end()}}}]),r}(BaseRenderer);function _typeof$5(e){return(_typeof$5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$e(e,t,r){return t&&_defineProperties$e(e.prototype,t),r&&_defineProperties$e(e,r),e}function _inherits$2(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$2(e,t)}function _setPrototypeOf$2(e,t){return(_setPrototypeOf$2=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$2(e){var t=_isNativeReflectConstruct$2();return function(){var r,n=_getPrototypeOf$2(e);if(t){var o=_getPrototypeOf$2(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$2(this,r)}}function _possibleConstructorReturn$2(e,t){return!t||"object"!==_typeof$5(t)&&"function"!=typeof t?_assertThisInitialized$2(e):t}function _assertThisInitialized$2(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$2(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$2(e){return(_getPrototypeOf$2=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ColumnHeadersRenderer=function(e){_inherits$2(r,e);var t=_createSuper$2(r);function r(e){return _classCallCheck$e(this,r),t.call(this,null,e)}return _createClass$e(r,[{key:"adjust",value:function(){var e=this.table,t=e.columnHeadersCount,r=e.rowHeadersCount,n=this.rootNode.firstChild;if(t){for(var o=this.table.columnsToRender+r,i=0,a=t;i<a;i++){for((n=this.rootNode.childNodes[i])||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<o;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)n.removeChild(n.lastChild),this.renderedNodes-=1}var s=this.rootNode.childNodes.length;if(s>t)for(var l=t;l<s;l++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&empty$1(n)}},{key:"render",value:function(){for(var e=this.table.columnHeadersCount,t=0;t<e;t+=1)for(var r=this.table,n=r.columnHeaderFunctions,o=r.columnsToRender,i=r.rowHeadersCount,a=this.rootNode.childNodes[t],s=-1*i;s<o;s+=1){var l=this.table.renderedColumnToSource(s),u=a.childNodes[s+i];u.className="",u.removeAttribute("style"),n[t](l,u,t)}}}]),r}(BaseRenderer);function _typeof$6(e){return(_typeof$6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$f(e,t,r){return t&&_defineProperties$f(e.prototype,t),r&&_defineProperties$f(e,r),e}function _inherits$3(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$3(e,t)}function _setPrototypeOf$3(e,t){return(_setPrototypeOf$3=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$3(e){var t=_isNativeReflectConstruct$3();return function(){var r,n=_getPrototypeOf$3(e);if(t){var o=_getPrototypeOf$3(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$3(this,r)}}function _possibleConstructorReturn$3(e,t){return!t||"object"!==_typeof$6(t)&&"function"!=typeof t?_assertThisInitialized$3(e):t}function _assertThisInitialized$3(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$3(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$3(e){return(_getPrototypeOf$3=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ColGroupRenderer=function(e){_inherits$3(r,e);var t=_createSuper$3(r);function r(e){return _classCallCheck$f(this,r),t.call(this,null,e)}return _createClass$f(r,[{key:"adjust",value:function(){for(var e=this.table,t=e.columnsToRender+e.rowHeadersCount;this.renderedNodes<t;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>t;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var e=this.table,t=e.columnsToRender,r=e.rowHeadersCount,n=0;n<r;n++){var o=this.table.renderedColumnToSource(n),i=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[n].style.width="".concat(i,"px")}for(var a=0;a<t;a++){var s=this.table.renderedColumnToSource(a),l=this.table.columnUtils.getStretchedColumnWidth(s);this.rootNode.childNodes[a+r].style.width="".concat(l,"px")}var u=this.rootNode.firstChild;u&&addClass(u,"rowHeader")}}]),r}(BaseRenderer);function _typeof$7(e){return(_typeof$7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _templateObject$2(){var e=_taggedTemplateLiteral$2(['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting \n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'],['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20\n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.']);return _templateObject$2=function(){return e},e}function _taggedTemplateLiteral$2(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _classCallCheck$g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$g(e,t,r){return t&&_defineProperties$g(e.prototype,t),r&&_defineProperties$g(e,r),e}function _inherits$4(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$4(e,t)}function _setPrototypeOf$4(e,t){return(_setPrototypeOf$4=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$4(e){var t=_isNativeReflectConstruct$4();return function(){var r,n=_getPrototypeOf$4(e);if(t){var o=_getPrototypeOf$4(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$4(this,r)}}function _possibleConstructorReturn$4(e,t){return!t||"object"!==_typeof$7(t)&&"function"!=typeof t?_assertThisInitialized$4(e):t}function _assertThisInitialized$4(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$4(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$4(e){return(_getPrototypeOf$4=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var performanceWarningAppeared=!1,RowsRenderer=function(e){_inherits$4(r,e);var t=_createSuper$4(r);function r(e){var n;return _classCallCheck$g(this,r),(n=t.call(this,"TR",e)).orderView=new OrderView(e,(function(e){return n.nodesPool.obtain(e)}),n.nodeType),n}return _createClass$g(r,[{key:"getRenderedNode",value:function(e){return this.orderView.getNode(e)}},{key:"render",value:function(){var e=this.table.rowsToRender;!performanceWarningAppeared&&e>1e3&&(performanceWarningAppeared=!0,warn(toSingleLine(_templateObject$2()))),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(var t=0;t<e;t++)this.orderView.render();this.orderView.end()}}]),r}(BaseRenderer);function _typeof$8(e){return(_typeof$8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$h(e,t,r){return t&&_defineProperties$h(e.prototype,t),r&&_defineProperties$h(e,r),e}function _inherits$5(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$5(e,t)}function _setPrototypeOf$5(e,t){return(_setPrototypeOf$5=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$5(e){var t=_isNativeReflectConstruct$5();return function(){var r,n=_getPrototypeOf$5(e);if(t){var o=_getPrototypeOf$5(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$5(this,r)}}function _possibleConstructorReturn$5(e,t){return!t||"object"!==_typeof$8(t)&&"function"!=typeof t?_assertThisInitialized$5(e):t}function _assertThisInitialized$5(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$5(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$5(e){return(_getPrototypeOf$5=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var CellsRenderer=function(e){_inherits$5(r,e);var t=_createSuper$5(r);function r(){var e;return _classCallCheck$h(this,r),(e=t.call(this,"TD")).orderViews=new WeakMap,e.sourceRowIndex=0,e}return _createClass$h(r,[{key:"obtainOrderView",value:function(e){var t,r=this;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new SharedOrderView(e,(function(e){return r.nodesPool.obtain(r.sourceRowIndex,e)}),this.nodeType),this.orderViews.set(e,t)),t}},{key:"render",value:function(){for(var e=this.table,t=e.rowsToRender,r=e.columnsToRender,n=e.rows,o=e.rowHeaders,i=0;i<t;i++){var a=this.table.renderedRowToSource(i),s=n.getRenderedNode(i);this.sourceRowIndex=a;var l=this.obtainOrderView(s),u=o.obtainOrderView(s);l.prependView(u).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(var c=0;c<r;c++){l.render();var f=l.getCurrentNode(),h=this.table.renderedColumnToSource(c);hasClass(f,"hide")||(f.className=""),f.removeAttribute("style"),this.table.cellRenderer(a,h,f)}l.end()}}}]),r}(BaseRenderer);function _classCallCheck$i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$i(e,t,r){return t&&_defineProperties$i(e.prototype,t),r&&_defineProperties$i(e,r),e}var TableRenderer=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.cellRenderer;_classCallCheck$i(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return _createClass$i(e,[{key:"setAxisUtils",value:function(e,t){this.rowUtils=e,this.columnUtils=t}},{key:"setViewportSize",value:function(e,t){this.rowsToRender=e,this.columnsToRender=t}},{key:"setFilters",value:function(e,t){this.rowFilter=e,this.columnFilter=t}},{key:"setHeaderContentRenderers",value:function(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}},{key:"setRenderers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rowHeaders,r=e.columnHeaders,n=e.colGroup,o=e.rows,i=e.cells;t.setTable(this),r.setTable(this),n.setTable(this),o.setTable(this),i.setTable(this),this.rowHeaders=t,this.columnHeaders=r,this.colGroup=n,this.rows=o,this.cells=i}},{key:"renderedRowToSource",value:function(e){return this.rowFilter.renderedToSource(e)}},{key:"renderedColumnToSource",value:function(e){return this.columnFilter.renderedToSource(e)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var e=this.rowsToRender,t=this.rows,r=0;r<e;r++){var n=t.getRenderedNode(r);if(n.firstChild){var o=this.renderedRowToSource(r),i=this.rowUtils.getHeight(o);n.firstChild.style.height=i?"".concat(i-1,"px"):""}}}}]),e}();function _classCallCheck$j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$j(e,t,r){return t&&_defineProperties$j(e.prototype,t),r&&_defineProperties$j(e,r),e}var Renderer=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.TABLE,n=t.THEAD,o=t.COLGROUP,i=t.TBODY,a=t.rowUtils,s=t.columnUtils,l=t.cellRenderer;_classCallCheck$j(this,e),this.renderer=new TableRenderer(r,{cellRenderer:l}),this.renderer.setRenderers({rowHeaders:new RowHeadersRenderer,columnHeaders:new ColumnHeadersRenderer(n),colGroup:new ColGroupRenderer(o),rows:new RowsRenderer(i),cells:new CellsRenderer}),this.renderer.setAxisUtils(a,s)}return _createClass$j(e,[{key:"setFilters",value:function(e,t){return this.renderer.setFilters(e,t),this}},{key:"setViewportSize",value:function(e,t){return this.renderer.setViewportSize(e,t),this}},{key:"setHeaderContentRenderers",value:function(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}();function stopImmediatePropagation(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function isImmediatePropagationStopped(e){return!1===e.isImmediatePropagationEnabled}function isRightClick(e){return 2===e.button}function isLeftClick(e){return 0===e.button}var domEventHelpers=Object.freeze({__proto__:null,stopImmediatePropagation:stopImmediatePropagation,isImmediatePropagationStopped:isImmediatePropagationStopped,isRightClick:isRightClick,isLeftClick:isLeftClick});function _classCallCheck$k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$k(e,t,r){return t&&_defineProperties$k(e.prototype,t),r&&_defineProperties$k(e,r),e}var listenersCounter=0,EventManager=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;_classCallCheck$k(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return _createClass$k(e,[{key:"addEventListener",value:function(e,t,r){var n=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function i(e){r.call(this,extendEvent(e))}return"boolean"==typeof o||isPassiveEventSupported()||(o=!1),this.context.eventListeners.push({element:e,event:t,callback:r,callbackProxy:i,options:o,eventManager:this}),e.addEventListener(t,i,o),listenersCounter+=1,function(){n.removeEventListener(e,t,r)}}},{key:"removeEventListener",value:function(e,t,r){for(var n,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.context.eventListeners.length;i;)if(i-=1,(n=this.context.eventListeners[i]).event===t&&n.element===e){if(r&&r!==n.callback)continue;if(o&&n.eventManager!==this)continue;this.context.eventListeners.splice(i,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),listenersCounter-=1}}},{key:"clearEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.context)for(var t=this.context.eventListeners.length;t;){t-=1;var r=this.context.eventListeners[t];r&&this.removeEventListener(r.element,r.event,r.callback,e)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(e,t){var r=e.document,n=e;r||(n=(r=e.ownerDocument?e.ownerDocument:e).defaultView);var o,i={bubbles:!0,cancelable:"mousemove"!==t,view:n,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};r.createEvent?(o=r.createEvent("MouseEvents")).initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,r.body.parentNode):o=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent("on".concat(t),o)}}]),e}();function extendEvent(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),stopImmediatePropagation(this)},e}function getListenersCounter(){return listenersCounter}function _classCallCheck$l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$l(e,t,r){return t&&_defineProperties$l(e.prototype,t),r&&_defineProperties$l(e,r),e}var privatePool$2=new WeakMap,Event$1=function(){function e(t){_classCallCheck$l(this,e),this.instance=t,this.eventManager=new EventManager(t),privatePool$2.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return _createClass$l(e,[{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.instance.wtTable.holder,"contextmenu",(function(t){return e.onContextMenu(t)})),this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseout",(function(t){return e.onMouseOut(t)}));var t=function(){e.eventManager.addEventListener(e.instance.wtTable.holder,"touchstart",(function(t){return e.onTouchStart(t)})),e.eventManager.addEventListener(e.instance.wtTable.holder,"touchend",(function(t){return e.onTouchEnd(t)})),e.instance.momentumScrolling||(e.instance.momentumScrolling={}),e.eventManager.addEventListener(e.instance.wtTable.holder,"scroll",(function(){clearTimeout(e.instance.momentumScrolling._timeout),e.instance.momentumScrolling.ongoing||e.instance.getSetting("onBeforeTouchScroll"),e.instance.momentumScrolling.ongoing=!0,e.instance.momentumScrolling._timeout=setTimeout((function(){e.instance.touchApplied||(e.instance.momentumScrolling.ongoing=!1,e.instance.getSetting("onAfterMomentumScroll"))}),200)}))};isMobileBrowser()?t():(isTouchSupported()&&t(),e.eventManager.addEventListener(e.instance.wtTable.holder,"mouseup",(function(t){return e.onMouseUp(t)})),e.eventManager.addEventListener(e.instance.wtTable.holder,"mousedown",(function(t){return e.onMouseDown(t)})))}},{key:"selectedCellWasTouched",value:function(e){var t=privatePool$2.get(this),r=this.parentCell(e).coords;if(t.selectedCellBeforeTouchEnd&&r){var n=[r.row,t.selectedCellBeforeTouchEnd.from.row],o=n[0],i=n[1],a=[r.col,t.selectedCellBeforeTouchEnd.from.col];return o===i&&a[0]===a[1]}return!1}},{key:"parentCell",value:function(e){var t={},r=closestDown(e,["TD","TH"],this.instance.wtTable.TABLE);return r?(t.coords=this.instance.wtTable.getCoords(r),t.TD=r):hasClass(e,"wtBorder")&&hasClass(e,"current")?(t.coords=this.instance.selections.getCell().cellRange.highlight,t.TD=this.instance.wtTable.getCell(t.coords)):hasClass(e,"wtBorder")&&hasClass(e,"area")&&this.instance.selections.createOrGetArea().cellRange&&(t.coords=this.instance.selections.createOrGetArea().cellRange.to,t.TD=this.instance.wtTable.getCell(t.coords)),t}},{key:"onMouseDown",value:function(e){var t=privatePool$2.get(this),r=this.instance.rootDocument.activeElement,n=partial(getParent,e.target),o=e.target;if(o!==r&&n(0)!==r&&n(1)!==r){var i=this.parentCell(o);hasClass(o,"corner")?this.instance.getSetting("onCellCornerMouseDown",e,o):i.TD&&this.instance.hasSetting("onCellMouseDown")&&this.instance.getSetting("onCellMouseDown",e,i.coords,i.TD,this.instance),(0===e.button||this.instance.touchApplied)&&i.TD&&(t.dblClickOrigin[0]=i.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout((function(){t.dblClickOrigin[0]=null}),1e3))}}},{key:"onContextMenu",value:function(e){if(this.instance.hasSetting("onCellContextMenu")){var t=this.parentCell(e.target);t.TD&&this.instance.getSetting("onCellContextMenu",e,t.coords,t.TD,this.instance)}}},{key:"onMouseOver",value:function(e){if(this.instance.hasSetting("onCellMouseOver")){var t=this.instance.wtTable.TABLE,r=closestDown(e.target,["TD","TH"],t),n=this.instance.cloneSource||this.instance;r&&r!==n.lastMouseOver&&isChildOf(r,t)&&(n.lastMouseOver=r,this.instance.getSetting("onCellMouseOver",e,this.instance.wtTable.getCoords(r),r,this.instance))}}},{key:"onMouseOut",value:function(e){if(this.instance.hasSetting("onCellMouseOut")){var t=this.instance.wtTable.TABLE,r=closestDown(e.target,["TD","TH"],t),n=closestDown(e.relatedTarget,["TD","TH"],t);r&&r!==n&&isChildOf(r,t)&&this.instance.getSetting("onCellMouseOut",e,this.instance.wtTable.getCoords(r),r,this.instance)}}},{key:"onMouseUp",value:function(e){var t=privatePool$2.get(this),r=this.parentCell(e.target);r.TD&&this.instance.hasSetting("onCellMouseUp")&&this.instance.getSetting("onCellMouseUp",e,r.coords,r.TD,this.instance),(0===e.button||this.instance.touchApplied)&&(r.TD===t.dblClickOrigin[0]&&r.TD===t.dblClickOrigin[1]?(hasClass(e.target,"corner")?this.instance.getSetting("onCellCornerDblClick",e,r.coords,r.TD,this.instance):this.instance.getSetting("onCellDblClick",e,r.coords,r.TD,this.instance),t.dblClickOrigin[0]=null,t.dblClickOrigin[1]=null):r.TD===t.dblClickOrigin[0]&&(t.dblClickOrigin[1]=r.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout((function(){t.dblClickOrigin[1]=null}),500)))}},{key:"onTouchStart",value:function(e){privatePool$2.get(this).selectedCellBeforeTouchEnd=this.instance.selections.getCell().cellRange,this.instance.touchApplied=!0,this.onMouseDown(e)}},{key:"onTouchEnd",value:function(e){var t=e.target;!1===this.selectedCellWasTouched(t)&&["A","BUTTON","INPUT"].includes(t.tagName)&&e.preventDefault(),this.onMouseUp(e),this.instance.touchApplied=!1}},{key:"destroy",value:function(){var e=privatePool$2.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}(),KEY_CODES={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL:17,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88};function isPrintableChar(e){return 32===e||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function isMetaKey(e){return-1!==[KEY_CODES.ARROW_DOWN,KEY_CODES.ARROW_UP,KEY_CODES.ARROW_LEFT,KEY_CODES.ARROW_RIGHT,KEY_CODES.HOME,KEY_CODES.END,KEY_CODES.DELETE,KEY_CODES.BACKSPACE,KEY_CODES.F1,KEY_CODES.F2,KEY_CODES.F3,KEY_CODES.F4,KEY_CODES.F5,KEY_CODES.F6,KEY_CODES.F7,KEY_CODES.F8,KEY_CODES.F9,KEY_CODES.F10,KEY_CODES.F11,KEY_CODES.F12,KEY_CODES.TAB,KEY_CODES.PAGE_DOWN,KEY_CODES.PAGE_UP,KEY_CODES.ENTER,KEY_CODES.ESCAPE,KEY_CODES.SHIFT,KEY_CODES.CAPS_LOCK,KEY_CODES.ALT].indexOf(e)}function isCtrlKey(e){var t=[];return navigator.platform.includes("Mac")?t.push(KEY_CODES.COMMAND_LEFT,KEY_CODES.COMMAND_RIGHT,KEY_CODES.COMMAND_FIREFOX):t.push(KEY_CODES.CONTROL),t.includes(e)}function isCtrlMetaKey(e){return[KEY_CODES.CONTROL,KEY_CODES.COMMAND_LEFT,KEY_CODES.COMMAND_RIGHT,KEY_CODES.COMMAND_FIREFOX].includes(e)}function isKey(e,t){var r=t.split("|"),n=!1;return arrayEach(r,(function(t){if(e===KEY_CODES[t])return n=!0,!1})),n}var unicodeHelpers=Object.freeze({__proto__:null,KEY_CODES:KEY_CODES,isPrintableChar:isPrintableChar,isMetaKey:isMetaKey,isCtrlKey:isCtrlKey,isCtrlMetaKey:isCtrlMetaKey,isKey:isKey});function _classCallCheck$m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$m(e,t,r){return t&&_defineProperties$m(e.prototype,t),r&&_defineProperties$m(e,r),e}var Overlays=function(){function e(t){_classCallCheck$m(this,e),this.wot=t;var r=this.wot,n=r.rootDocument,o=r.rootWindow,i=r.wtTable,a=parseInt(o.getComputedStyle(n.body).lineHeight,10),s=1.2*parseInt(o.getComputedStyle(n.body).fontSize,10);this.instance=this.wot,this.eventManager=new EventManager(this.wot),this.scrollbarSize=getScrollbarWidth(n),this.wot.update("scrollbarWidth",this.scrollbarSize),this.wot.update("scrollbarHeight",this.scrollbarSize);var l="hidden"===o.getComputedStyle(i.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=l?i.holder:getScrollableElement(i.TABLE),this.topOverlay=void 0,this.bottomOverlay=void 0,this.leftOverlay=void 0,this.topLeftCornerOverlay=void 0,this.bottomLeftCornerOverlay=void 0,this.prepareOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.browserLineHeight=a||s,this.registerListeners(),this.lastScrollX=o.scrollX,this.lastScrollY=o.scrollY}return _createClass$m(e,[{key:"prepareOverlays",value:function(){var e=!1;return this.topOverlay?e=this.topOverlay.updateStateOfRendering()||e:this.topOverlay=Overlay.createOverlay(Overlay.CLONE_TOP,this.wot),Overlay.hasOverlay(Overlay.CLONE_BOTTOM)||(this.bottomOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),Overlay.hasOverlay(Overlay.CLONE_BOTTOM_LEFT_CORNER)||(this.bottomLeftCornerOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),this.bottomOverlay?e=this.bottomOverlay.updateStateOfRendering()||e:this.bottomOverlay=Overlay.createOverlay(Overlay.CLONE_BOTTOM,this.wot),this.leftOverlay?e=this.leftOverlay.updateStateOfRendering()||e:this.leftOverlay=Overlay.createOverlay(Overlay.CLONE_LEFT,this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay?e=this.topLeftCornerOverlay.updateStateOfRendering()||e:this.topLeftCornerOverlay=Overlay.createOverlay(Overlay.CLONE_TOP_LEFT_CORNER,this.wot)),this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.bottomLeftCornerOverlay?e=this.bottomLeftCornerOverlay.updateStateOfRendering()||e:this.bottomLeftCornerOverlay=Overlay.createOverlay(Overlay.CLONE_BOTTOM_LEFT_CORNER,this.wot)),e}},{key:"refreshAll",value:function(){this.wot.drawn&&(this.wot.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.leftOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}},{key:"registerListeners",value:function(){var e=this,t=this.wot,r=t.rootDocument,n=t.rootWindow,o=this.topOverlay.mainTableScrollableElement,i=this.leftOverlay.mainTableScrollableElement;this.eventManager.addEventListener(r.documentElement,"keydown",(function(t){return e.onKeyDown(t)})),this.eventManager.addEventListener(r.documentElement,"keyup",(function(){return e.onKeyUp()})),this.eventManager.addEventListener(r,"visibilitychange",(function(){return e.onKeyUp()})),this.eventManager.addEventListener(o,"scroll",(function(t){return e.onTableScroll(t)}),{passive:!0}),o!==i&&this.eventManager.addEventListener(i,"scroll",(function(t){return e.onTableScroll(t)}),{passive:!0});var a,s=n.devicePixelRatio&&n.devicePixelRatio>1,l=this.scrollableElement===n,u=this.wot.wtSettings.getSetting("preventWheel"),c={passive:l};(u||s||!isChrome())&&this.eventManager.addEventListener(this.wot.wtTable.wtRootElement,"wheel",(function(t){return e.onCloneWheel(t,u)}),c),[this.topOverlay,this.bottomOverlay,this.leftOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay].forEach((function(t){if(t&&t.needFullRender){var r=t.clone.wtTable.holder;e.eventManager.addEventListener(r,"wheel",(function(t){return e.onCloneWheel(t,u)}),c)}})),this.eventManager.addEventListener(n,"resize",(function(){clearTimeout(a),a=setTimeout((function(){e.wot.getSetting("onWindowResize")}),200)}))}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(e){var t=this.wot.rootWindow,r=this.leftOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(n!==t&&o!==t&&!e.target.contains(n)||r!==t&&o!==t&&!e.target.contains(r))||this.syncScrollPositions(e)}},{key:"onCloneWheel",value:function(e,t){var r=this.wot.rootWindow,n=this.leftOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,i=e.target,a=o!==r&&i!==r&&!i.contains(o),s=n!==r&&i!==r&&!i.contains(n);if(!this.keyPressed||!a&&!s){var l=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==r&&l)&&e.preventDefault()}}},{key:"onKeyDown",value:function(e){this.keyPressed=isKey(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(e){var t=this.browserLineHeight,r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;1===e.deltaMode&&(n+=n*t,r+=r*t);var o=this.scrollVertically(r),i=this.scrollHorizontally(n);return o||i}},{key:"scrollVertically",value:function(e){var t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(e){var t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var e=this.wot.rootWindow,t=this.topOverlay.clone.wtTable.holder,r=this.leftOverlay.clone.wtTable.holder,n=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],o=n[0],i=n[1];if(this.horizontalScrolling=t.scrollLeft!==o||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==i||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=o;var a=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;a&&(a.scrollLeft=o)}this.verticalScrolling&&(r.scrollTop=i),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var e=this.topOverlay.mainTableScrollableElement,t=e.scrollLeft,r=e.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=r)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.leftOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var e=this.wot,t=e.rootWindow,r=e.wtTable;"hidden"===t.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=r.holder:this.scrollableElement=getScrollableElement(r.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.leftOverlay.destroy(),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy(),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted){var t=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement,r=t.clientWidth,n=t.clientHeight;r===this.spreaderLastSize.width&&n===this.spreaderLastSize.height||(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n,this.adjustElementsSize())}this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.leftOverlay.refresh(e),this.topOverlay.refresh(e),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(e),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.refresh(e)}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wot,r=t.wtViewport,n=t.wtTable,o=this.wot.getSetting("totalColumns"),i=this.wot.getSetting("totalRows"),a=r.getRowHeaderWidth(),s=r.getColumnHeaderHeight(),l=n.hider.style;if(l.width="".concat(a+this.leftOverlay.sumCellSizes(0,o),"px"),l.height="".concat(s+this.topOverlay.sumCellSizes(0,i)+1,"px"),this.scrollbarSize>0){var u=n.wtRootElement,c=u.scrollHeight,f=u.scrollWidth,h=n.holder,d=h.scrollHeight,p=h.scrollWidth;this.hasScrollbarRight=c<d,this.hasScrollbarBottom=f<p,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>f?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.leftOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}},{key:"applyToDOM",value:function(){this.wot.wtTable.isVisible()&&(this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted||this.adjustElementsSize(),this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.leftOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(e){if(!e)return null;var t=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],r=null;return arrayEach(t,(function(t){t&&t.clone&&t.clone.wtTable.TABLE.contains(e)&&(r=t.clone)})),r}},{key:"syncOverlayTableClassNames",value:function(){var e=this.instance.wtTable.TABLE;arrayEach([this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],(function(t){t&&(t.clone.wtTable.TABLE.className=e.className)}))}}]),e}();function _classCallCheck$n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$n(e,t,r){return t&&_defineProperties$n(e.prototype,t),r&&_defineProperties$n(e,r),e}var Scroll=function(){function e(t){_classCallCheck$n(this,e),this.wot=t}return _createClass$n(e,[{key:"scrollViewport",value:function(e,t,r,n,o){if(e.col<0||e.row<0)return!1;var i=this.scrollViewportHorizontally(e.col,r,o),a=this.scrollViewportVertically(e.row,t,n);return i||a}},{key:"scrollViewportHorizontally",value:function(e,t,r){if(!this.wot.drawn)return!1;var n=this._getVariables(),o=n.fixedColumnsLeft,i=n.leftOverlay,a=n.totalColumns,s=!1;if(e>=0&&e<=Math.max(a-1,0)){var l=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn();e>=o&&l>-1&&(e<l||r)?s=i.scrollTo(e):(-1===u||u>-1&&(e>u||t))&&(s=i.scrollTo(e,!0))}return s}},{key:"scrollViewportVertically",value:function(e,t,r){if(!this.wot.drawn)return!1;var n=this._getVariables(),o=n.fixedRowsBottom,i=n.fixedRowsTop,a=n.topOverlay,s=n.totalRows,l=!1;if(e>=0&&e<=Math.max(s-1,0)){var u=this.getFirstVisibleRow(),c=this.getLastVisibleRow();e>=i&&u>-1&&(e<u||t)?l=a.scrollTo(e):(-1===c||c>-1&&(e>c&&e<s-o||r))&&(l=a.scrollTo(e,!0))}return l}},{key:"getFirstVisibleRow",value:function(){var e=this._getVariables(),t=e.topOverlay,r=e.wtTable,n=e.wtViewport,o=e.totalRows,i=e.fixedRowsTop,a=this.wot.rootWindow,s=r.getFirstVisibleRow();if(t.mainTableScrollableElement===a){var l=offset(r.wtRootElement),u=innerHeight(r.hider),c=innerHeight(a),f=getScrollTop(a,a);if(l.top+u-c<=f){var h=n.getColumnHeaderHeight();h+=t.sumCellSizes(0,i);for(var d=o;d>0;d--)if(h+=t.sumCellSizes(d-1,d),l.top+u-h<=f){s=d;break}}}return s}},{key:"getLastVisibleRow",value:function(){var e=this._getVariables(),t=e.topOverlay,r=e.wtTable,n=e.wtViewport,o=e.totalRows,i=this.wot.rootWindow,a=r.getLastVisibleRow();if(t.mainTableScrollableElement===i){var s=offset(r.wtRootElement),l=getScrollTop(i,i);if(s.top>l)for(var u=innerHeight(i),c=n.getColumnHeaderHeight(),f=1;f<=o;f++)if(c+=t.sumCellSizes(f-1,f),s.top+c-l>=u){a=f-2;break}}return a}},{key:"getFirstVisibleColumn",value:function(){var e=this._getVariables(),t=e.leftOverlay,r=e.wtTable,n=e.wtViewport,o=e.totalColumns,i=this.wot.rootWindow,a=r.getFirstVisibleColumn();if(t.mainTableScrollableElement===i){var s=offset(r.wtRootElement),l=innerWidth(r.hider),u=innerWidth(i),c=getScrollLeft(i,i);if(s.left+l-u<=c)for(var f=n.getRowHeaderWidth(),h=o;h>0;h--)if(f+=t.sumCellSizes(h-1,h),s.left+l-f<=c){a=h;break}}return a}},{key:"getLastVisibleColumn",value:function(){var e=this._getVariables(),t=e.leftOverlay,r=e.wtTable,n=e.wtViewport,o=e.totalColumns,i=this.wot.rootWindow,a=r.getLastVisibleColumn();if(t.mainTableScrollableElement===i){var s=offset(r.wtRootElement),l=getScrollLeft(i,i);if(s.left>l)for(var u=innerWidth(i),c=n.getRowHeaderWidth(),f=1;f<=o;f++)if(c+=t.sumCellSizes(f-1,f),s.left+c-l>=u){a=f-2;break}}return a}},{key:"_getVariables",value:function(){var e=this.wot;return{topOverlay:e.wtOverlays.topOverlay,leftOverlay:e.wtOverlays.leftOverlay,wtTable:e.wtTable,wtViewport:e.wtViewport,totalRows:e.getSetting("totalRows"),totalColumns:e.getSetting("totalColumns"),fixedRowsTop:e.getSetting("fixedRowsTop"),fixedRowsBottom:e.getSetting("fixedRowsBottom"),fixedColumnsLeft:e.getSetting("fixedColumnsLeft")}}}]),e}();function _classCallCheck$o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$o(e,t,r){return t&&_defineProperties$o(e.prototype,t),r&&_defineProperties$o(e,r),e}var Settings=function(){function e(t,r){var n=this;_classCallCheck$o(this,e),this.wot=t,this.instance=t,this.defaults={table:void 0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderLeftOverlay:function(){return n.getSetting("fixedColumnsLeft")>0||n.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return n.getSetting("fixedRowsTop")>0||n.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return n.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(e,t,r){var o=n.getSetting("data",e,t);fastInnerText(r,null==o?"":o)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(e){return e},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onWindowResize:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null},this.settings={},objectEach(this.defaults,(function(e,t){if(void 0!==r[t])n.settings[t]=r[t];else{if(void 0===e)throw new Error('A required setting "'.concat(t,'" was not provided'));n.settings[t]=e}}))}return _createClass$o(e,[{key:"update",value:function(e,t){var r=this;return void 0===t?objectEach(e,(function(e,t){r.settings[t]=e})):this.settings[e]=t,this.wot}},{key:"getSetting",value:function(e,t,r,n,o){return"function"==typeof this.settings[e]?this.settings[e](t,r,n,o):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}},{key:"has",value:function(e){return!!this.settings[e]}}]),e}();function _classCallCheck$p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$p(e,t,r){return t&&_defineProperties$p(e.prototype,t),r&&_defineProperties$p(e,r),e}var Viewport=function(){function e(t){var r=this;_classCallCheck$p(this,e),this.wot=t,this.instance=this.wot,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=new EventManager(this.wot),this.eventManager.addEventListener(this.wot.rootWindow,"resize",(function(){r.clientHeight=r.getWorkspaceHeight()}))}return _createClass$p(e,[{key:"getWorkspaceHeight",value:function(){var e=this.wot.rootDocument,t=this.instance.wtOverlays.topOverlay.trimmingContainer,r=0;t===this.wot.rootWindow?r=e.documentElement.clientHeight:r=outerHeight(t)>0&&t.clientHeight>0?t.clientHeight:1/0;return r}},{key:"getWorkspaceWidth",value:function(){var e,t,r=this.wot,n=r.rootDocument,o=r.rootWindow,i=this.instance.wtOverlays.leftOverlay.trimmingContainer,a=n.documentElement.offsetWidth,s=r.getSetting("totalColumns");if(r.getSetting("preventOverflow"))return outerWidth(this.instance.wtTable.wtRootElement);if(e=r.getSetting("freezeOverlays")?Math.min(a-this.getWorkspaceOffset().left,a):Math.min(this.getContainerFillWidth(),a-this.getWorkspaceOffset().left,a),i===o&&s>0&&this.sumColumnWidths(0,s-1)>e)return n.documentElement.clientWidth;if(i!==o&&("scroll"===(t=getStyle(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow",o))||"hidden"===t||"auto"===t))return Math.max(e,i.clientWidth);var l=r.getSetting("stretchH");return"none"!==l&&l?e:Math.max(e,outerWidth(this.instance.wtTable.TABLE))}},{key:"hasVerticalScroll",value:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(e,t){for(var r=this.wot.wtTable,n=0,o=e;o<t;)n+=r.getColumnWidth(o),o+=1;return n}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var e=this.instance.wtTable.holder,t=this.wot.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);var r=t.offsetWidth;return this.containerWidth=r,e.removeChild(t),r}},{key:"getWorkspaceOffset",value:function(){return offset(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualHeight",value:function(){return outerHeight(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualWidth",value:function(){var e=this.wot.wtTable;return outerWidth(e.TABLE)||outerWidth(e.TBODY)||outerWidth(e.THEAD)}},{key:"getColumnHeaderHeight",value:function(){return this.instance.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=outerHeight(this.wot.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var e=this.getWorkspaceHeight();if(e===1/0)return e;var t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}},{key:"getRowHeaderWidth",value:function(){var e=this.instance.getSetting("rowHeaderWidth"),t=this.instance.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(var r=0,n=t.length;r<n;r++)this.rowHeaderWidth+=e[r]||e}if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth))if(t.length){var o=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var i=0,a=t.length;i<a;i++)o?(this.rowHeaderWidth+=outerWidth(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.instance.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var e=this.getWorkspaceWidth();if(e===1/0)return e;var t=this.getRowHeaderWidth();return t>0?e-t:e}},{key:"createRowsCalculator",value:function(){var e,t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:RENDER_TYPE,o=this.wot,i=o.wtSettings,a=o.wtOverlays,s=o.wtTable,l=o.rootDocument;this.rowHeaderWidth=NaN,e=i.settings.renderAllRows&&n===RENDER_TYPE?1/0:this.getViewportHeight();var u=a.topOverlay.getScrollPosition()-a.topOverlay.getTableParentOffset();u<0&&(u=0);var c=o.getSetting("fixedRowsTop"),f=o.getSetting("fixedRowsBottom"),h=o.getSetting("totalRows");return c&&(u+=r=a.topOverlay.sumCellSizes(0,c),e-=r),f&&a.bottomOverlay.clone&&(e-=r=a.bottomOverlay.sumCellSizes(h-f,h)),t=s.holder.clientHeight===s.holder.offsetHeight?0:getScrollbarWidth(l),new ViewportRowsCalculator({viewportSize:e,scrollOffset:u,totalItems:o.getSetting("totalRows"),itemSizeFn:function(e){return s.getRowHeight(e)},overrideFn:i.settings.viewportRowCalculatorOverride,calculationType:n,scrollbarHeight:t})}},{key:"createColumnsCalculator",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:RENDER_TYPE,t=this.wot,r=t.wtSettings,n=t.wtOverlays,o=t.wtTable,i=t.rootDocument,a=this.getViewportWidth(),s=n.leftOverlay.getScrollPosition()-n.leftOverlay.getTableParentOffset();this.columnHeaderHeight=NaN,s<0&&(s=0);var l=t.getSetting("fixedColumnsLeft");if(l){var u=n.leftOverlay.sumCellSizes(0,l);s+=u,a-=u}return o.holder.clientWidth!==o.holder.offsetWidth&&(a-=getScrollbarWidth(i)),new ViewportColumnsCalculator({viewportSize:a,scrollOffset:s,totalItems:t.getSetting("totalColumns"),itemSizeFn:function(e){return t.wtTable.getColumnWidth(e)},overrideFn:r.settings.viewportColumnCalculatorOverride,calculationType:e,stretchMode:t.getSetting("stretchH"),stretchingItemWidthFn:function(e,r){return t.getSetting("onBeforeStretchingColumnWidth",e,r)}})}},{key:"createRenderCalculators",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=e;if(t){var r=this.createRowsCalculator(FULLY_VISIBLE_TYPE),n=this.createColumnsCalculator(FULLY_VISIBLE_TYPE);this.areAllProposedVisibleRowsAlreadyRendered(r)&&this.areAllProposedVisibleColumnsAlreadyRendered(n)||(t=!1)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(RENDER_TYPE),this.columnsRenderCalculator=this.createColumnsCalculator(RENDER_TYPE)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(FULLY_VISIBLE_TYPE),this.columnsVisibleCalculator=this.createColumnsCalculator(FULLY_VISIBLE_TYPE)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(e){if(!this.rowsVisibleCalculator)return!1;var t=e.startRow,r=e.endRow,n=this.rowsRenderCalculator,o=n.startRow,i=n.endRow;return!(t<o||t===o&&t>0)&&!(r>i||r===i&&r<this.wot.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(e){if(!this.columnsVisibleCalculator)return!1;var t=e.startColumn,r=e.endColumn,n=this.columnsRenderCalculator,o=n.startColumn,i=n.endColumn;return!(t<o||t===o&&t>0)&&!(r>i||r===i&&r<this.wot.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){objectEach(this.hasOversizedColumnHeadersMarked,(function(e,t,r){r[t]=void 0}))}}]),e}();function _classCallCheck$q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$q(e,t,r){return t&&_defineProperties$q(e.prototype,t),r&&_defineProperties$q(e,r),e}var Walkontable=function(){function e(t){_classCallCheck$q(this,e);var r=[];if(this.guid="wt_".concat(randomString()),this.rootDocument=t.table.ownerDocument,this.rootWindow=this.rootDocument.defaultView,t.cloneSource?(this.cloneSource=t.cloneSource,this.cloneOverlay=t.cloneOverlay,this.wtSettings=t.cloneSource.wtSettings,this.wtTable=this.cloneOverlay.createTable(this,t.table),this.wtScroll=new Scroll(this),this.wtViewport=t.cloneSource.wtViewport,this.wtEvent=new Event$1(this),this.selections=this.cloneSource.selections):(this.wtSettings=new Settings(this,t),this.wtTable=new MasterTable(this,t.table),this.wtScroll=new Scroll(this),this.wtViewport=new Viewport(this),this.wtEvent=new Event$1(this),this.selections=this.getSetting("selections"),this.wtOverlays=new Overlays(this),this.exportSettingsAsClassNames()),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;n<o;n++)r.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(e,t){fastInnerText(t,r[e])}])}this.drawn=!1,this.drawInterrupted=!1}return _createClass$q(e,[{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,e||this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}},{key:"getCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return this.wtTable.getCell(e);var r=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsLeft");if(e.row<n&&e.col<i)return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(e);if(e.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<i&&e.row>=r-o){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone)return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<i)return this.wtOverlays.leftOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}},{key:"update",value:function(e,t){return this.wtSettings.update(e,t)}},{key:"scrollViewport",value:function(e,t,r,n,o){return!(e.col<0||e.row<0)&&this.wtScroll.scrollViewport(e,t,r,n,o)}},{key:"scrollViewportHorizontally",value:function(e,t,r){return!(e<0)&&this.wtScroll.scrollViewportHorizontally(e,t,r)}},{key:"scrollViewportVertically",value:function(e,t,r){return!(e<0)&&this.wtScroll.scrollViewportVertically(e,t,r)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"getOverlayName",value:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){var e=this,t=[],r=[];objectEach({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},(function(n,o){e.getSetting(o).length&&r.push(n),t.push(n)})),removeClass(this.wtTable.wtRootElement.parentNode,t),addClass(this.wtTable.wtRootElement.parentNode,r)}},{key:"getSetting",value:function(e,t,r,n,o){return this.wtSettings.getSetting(e,t,r,n,o)}},{key:"hasSetting",value:function(e){return this.wtSettings.has(e)}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}}]),e}();function _classCallCheck$r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$r(e,t,r){return t&&_defineProperties$r(e.prototype,t),r&&_defineProperties$r(e,r),e}var registeredOverlays={},Overlay=function(){function e(t){_classCallCheck$r(this,e),defineGetter(this,"wot",t,{writable:!1});var r=this.wot.wtTable,n=r.TABLE,o=r.hider,i=r.spreader,a=r.holder,s=r.wtRootElement;this.instance=this.wot,this.type="",this.mainTableScrollableElement=null,this.TABLE=n,this.hider=o,this.spreader=i,this.holder=a,this.wtRootElement=s,this.trimmingContainer=getTrimmingContainer(this.hider.parentNode.parentNode),this.areElementSizesAdjusted=!1,this.updateStateOfRendering()}return _createClass$r(e,null,[{key:"registerOverlay",value:function(t,r){if(-1===e.CLONE_TYPES.indexOf(t))throw new Error("Unsupported overlay (".concat(t,")."));registeredOverlays[t]=r}},{key:"createOverlay",value:function(e,t){return new registeredOverlays[e](t)}},{key:"hasOverlay",value:function(e){return void 0!==registeredOverlays[e]}},{key:"isOverlayTypeOf",value:function(e,t){return!(!e||!registeredOverlays[t])&&e instanceof registeredOverlays[t]}},{key:"CLONE_TOP",get:function(){return"top"}},{key:"CLONE_BOTTOM",get:function(){return"bottom"}},{key:"CLONE_LEFT",get:function(){return"left"}},{key:"CLONE_TOP_LEFT_CORNER",get:function(){return"top_left_corner"}},{key:"CLONE_BOTTOM_LEFT_CORNER",get:function(){return"bottom_left_corner"}},{key:"CLONE_TYPES",get:function(){return[e.CLONE_TOP,e.CLONE_BOTTOM,e.CLONE_LEFT,e.CLONE_TOP_LEFT_CORNER,e.CLONE_BOTTOM_LEFT_CORNER]}}]),_createClass$r(e,[{key:"updateStateOfRendering",value:function(){var e=this.needFullRender;this.needFullRender=this.shouldBeRendered();var t=e!==this.needFullRender;return t&&!this.needFullRender&&this.reset(),t}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=getTrimmingContainer(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var e=this.wot,t=e.wtTable;"hidden"===e.rootWindow.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=getScrollableElement(t.TABLE)}},{key:"getRelativeCellPosition",value:function(e,t,r){if(!1!==this.clone.wtTable.holder.contains(e)){var n=this.mainTableScrollableElement===this.wot.rootWindow,o=r<this.wot.getSetting("fixedColumnsLeft"),i=t<this.wot.getSetting("fixedRowsTop"),a=t>=this.wot.getSetting("totalRows")-this.wot.getSetting("fixedRowsBottom"),s={left:this.clone.wtTable.spreader.offsetLeft,top:this.clone.wtTable.spreader.offsetTop},l={left:e.offsetLeft,top:e.offsetTop};return n?this.getRelativeCellPositionWithinWindow(i,o,l,s):this.getRelativeCellPositionWithinHolder(i,a,o,l,s)}warn("The provided element is not a child of the ".concat(this.type," overlay"))}},{key:"getRelativeCellPositionWithinWindow",value:function(e,t,r,n){var o=this.wot.wtTable.wtRootElement.getBoundingClientRect(),i=0,a=0;(i=t?o.left<=0?-1*o.left:0:n.left,e)?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=n.top;return{left:r.left+i,top:r.top+a}}},{key:"getRelativeCellPositionWithinHolder",value:function(e,t,r,n,o){var i=this.clone.cloneSource.wtOverlays.leftOverlay.getScrollPosition(),a=this.clone.cloneSource.wtOverlays.topOverlay.getScrollPosition(),s=0,l=0;if(r||(s=i-o.left),t){var u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+u.top}else e||(l=a-o.top);return{left:n.left-s,top:n.top-l}}},{key:"makeClone",value:function(t){if(-1===e.CLONE_TYPES.indexOf(t))throw new Error('Clone type "'.concat(t,'" is not supported.'));var r=this.wot,n=r.wtTable,o=r.rootDocument,i=r.rootWindow,a=o.createElement("DIV"),s=o.createElement("TABLE"),l=n.wtRootElement.parentNode;a.className="ht_clone_".concat(t," handsontable"),a.style.position="absolute",a.style.top=0,a.style.left=0,a.style.overflow="visible",s.className=n.TABLE.className,a.appendChild(s),this.type=t,l.appendChild(a);var u=this.wot.getSetting("preventOverflow");return!0===u||"horizontal"===u&&this.type===e.CLONE_TOP||"vertical"===u&&this.type===e.CLONE_LEFT?this.mainTableScrollableElement=i:"hidden"===i.getComputedStyle(l).getPropertyValue("overflow")?this.mainTableScrollableElement=n.holder:this.mainTableScrollableElement=getScrollableElement(n.TABLE),new Walkontable({cloneSource:this.wot,cloneOverlay:this,table:s})}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t}},{key:"reset",value:function(){if(this.clone){var e=this.clone.wtTable.holder,t=this.clone.wtTable.hider;arrayEach([e.style,t.style,e.parentNode.style],(function(e){e.width="",e.height=""}))}}},{key:"destroy",value:function(){new EventManager(this.clone).destroy()}}]),e}();function _typeof$9(e){return(_typeof$9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$s(e,t,r){return t&&_defineProperties$s(e.prototype,t),r&&_defineProperties$s(e,r),e}var ColumnUtils=function(){function e(t){_classCallCheck$s(this,e),this.wot=t,this.headerWidths=new Map}return _createClass$s(e,[{key:"getWidth",value:function(e){var t=this.wot.wtSettings.settings.columnWidth;return"function"==typeof t?t=t(e):"object"===_typeof$9(t)&&(t=t[e]),t||this.wot.wtSettings.settings.defaultColumnWidth}},{key:"getStretchedColumnWidth",value:function(e){var t=this.getWidth(e),r=this.wot.wtViewport.columnsRenderCalculator,n=null!=t?t:this.wot.wtSettings.settings.defaultColumnWidth;if(r){var o=r.getStretchedColumnWidth(e,n);o&&(n=o)}return n}},{key:"getHeaderHeight",value:function(e){var t=this.wot.wtSettings.settings.defaultRowHeight,r=this.wot.wtViewport.oversizedColumnHeaders[e];return void 0!==r&&(t=t?Math.max(t,r):r),t}},{key:"getHeaderWidth",value:function(e){return this.headerWidths.get(this.wot.wtTable.columnFilter.sourceToRendered(e))}},{key:"calculateWidths",value:function(){var e=this.wot,t=e.wtTable,r=e.wtViewport,n=e.cloneSource,o=n?n.wtTable.holder:t.holder,i=o.offsetHeight<o.scrollHeight?getScrollbarWidth():0,a=e.getSetting("rowHeaderWidth");if(r.columnsRenderCalculator.refreshStretching(r.getViewportWidth()-i),null!=(a=e.getSetting("onModifyRowHeaderWidth",a)))for(var s=e.getSetting("rowHeaders").length,l=e.getSetting("defaultColumnWidth"),u=0;u<s;u++){var c=Array.isArray(a)?a[u]:a;c=null==c?l:c,this.headerWidths.set(u,c)}}}]),e}();function _classCallCheck$t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$t(e,t,r){return t&&_defineProperties$t(e.prototype,t),r&&_defineProperties$t(e,r),e}var RowUtils=function(){function e(t){_classCallCheck$t(this,e),this.wot=t}return _createClass$t(e,[{key:"getHeight",value:function(e){var t=this.wot.wtSettings.settings.rowHeight(e),r=this.wot.wtViewport.oversizedRows[e];return void 0!==r&&(t=void 0===t?r:Math.max(t,r)),t}}]),e}();function _toConsumableArray$2(e){return _arrayWithoutHoles$2(e)||_iterableToArray$2(e)||_unsupportedIterableToArray$2(e)||_nonIterableSpread$2()}function _nonIterableSpread$2(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray$2(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$2(e){if(Array.isArray(e))return _arrayLikeToArray$2(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray$2(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$2(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$2(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$2(e,t):void 0}}function _arrayLikeToArray$2(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck$u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$u(e,t,r){return t&&_defineProperties$u(e.prototype,t),r&&_defineProperties$u(e,r),e}var Table=function(){function e(t,r){var n=this;_classCallCheck$u(this,e),this.isMaster=!t.cloneOverlay,this.wot=t,this.instance=this.wot,this.TABLE=r,this.TBODY=null,this.THEAD=null,this.COLGROUP=null,this.tableOffset=0,this.holderOffset=0,this.hasTableHeight=!0,this.hasTableWidth=!0,this.isTableVisible=!1,removeTextNodes(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var o=this.wot.wtSettings.settings.rowHeaderWidth;this.wot.wtSettings.settings.rowHeaderWidth=function(){return n._modifyRowHeaderWidth(o)},this.rowUtils=new RowUtils(this.wot),this.columnUtils=new ColumnUtils(this.wot),this.tableRenderer=new Renderer({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wot.wtSettings.settings.cellRenderer})}return _createClass$u(e,[{key:"is",value:function(e){return Overlay.isOverlayTypeOf(this.wot.cloneOverlay,e)}},{key:"fixTableDomTree",value:function(){var e=this.wot.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.wot.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length&&this.THEAD.appendChild(e.createElement("TR"))}},{key:"createSpreader",value:function(e){var t,r=e.parentNode;return r&&r.nodeType===Node.ELEMENT_NODE&&hasClass(r,"wtHolder")||((t=this.wot.rootDocument.createElement("div")).className="wtSpreader",r&&r.insertBefore(t,e),t.appendChild(e)),t.style.position="relative",t}},{key:"createHider",value:function(e){var t,r=e.parentNode;return r&&r.nodeType===Node.ELEMENT_NODE&&hasClass(r,"wtHolder")||((t=this.wot.rootDocument.createElement("div")).className="wtHider",r&&r.insertBefore(t,e),t.appendChild(e)),t}},{key:"createHolder",value:function(e){var t,r=e.parentNode;return r&&r.nodeType===Node.ELEMENT_NODE&&hasClass(r,"wtHolder")||((t=this.wot.rootDocument.createElement("div")).style.position="relative",t.className="wtHolder",r&&r.insertBefore(t,e),this.isMaster&&(t.parentNode.className+="ht_master handsontable"),t.appendChild(e)),t}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wot,r=t.wtOverlays,n=t.wtViewport,o=t.getSetting("totalRows"),i=t.getSetting("totalColumns"),a=t.getSetting("rowHeaders"),s=a.length,l=t.getSetting("columnHeaders"),u=l.length,c=!1,f=e;if(this.isMaster&&(this.holderOffset=offset(this.holder),f=n.createRenderCalculators(f),s&&!t.getSetting("fixedColumnsLeft"))){var h=r.leftOverlay.getScrollPosition(),d=this.correctHeaderWidth;this.correctHeaderWidth=h>0,d!==this.correctHeaderWidth&&(f=!1)}if(this.isMaster&&(c=r.prepareOverlays()),f)this.isMaster&&n.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=offset(this.TABLE):this.tableOffset=this.wot.cloneSource.wtTable.tableOffset;var p=o>0?this.getFirstRenderedRow():0,y=i>0?this.getFirstRenderedColumn():0;this.rowFilter=new RowFilter(p,o,u),this.columnFilter=new ColumnFilter(y,i,s);var g,m=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var v={};this.wot.getSetting("beforeDraw",!0,v),m=!0!==v.skipRender}if(m)if(this.tableRenderer.setHeaderContentRenderers(a,l),(this.is(Overlay.CLONE_BOTTOM)||this.is(Overlay.CLONE_BOTTOM_LEFT_CORNER))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(g=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Overlay.CLONE_BOTTOM))&&this.markOversizedRows(),this.isMaster){this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays.refresh(!1),this.wot.wtOverlays.applyToDOM();var _=outerWidth(this.hider),b=outerWidth(this.TABLE);0!==_&&b!==_&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),g!==this.wot.wtViewport.getWorkspaceWidth()&&(this.wot.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wot.getSetting("onDraw",!0)}else this.is(Overlay.CLONE_BOTTOM)&&this.wot.cloneSource.wtOverlays.adjustElementsSize()}if(this.isMaster){var C=r.topOverlay.resetFixedPosition();r.bottomOverlay.clone&&(C=r.bottomOverlay.resetFixedPosition()||C),C=r.leftOverlay.resetFixedPosition()||C,r.topLeftCornerOverlay&&r.topLeftCornerOverlay.resetFixedPosition(),r.bottomLeftCornerOverlay&&r.bottomLeftCornerOverlay.clone&&r.bottomLeftCornerOverlay.resetFixedPosition(),C&&(r.refreshAll(),r.adjustElementsSize())}return this.refreshSelections(f),c&&r.syncScrollWithMaster(),t.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(e){for(var t,r,n,o=this.wot.wtTable.columnFilter.renderedToSource(e),i=this.wot.getSetting("columnHeaders").length,a=this.wot.wtSettings.settings.defaultRowHeight,s=this.wot.getSetting("columnHeaderHeight")||[];i;)i-=1,t=this.wot.wtTable.getColumnHeaderHeight(i),(r=this.wot.wtTable.getColumnHeader(o,i))&&(n=innerHeight(r),(!t&&a<n||t<n)&&(this.wot.wtViewport.oversizedColumnHeaders[i]=n),Array.isArray(s)?null!==s[i]&&void 0!==s[i]&&(this.wot.wtViewport.oversizedColumnHeaders[i]=s[i]):isNaN(s)||(this.wot.wtViewport.oversizedColumnHeaders[i]=s),this.wot.wtViewport.oversizedColumnHeaders[i]<(s[i]||s)&&(this.wot.wtViewport.oversizedColumnHeaders[i]=s[i]||s))}},{key:"adjustColumnHeaderHeights",value:function(){for(var e=this.wot,t=e.wtTable.THEAD.childNodes,r=e.wtViewport.oversizedColumnHeaders,n=0,o=e.getSetting("columnHeaders").length;n<o;n++)if(r[n]){if(!t[n]||0===t[n].childNodes.length)return;t[n].childNodes[0].style.height="".concat(r[n],"px")}}},{key:"resetOversizedRows",value:function(){var e=this.wot;if((this.isMaster||this.is(Overlay.CLONE_BOTTOM))&&!e.getSetting("externalRowCalculator"))for(var t=this.getRenderedRowsCount(),r=0;r<t;r++){var n=this.rowFilter.renderedToSource(r);e.wtViewport.oversizedRows&&e.wtViewport.oversizedRows[n]&&(e.wtViewport.oversizedRows[n]=void 0)}}},{key:"removeClassFromCells",value:function(e){for(var t=this.TABLE.querySelectorAll(".".concat(e)),r=0,n=t.length;r<n;r++)removeClass(t[r],e)}},{key:"refreshSelections",value:function(e){var t=this.wot;if(t.selections){var r=Array.from(t.selections),n=r.length;if(e){for(var o=[],i=0;i<n;i++){for(var a=r[i].settings,s=a.highlightHeaderClassName,l=a.highlightRowClassName,u=a.highlightColumnClassName,c=r[i].classNames,f=c.length,h=0;h<f;h++)o.includes(c[h])||o.push(c[h]);s&&!o.includes(s)&&o.push(s),l&&!o.includes(l)&&o.push(l),u&&!o.includes(u)&&o.push(u)}var d=t.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(d))for(var p=0;p<d.length;p++)o.push(d[p]);for(var y=o.length,g=0;g<y;g++)this.removeClassFromCells(o[g])}for(var m=0;m<n;m++)r[m].draw(t,e)}}},{key:"getCell",value:function(e){var t,r=e.row,n=e.col,o=this.wot.getSetting("onModifyGetCellCoords",r,n);if(o&&Array.isArray(o)){var i=_slicedToArray(o,2);r=i[0],n=i[1]}if(this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;if(!(t=r<0?this.THEAD.childNodes[this.rowFilter.sourceRowToVisibleColHeadedRow(r)]:this.TBODY.childNodes[this.rowFilter.sourceToRendered(r)])&&r>=0)throw new Error("TR was expected to be rendered but is not");var a=t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!a&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return a}},{key:"getColumnHeader",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.THEAD.childNodes[t];if(r)return r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}},{key:"getRowHeader",value:function(e){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return null;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return t?t.childNodes[0]:void 0}},{key:"getCoords",value:function(e){var t=e;if("TD"!==t.nodeName&&"TH"!==t.nodeName&&(t=closest(t,["TD","TH"])),null===t)return null;var r=t.parentNode,n=r.parentNode,o=index$1(r),i=t.cellIndex;if(overlayContainsElement(Overlay.CLONE_TOP_LEFT_CORNER,t,this.wtRootElement)||overlayContainsElement(Overlay.CLONE_TOP,t,this.wtRootElement))"THEAD"===n.nodeName&&(o-=n.childNodes.length);else if(overlayContainsElement(Overlay.CLONE_BOTTOM_LEFT_CORNER,t,this.wtRootElement)||overlayContainsElement(Overlay.CLONE_BOTTOM,t,this.wtRootElement)){o=this.wot.getSetting("totalRows")-n.childNodes.length+o}else o=n===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter.renderedToSource(o);return i=overlayContainsElement(Overlay.CLONE_TOP_LEFT_CORNER,t,this.wtRootElement)||overlayContainsElement(Overlay.CLONE_LEFT,t,this.wtRootElement)||overlayContainsElement(Overlay.CLONE_BOTTOM_LEFT_CORNER,t,this.wtRootElement)?this.columnFilter.offsettedTH(i):this.columnFilter.visibleRowHeadedColumnToSourceColumn(i),new CellCoords(o,i)}},{key:"markOversizedRows",value:function(){if(!this.wot.getSetting("externalRowCalculator")){var e,t,r,n,o,i=this.TBODY.childNodes.length;if(i*this.wot.wtSettings.settings.defaultRowHeight!==innerHeight(this.TBODY)-1||this.wot.getSetting("fixedRowsBottom"))for(;i;)i-=1,r=this.rowFilter.renderedToSource(i),e=this.getRowHeight(r),t=(o=(n=this.getTrForRow(r)).querySelector("th"))?innerHeight(o):innerHeight(n)-1,(!e&&this.wot.wtSettings.settings.defaultRowHeight<t||e<t)&&(t+=1,this.wot.wtViewport.oversizedRows[r]=t)}}},{key:"getTrForRow",value:function(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}},{key:"isColumnHeaderRendered",value:function(e){if(e>=0)return!1;var t=this.wot.getSetting("rowHeaders").length;return Math.abs(e)<=t}},{key:"isRowHeaderRendered",value:function(e){if(e>=0)return!1;var t=this.wot.getSetting("columnHeaders").length;return Math.abs(e)<=t}},{key:"isRowBeforeRenderedRows",value:function(e){var t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}},{key:"isRowAfterRenderedRows",value:function(e){return e>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(e){var t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}},{key:"isColumnAfterRenderedColumns",value:function(e){return this.columnFilter&&e>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(e){return this.columnFilter&&e>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(e){return this.rowFilter&&e>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wot.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wot.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(e){return this.rowUtils.getHeight(e)}},{key:"getColumnHeaderHeight",value:function(e){return this.columnUtils.getHeaderHeight(e)}},{key:"getColumnWidth",value:function(e){return this.columnUtils.getWidth(e)}},{key:"getStretchedColumnWidth",value:function(e){return this.columnUtils.getStretchedColumnWidth(e)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"isVisible",value:function(){return isVisible(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(e){var t=isFunction(e)?e():null;return Array.isArray(t)?(t=_toConsumableArray$2(t))[t.length-1]=this._correctRowHeaderWidth(t[t.length-1]):t=this._correctRowHeaderWidth(t),t}},{key:"_correctRowHeaderWidth",value:function(e){var t=e;return"number"!=typeof e&&(t=this.wot.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}]),e}(),MIXIN_NAME="calculatedRows",calculatedRows={getFirstRenderedRow:function(){var e=this.wot.wtViewport.rowsRenderCalculator.startRow;return null===e?-1:e},getFirstVisibleRow:function(){var e=this.wot.wtViewport.rowsVisibleCalculator.startRow;return null===e?-1:e},getLastRenderedRow:function(){var e=this.wot.wtViewport.rowsRenderCalculator.endRow;return null===e?-1:e},getLastVisibleRow:function(){var e=this.wot.wtViewport.rowsVisibleCalculator.endRow;return null===e?-1:e},getRenderedRowsCount:function(){return this.wot.wtViewport.rowsRenderCalculator.count},getVisibleRowsCount:function(){return this.wot.wtViewport.rowsVisibleCalculator.count}};defineGetter(calculatedRows,"MIXIN_NAME",MIXIN_NAME,{writable:!1,enumerable:!1});var MIXIN_NAME$1="calculatedColumns",calculatedColumns={getFirstRenderedColumn:function(){var e=this.wot.wtViewport.columnsRenderCalculator.startColumn;return null===e?-1:e},getFirstVisibleColumn:function(){var e=this.wot.wtViewport.columnsVisibleCalculator.startColumn;return null===e?-1:e},getLastRenderedColumn:function(){var e=this.wot.wtViewport.columnsRenderCalculator.endColumn;return null===e?-1:e},getLastVisibleColumn:function(){var e=this.wot.wtViewport.columnsVisibleCalculator.endColumn;return null===e?-1:e},getRenderedColumnsCount:function(){return this.wot.wtViewport.columnsRenderCalculator.count},getVisibleColumnsCount:function(){return this.wot.wtViewport.columnsVisibleCalculator.count}};function _typeof$a(e){return(_typeof$a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$v(e,t,r){return t&&_defineProperties$v(e.prototype,t),r&&_defineProperties$v(e,r),e}function _inherits$6(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$6(e,t)}function _setPrototypeOf$6(e,t){return(_setPrototypeOf$6=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$6(e){var t=_isNativeReflectConstruct$6();return function(){var r,n=_getPrototypeOf$6(e);if(t){var o=_getPrototypeOf$6(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$6(this,r)}}function _possibleConstructorReturn$6(e,t){return!t||"object"!==_typeof$a(t)&&"function"!=typeof t?_assertThisInitialized$6(e):t}function _assertThisInitialized$6(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$6(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$6(e){return(_getPrototypeOf$6=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}defineGetter(calculatedColumns,"MIXIN_NAME",MIXIN_NAME$1,{writable:!1,enumerable:!1});var MasterTable=function(e){_inherits$6(r,e);var t=_createSuper$6(r);function r(){return _classCallCheck$v(this,r),t.apply(this,arguments)}return _createClass$v(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var e=getTrimmingContainer(this.wtRootElement),t=this.wot.rootWindow;if(e===t){this.wot.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var r=e.parentElement,n=getStyle(e,"height",t),o=getStyle(e,"overflow",t),i=this.holder.style,a=e.scrollWidth,s=e.scrollHeight,l=e.getBoundingClientRect(),u=l.width,c=l.height;if(r&&["auto","hidden","scroll"].includes(o)){var f=e.cloneNode(!1);f.style.overflow="auto",e.nextElementSibling?r.insertBefore(f,e.nextElementSibling):r.appendChild(f);var h=parseInt(getComputedStyle(f,t).height,10);r.removeChild(f),0===h&&(c=0)}c=Math.min(c,s),i.height="auto"===n?"auto":"".concat(c,"px"),u=Math.min(u,a),i.width="".concat(u,"px"),i.overflow="",this.hasTableHeight="auto"===i.height||c>0,this.hasTableWidth=u>0}this.isTableVisible=isVisible(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var e=this.wot,t=e.getOverlayName(),r=e.getSetting("columnHeaders").length;if(r&&!e.wtViewport.hasOversizedColumnHeadersMarked[t]){for(var n=e.getSetting("rowHeaders").length,o=this.getRenderedColumnsCount(),i=0;i<r;i++)for(var a=-1*n;a<o;a++)this.markIfOversizedColumnHeader(a);e.wtViewport.hasOversizedColumnHeadersMarked[t]=!0}}}]),r}(Table);mixin(MasterTable,calculatedRows),mixin(MasterTable,calculatedColumns);var MIXIN_NAME$2="stickyColumnsLeft",stickyColumnsLeft={getFirstRenderedColumn:function(){return 0===this.wot.getSetting("totalColumns")?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var e=this.wot.getSetting("totalColumns");return Math.min(this.wot.getSetting("fixedColumnsLeft"),e)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};function _typeof$b(e){return(_typeof$b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits$7(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$7(e,t)}function _setPrototypeOf$7(e,t){return(_setPrototypeOf$7=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$7(e){var t=_isNativeReflectConstruct$7();return function(){var r,n=_getPrototypeOf$7(e);if(t){var o=_getPrototypeOf$7(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$7(this,r)}}function _possibleConstructorReturn$7(e,t){return!t||"object"!==_typeof$b(t)&&"function"!=typeof t?_assertThisInitialized$7(e):t}function _assertThisInitialized$7(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$7(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$7(e){return(_getPrototypeOf$7=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}defineGetter(stickyColumnsLeft,"MIXIN_NAME",MIXIN_NAME$2,{writable:!1,enumerable:!1});var LeftOverlayTable=function(e){_inherits$7(r,e);var t=_createSuper$7(r);function r(){return _classCallCheck$w(this,r),t.apply(this,arguments)}return r}(Table);function _typeof$c(e){return(_typeof$c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _construct(e,t,r){return(_construct=_isNativeReflectConstruct$8()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&_setPrototypeOf$8(o,r.prototype),o}).apply(null,arguments)}function _classCallCheck$x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$w(e,t,r){return t&&_defineProperties$w(e.prototype,t),r&&_defineProperties$w(e,r),e}function _inherits$8(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$8(e,t)}function _setPrototypeOf$8(e,t){return(_setPrototypeOf$8=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$8(e){var t=_isNativeReflectConstruct$8();return function(){var r,n=_getPrototypeOf$8(e);if(t){var o=_getPrototypeOf$8(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$8(this,r)}}function _possibleConstructorReturn$8(e,t){return!t||"object"!==_typeof$c(t)&&"function"!=typeof t?_assertThisInitialized$8(e):t}function _assertThisInitialized$8(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$8(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$8(e){return(_getPrototypeOf$8=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}mixin(LeftOverlayTable,calculatedRows),mixin(LeftOverlayTable,stickyColumnsLeft);var LeftOverlay=function(e){_inherits$8(r,e);var t=_createSuper$8(r);function r(e){var n;return _classCallCheck$x(this,r),(n=t.call(this,e)).clone=n.makeClone(Overlay.CLONE_LEFT),n}return _createClass$w(r,[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return _construct(LeftOverlayTable,t)}},{key:"shouldBeRendered",value:function(){return this.wot.getSetting("shouldRenderLeftOverlay")}},{key:"resetFixedPosition",value:function(){var e=this.wot.wtTable;if(this.needFullRender&&e.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,r=0,n=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==this.wot.rootWindow||n&&"horizontal"===n)r=this.getScrollPosition(),resetCssTransform(t);else{var o,i,a=e.hider.getBoundingClientRect(),s=Math.ceil(a.left),l=Math.ceil(a.right);i=""===(i=e.hider.style.top)?0:i,r=o=s<0&&l-t.offsetWidth>0?-s:0,setOverlayPosition(t,o+="px",i)}var u=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),u}}},{key:"setScrollPosition",value:function(e){var t=this.wot.rootWindow,r=!1;return this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,getWindowScrollTop(t)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(e,t){for(var r=this.wot.wtSettings.defaultColumnWidth,n=e,o=0;n<t;)o+=this.wot.wtTable.getStretchedColumnWidth(n)||r,n+=1;return o}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),e||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var e=this.wot,t=e.wtTable,r=e.rootDocument,n=e.rootWindow,o=getScrollbarWidth(r),i=this.clone.wtTable.holder.parentNode.style,a=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==n||"vertical"===a){var s=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(s-=o),s=Math.min(s,t.wtRootElement.scrollHeight),i.height="".concat(s,"px")}else i.height="";this.clone.wtTable.holder.style.height=i.height;var l=outerWidth(this.clone.wtTable.TABLE);i.width="".concat(l,"px")}},{key:"adjustRootChildrenSize",value:function(){var e,t=this.clone.wtTable.holder,r=this.wot.selections,n=Math.abs(null!==(e=null==r?void 0:r.getCell().getBorder(this.wot).cornerCenterPointOffset)&&void 0!==e?e:0);this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width="".concat(parseInt(t.parentNode.style.width,10)+n,"px")}},{key:"applyToDOM",value:function(){var e=this.wot.getSetting("totalColumns");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style.left="0"}this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(e,t){var r=this.getTableParentOffset(),n=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,o=0;return t&&n.offsetWidth!==n.clientWidth&&(o=getScrollbarWidth(this.wot.rootDocument)),t?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportWidth()):r+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),e),r+=o,this.setScrollPosition(r)}},{key:"getTableParentOffset",value:function(){var e=0;return this.wot.getSetting("preventOverflow")||this.trimmingContainer!==this.wot.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}},{key:"getScrollPosition",value:function(){return getScrollLeft(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"adjustHeaderBordersPosition",value:function(e){var t=this.wot.wtTable.holder.parentNode,r=this.wot.getSetting("rowHeaders"),n=this.wot.getSetting("fixedColumnsLeft");this.wot.getSetting("totalRows")?removeClass(t,"emptyRows"):addClass(t,"emptyRows");var o=!1;if(n&&!r.length)addClass(t,"innerBorderLeft");else if(!n&&r.length){var i=hasClass(t,"innerBorderLeft");e?(addClass(t,"innerBorderLeft"),o=!i):(removeClass(t,"innerBorderLeft"),o=i)}return o}}]),r}(Overlay);Overlay.registerOverlay(Overlay.CLONE_LEFT,LeftOverlay);var MIXIN_NAME$3="stickyRowsTop",stickyRowsTop={getFirstRenderedRow:function(){return 0===this.wot.getSetting("totalRows")?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wot.getSetting("totalRows");return Math.min(this.wot.getSetting("fixedRowsTop"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};function _typeof$d(e){return(_typeof$d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits$9(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$9(e,t)}function _setPrototypeOf$9(e,t){return(_setPrototypeOf$9=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$9(e){var t=_isNativeReflectConstruct$9();return function(){var r,n=_getPrototypeOf$9(e);if(t){var o=_getPrototypeOf$9(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$9(this,r)}}function _possibleConstructorReturn$9(e,t){return!t||"object"!==_typeof$d(t)&&"function"!=typeof t?_assertThisInitialized$9(e):t}function _assertThisInitialized$9(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$9(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$9(e){return(_getPrototypeOf$9=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}defineGetter(stickyRowsTop,"MIXIN_NAME",MIXIN_NAME$3,{writable:!1,enumerable:!1});var TopOverlayTable=function(e){_inherits$9(r,e);var t=_createSuper$9(r);function r(){return _classCallCheck$y(this,r),t.apply(this,arguments)}return r}(Table);function _typeof$e(e){return(_typeof$e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _construct$1(e,t,r){return(_construct$1=_isNativeReflectConstruct$a()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&_setPrototypeOf$a(o,r.prototype),o}).apply(null,arguments)}function _classCallCheck$z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$x(e,t,r){return t&&_defineProperties$x(e.prototype,t),r&&_defineProperties$x(e,r),e}function _inherits$a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$a(e,t)}function _setPrototypeOf$a(e,t){return(_setPrototypeOf$a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$a(e){var t=_isNativeReflectConstruct$a();return function(){var r,n=_getPrototypeOf$a(e);if(t){var o=_getPrototypeOf$a(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$a(this,r)}}function _possibleConstructorReturn$a(e,t){return!t||"object"!==_typeof$e(t)&&"function"!=typeof t?_assertThisInitialized$a(e):t}function _assertThisInitialized$a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$a(e){return(_getPrototypeOf$a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _defineProperty$1(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}mixin(TopOverlayTable,stickyRowsTop),mixin(TopOverlayTable,calculatedColumns);var TopOverlay=function(e){_inherits$a(r,e);var t=_createSuper$a(r);function r(e){var n;return _classCallCheck$z(this,r),_defineProperty$1(_assertThisInitialized$a(n=t.call(this,e)),"cachedFixedRowsTop",-1),n.clone=n.makeClone(Overlay.CLONE_TOP),n}return _createClass$x(r,[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return _construct$1(TopOverlayTable,t)}},{key:"shouldBeRendered",value:function(){return this.wot.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=this.wot.getSetting("preventOverflow"),r=0,n=!1;if(this.trimmingContainer!==this.wot.rootWindow||t&&"vertical"===t)r=this.getScrollPosition(),resetCssTransform(e);else{var o,i,a=this.wot.wtTable,s=a.hider.getBoundingClientRect(),l=Math.ceil(s.top),u=Math.ceil(s.bottom),c=e.offsetHeight;n=u===c,r=i=l<0&&u-c>0?-l:0,setOverlayPosition(e,o=""===(o=a.hider.style.left)?0:o,i+="px")}var f=this.adjustHeaderBordersPosition(r,n);return this.adjustElementsSize(),f}}},{key:"setScrollPosition",value:function(e){var t=this.wot.rootWindow,r=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(getWindowScrollLeft(t),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(e,t){for(var r=this.wot.wtSettings.settings.defaultRowHeight,n=e,o=0;n<t;){var i=this.wot.wtTable.getRowHeight(n);o+=void 0===i?r:i,n+=1}return o}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),e||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var e=this.wot,t=e.wtTable,r=e.rootDocument,n=e.rootWindow,o=getScrollbarWidth(r),i=this.clone.wtTable.holder.parentNode.style,a=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==n||"horizontal"===a){var s=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(s-=o),s=Math.min(s,t.wtRootElement.scrollWidth),i.width="".concat(s,"px")}else i.width="";this.clone.wtTable.holder.style.width=i.width;var l=outerHeight(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),i.height="".concat(l,"px")}},{key:"adjustRootChildrenSize",value:function(){var e,t=this.clone.wtTable.holder,r=this.wot.selections,n=Math.abs(null!==(e=null==r?void 0:r.getCell().getBorder(this.wot).cornerCenterPointOffset)&&void 0!==e?e:0);this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height="".concat(parseInt(t.parentNode.style.height,10)+n,"px")}},{key:"applyToDOM",value:function(){var e=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.left=""}},{key:"scrollTo",value:function(e,t){var r=this.wot,n=(r.cloneSource?r.cloneSource:r).wtTable.holder,o=this.getTableParentOffset(),i=0;if(t&&n.offsetHeight!==n.clientHeight&&(i=getScrollbarWidth(r.rootDocument)),t){var a=r.getSetting("fixedRowsBottom"),s=r.getSetting("totalRows");o+=this.sumCellSizes(0,e+1),o-=r.wtViewport.getViewportHeight()-this.sumCellSizes(s-a,s),o+=1}else o+=this.sumCellSizes(r.getSetting("fixedRowsTop"),e);return o+=i,this.setScrollPosition(o)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.wot.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return getScrollTop(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"adjustHeaderBordersPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.wot.wtTable.holder.parentNode,n=this.wot.getSetting("totalColumns");n?removeClass(r,"emptyColumns"):addClass(r,"emptyColumns");var o=!1;if(!t){var i=this.wot.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==i,s=this.wot.getSetting("columnHeaders");if((a||0===i)&&s.length>0){var l=hasClass(r,"innerBorderTop");this.cachedFixedRowsTop=this.wot.getSetting("fixedRowsTop"),e||0===this.wot.getSetting("totalRows")?(addClass(r,"innerBorderTop"),o=!l):(removeClass(r,"innerBorderTop"),o=l)}}if(0===this.wot.getSetting("rowHeaders").length){var u=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)");if(u)for(var c=0;c<u.length;c++)u[c].style["border-left-width"]=0}return o}}]),r}(Overlay);function _typeof$f(e){return(_typeof$f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits$b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$b(e,t)}function _setPrototypeOf$b(e,t){return(_setPrototypeOf$b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$b(e){var t=_isNativeReflectConstruct$b();return function(){var r,n=_getPrototypeOf$b(e);if(t){var o=_getPrototypeOf$b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$b(this,r)}}function _possibleConstructorReturn$b(e,t){return!t||"object"!==_typeof$f(t)&&"function"!=typeof t?_assertThisInitialized$b(e):t}function _assertThisInitialized$b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$b(e){return(_getPrototypeOf$b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Overlay.registerOverlay(Overlay.CLONE_TOP,TopOverlay);var TopLeftCornerOverlayTable=function(e){_inherits$b(r,e);var t=_createSuper$b(r);function r(){return _classCallCheck$A(this,r),t.apply(this,arguments)}return r}(Table);function _typeof$g(e){return(_typeof$g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _construct$2(e,t,r){return(_construct$2=_isNativeReflectConstruct$c()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&_setPrototypeOf$c(o,r.prototype),o}).apply(null,arguments)}function _classCallCheck$B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$y(e,t,r){return t&&_defineProperties$y(e.prototype,t),r&&_defineProperties$y(e,r),e}function _inherits$c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$c(e,t)}function _setPrototypeOf$c(e,t){return(_setPrototypeOf$c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$c(e){var t=_isNativeReflectConstruct$c();return function(){var r,n=_getPrototypeOf$c(e);if(t){var o=_getPrototypeOf$c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$c(this,r)}}function _possibleConstructorReturn$c(e,t){return!t||"object"!==_typeof$g(t)&&"function"!=typeof t?_assertThisInitialized$c(e):t}function _assertThisInitialized$c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$c(e){return(_getPrototypeOf$c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}mixin(TopLeftCornerOverlayTable,stickyRowsTop),mixin(TopLeftCornerOverlayTable,stickyColumnsLeft);var TopLeftCornerOverlay=function(e){_inherits$c(r,e);var t=_createSuper$c(r);function r(e){var n;return _classCallCheck$B(this,r),(n=t.call(this,e)).clone=n.makeClone(Overlay.CLONE_TOP_LEFT_CORNER),n}return _createClass$y(r,[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return _construct$2(TopLeftCornerOverlayTable,t)}},{key:"shouldBeRendered",value:function(){var e=this.wot;return e.getSetting("shouldRenderTopOverlay")&&e.getSetting("shouldRenderLeftOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===this.wot.rootWindow){var r=this.wot.wtTable.hider.getBoundingClientRect(),n=Math.ceil(r.top),o=Math.ceil(r.left),i=Math.ceil(r.bottom),a=Math.ceil(r.right),s="0",l="0";t&&"vertical"!==t||o<0&&a-e.offsetWidth>0&&(s="".concat(-o,"px")),t&&"horizontal"!==t||n<0&&i-e.offsetHeight>0&&(l="".concat(-n,"px")),setOverlayPosition(e,s,l)}else resetCssTransform(e);var u=outerHeight(this.clone.wtTable.TABLE),c=outerWidth(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(u=0),e.style.height="".concat(u,"px"),e.style.width="".concat(c,"px"),!1}}}]),r}(Overlay);Overlay.registerOverlay(Overlay.CLONE_TOP_LEFT_CORNER,TopLeftCornerOverlay);var MIXIN_NAME$4="stickyRowsBottom",stickyRowsBottom={getFirstRenderedRow:function(){var e=this.wot.getSetting("totalRows"),t=this.wot.getSetting("fixedRowsBottom"),r=e-t;return 0===e||0===t?-1:r<0?0:r},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wot.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wot.getSetting("totalRows");return Math.min(this.wot.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};function _typeof$h(e){return(_typeof$h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits$d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$d(e,t)}function _setPrototypeOf$d(e,t){return(_setPrototypeOf$d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$d(e){var t=_isNativeReflectConstruct$d();return function(){var r,n=_getPrototypeOf$d(e);if(t){var o=_getPrototypeOf$d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$d(this,r)}}function _possibleConstructorReturn$d(e,t){return!t||"object"!==_typeof$h(t)&&"function"!=typeof t?_assertThisInitialized$d(e):t}function _assertThisInitialized$d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$d(e){return(_getPrototypeOf$d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}defineGetter(stickyRowsBottom,"MIXIN_NAME",MIXIN_NAME$4,{writable:!1,enumerable:!1});var BottomOverlayTable=function(e){_inherits$d(r,e);var t=_createSuper$d(r);function r(){return _classCallCheck$C(this,r),t.apply(this,arguments)}return r}(Table);function _typeof$i(e){return(_typeof$i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _construct$3(e,t,r){return(_construct$3=_isNativeReflectConstruct$e()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&_setPrototypeOf$e(o,r.prototype),o}).apply(null,arguments)}function _classCallCheck$D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$z(e,t,r){return t&&_defineProperties$z(e.prototype,t),r&&_defineProperties$z(e,r),e}function _inherits$e(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$e(e,t)}function _setPrototypeOf$e(e,t){return(_setPrototypeOf$e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$e(e){var t=_isNativeReflectConstruct$e();return function(){var r,n=_getPrototypeOf$e(e);if(t){var o=_getPrototypeOf$e(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$e(this,r)}}function _possibleConstructorReturn$e(e,t){return!t||"object"!==_typeof$i(t)&&"function"!=typeof t?_assertThisInitialized$e(e):t}function _assertThisInitialized$e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$e(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$e(e){return(_getPrototypeOf$e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _defineProperty$2(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}mixin(BottomOverlayTable,stickyRowsBottom),mixin(BottomOverlayTable,calculatedColumns);var BottomOverlay=function(e){_inherits$e(r,e);var t=_createSuper$e(r);function r(e){var n;return _classCallCheck$D(this,r),_defineProperty$2(_assertThisInitialized$e(n=t.call(this,e)),"cachedFixedRowsBottom",-1),n.clone=n.makeClone(Overlay.CLONE_BOTTOM),n}return _createClass$z(r,[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return _construct$3(BottomOverlayTable,t)}},{key:"shouldBeRendered",value:function(){return this.wot.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode;e.style.top="";var t=0,r=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==this.wot.rootWindow||r&&"vertical"===r)t=this.getScrollPosition(),this.repositionOverlay();else{var n,o,i=this.wot,a=i.rootDocument,s=i.wtTable,l=s.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=a.documentElement.clientHeight;n=""===(n=s.hider.style.left)?0:n,t=o=u>c?u-c:0,o+="px",e.style.left=n,e.style.bottom=o}var f=this.adjustHeaderBordersPosition(t);return this.adjustElementsSize(),f}}},{key:"repositionOverlay",value:function(){var e=this.wot,t=e.wtTable,r=e.rootDocument,n=this.clone.wtTable.holder.parentNode,o=getScrollbarWidth(r);t.holder.clientHeight===t.holder.offsetHeight&&(o=0),n.style.bottom="".concat(o,"px")}},{key:"setScrollPosition",value:function(e){var t=this.wot.rootWindow,r=!1;return this.mainTableScrollableElement===t?(t.scrollTo(getWindowScrollLeft(t),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(e,t){for(var r=this.wot,n=r.wtTable,o=r.wtSettings.settings.defaultRowHeight,i=e,a=0;i<t;){var s=n.getRowHeight(i);a+=void 0===s?o:s,i+=1}return a}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),e||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var e=this.wot,t=e.wtTable,r=e.wtViewport,n=e.rootWindow,o=getScrollbarWidth(this.wot.rootDocument),i=this.clone.wtTable.holder.parentNode.style,a=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==n||"horizontal"===a){var s=r.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(s-=o),s=Math.min(s,t.wtRootElement.scrollWidth),i.width="".concat(s,"px")}else i.width="";this.clone.wtTable.holder.style.width=i.width;var l=outerHeight(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),i.height="".concat(l,"px")}},{key:"adjustRootChildrenSize",value:function(){var e=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}},{key:"applyToDOM",value:function(){var e=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.left=""}},{key:"scrollTo",value:function(e,t){var r=this.getTableParentOffset(),n=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,o=0;t&&n.offsetHeight!==n.clientHeight&&(o=getScrollbarWidth(this.wot.rootDocument)),t?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wot.getSetting("fixedRowsBottom"),e),r+=o,this.setScrollPosition(r)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.wot.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return getScrollTop(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"adjustHeaderBordersPosition",value:function(e){var t=this.wot.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==t,n=this.wot.getSetting("columnHeaders"),o=!1;if((r||0===t)&&n.length>0){var i=this.wot.wtTable.holder.parentNode,a=hasClass(i,"innerBorderBottom");this.cachedFixedRowsBottom=this.wot.getSetting("fixedRowsBottom"),e||0===this.wot.getSetting("totalRows")?(addClass(i,"innerBorderBottom"),o=!a):(removeClass(i,"innerBorderBottom"),o=a)}return o}}]),r}(Overlay);function _typeof$j(e){return(_typeof$j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits$f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$f(e,t)}function _setPrototypeOf$f(e,t){return(_setPrototypeOf$f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$f(e){var t=_isNativeReflectConstruct$f();return function(){var r,n=_getPrototypeOf$f(e);if(t){var o=_getPrototypeOf$f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$f(this,r)}}function _possibleConstructorReturn$f(e,t){return!t||"object"!==_typeof$j(t)&&"function"!=typeof t?_assertThisInitialized$f(e):t}function _assertThisInitialized$f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$f(e){return(_getPrototypeOf$f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Overlay.registerOverlay(Overlay.CLONE_BOTTOM,BottomOverlay);var BottomLeftCornerOverlayTable=function(e){_inherits$f(r,e);var t=_createSuper$f(r);function r(){return _classCallCheck$E(this,r),t.apply(this,arguments)}return r}(Table);function _typeof$k(e){return(_typeof$k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _construct$4(e,t,r){return(_construct$4=_isNativeReflectConstruct$g()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&_setPrototypeOf$g(o,r.prototype),o}).apply(null,arguments)}function _classCallCheck$F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$A(e,t,r){return t&&_defineProperties$A(e.prototype,t),r&&_defineProperties$A(e,r),e}function _inherits$g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$g(e,t)}function _setPrototypeOf$g(e,t){return(_setPrototypeOf$g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$g(e){var t=_isNativeReflectConstruct$g();return function(){var r,n=_getPrototypeOf$g(e);if(t){var o=_getPrototypeOf$g(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$g(this,r)}}function _possibleConstructorReturn$g(e,t){return!t||"object"!==_typeof$k(t)&&"function"!=typeof t?_assertThisInitialized$g(e):t}function _assertThisInitialized$g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$g(e){return(_getPrototypeOf$g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}mixin(BottomLeftCornerOverlayTable,stickyRowsBottom),mixin(BottomLeftCornerOverlayTable,stickyColumnsLeft);var BottomLeftCornerOverlay=function(e){_inherits$g(r,e);var t=_createSuper$g(r);function r(e){var n;return _classCallCheck$F(this,r),(n=t.call(this,e)).clone=n.makeClone(Overlay.CLONE_BOTTOM_LEFT_CORNER),n}return _createClass$A(r,[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return _construct$4(BottomLeftCornerOverlayTable,t)}},{key:"shouldBeRendered",value:function(){var e=this.wot;return e.getSetting("shouldRenderBottomOverlay")&&e.getSetting("shouldRenderLeftOverlay")}},{key:"resetFixedPosition",value:function(){var e=this.wot;if(this.updateTrimmingContainer(),e.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===e.rootWindow){var r,n,o=this.wot,i=o.rootDocument,a=o.wtTable.hider.getBoundingClientRect(),s=Math.ceil(a.bottom),l=Math.ceil(a.left),u=i.documentElement.clientHeight;r=l<0?-l:0,n=s>u?s-u:0,n+="px",r+="px",t.style.left=r,t.style.bottom=n}else resetCssTransform(t),this.repositionOverlay();var c=outerHeight(this.clone.wtTable.TABLE),f=outerWidth(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(c=0),t.style.height="".concat(c,"px"),t.style.width="".concat(f,"px"),!1}}},{key:"repositionOverlay",value:function(){var e=this.wot,t=e.wtTable,r=e.rootDocument,n=this.clone.wtTable.holder.parentNode,o=getScrollbarWidth(r);t.holder.clientHeight===t.holder.offsetHeight&&(o=0),n.style.bottom="".concat(o,"px")}}]),r}(Overlay);function _slicedToArray$1(e,t){return _arrayWithHoles$1(e)||_iterableToArrayLimit$1(e,t)||_unsupportedIterableToArray$3(e,t)||_nonIterableRest$1()}function _nonIterableRest$1(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$3(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$3(e,t):void 0}}function _arrayLikeToArray$3(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$1(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$1(e){if(Array.isArray(e))return e}function _classCallCheck$G(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$B(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$B(e,t,r){return t&&_defineProperties$B(e.prototype,t),r&&_defineProperties$B(e,r),e}Overlay.registerOverlay(Overlay.CLONE_BOTTOM_LEFT_CORNER,BottomLeftCornerOverlay);var Border=function(){function e(t,r){_classCallCheck$G(this,e),r&&(this.eventManager=new EventManager(t),this.instance=t,this.wot=t,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.left=null,this.bottom=null,this.right=null,this.topStyle=null,this.leftStyle=null,this.bottomStyle=null,this.rightStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return _createClass$B(e,[{key:"registerListeners",value:function(){var e=this,t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",(function(){return e.onMouseDown()})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()}));for(var r=function(t,r){var n=e.main.childNodes[t];e.eventManager.addEventListener(n,"mouseenter",(function(r){return e.onMouseEnter(r,e.main.childNodes[t])}))},n=0,o=this.main.childNodes.length;n<o;n++)r(n)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(e,t){if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){e.preventDefault(),stopImmediatePropagation(e);var r=this,n=this.wot.rootDocument.body,o=t.getBoundingClientRect();t.style.display="none",this.eventManager.addEventListener(n,"mousemove",(function e(i){var a;((a=i).clientY<Math.floor(o.top)||a.clientY>Math.ceil(o.top+o.height)||a.clientX<Math.floor(o.left)||a.clientX>Math.ceil(o.left+o.width))&&(r.eventManager.removeEventListener(n,"mousemove",e),t.style.display="block")}))}}},{key:"createBorders",value:function(e){var t=this.wot.rootDocument;this.main=t.createElement("div");var r=["top","left","bottom","right","corner"],n=this.main.style;n.position="absolute",n.top=0,n.left=0;for(var o=0;o<5;o++){var i=r[o],a=t.createElement("div");a.className="wtBorder ".concat(this.settings.className||""),this.settings[i]&&this.settings[i].hide&&(a.className+=" hidden"),(n=a.style).backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:e.border.color,n.height=this.settings[i]&&this.settings[i].width?"".concat(this.settings[i].width,"px"):"".concat(e.border.width,"px"),n.width=this.settings[i]&&this.settings[i].width?"".concat(this.settings[i].width,"px"):"".concat(e.border.width,"px"),this.main.appendChild(a)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),isMobileBrowser()&&this.createMultipleSelectorHandles(),this.disappear();var s=this.wot.wtTable,l=s.bordersHolder;l||((l=t.createElement("div")).className="htBorders",s.bordersHolder=l,s.spreader.appendChild(l)),l.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var e=this,t=this.wot.rootDocument;this.selectionHandles={topLeft:t.createElement("DIV"),topLeftHitArea:t.createElement("DIV"),bottomRight:t.createElement("DIV"),bottomRightHitArea:t.createElement("DIV")};this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style},objectEach({position:"absolute",height:"".concat(40,"px"),width:"".concat(40,"px"),"border-radius":"".concat(parseInt(40/1.5,10),"px")},(function(t,r){e.selectionHandles.styles.bottomRightHitArea[r]=t,e.selectionHandles.styles.topLeftHitArea[r]=t})),objectEach({position:"absolute",height:"".concat(10,"px"),width:"".concat(10,"px"),"border-radius":"".concat(parseInt(10/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"},(function(t,r){e.selectionHandles.styles.bottomRight[r]=t,e.selectionHandles.styles.topLeft[r]=t})),this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)}},{key:"isPartRange",value:function(e,t){var r=this.wot.selections.createOrGetArea();return!(!r.cellRange||e===r.cellRange.to.row&&t===r.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(e,t,r,n,o,i){var a=parseInt(this.selectionHandles.styles.topLeft.width,10),s=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top="".concat(parseInt(r-a,10),"px"),this.selectionHandles.styles.topLeft.left="".concat(parseInt(n-a,10),"px"),this.selectionHandles.styles.topLeftHitArea.top="".concat(parseInt(r-s/4*3,10),"px"),this.selectionHandles.styles.topLeftHitArea.left="".concat(parseInt(n-s/4*3,10),"px"),this.selectionHandles.styles.bottomRight.top="".concat(parseInt(r+i,10),"px"),this.selectionHandles.styles.bottomRight.left="".concat(parseInt(n+o,10),"px"),this.selectionHandles.styles.bottomRightHitArea.top="".concat(parseInt(r+i-s/4,10),"px"),this.selectionHandles.styles.bottomRightHitArea.left="".concat(parseInt(n+o-s/4,10),"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(e,t)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")}},{key:"appear",value:function(e){if(!this.disabled){for(var t,r,n,o,i=this.wot,a=i.wtTable,s=i.rootDocument,l=i.rootWindow,u=a.getRenderedRowsCount(),c=0;c<u;c+=1){var f=a.rowFilter.renderedToSource(c);if(f>=e[0]&&f<=e[2]){t=f;break}}for(var h=u-1;h>=0;h-=1){var d=a.rowFilter.renderedToSource(h);if(d>=e[0]&&d<=e[2]){r=d;break}}for(var p=a.getRenderedColumnsCount(),y=0;y<p;y+=1){var g=a.columnFilter.renderedToSource(y);if(g>=e[1]&&g<=e[3]){n=g;break}}for(var m=p-1;m>=0;m-=1){var v=a.columnFilter.renderedToSource(m);if(v>=e[1]&&v<=e[3]){o=v;break}}if(void 0!==t&&void 0!==n){var _=a.getCell(new CellCoords(t,n)),b=t!==r||n!==o,C=b?a.getCell(new CellCoords(r,o)):_,w=offset(_),E=b?offset(C):w,S=offset(a.TABLE),O=w.top,T=w.left,R=T-S.left-1,$=E.left+outerWidth(C)-T;if(this.isEntireColumnSelected(t,r)){var I=this.getDimensionsFromHeader("columns",n,o,S),A=null;if(I){var P=_slicedToArray$1(I,3);A=P[0],R=P[1],$=P[2]}A&&(_=A)}var k=O-S.top-1,N=E.top+outerHeight(C)-O;if(this.isEntireRowSelected(n,o)){var M=this.getDimensionsFromHeader("rows",t,r,S),D=null;if(M){var L=_slicedToArray$1(M,3);D=L[0],k=L[1],N=L[2]}D&&(_=D)}var x=getComputedStyle(_,l);parseInt(x.borderTopWidth,10)>0&&(k+=1,N=N>0?N-1:0),parseInt(x.borderLeftWidth,10)>0&&(R+=1,$=$>0?$-1:0),this.topStyle.top="".concat(k,"px"),this.topStyle.left="".concat(R,"px"),this.topStyle.width="".concat($,"px"),this.topStyle.display="block",this.leftStyle.top="".concat(k,"px"),this.leftStyle.left="".concat(R,"px"),this.leftStyle.height="".concat(N,"px"),this.leftStyle.display="block";var H=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(k+N-H,"px"),this.bottomStyle.left="".concat(R,"px"),this.bottomStyle.width="".concat($,"px"),this.bottomStyle.display="block",this.rightStyle.top="".concat(k,"px"),this.rightStyle.left="".concat(R+$-H,"px"),this.rightStyle.height="".concat(N+1,"px"),this.rightStyle.display="block";var j=this.settings.border.cornerVisible;j="function"==typeof j?j(this.settings.layerLevel):j;var F=this.wot.getSetting("onModifyGetCellCoords",r,o),U=r,B=o;if(F&&Array.isArray(F)){var V=_slicedToArray$1(F,4);U=V[2],B=V[3]}if(isMobileBrowser()||!j||this.isPartRange(U,B))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(k+N+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.left="".concat(R+$+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var W=getTrimmingContainer(a.TABLE),G=W===l;if(G&&(W=s.documentElement),o===this.wot.getSetting("totalColumns")-1)(G?C.getBoundingClientRect().left:C.offsetLeft)+outerWidth(C)+parseInt(this.cornerDefaultStyle.width,10)/2>=innerWidth(W)&&(this.cornerStyle.left="".concat(Math.floor(R+$+this.cornerCenterPointOffset-parseInt(this.cornerDefaultStyle.width,10)/2),"px"),this.cornerStyle.borderRightWidth=0);if(r===this.wot.getSetting("totalRows")-1)(G?C.getBoundingClientRect().top:C.offsetTop)+outerHeight(C)+parseInt(this.cornerDefaultStyle.height,10)/2>=innerHeight(W)&&(this.cornerStyle.top="".concat(Math.floor(k+N+this.cornerCenterPointOffset-parseInt(this.cornerDefaultStyle.height,10)/2),"px"),this.cornerStyle.borderBottomWidth=0);this.cornerStyle.display="block"}isMobileBrowser()&&this.updateMultipleSelectionHandlesPosition(r,o,k,R,$,N)}else this.disappear()}}},{key:"isEntireColumnSelected",value:function(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(e,t,r,n){var o=this.wot.wtTable,i=o.wtRootElement.parentNode,a=null,s=null,l=null,u=null,c=null,f=null,h=null,d=null;switch(e){case"rows":a=function(){return o.getRowHeader.apply(o,arguments)},s=function(){return outerHeight.apply(void 0,arguments)},l="ht__selection--rows",f="top";break;case"columns":a=function(){return o.getColumnHeader.apply(o,arguments)},s=function(){return outerWidth.apply(void 0,arguments)},l="ht__selection--columns",f="left"}if(i.className.includes(l)){var p=this.wot.getSetting("columnHeaders").length;if(h=a(t,p-1),d=a(r,p-1),!h||!d)return!1;var y=offset(h),g=offset(d);return h&&d&&(u=y[f]-n[f]-1,c=g[f]+s(d)-y[f]),[h,u,c]}return!1}},{key:"changeBorderStyle",value:function(e,t){var r=this[e].style,n=t[e];!n||n.hide?addClass(this[e],"hidden"):(hasClass(this[e],"hidden")&&removeClass(this[e],"hidden"),r.backgroundColor=n.color,"top"!==e&&"bottom"!==e||(r.height="".concat(n.width,"px")),"right"!==e&&"left"!==e||(r.width="".concat(n.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(e){var t=1,r="#000",n=this[e].style;n.backgroundColor=r,n.width="".concat(t,"px"),n.height="".concat(t,"px")}},{key:"toggleHiddenClass",value:function(e,t){this.changeBorderToDefaultStyle(e),t?addClass(this[e],"hidden"):removeClass(this[e],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none",isMobileBrowser()&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}(),propertyIsEnumerable=objectPropertyIsEnumerable.f,createMethod$5=function(e){return function(t){for(var r,n=toIndexedObject(t),o=objectKeys(n),i=o.length,a=0,s=[];i>a;)r=o[a++],descriptors&&!propertyIsEnumerable.call(n,r)||s.push(e?[r,n[r]]:n[r]);return s}},objectToArray={entries:createMethod$5(!0),values:createMethod$5(!1)},$values=objectToArray.values;function _slicedToArray$2(e,t){return _arrayWithHoles$2(e)||_iterableToArrayLimit$2(e,t)||_unsupportedIterableToArray$4(e,t)||_nonIterableRest$2()}function _nonIterableRest$2(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$4(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$4(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$4(e,t):void 0}}function _arrayLikeToArray$4(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$2(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$2(e){if(Array.isArray(e))return e}function _typeof$l(e){return(_typeof$l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$H(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$C(e,t,r){return t&&_defineProperties$C(e.prototype,t),r&&_defineProperties$C(e,r),e}_export({target:"Object",stat:!0},{values:function(e){return $values(e)}});var Selection=function(){function e(t,r){_classCallCheck$H(this,e),this.settings=t,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return _createClass$C(e,[{key:"getBorder",value:function(e){return this.instanceBorders[e.guid]||(this.instanceBorders[e.guid]=new Border(e,this.settings)),this.instanceBorders[e.guid]}},{key:"isEmpty",value:function(){return null===this.cellRange}},{key:"add",value:function(e){return this.isEmpty()?this.cellRange=new CellRange(e):this.cellRange.expand(e),this}},{key:"replace",value:function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var e=this.cellRange.getOuterTopLeftCorner(),t=this.cellRange.getOuterBottomRightCorner();return[e.row,e.col,t.row,t.col]}},{key:"addClassAtCoords",value:function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=e.wtTable.getCell(new CellCoords(t,r));if("object"===_typeof$l(i)){var a=n;o&&(a=this.classNameGenerator(i),this.classNames.includes(a)||this.classNames.push(a)),addClass(i,a)}return this}},{key:"linearClassNameGenerator",value:function(e,t){return function r(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0===t||0===o)return e;var i=o>=0?o:t,a=e,s=0===(i-=1)?e:"".concat(e,"-").concat(i);if(hasClass(n,s)){var l=i+1;a="".concat(e,"-").concat(l)}else a=r(n,i);return a}}},{key:"draw",value:function(e){if(this.isEmpty())this.settings.border&&this.getBorder(e).disappear();else{var t=e.wtTable.getRenderedRowsCount(),r=e.wtTable.getRenderedColumnsCount(),n=this.getCorners(),o=_slicedToArray$2(n,4),i=o[0],a=o[1],s=o[2],l=o[3];if(null!==a&&null!==l)for(var u=0;u<r;u+=1){var c=e.wtTable.columnFilter.renderedToSource(u);if(c>=a&&c<=l){var f=e.wtTable.getColumnHeader(c);if(f){var h=[];this.settings.highlightHeaderClassName&&h.push(this.settings.highlightHeaderClassName),this.settings.highlightColumnClassName&&h.push(this.settings.highlightColumnClassName),addClass(f,h)}}}if(null!==i&&null!==s)for(var d=0;d<t;d+=1){var p=e.wtTable.rowFilter.renderedToSource(d);if(p>=i&&p<=s){var y=e.wtTable.getRowHeader(p);if(y){var g=[];this.settings.highlightHeaderClassName&&g.push(this.settings.highlightHeaderClassName),this.settings.highlightRowClassName&&g.push(this.settings.highlightRowClassName),addClass(y,g)}}if(null!==a&&null!==l)for(var m=0;m<r;m+=1){var v=e.wtTable.columnFilter.renderedToSource(m);p>=i&&p<=s&&v>=a&&v<=l?this.settings.className&&this.addClassAtCoords(e,p,v,this.settings.className,this.settings.markIntersections):p>=i&&p<=s?this.settings.highlightRowClassName&&this.addClassAtCoords(e,p,v,this.settings.highlightRowClassName):v>=a&&v<=l&&this.settings.highlightColumnClassName&&this.addClassAtCoords(e,p,v,this.settings.highlightColumnClassName);var _=e.getSetting("onAfterDrawSelection",p,v,this.settings.layerLevel);"string"==typeof _&&this.addClassAtCoords(e,p,v,_)}}e.getSetting("onBeforeDrawBorders",n,this.settings.className),this.settings.border&&this.getBorder(e).appear(n)}}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach((function(e){return e.destroy()}))}}]),e}(),MIXIN_NAME$5="hooksRefRegisterer",hooksRefRegisterer={_hooksStorage:Object.create(null),addHook:function(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey:function(e){var t=this;arrayEach(this._hooksStorage[e]||[],(function(r){t.hot.removeHook(e,r)}))},clearHooks:function(){var e=this;objectEach(this._hooksStorage,(function(t,r){return e.removeHooksByKey(r)})),this._hooksStorage={}}};function _typeof$m(e){return(_typeof$m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _slicedToArray$3(e,t){return _arrayWithHoles$3(e)||_iterableToArrayLimit$3(e,t)||_unsupportedIterableToArray$5(e,t)||_nonIterableRest$3()}function _nonIterableRest$3(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$5(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$5(e,t):void 0}}function _arrayLikeToArray$5(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$3(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$3(e){if(Array.isArray(e))return e}function _inherits$h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$h(e,t)}function _setPrototypeOf$h(e,t){return(_setPrototypeOf$h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$h(e){var t=_isNativeReflectConstruct$h();return function(){var r,n=_getPrototypeOf$h(e);if(t){var o=_getPrototypeOf$h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$h(this,r)}}function _possibleConstructorReturn$h(e,t){return!t||"object"!==_typeof$m(t)&&"function"!=typeof t?_assertThisInitialized$h(e):t}function _assertThisInitialized$h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$h(e){return(_getPrototypeOf$h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classCallCheck$I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$D(e,t,r){return t&&_defineProperties$D(e.prototype,t),r&&_defineProperties$D(e,r),e}defineGetter(hooksRefRegisterer,"MIXIN_NAME",MIXIN_NAME$5,{writable:!1,enumerable:!1});var EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"},BaseEditor=function(){function e(t){_classCallCheck$I(this,e),this.hot=t,this.instance=t,this.state=EditorState.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return _createClass$D(e,[{key:"_fireCallbacks",value:function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(e,t,r,n,o,i){this.TD=n,this.row=e,this.col=t,this.prop=r,this.originalValue=o,this.cellProperties=i,this.state=EditorState.VIRGIN}},{key:"extend",value:function(){return function(e){_inherits$h(r,e);var t=_createSuper$h(r);function r(){return _classCallCheck$I(this,r),t.apply(this,arguments)}return r}(this.constructor)}},{key:"saveValue",value:function(e,t){var r,n,o,i;if(t){var a=this.hot.getSelectedLast();r=Math.min(a[0],a[2]),n=Math.min(a[1],a[3]),o=Math.max(a[0],a[2]),i=Math.max(a[1],a[3])}else{var s=[this.row,this.col,null,null];r=s[0],n=s[1],o=s[2],i=s[3]}var l=this.hot.runHooks("modifyGetCellCoords",r,n);if(Array.isArray(l)){var u=_slicedToArray$3(l,2);r=u[0],n=u[1]}this.hot.populateFromArray(r,n,e,o,i,"edit")}},{key:"beginEditing",value:function(e,t){if(this.state===EditorState.VIRGIN){if(this.hot.view.scrollViewport(new CellCoords(this.row,this.col)),this.state=EditorState.EDITING,this.isInFullEditMode()){var r="string"==typeof e?e:stringify(this.originalValue);this.setValue(r)}this.open(t),this._opened=!0,this.focus(),this.hot.view.render(),this.hot.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(e,t,r){var n,o=this;if(r){var i=this._closeCallback;this._closeCallback=function(e){i&&i(e),r(e),o.hot.view.render()}}if(!this.isWaiting())if(this.state!==EditorState.VIRGIN){if(this.state===EditorState.EDITING){if(e)return this.cancelChanges(),void this.hot.view.render();var a=this.getValue();n=this.hot.getSettings().trimWhitespace?[["string"==typeof a?String.prototype.trim.call(a||""):a]]:[[a]],this.state=EditorState.WAITING,this.saveValue(n,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(function(e){o.state=EditorState.FINISHED,o.discardEditor(e)})):(this.state=EditorState.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((function(){o._fireCallbacks(!0)}))}},{key:"cancelChanges",value:function(){this.state=EditorState.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(e){this.state===EditorState.FINISHED&&(!1===e&&!0!==this.cellProperties.allowInvalid?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=EditorState.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=EditorState.VIRGIN,this._fireCallbacks(!0)))}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===EditorState.WAITING}},{key:"getEditedCellsLayerClass",value:function(){switch(this.checkEditorSection()){case"right":return"ht_clone_right";case"left":return"ht_clone_left";case"bottom":return"ht_clone_bottom";case"bottom-right-corner":return"ht_clone_bottom_right_corner";case"bottom-left-corner":return"ht_clone_bottom_left_corner";case"top":return"ht_clone_top";case"top-right-corner":return"ht_clone_top_right_corner";case"top-left-corner":return"ht_clone_top_left_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var e=this.hot.countRows(),t="";return this.row<this.hot.getSettings().fixedRowsTop?t=this.col<this.hot.getSettings().fixedColumnsLeft?"top-left-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?t=this.col<this.hot.getSettings().fixedColumnsLeft?"bottom-left-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsLeft&&(t="left"),t}}]),e}();mixin(BaseEditor,hooksRefRegisterer);var $find=arrayIteration.find,FIND="find",SKIPS_HOLES=!0,USES_TO_LENGTH$6=arrayMethodUsesToLength(FIND);FIND in[]&&Array(1)[FIND]((function(){SKIPS_HOLES=!1})),_export({target:"Array",proto:!0,forced:SKIPS_HOLES||!USES_TO_LENGTH$6},{find:function(e){return $find(this,e,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables(FIND);var test$2=[],nativeSort=test$2.sort,FAILS_ON_UNDEFINED=fails((function(){test$2.sort(void 0)})),FAILS_ON_NULL=fails((function(){test$2.sort(null)})),STRICT_METHOD$3=arrayMethodIsStrict("sort"),FORCED$3=FAILS_ON_UNDEFINED||!FAILS_ON_NULL||!STRICT_METHOD$3;_export({target:"Array",proto:!0,forced:FORCED$3},{sort:function(e){return void 0===e?nativeSort.call(toObject(this)):nativeSort.call(toObject(this),aFunction$1(e))}});var nativeGetOwnPropertyDescriptor$2=objectGetOwnPropertyDescriptor.f,FAILS_ON_PRIMITIVES$3=fails((function(){nativeGetOwnPropertyDescriptor$2(1)})),FORCED$4=!descriptors||FAILS_ON_PRIMITIVES$3;function get$1(e,t){var r,n,o=arguments.length<3?e:arguments[2];return anObject(e)===o?e[t]:(r=objectGetOwnPropertyDescriptor.f(e,t))?has(r,"value")?r.value:void 0===r.get?void 0:r.get.call(o):isObject(n=objectGetPrototypeOf(e))?get$1(n,t,o):void 0}function cellDecorator(e,t,r,n,o,i,a){var s=[],l=[];a.className&&addClass(t,a.className),a.readOnly&&s.push(a.readOnlyCellClassName),!1===a.valid&&a.invalidCellClassName?s.push(a.invalidCellClassName):l.push(a.invalidCellClassName),!1===a.wordWrap&&a.noWordWrapClassName&&s.push(a.noWordWrapClassName),!i&&a.placeholder&&s.push(a.placeholderCellClassName),removeClass(t,l),addClass(t,s)}function autocompleteRenderer(e,t,r,n,o,i,a){var s=e.rootDocument,l=a.allowHtml?"html":"text",u=s.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(s.createTextNode(String.fromCharCode(9660))),_getItem(l).apply(this,[e,t,r,n,o,i,a]),t.firstChild||t.appendChild(s.createTextNode(String.fromCharCode(160))),t.insertBefore(u,t.firstChild),addClass(t,"htAutocomplete"),!e.acArrowListener){var c=new EventManager(e);e.acArrowListener=function(o){hasClass(o.target,"htAutocompleteArrow")&&e.view.wt.getSetting("onCellDblClick",null,new CellCoords(r,n),t)},c.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",(function(){c.destroy()}))}}_export({target:"Object",stat:!0,forced:FORCED$4,sham:!descriptors},{getOwnPropertyDescriptor:function(e,t){return nativeGetOwnPropertyDescriptor$2(toIndexedObject(e),t)}}),_export({target:"Reflect",stat:!0},{get:get$1});var isListeningKeyDownEvent=new WeakMap,isCheckboxListenerAdded=new WeakMap,BAD_VALUE_CLASS="htBadValue";function checkboxRenderer(e,t,r,n,o,i,a){var s=e.rootDocument;_getItem("base").apply(this,[e,t,r,n,o,i,a]),registerEvents(e);var l=createInput(s),u=a.label,c=!1;if(void 0===a.checkedTemplate&&(a.checkedTemplate=!0),void 0===a.uncheckedTemplate&&(a.uncheckedTemplate=!1),empty$1(t),i===a.checkedTemplate||equalsIgnoreCase(i,a.checkedTemplate)?l.checked=!0:i===a.uncheckedTemplate||equalsIgnoreCase(i,a.uncheckedTemplate)?l.checked=!1:null===i?addClass(l,"noValue"):(l.style.display="none",addClass(l,BAD_VALUE_CLASS),c=!0),l.setAttribute("data-row",r),l.setAttribute("data-col",n),!c&&u){var f="";if(u.value)f="function"==typeof u.value?u.value.call(this,r,n,o,i):u.value;else if(u.property){var h=e.getDataAtRowProp(r,u.property);f=null!==h?h:""}var d=createLabel(s,f);"before"===u.position?d.appendChild(l):d.insertBefore(l,d.firstChild),l=d}function p(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=e.getSelectedRange();if(r)for(var n=0;n<r.length;n++){for(var o=r[n].getTopLeftCorner(),i=o.row,a=o.col,s=r[n].getBottomRightCorner(),l=s.row,u=s.col,c=[],f=i;f<=l;f+=1)for(var h=a;h<=u;h+=1){var d=e.getCellMeta(f,h);if("checkbox"!==d.type)return;if(!0!==d.readOnly){void 0===d.checkedTemplate&&(d.checkedTemplate=!0),void 0===d.uncheckedTemplate&&(d.uncheckedTemplate=!1);var p=e.getDataAtCell(f,h);!1===t?[d.checkedTemplate,d.checkedTemplate.toString()].includes(p)?c.push([f,h,d.uncheckedTemplate]):[d.uncheckedTemplate,d.uncheckedTemplate.toString(),null,void 0].includes(p)&&c.push([f,h,d.checkedTemplate]):c.push([f,h,d.uncheckedTemplate])}}c.length>0&&e.setDataAtCell(c)}}t.appendChild(l),c&&t.appendChild(s.createTextNode("#bad-value#")),isListeningKeyDownEvent.has(e)||(isListeningKeyDownEvent.set(e,!0),e.addHook("beforeKeyDown",(function(t){var r="SPACE|ENTER",n="DELETE|BACKSPACE",o=partial(isKey,t.keyCode);if(!e.getSettings().enterBeginsEditing&&o("ENTER"))return;o("".concat(r,"|").concat(n))&&!isImmediatePropagationStopped(t)&&function(t){var r=e.getSelectedRange();if(!r)return;for(var n=0;n<r.length;n++)for(var o=r[n].getTopLeftCorner(),i=r[n].getBottomRightCorner(),a=o.row;a<=i.row;a++)for(var s=o.col;s<=i.col;s++){var l=e.getCellMeta(a,s);if("checkbox"!==l.type)return;var u=e.getCell(a,s);if(null==u)t(a,s,l);else{var c=u.querySelectorAll("input[type=checkbox]");c.length>0&&!l.readOnly&&t(c)}}}((function(){stopImmediatePropagation(t),t.preventDefault()}));o(r)&&p();o(n)&&p(!0)})))}function registerEvents(e){var t=isCheckboxListenerAdded.get(e);if(!t){var r=e.rootElement;(t=new EventManager(e)).addEventListener(r,"click",(function(t){return onClick(t,e)})),t.addEventListener(r,"mouseup",(function(t){return onMouseUp(t,e)})),t.addEventListener(r,"change",(function(t){return onChange(t,e)})),isCheckboxListenerAdded.set(e,t)}return t}function createInput(e){var t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off"),t.setAttribute("tabindex","-1"),t.cloneNode(!1)}function createLabel(e,t){var r=e.createElement("label");return r.className="htCheckboxRendererLabel",r.appendChild(e.createTextNode(t)),r.cloneNode(!0)}function onMouseUp(e,t){isCheckboxInput(e.target)&&setTimeout(t.listen,10)}function onClick(e,t){if(!isCheckboxInput(e.target))return!1;var r=parseInt(e.target.getAttribute("data-row"),10),n=parseInt(e.target.getAttribute("data-col"),10);t.getCellMeta(r,n).readOnly&&e.preventDefault()}function onChange(e,t){if(!isCheckboxInput(e.target))return!1;var r=parseInt(e.target.getAttribute("data-row"),10),n=parseInt(e.target.getAttribute("data-col"),10),o=t.getCellMeta(r,n);if(!o.readOnly){var i=null;i=e.target.checked?void 0===o.uncheckedTemplate||o.checkedTemplate:void 0!==o.uncheckedTemplate&&o.uncheckedTemplate,t.setDataAtCell(r,n,i)}}function isCheckboxInput(e){return"INPUT"===e.tagName&&"checkbox"===e.getAttribute("type")}function htmlRenderer(e,t,r,n,o,i,a){_getItem("base").apply(this,[e,t,r,n,o,i,a]),fastInnerHTML(t,null==i?"":i)}var numbro_min=createCommonjsModule((function(e,t){e.exports=function e(t,r,n){function o(a,s){if(!r[a]){if(!t[a]){var l="function"==typeof commonjsRequire&&commonjsRequire;if(!s&&l)return l(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[a]={exports:{}};t[a][0].call(c.exports,(function(e){return o(t[a][1][e]||e)}),c,c.exports,e,t,r,n)}return r[a].exports}for(var i="function"==typeof commonjsRequire&&commonjsRequire,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(e,t,r){!function(e){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,o=Math.ceil,i=Math.floor,a="[BigNumber Error] ",s=a+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,f=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],h=1e7,d=1e9;function p(e){var t=0|e;return 0<e||e===t?t:t-1}function y(e){for(var t,r,n=1,o=e.length,i=e[0]+"";n<o;){for(t=e[n++]+"",r=u-t.length;r--;t="0"+t);i+=t}for(o=i.length;48===i.charCodeAt(--o););return i.slice(0,o+1||1)}function g(e,t){var r,n,o=e.c,i=t.c,a=e.s,s=t.s,l=e.e,u=t.e;if(!a||!s)return null;if(r=o&&!o[0],n=i&&!i[0],r||n)return r?n?0:-s:a;if(a!=s)return a;if(r=a<0,n=l==u,!o||!i)return n?0:!o^r?1:-1;if(!n)return u<l^r?1:-1;for(s=(l=o.length)<(u=i.length)?l:u,a=0;a<s;a++)if(o[a]!=i[a])return o[a]>i[a]^r?1:-1;return l==u?0:u<l^r?1:-1}function m(e,t,r,n){if(e<t||r<e||e!==(e<0?o(e):i(e)))throw Error(a+(n||"Argument")+("number"==typeof e?e<t||r<e?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function v(e){var t=e.c.length-1;return p(e.e/u)==t&&e.c[t]%2!=0}function _(e,t){return(1<e.length?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function b(e,t,r){var n,o;if(t<0){for(o=r+".";++t;o+=r);e=o+e}else if(++t>(n=e.length)){for(o=r,t-=n;--t;o+=r);e+=o}else t<n&&(e=e.slice(0,t)+"."+e.slice(t));return e}(r=function e(t){var r,C,w,E,S,O,T,R,$,I,A=V.prototype={constructor:V,toString:null,valueOf:null},P=new V(1),k=20,N=4,M=-7,D=21,L=-1e7,x=1e7,H=!1,j=1,F=0,U={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},B="0123456789abcdefghijklmnopqrstuvwxyz";function V(e,t){var r,o,a,l,f,h,d,p,y=this;if(!(y instanceof V))return new V(e,t);if(null==t){if(e instanceof V)return y.s=e.s,y.e=e.e,void(y.c=(e=e.c)?e.slice():e);if((h="number"==typeof e)&&0*e==0){if(y.s=1/e<0?(e=-e,-1):1,e===~~e){for(l=0,f=e;10<=f;f/=10,l++);return y.e=l,void(y.c=[e])}p=String(e)}else{if(p=String(e),!n.test(p))return w(y,p,h);y.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}-1<(l=p.indexOf("."))&&(p=p.replace(".","")),0<(f=p.search(/e/i))?(l<0&&(l=f),l+=+p.slice(f+1),p=p.substring(0,f)):l<0&&(l=p.length)}else{if(m(t,2,B.length,"Base"),p=String(e),10==t)return Y(y=new V(e instanceof V?e:p),k+y.e+1,N);if(h="number"==typeof e){if(0*e!=0)return w(y,p,h,t);if(y.s=1/e<0?(p=p.slice(1),-1):1,V.DEBUG&&15<p.replace(/^0\.0*|\./,"").length)throw Error(s+e);h=!1}else y.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(r=B.slice(0,t),l=f=0,d=p.length;f<d;f++)if(r.indexOf(o=p.charAt(f))<0){if("."==o){if(l<f){l=d;continue}}else if(!a&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){a=!0,f=-1,l=0;continue}return w(y,String(e),h,t)}-1<(l=(p=C(p,t,10,y.s)).indexOf("."))?p=p.replace(".",""):l=p.length}for(f=0;48===p.charCodeAt(f);f++);for(d=p.length;48===p.charCodeAt(--d););if(p=p.slice(f,++d)){if(d-=f,h&&V.DEBUG&&15<d&&(c<e||e!==i(e)))throw Error(s+y.s*e);if(x<(l=l-f-1))y.c=y.e=null;else if(l<L)y.c=[y.e=0];else{if(y.e=l,y.c=[],f=(l+1)%u,l<0&&(f+=u),f<d){for(f&&y.c.push(+p.slice(0,f)),d-=u;f<d;)y.c.push(+p.slice(f,f+=u));p=p.slice(f),f=u-p.length}else f-=d;for(;f--;p+="0");y.c.push(+p)}}else y.c=[y.e=0]}function W(e,t,r,n){var o,i,a,s,l;if(null==r?r=N:m(r,0,8),!e.c)return e.toString();if(o=e.c[0],a=e.e,null==t)l=y(e.c),l=1==n||2==n&&(a<=M||D<=a)?_(l,a):b(l,a,"0");else if(i=(e=Y(new V(e),t,r)).e,s=(l=y(e.c)).length,1==n||2==n&&(t<=i||i<=M)){for(;s<t;l+="0",s++);l=_(l,i)}else if(t-=a,l=b(l,i,"0"),s<i+1){if(0<--t)for(l+=".";t--;l+="0");}else if(0<(t+=i-s))for(i+1==s&&(l+=".");t--;l+="0");return e.s<0&&o?"-"+l:l}function G(e,t){for(var r,n=1,o=new V(e[0]);n<e.length;n++){if(!(r=new V(e[n])).s){o=r;break}t.call(o,r)&&(o=r)}return o}function z(e,t,r){for(var n=1,o=t.length;!t[--o];t.pop());for(o=t[0];10<=o;o/=10,n++);return(r=n+r*u-1)>x?e.c=e.e=null:e.c=r<L?[e.e=0]:(e.e=r,t),e}function Y(e,t,r,n){var a,s,c,h,d,p,y,g=e.c,m=f;if(g){e:{for(a=1,h=g[0];10<=h;h/=10,a++);if((s=t-a)<0)s+=u,c=t,y=(d=g[p=0])/m[a-c-1]%10|0;else if((p=o((s+1)/u))>=g.length){if(!n)break e;for(;g.length<=p;g.push(0));d=y=0,c=(s%=u)-u+(a=1)}else{for(d=h=g[p],a=1;10<=h;h/=10,a++);y=(c=(s%=u)-u+a)<0?0:d/m[a-c-1]%10|0}if(n=n||t<0||null!=g[p+1]||(c<0?d:d%m[a-c-1]),n=r<4?(y||n)&&(0==r||r==(e.s<0?3:2)):5<y||5==y&&(4==r||n||6==r&&(0<s?0<c?d/m[a-c]:0:g[p-1])%10&1||r==(e.s<0?8:7)),t<1||!g[0])return g.length=0,n?(t-=e.e+1,g[0]=m[(u-t%u)%u],e.e=-t||0):g[0]=e.e=0,e;if(0==s?(g.length=p,h=1,p--):(g.length=p+1,h=m[u-s],g[p]=0<c?i(d/m[a-c]%m[c])*h:0),n)for(;;){if(0==p){for(s=1,c=g[0];10<=c;c/=10,s++);for(c=g[0]+=h,h=1;10<=c;c/=10,h++);s!=h&&(e.e++,g[0]==l&&(g[0]=1));break}if(g[p]+=h,g[p]!=l)break;g[p--]=0,h=1}for(s=g.length;0===g[--s];g.pop());}e.e>x?e.c=e.e=null:e.e<L&&(e.c=[e.e=0])}return e}function K(e){var t,r=e.e;return null===r?e.toString():(t=y(e.c),t=r<=M||D<=r?_(t,r):b(t,r,"0"),e.s<0?"-"+t:t)}return V.clone=e,V.ROUND_UP=0,V.ROUND_DOWN=1,V.ROUND_CEIL=2,V.ROUND_FLOOR=3,V.ROUND_HALF_UP=4,V.ROUND_HALF_DOWN=5,V.ROUND_HALF_EVEN=6,V.ROUND_HALF_CEIL=7,V.ROUND_HALF_FLOOR=8,V.EUCLID=9,V.config=V.set=function(e){var t,r;if(null!=e){if("object"!=typeof e)throw Error(a+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(m(r=e[t],0,d,t),k=r),e.hasOwnProperty(t="ROUNDING_MODE")&&(m(r=e[t],0,8,t),N=r),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((r=e[t])&&r.pop?(m(r[0],-d,0,t),m(r[1],0,d,t),M=r[0],D=r[1]):(m(r,-d,d,t),M=-(D=r<0?-r:r))),e.hasOwnProperty(t="RANGE"))if((r=e[t])&&r.pop)m(r[0],-d,-1,t),m(r[1],1,d,t),L=r[0],x=r[1];else{if(m(r,-d,d,t),!r)throw Error(a+t+" cannot be zero: "+r);L=-(x=r<0?-r:r)}if(e.hasOwnProperty(t="CRYPTO")){if((r=e[t])!==!!r)throw Error(a+t+" not true or false: "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw H=!r,Error(a+"crypto unavailable");H=r}else H=r}if(e.hasOwnProperty(t="MODULO_MODE")&&(m(r=e[t],0,9,t),j=r),e.hasOwnProperty(t="POW_PRECISION")&&(m(r=e[t],0,d,t),F=r),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(r=e[t]))throw Error(a+t+" not an object: "+r);U=r}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(r=e[t])||/^.$|[+-.\s]|(.).*\1/.test(r))throw Error(a+t+" invalid: "+r);B=r}}return{DECIMAL_PLACES:k,ROUNDING_MODE:N,EXPONENTIAL_AT:[M,D],RANGE:[L,x],CRYPTO:H,MODULO_MODE:j,POW_PRECISION:F,FORMAT:U,ALPHABET:B}},V.isBigNumber=function(e){return e instanceof V||e&&!0===e._isBigNumber||!1},V.maximum=V.max=function(){return G(arguments,A.lt)},V.minimum=V.min=function(){return G(arguments,A.gt)},V.random=(E=9007199254740992,S=Math.random()*E&2097151?function(){return i(Math.random()*E)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,r,n,s,l,c=0,h=[],p=new V(P);if(null==e?e=k:m(e,0,d),s=o(e/u),H)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(s*=2));c<s;)9e15<=(l=131072*t[c]+(t[c+1]>>>11))?(r=crypto.getRandomValues(new Uint32Array(2)),t[c]=r[0],t[c+1]=r[1]):(h.push(l%1e14),c+=2);c=s/2}else{if(!crypto.randomBytes)throw H=!1,Error(a+"crypto unavailable");for(t=crypto.randomBytes(s*=7);c<s;)9e15<=(l=281474976710656*(31&t[c])+1099511627776*t[c+1]+4294967296*t[c+2]+16777216*t[c+3]+(t[c+4]<<16)+(t[c+5]<<8)+t[c+6])?crypto.randomBytes(7).copy(t,c):(h.push(l%1e14),c+=7);c=s/7}if(!H)for(;c<s;)(l=S())<9e15&&(h[c++]=l%1e14);for(s=h[--c],e%=u,s&&e&&(l=f[u-e],h[c]=i(s/l)*l);0===h[c];h.pop(),c--);if(c<0)h=[n=0];else{for(n=-1;0===h[0];h.splice(0,1),n-=u);for(c=1,l=h[0];10<=l;l/=10,c++);c<u&&(n-=u-c)}return p.e=n,p.c=h,p}),V.sum=function(){for(var e=1,t=arguments,r=new V(t[0]);e<t.length;)r=r.plus(t[e++]);return r},C=function(){var e="0123456789";function t(e,t,r,n){for(var o,i,a=[0],s=0,l=e.length;s<l;){for(i=a.length;i--;a[i]*=t);for(a[0]+=n.indexOf(e.charAt(s++)),o=0;o<a.length;o++)a[o]>r-1&&(null==a[o+1]&&(a[o+1]=0),a[o+1]+=a[o]/r|0,a[o]%=r)}return a.reverse()}return function(n,o,i,a,s){var l,u,c,f,h,d,p,g,m=n.indexOf("."),v=k,_=N;for(0<=m&&(f=F,F=0,n=n.replace(".",""),d=(g=new V(o)).pow(n.length-m),F=f,g.c=t(b(y(d.c),d.e,"0"),10,i,e),g.e=g.c.length),c=f=(p=t(n,o,i,s?(l=B,e):(l=e,B))).length;0==p[--f];p.pop());if(!p[0])return l.charAt(0);if(m<0?--c:(d.c=p,d.e=c,d.s=a,p=(d=r(d,g,v,_,i)).c,h=d.r,c=d.e),m=p[u=c+v+1],f=i/2,h=h||u<0||null!=p[u+1],h=_<4?(null!=m||h)&&(0==_||_==(d.s<0?3:2)):f<m||m==f&&(4==_||h||6==_&&1&p[u-1]||_==(d.s<0?8:7)),u<1||!p[0])n=h?b(l.charAt(1),-v,l.charAt(0)):l.charAt(0);else{if(p.length=u,h)for(--i;++p[--u]>i;)p[u]=0,u||(++c,p=[1].concat(p));for(f=p.length;!p[--f];);for(m=0,n="";m<=f;n+=l.charAt(p[m++]));n=b(n,c,l.charAt(0))}return n}}(),r=function(){function e(e,t,r){var n,o,i,a,s=0,l=e.length,u=t%h,c=t/h|0;for(e=e.slice();l--;)s=((o=u*(i=e[l]%h)+(n=c*i+(a=e[l]/h|0)*u)%h*h+s)/r|0)+(n/h|0)+c*a,e[l]=o%r;return s&&(e=[s].concat(e)),e}function t(e,t,r,n){var o,i;if(r!=n)i=n<r?1:-1;else for(o=i=0;o<r;o++)if(e[o]!=t[o]){i=e[o]>t[o]?1:-1;break}return i}function r(e,t,r,n){for(var o=0;r--;)e[r]-=o,o=e[r]<t[r]?1:0,e[r]=o*n+e[r]-t[r];for(;!e[0]&&1<e.length;e.splice(0,1));}return function(n,o,a,s,c){var f,h,d,y,g,m,v,_,b,C,w,E,S,O,T,R,$,I=n.s==o.s?1:-1,A=n.c,P=o.c;if(!(A&&A[0]&&P&&P[0]))return new V(n.s&&o.s&&(A?!P||A[0]!=P[0]:P)?A&&0==A[0]||!P?0*I:I/0:NaN);for(b=(_=new V(I)).c=[],I=a+(h=n.e-o.e)+1,c||(c=l,h=p(n.e/u)-p(o.e/u),I=I/u|0),d=0;P[d]==(A[d]||0);d++);if(P[d]>(A[d]||0)&&h--,I<0)b.push(1),y=!0;else{for(O=A.length,R=P.length,I+=2,1<(g=i(c/(P[d=0]+1)))&&(P=e(P,g,c),A=e(A,g,c),R=P.length,O=A.length),S=R,w=(C=A.slice(0,R)).length;w<R;C[w++]=0);$=P.slice(),$=[0].concat($),T=P[0],P[1]>=c/2&&T++;do{if(g=0,(f=t(P,C,R,w))<0){if(E=C[0],R!=w&&(E=E*c+(C[1]||0)),1<(g=i(E/T)))for(c<=g&&(g=c-1),v=(m=e(P,g,c)).length,w=C.length;1==t(m,C,v,w);)g--,r(m,R<v?$:P,v,c),v=m.length,f=1;else 0==g&&(f=g=1),v=(m=P.slice()).length;if(v<w&&(m=[0].concat(m)),r(C,m,w,c),w=C.length,-1==f)for(;t(P,C,R,w)<1;)g++,r(C,R<w?$:P,w,c),w=C.length}else 0===f&&(g++,C=[0]);b[d++]=g,C[0]?C[w++]=A[S]||0:(C=[A[S]],w=1)}while((S++<O||null!=C[0])&&I--);y=null!=C[0],b[0]||b.splice(0,1)}if(c==l){for(d=1,I=b[0];10<=I;I/=10,d++);Y(_,a+(_.e=d+h*u-1)+1,s,y)}else _.e=h,_.r=+y;return _}}(),O=/^(-?)0([xbo])(?=\w[\w.]*$)/i,T=/^([^.]+)\.$/,R=/^\.([^.]+)$/,$=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g,w=function(e,t,r,n){var o,i=r?t:t.replace(I,"");if($.test(i))e.s=isNaN(i)?null:i<0?-1:1,e.c=e.e=null;else{if(!r&&(i=i.replace(O,(function(e,t,r){return o="x"==(r=r.toLowerCase())?16:"b"==r?2:8,n&&n!=o?e:t})),n&&(o=n,i=i.replace(T,"$1").replace(R,"0.$1")),t!=i))return new V(i,o);if(V.DEBUG)throw Error(a+"Not a"+(n?" base "+n:"")+" number: "+t);e.c=e.e=e.s=null}},A.absoluteValue=A.abs=function(){var e=new V(this);return e.s<0&&(e.s=1),e},A.comparedTo=function(e,t){return g(this,new V(e,t))},A.decimalPlaces=A.dp=function(e,t){var r,n,o;if(null!=e)return m(e,0,d),null==t?t=N:m(t,0,8),Y(new V(this),e+this.e+1,t);if(!(r=this.c))return null;if(n=((o=r.length-1)-p(this.e/u))*u,o=r[o])for(;o%10==0;o/=10,n--);return n<0&&(n=0),n},A.dividedBy=A.div=function(e,t){return r(this,new V(e,t),k,N)},A.dividedToIntegerBy=A.idiv=function(e,t){return r(this,new V(e,t),0,1)},A.exponentiatedBy=A.pow=function(e,t){var r,n,s,l,c,f,h,d,p=this;if((e=new V(e)).c&&!e.isInteger())throw Error(a+"Exponent not an integer: "+K(e));if(null!=t&&(t=new V(t)),c=14<e.e,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!e.c||!e.c[0])return d=new V(Math.pow(+K(p),c?2-v(e):+K(e))),t?d.mod(t):d;if(f=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new V(NaN);(n=!f&&p.isInteger()&&t.isInteger())&&(p=p.mod(t))}else{if(9<e.e&&(0<p.e||p.e<-1||(0==p.e?1<p.c[0]||c&&24e7<=p.c[1]:p.c[0]<8e13||c&&p.c[0]<=9999975e7)))return l=p.s<0&&v(e)?-0:0,-1<p.e&&(l=1/l),new V(f?1/l:l);F&&(l=o(F/u+2))}for(h=c?(r=new V(.5),f&&(e.s=1),v(e)):(s=Math.abs(+K(e)))%2,d=new V(P);;){if(h){if(!(d=d.times(p)).c)break;l?d.c.length>l&&(d.c.length=l):n&&(d=d.mod(t))}if(s){if(0===(s=i(s/2)))break;h=s%2}else if(Y(e=e.times(r),e.e+1,1),14<e.e)h=v(e);else{if(0==(s=+K(e)))break;h=s%2}p=p.times(p),l?p.c&&p.c.length>l&&(p.c.length=l):n&&(p=p.mod(t))}return n?d:(f&&(d=P.div(d)),t?d.mod(t):l?Y(d,F,N,void 0):d)},A.integerValue=function(e){var t=new V(this);return null==e?e=N:m(e,0,8),Y(t,t.e+1,e)},A.isEqualTo=A.eq=function(e,t){return 0===g(this,new V(e,t))},A.isFinite=function(){return!!this.c},A.isGreaterThan=A.gt=function(e,t){return 0<g(this,new V(e,t))},A.isGreaterThanOrEqualTo=A.gte=function(e,t){return 1===(t=g(this,new V(e,t)))||0===t},A.isInteger=function(){return!!this.c&&p(this.e/u)>this.c.length-2},A.isLessThan=A.lt=function(e,t){return g(this,new V(e,t))<0},A.isLessThanOrEqualTo=A.lte=function(e,t){return-1===(t=g(this,new V(e,t)))||0===t},A.isNaN=function(){return!this.s},A.isNegative=function(){return this.s<0},A.isPositive=function(){return 0<this.s},A.isZero=function(){return!!this.c&&0==this.c[0]},A.minus=function(e,t){var r,n,o,i,a=this,s=a.s;if(t=(e=new V(e,t)).s,!s||!t)return new V(NaN);if(s!=t)return e.s=-t,a.plus(e);var c=a.e/u,f=e.e/u,h=a.c,d=e.c;if(!c||!f){if(!h||!d)return h?(e.s=-t,e):new V(d?a:NaN);if(!h[0]||!d[0])return d[0]?(e.s=-t,e):new V(h[0]?a:3==N?-0:0)}if(c=p(c),f=p(f),h=h.slice(),s=c-f){for((o=(i=s<0)?(s=-s,h):(f=c,d)).reverse(),t=s;t--;o.push(0));o.reverse()}else for(n=(i=(s=h.length)<(t=d.length))?s:t,s=t=0;t<n;t++)if(h[t]!=d[t]){i=h[t]<d[t];break}if(i&&(o=h,h=d,d=o,e.s=-e.s),0<(t=(n=d.length)-(r=h.length)))for(;t--;h[r++]=0);for(t=l-1;s<n;){if(h[--n]<d[n]){for(r=n;r&&!h[--r];h[r]=t);--h[r],h[n]+=l}h[n]-=d[n]}for(;0==h[0];h.splice(0,1),--f);return h[0]?z(e,h,f):(e.s=3==N?-1:1,e.c=[e.e=0],e)},A.modulo=A.mod=function(e,t){var n,o,i=this;return e=new V(e,t),!i.c||!e.s||e.c&&!e.c[0]?new V(NaN):!e.c||i.c&&!i.c[0]?new V(i):(9==j?(o=e.s,e.s=1,n=r(i,e,0,3),e.s=o,n.s*=o):n=r(i,e,0,j),(e=i.minus(n.times(e))).c[0]||1!=j||(e.s=i.s),e)},A.multipliedBy=A.times=function(e,t){var r,n,o,i,a,s,c,f,d,y,g,m,v,_,b,C=this,w=C.c,E=(e=new V(e,t)).c;if(!(w&&E&&w[0]&&E[0]))return!C.s||!e.s||w&&!w[0]&&!E||E&&!E[0]&&!w?e.c=e.e=e.s=null:(e.s*=C.s,w&&E?(e.c=[0],e.e=0):e.c=e.e=null),e;for(n=p(C.e/u)+p(e.e/u),e.s*=C.s,(c=w.length)<(y=E.length)&&(v=w,w=E,E=v,o=c,c=y,y=o),o=c+y,v=[];o--;v.push(0));for(_=l,b=h,o=y;0<=--o;){for(r=0,g=E[o]%b,m=E[o]/b|0,i=o+(a=c);o<i;)r=((f=g*(f=w[--a]%b)+(s=m*f+(d=w[a]/b|0)*g)%b*b+v[i]+r)/_|0)+(s/b|0)+m*d,v[i--]=f%_;v[i]=r}return r?++n:v.splice(0,1),z(e,v,n)},A.negated=function(){var e=new V(this);return e.s=-e.s||null,e},A.plus=function(e,t){var r,n=this,o=n.s;if(t=(e=new V(e,t)).s,!o||!t)return new V(NaN);if(o!=t)return e.s=-t,n.minus(e);var i=n.e/u,a=e.e/u,s=n.c,c=e.c;if(!i||!a){if(!s||!c)return new V(o/0);if(!s[0]||!c[0])return c[0]?e:new V(s[0]?n:0*o)}if(i=p(i),a=p(a),s=s.slice(),o=i-a){for((r=0<o?(a=i,c):(o=-o,s)).reverse();o--;r.push(0));r.reverse()}for((o=s.length)-(t=c.length)<0&&(r=c,c=s,s=r,t=o),o=0;t;)o=(s[--t]=s[t]+c[t]+o)/l|0,s[t]=l===s[t]?0:s[t]%l;return o&&(s=[o].concat(s),++a),z(e,s,a)},A.precision=A.sd=function(e,t){var r,n,o;if(null!=e&&e!==!!e)return m(e,1,d),null==t?t=N:m(t,0,8),Y(new V(this),e,t);if(!(r=this.c))return null;if(n=(o=r.length-1)*u+1,o=r[o]){for(;o%10==0;o/=10,n--);for(o=r[0];10<=o;o/=10,n++);}return e&&this.e+1>n&&(n=this.e+1),n},A.shiftedBy=function(e){return m(e,-c,c),this.times("1e"+e)},A.squareRoot=A.sqrt=function(){var e,t,n,o,i,a=this,s=a.c,l=a.s,u=a.e,c=k+4,f=new V("0.5");if(1!==l||!s||!s[0])return new V(!l||l<0&&(!s||s[0])?NaN:s?a:1/0);if((n=0==(l=Math.sqrt(+K(a)))||l==1/0?(((t=y(s)).length+u)%2==0&&(t+="0"),l=Math.sqrt(+t),u=p((u+1)/2)-(u<0||u%2),new V(t=l==1/0?"1e"+u:(t=l.toExponential()).slice(0,t.indexOf("e")+1)+u)):new V(l+"")).c[0])for((l=(u=n.e)+c)<3&&(l=0);;)if(i=n,n=f.times(i.plus(r(a,i,c,1))),y(i.c).slice(0,l)===(t=y(n.c)).slice(0,l)){if(n.e<u&&--l,"9999"!=(t=t.slice(l-3,l+1))&&(o||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(Y(n,n.e+k+2,1),e=!n.times(n).eq(a));break}if(!o&&(Y(i,i.e+k+2,0),i.times(i).eq(a))){n=i;break}c+=4,l+=4,o=1}return Y(n,n.e+k+1,N,e)},A.toExponential=function(e,t){return null!=e&&(m(e,0,d),e++),W(this,e,t,1)},A.toFixed=function(e,t){return null!=e&&(m(e,0,d),e=e+this.e+1),W(this,e,t)},A.toFormat=function(e,t,r){var n;if(null==r)null!=e&&t&&"object"==typeof t?(r=t,t=null):e&&"object"==typeof e?(r=e,e=t=null):r=U;else if("object"!=typeof r)throw Error(a+"Argument not an object: "+r);if(n=this.toFixed(e,t),this.c){var o,i=n.split("."),s=+r.groupSize,l=+r.secondaryGroupSize,u=r.groupSeparator||"",c=i[0],f=i[1],h=this.s<0,d=h?c.slice(1):c,p=d.length;if(l&&(o=s,s=l,p-=l=o),0<s&&0<p){for(o=p%s||s,c=d.substr(0,o);o<p;o+=s)c+=u+d.substr(o,s);0<l&&(c+=u+d.slice(o)),h&&(c="-"+c)}n=f?c+(r.decimalSeparator||"")+((l=+r.fractionGroupSize)?f.replace(new RegExp("\\d{"+l+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):f):c}return(r.prefix||"")+n+(r.suffix||"")},A.toFraction=function(e){var t,n,o,i,s,l,c,h,d,p,g,m,v=this,_=v.c;if(null!=e&&(!(c=new V(e)).isInteger()&&(c.c||1!==c.s)||c.lt(P)))throw Error(a+"Argument "+(c.isInteger()?"out of range: ":"not an integer: ")+K(c));if(!_)return new V(v);for(t=new V(P),d=n=new V(P),o=h=new V(P),m=y(_),s=t.e=m.length-v.e-1,t.c[0]=f[(l=s%u)<0?u+l:l],e=!e||0<c.comparedTo(t)?0<s?t:d:c,l=x,x=1/0,c=new V(m),h.c[0]=0;p=r(c,t,0,1),1!=(i=n.plus(p.times(o))).comparedTo(e);)n=o,o=i,d=h.plus(p.times(i=d)),h=i,t=c.minus(p.times(i=t)),c=i;return i=r(e.minus(n),o,0,1),h=h.plus(i.times(d)),n=n.plus(i.times(o)),h.s=d.s=v.s,g=r(d,o,s*=2,N).minus(v).abs().comparedTo(r(h,n,s,N).minus(v).abs())<1?[d,o]:[h,n],x=l,g},A.toNumber=function(){return+K(this)},A.toPrecision=function(e,t){return null!=e&&m(e,1,d),W(this,e,t,2)},A.toString=function(e){var t,r=this,n=r.s,o=r.e;return null===o?n?(t="Infinity",n<0&&(t="-"+t)):t="NaN":(t=null==e?o<=M||D<=o?_(y(r.c),o):b(y(r.c),o,"0"):10===e?b(y((r=Y(new V(r),k+o+1,N)).c),r.e,"0"):(m(e,2,B.length,"Base"),C(b(y(r.c),o,"0"),10,e,n,!0)),n<0&&r.c[0]&&(t="-"+t)),t},A.valueOf=A.toJSON=function(){return K(this)},A._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(A[Symbol.toStringTag]="BigNumber",A[Symbol.for("nodejs.util.inspect.custom")]=A.valueOf),null!=t&&V.set(t),V}()).default=r.BigNumber=r,void 0!==t&&t.exports?t.exports=r:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=r)}(this)},{}],2:[function(e,t,r){t.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(e,t,r){function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=e("./globalState"),i=e("./validating"),a=e("./parsing"),s=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],l={general:{scale:1024,suffixes:s,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:s,marker:"d"}},u={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function c(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length?arguments[2]:void 0;if("string"==typeof t&&(t=a.parseFormat(t)),!i.validateFormat(t))return"ERROR: invalid format";var n=t.prefix||"",s=t.postfix||"",c=function(e,t,r){switch(t.output){case"currency":return function(e,t,r){var n=r.currentCurrency(),o=Object.assign({},u,t),i=void 0,a="",s=!!o.totalLength||!!o.forceAverage||o.average,l=t.currencyPosition||n.position,c=t.currencySymbol||n.symbol;o.spaceSeparated&&(a=" "),"infix"===l&&(i=a+c+a);var f=p({instance:e,providedFormat:t,state:r,decimalSeparator:i});return"prefix"===l&&(f=e._value<0&&"sign"===o.negative?"-".concat(a).concat(c).concat(f.slice(1)):c+a+f),l&&"postfix"!==l||(f=f+(a=s?"":a)+c),f}(e,t=y(t,o.currentCurrencyDefaultFormat()),o);case"percent":return function(e,t,r,n){var o=t.prefixSymbol,i=p({instance:n(100*e._value),providedFormat:t,state:r}),a=Object.assign({},u,t);return o?"%".concat(a.spaceSeparated?" ":"").concat(i):"".concat(i).concat(a.spaceSeparated?" ":"","%")}(e,t=y(t,o.currentPercentageDefaultFormat()),o,r);case"byte":return t=y(t,o.currentByteDefaultFormat()),b=e,w=o,E=r,S=(C=t).base||"binary",O=l[S],R=(T=f(b._value,O.suffixes,O.scale)).value,$=T.suffix,I=p({instance:E(R),providedFormat:C,state:w,defaults:w.currentByteDefaultFormat()}),A=w.currentAbbreviations(),"".concat(I).concat(A.spaced?" ":"").concat($);case"time":return t=y(t,o.currentTimeDefaultFormat()),g=e,m=Math.floor(g._value/60/60),v=Math.floor((g._value-60*m*60)/60),_=Math.round(g._value-60*m*60-60*v),"".concat(m,":").concat(v<10?"0":"").concat(v,":").concat(_<10?"0":"").concat(_);case"ordinal":return n=e,i=t=y(t,o.currentOrdinalDefaultFormat()),s=(a=o).currentOrdinal(),c=Object.assign({},u,i),h=p({instance:n,providedFormat:i,state:a}),d=s(n._value),"".concat(h).concat(c.spaceSeparated?" ":"").concat(d);case"number":default:return p({instance:e,providedFormat:t,numbro:r})}var n,i,a,s,c,h,d,g,m,v,_,b,C,w,E,S,O,T,R,$,I,A}(e,t,r);return(c=n+c)+s}function f(e,t,r){var n=t[0],o=Math.abs(e);if(r<=o){for(var i=1;i<t.length;++i){var a=Math.pow(r,i),s=Math.pow(r,i+1);if(a<=o&&o<s){n=t[i],e/=a;break}}n===t[0]&&(e/=Math.pow(r,t.length-1),n=t[t.length-1])}return{value:e,suffix:n}}function h(e){for(var t="",r=0;r<e;r++)t+="0";return t}function d(e,t){return-1!==e.toString().indexOf("e")?function(e,t){var r=e.toString(),o=n(r.split("e"),2),i=o[0],a=o[1],s=n(i.split("."),2),l=s[0],u=s[1],c=void 0===u?"":u;if(0<+a)r=l+c+h(a-c.length);else{var f=".";f=+l<0?"-0".concat(f):"0".concat(f);var d=(h(-a-1)+Math.abs(l)+c).substr(0,t);d.length<t&&(d+=h(t-d.length)),r=f+d}return 0<+a&&0<t&&(r+=".".concat(h(t))),r}(e,t):(Math.round(+"".concat(e,"e+").concat(t))/Math.pow(10,t)).toFixed(t)}function p(e){var t=e.instance,r=e.providedFormat,i=e.state,a=void 0===i?o:i,s=e.decimalSeparator,l=e.defaults,c=void 0===l?a.currentDefaults():l,f=t._value;if(0===f&&a.hasZeroFormat())return a.getZeroFormat();if(!isFinite(f))return f.toString();var h,p,y,g,m,v,_,b,C=Object.assign({},u,c,r),w=C.totalLength,E=w?0:C.characteristic,S=C.optionalCharacteristic,O=C.forceAverage,T=!!w||!!O||C.average,R=w?-1:T&&void 0===r.mantissa?0:C.mantissa,$=!w&&(void 0===r.optionalMantissa?-1===R:C.optionalMantissa),I=C.trimMantissa,A=C.thousandSeparated,P=C.spaceSeparated,k=C.negative,N=C.forceSign,M=C.exponential,D="";if(T){var L=function(e){var t=e.value,r=e.forceAverage,n=e.abbreviations,o=e.spaceSeparated,i=void 0!==o&&o,a=e.totalLength,s=void 0===a?0:a,l="",u=Math.abs(t),c=-1;if(u>=Math.pow(10,12)&&!r||"trillion"===r?(l=n.trillion,t/=Math.pow(10,12)):u<Math.pow(10,12)&&u>=Math.pow(10,9)&&!r||"billion"===r?(l=n.billion,t/=Math.pow(10,9)):u<Math.pow(10,9)&&u>=Math.pow(10,6)&&!r||"million"===r?(l=n.million,t/=Math.pow(10,6)):(u<Math.pow(10,6)&&u>=Math.pow(10,3)&&!r||"thousand"===r)&&(l=n.thousand,t/=Math.pow(10,3)),l&&(l=(i?" ":"")+l),s){var f=t.toString().split(".")[0];c=Math.max(s-f.length,0)}return{value:t,abbreviation:l,mantissaPrecision:c}}({value:f,forceAverage:O,abbreviations:a.currentAbbreviations(),spaceSeparated:P,totalLength:w});f=L.value,D+=L.abbreviation,w&&(R=L.mantissaPrecision)}if(M){var x=(p=(h={value:f,characteristicPrecision:E}).value,g=void 0===(y=h.characteristicPrecision)?0:y,v=(m=n(p.toExponential().split("e"),2))[0],_=m[1],b=+v,g&&1<g&&(b*=Math.pow(10,g-1),_=0<=(_=+_-(g-1))?"+".concat(_):_),{value:b,abbreviation:"e".concat(_)});f=x.value,D=x.abbreviation+D}var H,j,F,U=function(e,t,r,o,i){if(-1===o)return e;var a=d(t,o),s=n(a.toString().split("."),2),l=s[0],u=s[1],c=void 0===u?"":u;if(c.match(/^0+$/)&&(r||i))return l;var f=c.match(/0+$/);return i&&f?"".concat(l,".").concat(c.toString().slice(0,f.index)):a.toString()}(f.toString(),f,$,R,I);return U=function(e,t,r,n,o){var i=n.currentDelimiters(),a=i.thousands;o=o||i.decimal;var s=i.thousandsSize||3,l=e.toString(),u=l.split(".")[0],c=l.split(".")[1];return r&&(t<0&&(u=u.slice(1)),function(e,t){for(var r=[],n=0,o=e;0<o;o--)n===t&&(r.unshift(o),n=0),n++;return r}(u.length,s).forEach((function(e,t){u=u.slice(0,e+t)+a+u.slice(e+t)})),t<0&&(u="-".concat(u))),c?u+o+c:u}(U=function(e,t,r,o){var i=e,a=n(i.toString().split("."),2),s=a[0],l=a[1];if(s.match(/^-?0$/)&&r)return l?"".concat(s.replace("0",""),".").concat(l):s.replace("0","");if(s.length<o)for(var u=o-s.length,c=0;c<u;c++)i="0".concat(i);return i.toString()}(U,0,S,E),f,A,a,s),(T||M)&&(U+=D),(N||f<0)&&(H=U,F=k,U=0===(j=f)?H:0==+H?H.replace("-",""):0<j?"+".concat(H):"sign"===F?H:"(".concat(H.replace("-",""),")")),U}function y(e,t){if(!e)return t;var r=Object.keys(e);return 1===r.length&&"output"===r[0]?t:e}t.exports=function(e){return{format:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return c.apply(void 0,r.concat([e]))},getByteUnit:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return function(e){var t=l.general;return f(e._value,t.suffixes,t.scale).suffix}.apply(void 0,r.concat([e]))},getBinaryByteUnit:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return function(e){var t=l.binary;return f(e._value,t.suffixes,t.scale).suffix}.apply(void 0,r.concat([e]))},getDecimalByteUnit:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return function(e){var t=l.decimal;return f(e._value,t.suffixes,t.scale).suffix}.apply(void 0,r.concat([e]))},formatOrDefault:y}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(e,t,r){var n=e("./en-US"),o=e("./validating"),i=e("./parsing"),a={},s=void 0,l={},u=null,c={};function f(e){s=e}function h(){return l[s]}a.languages=function(){return Object.assign({},l)},a.currentLanguage=function(){return s},a.currentCurrency=function(){return h().currency},a.currentAbbreviations=function(){return h().abbreviations},a.currentDelimiters=function(){return h().delimiters},a.currentOrdinal=function(){return h().ordinal},a.currentDefaults=function(){return Object.assign({},h().defaults,c)},a.currentOrdinalDefaultFormat=function(){return Object.assign({},a.currentDefaults(),h().ordinalFormat)},a.currentByteDefaultFormat=function(){return Object.assign({},a.currentDefaults(),h().byteFormat)},a.currentPercentageDefaultFormat=function(){return Object.assign({},a.currentDefaults(),h().percentageFormat)},a.currentCurrencyDefaultFormat=function(){return Object.assign({},a.currentDefaults(),h().currencyFormat)},a.currentTimeDefaultFormat=function(){return Object.assign({},a.currentDefaults(),h().timeFormat)},a.setDefaults=function(e){e=i.parseFormat(e),o.validateFormat(e)&&(c=e)},a.getZeroFormat=function(){return u},a.setZeroFormat=function(e){return u="string"==typeof e?e:null},a.hasZeroFormat=function(){return null!==u},a.languageData=function(e){if(e){if(l[e])return l[e];throw new Error('Unknown tag "'.concat(e,'"'))}return h()},a.registerLanguage=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!o.validateLanguage(e))throw new Error("Invalid language data");l[e.languageTag]=e,t&&f(e.languageTag)},a.setLanguage=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:n.languageTag;if(!l[e]){var r=e.split("-")[0],o=Object.keys(l).find((function(e){return e.split("-")[0]===r}));return l[o]?void f(o):void f(t)}f(e)},a.registerLanguage(n),s=n.languageTag,t.exports=a},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(e,t,r){t.exports=function(t){return{loadLanguagesInNode:function(r){return n=t,void r.forEach((function(t){var r=void 0;try{r=e("../languages/".concat(t))}catch(r){console.error('Unable to load "'.concat(t,'". No matching language file found.'))}r&&n.registerLanguage(r)}));var n}}}},{}],6:[function(e,t,r){var n=e("bignumber.js");function o(e,t,r){var o=new n(e._value),i=t;return r.isNumbro(t)&&(i=t._value),i=new n(i),e._value=o.minus(i).toNumber(),e}t.exports=function(e){return{add:function(t,r){return i=r,a=e,s=new n((o=t)._value),l=i,a.isNumbro(i)&&(l=i._value),l=new n(l),o._value=s.plus(l).toNumber(),o;var o,i,a,s,l},subtract:function(t,r){return o(t,r,e)},multiply:function(t,r){return i=r,a=e,s=new n((o=t)._value),l=i,a.isNumbro(i)&&(l=i._value),l=new n(l),o._value=s.times(l).toNumber(),o;var o,i,a,s,l},divide:function(t,r){return i=r,a=e,s=new n((o=t)._value),l=i,a.isNumbro(i)&&(l=i._value),l=new n(l),o._value=s.dividedBy(l).toNumber(),o;var o,i,a,s,l},set:function(t,r){return n=t,i=o=r,e.isNumbro(o)&&(i=o._value),n._value=i,n;var n,o,i},difference:function(t,r){return n=r,o(a=(i=e)(t._value),n,i),Math.abs(a._value);var n,i,a}}}},{"bignumber.js":1}],7:[function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=e("./globalState"),i=e("./validating"),a=e("./loading")(d),s=e("./unformatting"),l=e("./formatting")(d),u=e("./manipulating")(d),c=e("./parsing"),f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._value=t}var t;return(t=[{key:"clone",value:function(){return d(this._value)}},{key:"format",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return l.format(this,e)}},{key:"formatCurrency",value:function(e){return"string"==typeof e&&(e=c.parseFormat(e)),(e=l.formatOrDefault(e,o.currentCurrencyDefaultFormat())).output="currency",l.format(this,e)}},{key:"formatTime",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.output="time",l.format(this,e)}},{key:"binaryByteUnits",value:function(){return l.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return l.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return l.getByteUnit(this)}},{key:"difference",value:function(e){return u.difference(this,e)}},{key:"add",value:function(e){return u.add(this,e)}},{key:"subtract",value:function(e){return u.subtract(this,e)}},{key:"multiply",value:function(e){return u.multiply(this,e)}},{key:"divide",value:function(e){return u.divide(this,e)}},{key:"set",value:function(e){return u.set(this,h(e))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&n(e.prototype,t),e}();function h(e){var t=e;return d.isNumbro(e)?t=e._value:"string"==typeof e?t=d.unformat(e):isNaN(e)&&(t=NaN),t}function d(e){return new f(h(e))}d.version="2.1.2",d.isNumbro=function(e){return e instanceof f},d.language=o.currentLanguage,d.registerLanguage=o.registerLanguage,d.setLanguage=o.setLanguage,d.languages=o.languages,d.languageData=o.languageData,d.zeroFormat=o.setZeroFormat,d.defaultFormat=o.currentDefaults,d.setDefaults=o.setDefaults,d.defaultCurrencyFormat=o.currentCurrencyDefaultFormat,d.validate=i.validate,d.loadLanguagesInNode=a.loadLanguagesInNode,d.unformat=s.unformat,t.exports=d},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(e,t,r){t.exports={parseFormat:function(e){var t,r,n,o,i,a,s,l,u,c,f,h,d,p,y,g,m,v,_,b,C=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof e?e:(r=C,i=C,function(e,t){if(-1===e.indexOf("$")){if(-1===e.indexOf("%"))return-1!==e.indexOf("bd")?(t.output="byte",t.base="general"):-1!==e.indexOf("b")?(t.output="byte",t.base="binary"):-1!==e.indexOf("d")?(t.output="byte",t.base="decimal"):-1===e.indexOf(":")?-1!==e.indexOf("o")&&(t.output="ordinal"):t.output="time";t.output="percent"}else t.output="currency"}(e=(a=(o=e=(n=(t=e).match(/^{([^}]*)}/))?(r.prefix=n[1],t.slice(n[0].length)):t).match(/{([^}]*)}$/))?(i.postfix=a[1],o.slice(0,-a[0].length)):o,C),s=C,(l=e.match(/[1-9]+[0-9]*/))&&(s.totalLength=+l[0]),u=C,(c=e.split(".")[0].match(/0+/))&&(u.characteristic=c[0].length),function(e,t){if(-1!==e.indexOf(".")){var r=e.split(".")[0];t.optionalCharacteristic=-1===r.indexOf("0")}}(e,C),f=C,-1!==e.indexOf("a")&&(f.average=!0),d=C,-1!==(h=e).indexOf("K")?d.forceAverage="thousand":-1!==h.indexOf("M")?d.forceAverage="million":-1!==h.indexOf("B")?d.forceAverage="billion":-1!==h.indexOf("T")&&(d.forceAverage="trillion"),function(e,t){var r=e.split(".")[1];if(r){var n=r.match(/0+/);n&&(t.mantissa=n[0].length)}}(e,C),y=C,(p=e).match(/\[\.]/)?y.optionalMantissa=!0:p.match(/\./)&&(y.optionalMantissa=!1),g=C,-1!==e.indexOf(",")&&(g.thousandSeparated=!0),m=C,-1!==e.indexOf(" ")&&(m.spaceSeparated=!0),_=C,(v=e).match(/^\+?\([^)]*\)$/)&&(_.negative="parenthesis"),v.match(/^\+?-/)&&(_.negative="sign"),b=C,e.match(/^\+/)&&(b.forceSign=!0),C)}}},{}],9:[function(e,t,r){var n=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function o(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function i(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",i=3<arguments.length?arguments[3]:void 0,a=4<arguments.length?arguments[4]:void 0,s=5<arguments.length?arguments[5]:void 0,l=6<arguments.length?arguments[6]:void 0;if(""!==e)return e===a?0:function e(t,r){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",a=3<arguments.length?arguments[3]:void 0,s=4<arguments.length?arguments[4]:void 0,l=5<arguments.length?arguments[5]:void 0,u=6<arguments.length?arguments[6]:void 0;if(!isNaN(+t))return+t;var c="",f=t.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(f!==t)return-1*e(f,r,i,a,s,l,u);for(var h=0;h<n.length;h++){var d=n[h];if((c=t.replace(d.key,""))!==t)return e(c,r,i,a,s,l,u)*d.factor}if((c=t.replace("%",""))!==t)return e(c,r,i,a,s,l,u)/100;var p=parseFloat(t);if(!isNaN(p)){var y=a(p);if(y&&"."!==y&&(c=t.replace(new RegExp("".concat(o(y),"$")),""))!==t)return e(c,r,i,a,s,l,u);var g={};Object.keys(l).forEach((function(e){g[l[e]]=e}));for(var m=Object.keys(g).sort().reverse(),v=m.length,_=0;_<v;_++){var b=m[_],C=g[b];if((c=t.replace(b,""))!==t){var w=void 0;switch(C){case"thousand":w=Math.pow(10,3);break;case"million":w=Math.pow(10,6);break;case"billion":w=Math.pow(10,9);break;case"trillion":w=Math.pow(10,12)}return e(c,r,i,a,s,l,u)*w}}}}(function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",n=e.replace(r,"");return(n=n.replace(new RegExp("([0-9])".concat(o(t.thousands),"([0-9])"),"g"),"$1$2")).replace(t.decimal,".")}(e,t,r),t,r,i,a,s,l)}t.exports={unformat:function(t,r){var n,o,a,s=e("./globalState"),l=s.currentDelimiters(),u=s.currentCurrency().symbol,c=s.currentOrdinal(),f=s.getZeroFormat(),h=s.currentAbbreviations(),d=void 0;if("string"==typeof t)d=function(e,t){if(!e.indexOf(":")||":"===t.thousands)return!1;var r=e.split(":");if(3!==r.length)return!1;var n=+r[0],o=+r[1],i=+r[2];return!isNaN(n)&&!isNaN(o)&&!isNaN(i)}(t,l)?(o=+(n=t.split(":"))[0],a=+n[1],+n[2]+60*a+3600*o):i(t,l,u,c,f,h,r);else{if("number"!=typeof t)return;d=t}if(void 0!==d)return d}}},{"./globalState":4}],10:[function(e,t,r){function n(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=e("./unformatting"),a=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,s={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(e,t){return"byte"===t.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(e){return"byte"===e.output}},characteristic:{type:"number",restriction:function(e){return 0<=e},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(e){return 0<=e},message:"value must be positive"},{restriction:function(e,t){return!t.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(e){return 0<=e},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(e,t){return"percent"===t.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},l={languageTag:{type:"string",mandatory:!0,restriction:function(e){return e.match(a)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function u(e){return!!i.unformat(e)}function c(e,t,r){var i=3<arguments.length&&void 0!==arguments[3]&&arguments[3],a=Object.keys(e).map((function(n){if(!t[n])return console.error("".concat(r," Invalid key: ").concat(n)),!1;var i=e[n],a=t[n];if("string"==typeof a&&(a={type:a}),"format"===a.type){if(!c(i,s,"[Validate ".concat(n,"]"),!0))return!1}else if(o(i)!==a.type)return console.error("".concat(r," ").concat(n,' type mismatched: "').concat(a.type,'" expected, "').concat(o(i),'" provided')),!1;if(a.restrictions&&a.restrictions.length)for(var l=a.restrictions.length,u=0;u<l;u++){var f=a.restrictions[u],h=f.restriction,d=f.message;if(!h(i,e))return console.error("".concat(r," ").concat(n," invalid value: ").concat(d)),!1}return a.restriction&&!a.restriction(i,e)?(console.error("".concat(r," ").concat(n," invalid value: ").concat(a.message)),!1):a.validValues&&-1===a.validValues.indexOf(i)?(console.error("".concat(r," ").concat(n," invalid value: must be among ").concat(JSON.stringify(a.validValues),', "').concat(i,'" provided')),!1):!(a.children&&!c(i,a.children,"[Validate ".concat(n,"]")))}));return i||a.push.apply(a,n(Object.keys(t).map((function(n){var o=t[n];if("string"==typeof o&&(o={type:o}),o.mandatory){var i=o.mandatory;if("function"==typeof i&&(i=i(e)),i&&void 0===e[n])return console.error("".concat(r,' Missing mandatory key "').concat(n,'"')),!1}return!0})))),a.reduce((function(e,t){return e&&t}),!0)}function f(e){return c(e,s,"[Validate format]")}t.exports={validate:function(e,t){var r=u(e),n=f(t);return r&&n},validateFormat:f,validateInput:u,validateLanguage:function(e){return c(e,l,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)}));function _typeof$n(e){return(_typeof$n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function isNumeric(e){var t=_typeof$n(e);return"number"==t?!isNaN(e)&&isFinite(e):"string"==t?!!e.length&&(1==e.length?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e)):"object"==t&&!(!e||"number"!=typeof e.valueOf()||e instanceof Date)}function rangeEach(e,t,r){var n=-1;for("function"==typeof t?(r=t,t=e):n=e-1;++n<=t&&!1!==r(n););}function rangeEachReverse(e,t,r){var n=e+1;for("function"==typeof t&&(r=t,t=0);--n>=t&&!1!==r(n););}function valueAccordingPercent(e,t){return t=parseInt(t.toString().replace("%",""),10),t=parseInt(e*t/100,10)}var numberHelpers=Object.freeze({__proto__:null,isNumeric:isNumeric,rangeEach:rangeEach,rangeEachReverse:rangeEachReverse,valueAccordingPercent:valueAccordingPercent});function numericRenderer(e,t,r,n,o,i,a){var s=i;if(isNumeric(s)){var l=a.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,f=a.className||"",h=f.length?f.split(" "):[];if(void 0!==u&&!numbro_min.languages()[u]){var d=u.replace("-",""),p=numbro_min.allLanguages?numbro_min.allLanguages[u]:numbro_min[d];p&&numbro_min.registerLanguage(p)}numbro_min.setLanguage(u),s=numbro_min(s).format(c||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" ")}_getItem("text")(e,t,r,n,o,s,a)}function passwordRenderer(e,t,r,n,o,i,a){_getItem("text").apply(this,[e,t,r,n,o,i,a]);var s=a.hashLength||t.innerHTML.length,l=a.hashSymbol||"*",u="";rangeEach(s-1,(function(){u+=l})),fastInnerHTML(t,u)}function textRenderer(e,t,r,n,o,i,a){_getItem("base").apply(this,[e,t,r,n,o,i,a]);var s=i;if(!s&&a.placeholder&&(s=a.placeholder),s=stringify(s),e.getSettings().trimWhitespace||e.getSettings().wordWrap||(s=s.replace(/ /g,String.fromCharCode(160))),a.rendererTemplate){empty$1(t);var l=e.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=e.getSourceDataAtRow(r),t.appendChild(l)}else fastInnerText(t,s)}var _staticRegister=staticRegister("renderers"),register=_staticRegister.register,getItem=_staticRegister.getItem,hasItem=_staticRegister.hasItem,getNames=_staticRegister.getNames;function _getItem(e){if("function"==typeof e)return e;if(!hasItem(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return getItem(e)}register("base",cellDecorator),register("autocomplete",autocompleteRenderer),register("checkbox",checkboxRenderer),register("html",htmlRenderer),register("numeric",numericRenderer),register("password",passwordRenderer),register("text",textRenderer);var autoResize_1=createCommonjsModule((function(e,t){e.exports=function(){var e,t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},r=document.body,n=document.createTextNode(""),o=document.createElement("SPAN"),i=function(e,t,r){e.addEventListener(t,r,!1)},a=function(e,t,r){e.removeEventListener(t,r,!1)},s=function(i){var a,s;i?/^[a-zA-Z \.,\\\/\|0-9]$/.test(i)||(i="."):i="",void 0!==n.textContent?n.textContent=e.value+i:n.data=e.value+i,o.style.fontSize=c(e).fontSize,o.style.fontFamily=c(e).fontFamily,o.style.whiteSpace="pre",r.appendChild(o),a=o.clientWidth+2,r.removeChild(o),e.style.height=t.minHeight+"px",t.minWidth>a?e.style.width=t.minWidth+"px":a>t.maxWidth?e.style.width=t.maxWidth+"px":e.style.width=a+"px",s=e.scrollHeight?e.scrollHeight-1:0,t.minHeight>s?e.style.height=t.minHeight+"px":t.maxHeight<s?(e.style.height=t.maxHeight+"px",e.style.overflowY="visible"):e.style.height=s+"px"},l=function(){window.setTimeout(s,0)},u=function(r,a,u){e=r,function(r){if(r&&r.minHeight)if("inherit"==r.minHeight)t.minHeight=e.clientHeight;else{var i=parseInt(r.minHeight);isNaN(i)||(t.minHeight=i)}if(r&&r.maxHeight)if("inherit"==r.maxHeight)t.maxHeight=e.clientHeight;else{var a=parseInt(r.maxHeight);isNaN(a)||(t.maxHeight=a)}if(r&&r.minWidth)if("inherit"==r.minWidth)t.minWidth=e.clientWidth;else{var s=parseInt(r.minWidth);isNaN(s)||(t.minWidth=s)}if(r&&r.maxWidth)if("inherit"==r.maxWidth)t.maxWidth=e.clientWidth;else{var l=parseInt(r.maxWidth);isNaN(l)||(t.maxWidth=l)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(n))}(a),"TEXTAREA"==e.nodeName&&(e.style.resize="none",e.style.overflowY="",e.style.height=t.minHeight+"px",e.style.minWidth=t.minWidth+"px",e.style.maxWidth=t.maxWidth+"px",e.style.overflowY="hidden"),u&&(i(e,"change",s),i(e,"cut",l),i(e,"paste",l),i(e,"drop",l),i(e,"keydown",l),i(e,"focus",s),i(e,"compositionstart",l),i(e,"compositionupdate",l),i(e,"compositionend",l)),s()};function c(e){return e.currentStyle||document.defaultView.getComputedStyle(e)}return{init:function(e,t,r){u(e,t,r)},unObserve:function(){a(e,"change",s),a(e,"cut",l),a(e,"paste",l),a(e,"drop",l),a(e,"keydown",l),a(e,"focus",s),a(e,"compositionstart",l),a(e,"compositionupdate",l),a(e,"compositionend",l)},resize:s}}}));function _typeof$o(e){return(_typeof$o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$E(e,t,r){return t&&_defineProperties$E(e.prototype,t),r&&_defineProperties$E(e,r),e}function _get(e,t,r){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$i(e)););return e}function _inherits$i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$i(e,t)}function _setPrototypeOf$i(e,t){return(_setPrototypeOf$i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$i(e){var t=_isNativeReflectConstruct$i();return function(){var r,n=_getPrototypeOf$i(e);if(t){var o=_getPrototypeOf$i(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$i(this,r)}}function _possibleConstructorReturn$i(e,t){return!t||"object"!==_typeof$o(t)&&"function"!=typeof t?_assertThisInitialized$i(e):t}function _assertThisInitialized$i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$i(e){return(_getPrototypeOf$i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var EDITOR_VISIBLE_CLASS_NAME="ht_editor_visible",EDITOR_HIDDEN_CLASS_NAME="ht_editor_hidden",TextEditor=function(e){_inherits$i(r,e);var t=_createSuper$i(r);function r(e){var n;return _classCallCheck$J(this,r),(n=t.call(this,e)).eventManager=new EventManager(_assertThisInitialized$i(n)),n.autoResize=autoResize_1(),n.TEXTAREA=void 0,n.textareaStyle=void 0,n.TEXTAREA_PARENT=void 0,n.textareaParentStyle=void 0,n.layerClass=void 0,n.createElements(),n.bindEvents(),n.hot.addHookOnce("afterDestroy",(function(){return n.destroy()})),n}return _createClass$E(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(e){this.TEXTAREA.value=e}},{key:"open",value:function(){var e=this;this.refreshDimensions(),this.showEditableElement(),this.addHook("beforeKeyDown",(function(t){return e.onBeforeKeyDown(t)}))}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.removeHooksByKey("beforeKeyDown")}},{key:"prepare",value:function(e,t,n,o,i,a){var s=this.state;if(_get(_getPrototypeOf$i(r.prototype),"prepare",this).call(this,e,t,n,o,i,a),!a.readOnly){this.refreshDimensions(!0);var l=a.allowInvalid,u=a.fragmentSelection;l&&(this.TEXTAREA.value=""),s!==EditorState.FINISHED&&this.hideEditableElement(),!u&&!isMobileBrowser()&&this.focus()}}},{key:"beginEditing",value:function(e,t){this.state===EditorState.VIRGIN&&(this.TEXTAREA.value="",_get(_getPrototypeOf$i(r.prototype),"beginEditing",this).call(this,e,t))}},{key:"focus",value:function(){this.TEXTAREA.select(),setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var e=this.hot.rootDocument;this.TEXTAREA=e.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,addClass(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),addClass(this.TEXTAREA_PARENT,"handsontableInputHolder"),hasClass(this.TEXTAREA_PARENT,this.layerClass)&&removeClass(this.TEXTAREA_PARENT,this.layerClass),addClass(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(isIE()||isEdge())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",hasClass(this.TEXTAREA_PARENT,this.layerClass)&&removeClass(this.TEXTAREA_PARENT,this.layerClass),addClass(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle.right="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var e=this.TEXTAREA_PARENT.childNodes,t=!1;rangeEach(e.length-1,(function(r){if(hasClass(e[r],"handsontableEditor"))return t=!0,!1})),hasClass(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME)&&removeClass(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME),t?(this.layerClass=EDITOR_VISIBLE_CLASS_NAME,addClass(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),addClass(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state===EditorState.EDITING||e)if(this.TD=this.getEditedCell(),this.TD){var t,r=this.hot.view.wt,n=r.wtOverlays,o=r.wtViewport,i=offset(this.TD),a=offset(this.hot.rootElement),s=n.topOverlay.holder,l=n.leftOverlay.holder,u=s!==this.hot.rootWindow?s.scrollTop:0,c=l!==this.hot.rootWindow?l.scrollLeft:0,f=this.checkEditorSection(),h=["","left"].includes(f)?u:0,d=["","top","bottom"].includes(f)?c:0,p=i.top===a.top?0:1,y=this.TD.style.backgroundColor,g=i.top-a.top-p-h,m=i.left-a.left-1-d;switch(f){case"top":t=getCssTransform(n.topOverlay.clone.wtTable.holder.parentNode);break;case"left":t=getCssTransform(n.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":t=getCssTransform(n.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":t=getCssTransform(n.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":t=getCssTransform(n.bottomOverlay.clone.wtTable.holder.parentNode)}var v=this.hot.hasColHeaders(),_=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),b=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),C=this.hot.rowIndexMapper.getRenderableIndexesLength(),w=C-this.hot.view.wt.getSetting("fixedRowsBottom");(v&&_<=0||_===w)&&(g+=1),b<=0&&(m+=1),t&&-1!==t?this.textareaParentStyle[t[0]]=t[1]:resetCssTransform(this.TEXTAREA_PARENT),this.textareaParentStyle.top="".concat(g,"px"),this.textareaParentStyle.left="".concat(m,"px"),this.showEditableElement();var E=o.rowsRenderCalculator.startPosition,S=o.columnsRenderCalculator.startPosition,O=n.leftOverlay.getScrollPosition(),T=n.topOverlay.getScrollPosition(),R=getScrollbarWidth(this.hot.rootDocument),$=this.TD.offsetTop+E-T,I=this.TD.offsetLeft+S-O,A=innerWidth(this.TD)-8,P=hasVerticalScrollbar(s)?R:0,k=hasHorizontalScrollbar(l)?R:0,N=this.hot.view.maximumVisibleElementWidth(I)-9-P,M=this.TD.scrollHeight+1,D=Math.max(this.hot.view.maximumVisibleElementHeight($)-k,23),L=getComputedStyle(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=L.fontSize,this.TEXTAREA.style.fontFamily=L.fontFamily,this.TEXTAREA.style.backgroundColor=y,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(M,D),maxHeight:D,minWidth:Math.min(A,N),maxWidth:N},!0)}else e||this.close()}},{key:"bindEvents",value:function(){var e=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",(function(e){return e.stopPropagation()})),this.eventManager.addEventListener(this.TEXTAREA,"paste",(function(e){return e.stopPropagation()})),this.addHook("afterScrollHorizontally",(function(){return e.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return e.refreshDimensions()})),this.addHook("afterColumnResize",(function(){e.refreshDimensions(),e.focus()})),this.addHook("afterRowResize",(function(){e.refreshDimensions(),e.focus()}))}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"onBeforeKeyDown",value:function(e){var t=(e.ctrlKey||e.metaKey)&&!e.altKey;if(e.target===this.TEXTAREA&&!isImmediatePropagationStopped(e)){switch(e.keyCode){case KEY_CODES.ARROW_RIGHT:case KEY_CODES.ARROW_LEFT:this.isInFullEditMode()&&(this.isWaiting()||this.allowKeyEventPropagation(e.keyCode)||stopImmediatePropagation(e));break;case KEY_CODES.ARROW_UP:case KEY_CODES.ARROW_DOWN:this.isInFullEditMode()&&(this.isWaiting()||this.allowKeyEventPropagation(e.keyCode)||stopImmediatePropagation(e));break;case KEY_CODES.ENTER:var r=this.hot.selection.isMultiple();if(t&&!r||e.altKey){if(this.isOpened()){var n=getCaretPosition(this.TEXTAREA),o=this.getValue(),i="".concat(o.slice(0,n),"\n").concat(o.slice(n));this.setValue(i),setCaretPosition(this.TEXTAREA,n+1)}else this.beginEditing("".concat(this.originalValue,"\n"));stopImmediatePropagation(e)}e.preventDefault();break;case KEY_CODES.BACKSPACE:case KEY_CODES.DELETE:case KEY_CODES.HOME:case KEY_CODES.END:stopImmediatePropagation(e)}-1===[KEY_CODES.ARROW_UP,KEY_CODES.ARROW_RIGHT,KEY_CODES.ARROW_DOWN,KEY_CODES.ARROW_LEFT].indexOf(e.keyCode)&&this.autoResize.resize(String.fromCharCode(e.keyCode))}}}]),r}(BaseEditor);function _typeof$p(e){return(_typeof$p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$K(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$F(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$F(e,t,r){return t&&_defineProperties$F(e.prototype,t),r&&_defineProperties$F(e,r),e}function _get$1(e,t,r){return(_get$1="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$1(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$1(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$j(e)););return e}function _inherits$j(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$j(e,t)}function _setPrototypeOf$j(e,t){return(_setPrototypeOf$j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$j(e){var t=_isNativeReflectConstruct$j();return function(){var r,n=_getPrototypeOf$j(e);if(t){var o=_getPrototypeOf$j(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$j(this,r)}}function _possibleConstructorReturn$j(e,t){return!t||"object"!==_typeof$p(t)&&"function"!=typeof t?_assertThisInitialized$j(e):t}function _assertThisInitialized$j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$j(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$j(e){return(_getPrototypeOf$j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var HandsontableEditor=function(e){_inherits$j(r,e);var t=_createSuper$j(r);function r(){return _classCallCheck$K(this,r),t.apply(this,arguments)}return _createClass$F(r,[{key:"open",value:function(){_get$1(_getPrototypeOf$j(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),setCaretPosition(this.TEXTAREA,0,this.TEXTAREA.value.length)}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),_get$1(_getPrototypeOf$j(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(e,t,n,o,i,a){_get$1(_getPrototypeOf$j(r.prototype),"prepare",this).call(this,e,t,n,o,i,a);var s=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(e,t){var r=this.getSourceData(t.row,t.col);void 0!==r&&s.setValue(r),s.instance.destroyEditor()},preventWheel:!0};this.cellProperties.handsontable&&extend(l,a.handsontable),this.htOptions=l}},{key:"beginEditing",value:function(e,t){var n=this.hot.getSettings().onBeginEditing;n&&!1===n()||_get$1(_getPrototypeOf$j(r.prototype),"beginEditing",this).call(this,e,t)}},{key:"createElements",value:function(){_get$1(_getPrototypeOf$j(r.prototype),"createElements",this).call(this);var e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}},{key:"finishEditing",value:function(e,t,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var o=this.htEditor.getInstance().getValue();void 0!==o&&this.setValue(o)}_get$1(_getPrototypeOf$j(r.prototype),"finishEditing",this).call(this,e,t,n)}},{key:"assignHooks",value:function(){var e=this;this.hot.addHook("afterDestroy",(function(){e.htEditor&&e.htEditor.destroy()}))}},{key:"onBeforeKeyDown",value:function(e){if(!isImmediatePropagationStopped(e)){var t,n,o=this.htEditor.getInstance();if(e.keyCode===KEY_CODES.ARROW_DOWN)if(o.getSelectedLast()||o.flipped){if(o.getSelectedLast())if(o.flipped)t=o.getSelectedLast()[0]+1;else if(!o.flipped){var i=o.countRows()-1;n=o.getSelectedLast()[0],t=Math.min(i,n+1)}}else t=0;else e.keyCode===KEY_CODES.ARROW_UP&&(!o.getSelectedLast()&&o.flipped?t=o.countRows()-1:o.getSelectedLast()&&(o.flipped?(n=o.getSelectedLast()[0],t=Math.max(0,n-1)):t=(n=o.getSelectedLast()[0])-1));void 0!==t&&(t<0||o.flipped&&t>o.countRows()-1?o.deselectCell():o.selectCell(t,0),o.getData().length&&(e.preventDefault(),stopImmediatePropagation(e),this.hot.listen(),this.TEXTAREA.focus())),_get$1(_getPrototypeOf$j(r.prototype),"onBeforeKeyDown",this).call(this,e)}}}]),r}(TextEditor);function _typeof$q(e){return(_typeof$q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$G(e,t,r){return t&&_defineProperties$G(e.prototype,t),r&&_defineProperties$G(e,r),e}function _get$2(e,t,r){return(_get$2="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$2(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$2(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$k(e)););return e}function _inherits$k(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$k(e,t)}function _setPrototypeOf$k(e,t){return(_setPrototypeOf$k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$k(e){var t=_isNativeReflectConstruct$k();return function(){var r,n=_getPrototypeOf$k(e);if(t){var o=_getPrototypeOf$k(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$k(this,r)}}function _possibleConstructorReturn$k(e,t){return!t||"object"!==_typeof$q(t)&&"function"!=typeof t?_assertThisInitialized$k(e):t}function _assertThisInitialized$k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$k(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$k(e){return(_getPrototypeOf$k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var privatePool$3=new WeakMap,AutocompleteEditor=function(e){_inherits$k(r,e);var t=_createSuper$k(r);function r(e){var n;return _classCallCheck$L(this,r),(n=t.call(this,e)).query=null,n.strippedChoices=[],n.rawChoices=[],privatePool$3.set(_assertThisInitialized$k(n),{skipOne:!1,isMacOS:n.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),n}return _createClass$G(r,[{key:"getValue",value:function(){var e=this,t=this.rawChoices.find((function(t){return e.stripValueIfNeeded(t)===e.TEXTAREA.value}));return isDefined(t)?t:this.TEXTAREA.value}},{key:"createElements",value:function(){_get$2(_getPrototypeOf$k(r.prototype),"createElements",this).call(this),addClass(this.htContainer,"autocompleteEditor"),addClass(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll")}},{key:"open",value:function(){var e=this,t=privatePool$3.get(this);this.TEXTAREA_PARENT.style.overflow="auto",_get$2(_getPrototypeOf$k(r.prototype),"open",this).call(this),this.TEXTAREA_PARENT.style.overflow="";var n=this.htEditor.getInstance(),o=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var i=getScrollbarWidth();0===i&&t.isMacOS&&(i+=15),n.updateSettings({colWidths:o?[outerWidth(this.TEXTAREA)-2]:void 0,width:o?outerWidth(this.TEXTAREA)+i:void 0,renderer:function(t,r,n,o,i,a,s){_getItem("text")(t,r,n,o,i,a,s);var l,u,c=e.cellProperties,f=c.filteringCaseSensitive,h=c.allowHtml,d=e.query,p=stringify(a);p&&!h&&-1!==(l=!0===f?p.indexOf(d):p.toLowerCase().indexOf(d.toLowerCase()))&&(u=p.substr(l,d.length),p=p.replace(u,"<strong>".concat(u,"</strong>"))),r.innerHTML=p},autoColumnSize:!0}),t.skipOne&&(t.skipOne=!1),this.hot._registerTimeout((function(){e.queryChoices(e.TEXTAREA.value)}))}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),_get$2(_getPrototypeOf$k(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(e){_get$2(_getPrototypeOf$k(r.prototype),"discardEditor",this).call(this,e),this.hot.view.render()}},{key:"queryChoices",value:function(e){var t=this,r=this.cellProperties.source;this.query=e,"function"==typeof r?r.call(this.cellProperties,e,(function(e){t.rawChoices=e,t.updateChoicesList(t.stripValuesIfNeeded(e))})):Array.isArray(r)?(this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(e){var t=getCaretPosition(this.TEXTAREA),n=getSelectionEndPosition(this.TEXTAREA),o=this.cellProperties.sortByRelevance,i=this.cellProperties.filter,a=null,s=null,l=e;o&&(a=r.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));var u=Array.isArray(a)?a.length:0;if(!1===i)u&&(s=a[0]);else{for(var c=[],f=0,h=l.length;f<h&&!(o&&u<=f);f++)u?c.push(l[a[f]]):c.push(l[f]);s=0,l=c}this.strippedChoices=l,this.htEditor.loadData(pivot([l])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(s),this.hot.listen(),setCaretPosition(this.TEXTAREA,t,t===n?void 0:n)}},{key:"flipDropdownIfNeeded",value:function(){var e=offset(this.TEXTAREA),t=outerHeight(this.TEXTAREA),r=this.getDropdownHeight(),n=getTrimmingContainer(this.hot.view.wt.wtTable.TABLE),o=n.scrollTop,i=outerHeight(this.hot.view.wt.wtTable.THEAD),a={row:0,col:0};n!==this.hot.rootWindow&&(a=offset(n));var s=e.top-a.top-i+o,l=n.scrollHeight-s-i-t,u=r>l&&s>l;return u?this.flipDropdown(r):this.unflipDropdown(),this.limitDropdownIfNeeded(u?s:l,r),u}},{key:"limitDropdownIfNeeded",value:function(e,t){if(t>e){var r,n=0,o=0,i=0;do{n+=i=this.htEditor.getRowHeight(o)||this.htEditor.view.wt.wtSettings.settings.defaultRowHeight,o+=1}while(n<e);r=n-i,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+t-r,"px")),this.setDropdownHeight(n-i)}}},{key:"flipDropdown",value:function(e){var t=this.htEditor.rootElement.style;t.position="absolute",t.top="".concat(-e,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var e=this.htEditor.rootElement.style;"absolute"===e.position&&(e.position="",e.top=""),this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var e=this.htEditor.getColWidth(0)+getScrollbarWidth(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(e){this.htEditor.updateSettings({height:e})}},{key:"highlightBestMatchingChoice",value:function(e){"number"==typeof e?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var e=this.htEditor.getInstance().getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}},{key:"stripValueIfNeeded",value:function(e){return this.stripValuesIfNeeded([e])[0]}},{key:"stripValuesIfNeeded",value:function(e){var t=this.cellProperties.allowHtml,r=arrayMap(e,(function(e){return stringify(e)}));return arrayMap(r,(function(e){return t?e:stripTags(e)}))}},{key:"allowKeyEventPropagation",value:function(e){var t=this.htEditor.getSelectedRangeLast(),r=t?t.from.row:-1,n=!1;return e===KEY_CODES.ARROW_DOWN&&r>0&&r<this.htEditor.countRows()-1&&(n=!0),e===KEY_CODES.ARROW_UP&&r>-1&&(n=!0),n}},{key:"onBeforeKeyDown",value:function(e){var t=this,n=privatePool$3.get(this);if(n.skipOne=!1,isPrintableChar(e.keyCode)||e.keyCode===KEY_CODES.BACKSPACE||e.keyCode===KEY_CODES.DELETE||e.keyCode===KEY_CODES.INSERT){var o=0;if(e.keyCode===KEY_CODES.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(o+=10),this.htEditor&&this.hot._registerTimeout((function(){t.queryChoices(t.TEXTAREA.value),n.skipOne=!0}),o)}_get$2(_getPrototypeOf$k(r.prototype),"onBeforeKeyDown",this).call(this,e)}}]),r}(HandsontableEditor);function _typeof$r(e){return(_typeof$r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$M(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$H(e,t,r){return t&&_defineProperties$H(e.prototype,t),r&&_defineProperties$H(e,r),e}function _inherits$l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$l(e,t)}function _setPrototypeOf$l(e,t){return(_setPrototypeOf$l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$l(e){var t=_isNativeReflectConstruct$l();return function(){var r,n=_getPrototypeOf$l(e);if(t){var o=_getPrototypeOf$l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$l(this,r)}}function _possibleConstructorReturn$l(e,t){return!t||"object"!==_typeof$r(t)&&"function"!=typeof t?_assertThisInitialized$l(e):t}function _assertThisInitialized$l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$l(e){return(_getPrototypeOf$l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}AutocompleteEditor.sortByRelevance=function(e,t,r){var n,o,i,a,s=[],l=e.length,u=[],c=t.length;if(0===l){for(a=0;a<c;a++)u.push(a);return u}for(a=0;a<c;a++)n=stripTags(stringify(t[a])),-1!==(o=r?n.indexOf(e):n.toLowerCase().indexOf(e.toLowerCase()))&&(i=n.length-o-l,s.push({baseIndex:a,index:o,charsLeft:i,value:n}));for(s.sort((function(e,t){if(-1===t.index)return-1;if(-1===e.index)return 1;if(e.index<t.index)return-1;if(t.index<e.index)return 1;if(e.index===t.index){if(e.charsLeft<t.charsLeft)return-1;if(e.charsLeft>t.charsLeft)return 1}return 0})),a=0,c=s.length;a<c;a++)u.push(s[a].baseIndex);return u};var CheckboxEditor=function(e){_inherits$l(r,e);var t=_createSuper$l(r);function r(){return _classCallCheck$M(this,r),t.apply(this,arguments)}return _createClass$H(r,[{key:"beginEditing",value:function(e,t){if(t&&"mouseup"===t.type){var r=this.TD.querySelector('input[type="checkbox"]');hasClass(r,"htBadValue")||r.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}]),r}(BaseEditor),pikaday=createCommonjsModule((function(e,t){
/*!
     * Pikaday
     *
     * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
     */
!function(t,r){var n;try{n=moment}catch(e){}e.exports=function(e){var t="function"==typeof e,r=!!window.addEventListener,n=window.document,o=window.setTimeout,i=function(e,t,n,o){r?e.addEventListener(t,n,!!o):e.attachEvent("on"+t,n)},a=function(e,t,n,o){r?e.removeEventListener(t,n,!!o):e.detachEvent("on"+t,n)},s=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},l=function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},u=function(e,t){l(e,t)||(e.className=""===e.className?t:e.className+" "+t)},c=function(e,t){e.className=s((" "+e.className+" ").replace(" "+t+" "," "))},f=function(e){return/Array/.test(Object.prototype.toString.call(e))},h=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},d=function(e){var t=e.getDay();return 0===t||6===t},p=function(e){return e%4==0&&e%100!=0||e%400==0},y=function(e,t){return[31,p(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},g=function(e){h(e)&&e.setHours(0,0,0,0)},m=function(e,t){return e.getTime()===t.getTime()},v=function(e,t,r){var n,o;for(n in t)(o=void 0!==e[n])&&"object"==typeof t[n]&&null!==t[n]&&void 0===t[n].nodeName?h(t[n])?r&&(e[n]=new Date(t[n].getTime())):f(t[n])?r&&(e[n]=t[n].slice(0)):e[n]=v({},t[n],r):!r&&o||(e[n]=t[n]);return e},_=function(e,t,r){var o;n.createEvent?((o=n.createEvent("HTMLEvents")).initEvent(t,!0,!1),o=v(o,r),e.dispatchEvent(o)):n.createEventObject&&(o=n.createEventObject(),o=v(o,r),e.fireEvent("on"+t,o))},b=function(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),e.month>11&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e},C={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},w=function(e,t,r){for(t+=e.firstDay;t>=7;)t-=7;return r?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},E=function(e){var t=[],r="false";if(e.isEmpty){if(!e.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';t.push("is-outside-current-month"),e.enableSelectionDaysInNextAndPreviousMonths||t.push("is-selection-disabled")}return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),r="true"),e.hasEvent&&t.push("has-event"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+r+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"},S=function(e,t,r){var n=new Date(r,0,1);return'<td class="pika-week">'+Math.ceil(((new Date(r,t,e)-n)/864e5+n.getDay()+1)/7)+"</td>"},O=function(e,t,r,n){return'<tr class="pika-row'+(r?" pick-whole-week":"")+(n?" is-selected":"")+'">'+(t?e.reverse():e).join("")+"</tr>"},T=function(e){return"<tbody>"+e.join("")+"</tbody>"},R=function(e){var t,r=[];for(e.showWeekNumber&&r.push("<th></th>"),t=0;t<7;t++)r.push('<th scope="col"><abbr title="'+w(e,t)+'">'+w(e,t,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?r.reverse():r).join("")+"</tr></thead>"},$=function(e,t,r,n,o,i){var a,s,l,u,c,h=e._o,d=r===h.minYear,p=r===h.maxYear,y='<div id="'+i+'" class="pika-title" role="heading" aria-live="assertive">',g=!0,m=!0;for(l=[],a=0;a<12;a++)l.push('<option value="'+(r===o?a-t:12+a-t)+'"'+(a===n?' selected="selected"':"")+(d&&a<h.minMonth||p&&a>h.maxMonth?'disabled="disabled"':"")+">"+h.i18n.months[a]+"</option>");for(u='<div class="pika-label">'+h.i18n.months[n]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",f(h.yearRange)?(a=h.yearRange[0],s=h.yearRange[1]+1):(a=r-h.yearRange,s=1+r+h.yearRange),l=[];a<s&&a<=h.maxYear;a++)a>=h.minYear&&l.push('<option value="'+a+'"'+(a===r?' selected="selected"':"")+">"+a+"</option>");return c='<div class="pika-label">'+r+h.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",h.showMonthAfterYear?y+=c+u:y+=u+c,d&&(0===n||h.minMonth>=n)&&(g=!1),p&&(11===n||h.maxMonth<=n)&&(m=!1),0===t&&(y+='<button class="pika-prev'+(g?"":" is-disabled")+'" type="button">'+h.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(y+='<button class="pika-next'+(m?"":" is-disabled")+'" type="button">'+h.i18n.nextMonth+"</button>"),y+"</div>"},I=function(e,t,r){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+r+'">'+R(e)+T(t)+"</table>"},A=function(a){var s=this,u=s.config(a);s._onMouseDown=function(e){if(s._v){var t=(e=e||window.event).target||e.srcElement;if(t)if(l(t,"is-disabled")||(!l(t,"pika-button")||l(t,"is-empty")||l(t.parentNode,"is-disabled")?l(t,"pika-prev")?s.prevMonth():l(t,"pika-next")&&s.nextMonth():(s.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day"))),u.bound&&o((function(){s.hide(),u.blurFieldOnSelect&&u.field&&u.field.blur()}),100))),l(t,"pika-select"))s._c=!0;else{if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}}},s._onChange=function(e){var t=(e=e||window.event).target||e.srcElement;t&&(l(t,"pika-select-month")?s.gotoMonth(t.value):l(t,"pika-select-year")&&s.gotoYear(t.value))},s._onKeyChange=function(e){if(e=e||window.event,s.isVisible())switch(e.keyCode){case 13:case 27:u.field&&u.field.blur();break;case 37:e.preventDefault(),s.adjustDate("subtract",1);break;case 38:s.adjustDate("subtract",7);break;case 39:s.adjustDate("add",1);break;case 40:s.adjustDate("add",7)}},s._onInputChange=function(r){var n;r.firedBy!==s&&(n=u.parse?u.parse(u.field.value,u.format):t?(n=e(u.field.value,u.format,u.formatStrict))&&n.isValid()?n.toDate():null:new Date(Date.parse(u.field.value)),h(n)&&s.setDate(n),s._v||s.show())},s._onInputFocus=function(){s.show()},s._onInputClick=function(){s.show()},s._onInputBlur=function(){var e=n.activeElement;do{if(l(e,"pika-single"))return}while(e=e.parentNode);s._c||(s._b=o((function(){s.hide()}),50)),s._c=!1},s._onClick=function(e){var t=(e=e||window.event).target||e.srcElement,n=t;if(t){!r&&l(t,"pika-select")&&(t.onchange||(t.setAttribute("onchange","return;"),i(t,"change",s._onChange)));do{if(l(n,"pika-single")||n===u.trigger)return}while(n=n.parentNode);s._v&&t!==u.trigger&&n!==u.trigger&&s.hide()}},s.el=n.createElement("div"),s.el.className="pika-single"+(u.isRTL?" is-rtl":"")+(u.theme?" "+u.theme:""),i(s.el,"mousedown",s._onMouseDown,!0),i(s.el,"touchend",s._onMouseDown,!0),i(s.el,"change",s._onChange),u.keyboardInput&&i(n,"keydown",s._onKeyChange),u.field&&(u.container?u.container.appendChild(s.el):u.bound?n.body.appendChild(s.el):u.field.parentNode.insertBefore(s.el,u.field.nextSibling),i(u.field,"change",s._onInputChange),u.defaultDate||(t&&u.field.value?u.defaultDate=e(u.field.value,u.format).toDate():u.defaultDate=new Date(Date.parse(u.field.value)),u.setDefaultDate=!0));var c=u.defaultDate;h(c)?u.setDefaultDate?s.setDate(c,!0):s.gotoDate(c):s.gotoDate(new Date),u.bound?(this.hide(),s.el.className+=" is-bound",i(u.trigger,"click",s._onInputClick),i(u.trigger,"focus",s._onInputFocus),i(u.trigger,"blur",s._onInputBlur)):this.show()};return A.prototype={config:function(e){this._o||(this._o=v({},C,!0));var t=v(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.theme="string"==typeof t.theme&&t.theme?t.theme:null,t.bound=!!(void 0!==t.bound?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn="function"==typeof t.disableDayFn?t.disableDayFn:null;var r=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=r>4?4:r,h(t.minDate)||(t.minDate=!1),h(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&this.setMinDate(t.minDate),t.maxDate&&this.setMaxDate(t.maxDate),f(t.yearRange)){var n=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||n,t.yearRange[1]=parseInt(t.yearRange[1],10)||n}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||C.yearRange,t.yearRange>100&&(t.yearRange=100);return t},toString:function(r){return r=r||this._o.format,h(this._d)?this._o.toString?this._o.toString(this._d,r):t?e(this._d).format(r):this._d.toDateString():""},getMoment:function(){return t?e(this._d):null},setMoment:function(r,n){t&&e.isMoment(r)&&this.setDate(r.toDate(),n)},getDate:function(){return h(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",_(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof e&&(e=new Date(Date.parse(e))),h(e)){var r=this._o.minDate,n=this._o.maxDate;h(r)&&e<r?e=r:h(n)&&e>n&&(e=n),this._d=new Date(e.getTime()),g(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),_(this._o.field,"change",{firedBy:this})),t||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(e){var t=!0;if(h(e)){if(this.calendars){var r=new Date(this.calendars[0].year,this.calendars[0].month,1),n=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),o=e.getTime();n.setMonth(n.getMonth()+1),n.setDate(n.getDate()-1),t=o<r.getTime()||n.getTime()<o}t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(e,t){var r,n=this.getDate()||new Date,o=24*parseInt(t)*60*60*1e3;"add"===e?r=new Date(n.valueOf()+o):"subtract"===e&&(r=new Date(n.valueOf()-o)),this.setDate(r)},adjustCalendars:function(){this.calendars[0]=b(this.calendars[0]);for(var e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=b({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(g(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=C.minDate,this._o.minYear=C.minYear,this._o.minMonth=C.minMonth,this._o.startRange=C.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(g(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=C.maxDate,this._o.maxYear=C.maxYear,this._o.maxMonth=C.maxMonth,this._o.endRange=C.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(this._v||e){var t,r=this._o,n=r.minYear,i=r.maxYear,a=r.minMonth,s=r.maxMonth,l="";this._y<=n&&(this._y=n,!isNaN(a)&&this._m<a&&(this._m=a)),this._y>=i&&(this._y=i,!isNaN(s)&&this._m>s&&(this._m=s)),t="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(var u=0;u<r.numberOfMonths;u++)l+='<div class="pika-lendar">'+$(this,u,this.calendars[u].year,this.calendars[u].month,this.calendars[0].year,t)+this.render(this.calendars[u].year,this.calendars[u].month,t)+"</div>";this.el.innerHTML=l,r.bound&&"hidden"!==r.field.type&&o((function(){r.trigger.focus()}),1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),r.bound&&r.field.setAttribute("aria-label",r.ariaLabel)}},adjustPosition:function(){var e,t,r,o,i,a,s,l,f,h,d,p;if(!this._o.container){if(this.el.style.position="absolute",t=e=this._o.trigger,r=this.el.offsetWidth,o=this.el.offsetHeight,i=window.innerWidth||n.documentElement.clientWidth,a=window.innerHeight||n.documentElement.clientHeight,s=window.pageYOffset||n.body.scrollTop||n.documentElement.scrollTop,d=!0,p=!0,"function"==typeof e.getBoundingClientRect)l=(h=e.getBoundingClientRect()).left+window.pageXOffset,f=h.bottom+window.pageYOffset;else for(l=t.offsetLeft,f=t.offsetTop+t.offsetHeight;t=t.offsetParent;)l+=t.offsetLeft,f+=t.offsetTop;(this._o.reposition&&l+r>i||this._o.position.indexOf("right")>-1&&l-r+e.offsetWidth>0)&&(l=l-r+e.offsetWidth,d=!1),(this._o.reposition&&f+o>a+s||this._o.position.indexOf("top")>-1&&f-o-e.offsetHeight>0)&&(f=f-o-e.offsetHeight,p=!1),this.el.style.left=l+"px",this.el.style.top=f+"px",u(this.el,d?"left-aligned":"right-aligned"),u(this.el,p?"bottom-aligned":"top-aligned"),c(this.el,d?"right-aligned":"left-aligned"),c(this.el,p?"top-aligned":"bottom-aligned")}},render:function(e,t,r){var n=this._o,o=new Date,i=y(e,t),a=new Date(e,t,1).getDay(),s=[],l=[];g(o),n.firstDay>0&&(a-=n.firstDay)<0&&(a+=7);for(var u=0===t?11:t-1,c=11===t?0:t+1,f=0===t?e-1:e,p=11===t?e+1:e,v=y(f,u),_=i+a,b=_;b>7;)b-=7;_+=7-b;for(var C=!1,w=0,T=0;w<_;w++){var R=new Date(e,t,w-a+1),$=!!h(this._d)&&m(R,this._d),A=m(R,o),P=-1!==n.events.indexOf(R.toDateString()),k=w<a||w>=i+a,N=w-a+1,M=t,D=e,L=n.startRange&&m(n.startRange,R),x=n.endRange&&m(n.endRange,R),H=n.startRange&&n.endRange&&n.startRange<R&&R<n.endRange;k&&(w<a?(N=v+N,M=u,D=f):(N-=i,M=c,D=p));var j={day:N,month:M,year:D,hasEvent:P,isSelected:$,isToday:A,isDisabled:n.minDate&&R<n.minDate||n.maxDate&&R>n.maxDate||n.disableWeekends&&d(R)||n.disableDayFn&&n.disableDayFn(R),isEmpty:k,isStartRange:L,isEndRange:x,isInRange:H,showDaysInNextAndPreviousMonths:n.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:n.enableSelectionDaysInNextAndPreviousMonths};n.pickWholeWeek&&$&&(C=!0),l.push(E(j)),7==++T&&(n.showWeekNumber&&l.unshift(S(w-a,t,e)),s.push(O(l,n.isRTL,n.pickWholeWeek,C)),l=[],T=0,C=!1)}return I(n,s,r)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),c(this.el,"is-hidden"),this._o.bound&&(i(n,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var e=this._v;!1!==e&&(this._o.bound&&a(n,"click",this._onClick),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",u(this.el,"is-hidden"),this._v=!1,void 0!==e&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){var e=this._o;this.hide(),a(this.el,"mousedown",this._onMouseDown,!0),a(this.el,"touchend",this._onMouseDown,!0),a(this.el,"change",this._onChange),e.keyboardInput&&a(n,"keydown",this._onKeyChange),e.field&&(a(e.field,"change",this._onInputChange),e.bound&&(a(e.trigger,"click",this._onInputClick),a(e.trigger,"focus",this._onInputFocus),a(e.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},A}(n)}()}));function _typeof$s(e){return(_typeof$s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$N(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$I(e,t,r){return t&&_defineProperties$I(e.prototype,t),r&&_defineProperties$I(e,r),e}function _get$3(e,t,r){return(_get$3="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$3(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$3(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$m(e)););return e}function _inherits$m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$m(e,t)}function _setPrototypeOf$m(e,t){return(_setPrototypeOf$m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$m(e){var t=_isNativeReflectConstruct$m();return function(){var r,n=_getPrototypeOf$m(e);if(t){var o=_getPrototypeOf$m(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$m(this,r)}}function _possibleConstructorReturn$m(e,t){return!t||"object"!==_typeof$s(t)&&"function"!=typeof t?_assertThisInitialized$m(e):t}function _assertThisInitialized$m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$m(e){return(_getPrototypeOf$m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var DateEditor=function(e){_inherits$m(r,e);var t=_createSuper$m(r);function r(e){var n;return _classCallCheck$N(this,r),(n=t.call(this,e)).defaultDateFormat="DD/MM/YYYY",n.isCellEdited=!1,n.parentDestroyed=!1,n}return _createClass$I(r,[{key:"init",value:function(){var e=this;if("function"!=typeof moment)throw new Error("You need to include moment.js to your project.");if("function"!=typeof pikaday)throw new Error("You need to include Pikaday to your project.");_get$3(_getPrototypeOf$m(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",(function(){e.parentDestroyed=!0,e.destroyElements()}))}},{key:"createElements",value:function(){_get$3(_getPrototypeOf$m(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,addClass(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.$datePicker=new pikaday(this.getDatePickerConfig()),new EventManager(this).addEventListener(this.datePicker,"mousedown",(function(e){return e.stopPropagation()})),this.hideDatepicker()}},{key:"destroyElements",value:function(){var e=this.datePicker.parentNode;this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}},{key:"prepare",value:function(e,t,n,o,i,a){_get$3(_getPrototypeOf$m(r.prototype),"prepare",this).call(this,e,t,n,o,i,a)}},{key:"open",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;_get$3(_getPrototypeOf$m(r.prototype),"open",this).call(this),this.showDatepicker(e)}},{key:"close",value:function(){var e=this;this._opened=!1,this.instance._registerTimeout((function(){e.instance._refreshBorders()})),_get$3(_getPrototypeOf$m(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){var n=this.originalValue;void 0!==n&&this.setValue(n)}this.hideDatepicker(),_get$3(_getPrototypeOf$m(r.prototype),"finishEditing",this).call(this,e,t)}},{key:"showDatepicker",value:function(e){this.$datePicker.config(this.getDatePickerConfig());var t,r=this.TD.getBoundingClientRect(),n=this.cellProperties.dateFormat||this.defaultDateFormat,o=this.$datePicker.config(),i=this.instance.view.isMouseDown(),a=!!e&&isMetaKey(e.keyCode);this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+r.top+outerHeight(this.TD),"px"),this.datePickerStyle.left="".concat(this.hot.rootWindow.pageXOffset+r.left,"px"),this.$datePicker._onInputFocus=function(){},o.format=n,this.originalValue?(t=this.originalValue,moment(t,n,!0).isValid()&&this.$datePicker.setMoment(moment(t,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),a||i||this.setValue("")):this.cellProperties.defaultDate?(t=this.cellProperties.defaultDate,o.defaultDate=t,moment(t,n,!0).isValid()&&this.$datePicker.setMoment(moment(t,n),!0),a||i||this.setValue("")):this.$datePicker.gotoToday(),this.datePickerStyle.display="block",this.$datePicker.show()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var e=this,t=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&deepExtend(r,this.cellProperties.datePickerConfig);var n=r.onSelect,o=r.onClose;return r.field=t,r.trigger=t,r.container=this.datePicker,r.bound=!1,r.format=r.format||this.defaultDateFormat,r.reposition=r.reposition||!1,r.onSelect=function(t){var r=t;isNaN(r.getTime())||(r=moment(r).format(e.cellProperties.dateFormat||e.defaultDateFormat)),e.setValue(r),e.hideDatepicker(),n&&n()},r.onClose=function(){e.parentDestroyed||e.finishEditing(!1),o&&o()},r}}]),r}(TextEditor);function _typeof$t(e){return(_typeof$t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$J(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$J(e,t,r){return t&&_defineProperties$J(e.prototype,t),r&&_defineProperties$J(e,r),e}function _get$4(e,t,r){return(_get$4="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$4(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$4(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$n(e)););return e}function _inherits$n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$n(e,t)}function _setPrototypeOf$n(e,t){return(_setPrototypeOf$n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$n(e){var t=_isNativeReflectConstruct$n();return function(){var r,n=_getPrototypeOf$n(e);if(t){var o=_getPrototypeOf$n(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$n(this,r)}}function _possibleConstructorReturn$n(e,t){return!t||"object"!==_typeof$t(t)&&"function"!=typeof t?_assertThisInitialized$n(e):t}function _assertThisInitialized$n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$n(e){return(_getPrototypeOf$n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var DropdownEditor=function(e){_inherits$n(r,e);var t=_createSuper$n(r);function r(){return _classCallCheck$O(this,r),t.apply(this,arguments)}return _createClass$J(r,[{key:"prepare",value:function(e,t,n,o,i,a){_get$4(_getPrototypeOf$n(r.prototype),"prepare",this).call(this,e,t,n,o,i,a),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}]),r}(AutocompleteEditor);function _typeof$u(e){return(_typeof$u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits$o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$o(e,t)}function _setPrototypeOf$o(e,t){return(_setPrototypeOf$o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$o(e){var t=_isNativeReflectConstruct$o();return function(){var r,n=_getPrototypeOf$o(e);if(t){var o=_getPrototypeOf$o(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$o(this,r)}}function _possibleConstructorReturn$o(e,t){return!t||"object"!==_typeof$u(t)&&"function"!=typeof t?_assertThisInitialized$o(e):t}function _assertThisInitialized$o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$o(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$o(e){return(_getPrototypeOf$o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Hooks.getSingleton().add("beforeValidate",(function(e,t,r){var n=this.getCellMeta(t,this.propToCol(r));n.editor===DropdownEditor&&void 0===n.strict&&(n.filter=!1,n.strict=!0)}));var NumericEditor=function(e){_inherits$o(r,e);var t=_createSuper$o(r);function r(){return _classCallCheck$P(this,r),t.apply(this,arguments)}return r}(TextEditor);function _typeof$v(e){return(_typeof$v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$Q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$K(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$K(e,t,r){return t&&_defineProperties$K(e.prototype,t),r&&_defineProperties$K(e,r),e}function _get$5(e,t,r){return(_get$5="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$5(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$5(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$p(e)););return e}function _inherits$p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$p(e,t)}function _setPrototypeOf$p(e,t){return(_setPrototypeOf$p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$p(e){var t=_isNativeReflectConstruct$p();return function(){var r,n=_getPrototypeOf$p(e);if(t){var o=_getPrototypeOf$p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$p(this,r)}}function _possibleConstructorReturn$p(e,t){return!t||"object"!==_typeof$v(t)&&"function"!=typeof t?_assertThisInitialized$p(e):t}function _assertThisInitialized$p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$p(e){return(_getPrototypeOf$p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var PasswordEditor=function(e){_inherits$p(r,e);var t=_createSuper$p(r);function r(){return _classCallCheck$Q(this,r),t.apply(this,arguments)}return _createClass$K(r,[{key:"createElements",value:function(){_get$5(_getPrototypeOf$p(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,empty$1(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}]),r}(TextEditor);function _typeof$w(e){return(_typeof$w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$L(e,t,r){return t&&_defineProperties$L(e.prototype,t),r&&_defineProperties$L(e,r),e}function _get$6(e,t,r){return(_get$6="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$6(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$6(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$q(e)););return e}function _inherits$q(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$q(e,t)}function _setPrototypeOf$q(e,t){return(_setPrototypeOf$q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$q(e){var t=_isNativeReflectConstruct$q();return function(){var r,n=_getPrototypeOf$q(e);if(t){var o=_getPrototypeOf$q(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$q(this,r)}}function _possibleConstructorReturn$q(e,t){return!t||"object"!==_typeof$w(t)&&"function"!=typeof t?_assertThisInitialized$q(e):t}function _assertThisInitialized$q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$q(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$q(e){return(_getPrototypeOf$q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var EDITOR_VISIBLE_CLASS_NAME$1="ht_editor_visible",SelectEditor=function(e){_inherits$q(r,e);var t=_createSuper$q(r);function r(){return _classCallCheck$R(this,r),t.apply(this,arguments)}return _createClass$L(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),addClass(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(e){this.select.value=e}},{key:"open",value:function(){var e=this;this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.addHook("beforeKeyDown",(function(){return e.onBeforeKeyDown()}))}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",hasClass(this.select,EDITOR_VISIBLE_CLASS_NAME$1)&&removeClass(this.select,EDITOR_VISIBLE_CLASS_NAME$1),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var e=this;this.addHook("afterScrollHorizontally",(function(){return e.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return e.refreshDimensions()})),this.addHook("afterColumnResize",(function(){return e.refreshDimensions()})),this.addHook("afterRowResize",(function(){return e.refreshDimensions()}))}},{key:"prepare",value:function(e,t,n,o,i,a){var s=this;_get$6(_getPrototypeOf$q(r.prototype),"prepare",this).call(this,e,t,n,o,i,a);var l,u=this.cellProperties.selectOptions;l="function"==typeof u?this.prepareOptions(u(this.row,this.col,this.prop)):this.prepareOptions(u),empty$1(this.select),objectEach(l,(function(e,t){var r=s.hot.rootDocument.createElement("OPTION");r.value=t,fastInnerHTML(r,e),s.select.appendChild(r)}))}},{key:"prepareOptions",value:function(e){var t={};if(Array.isArray(e))for(var r=0,n=e.length;r<n;r++)t[e[r]]=e[r];else"object"===_typeof$w(e)&&(t=e);return t}},{key:"refreshValue",value:function(){var e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===EditorState.EDITING)if(this.TD=this.getEditedCell(),this.TD){var e,t=this.hot.view.wt.wtOverlays,r=offset(this.TD),n=offset(this.hot.rootElement),o=t.scrollableElement,i=this.checkEditorSection(),a=outerWidth(this.TD)+1,s=outerHeight(this.TD)+1,l=r.top-n.top-1-(o.scrollTop||0),u=r.left-n.left-1-(o.scrollLeft||0);switch(i){case"top":e=getCssTransform(t.topOverlay.clone.wtTable.holder.parentNode);break;case"left":e=getCssTransform(t.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":e=getCssTransform(t.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":e=getCssTransform(t.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":e=getCssTransform(t.bottomOverlay.clone.wtTable.holder.parentNode)}var c=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),f=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),h=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view.wt.getSetting("fixedRowsBottom");(c<=0||c===h)&&(l+=1),f<=0&&(u+=1);var d=this.select.style;e&&-1!==e?d[e[0]]=e[1]:resetCssTransform(this.select);var p=getComputedStyle(this.TD,this.hot.rootWindow);parseInt(p.borderTopWidth,10)>0&&(s-=1),parseInt(p.borderLeftWidth,10)>0&&(a-=1),d.height="".concat(s,"px"),d.minWidth="".concat(a,"px"),d.top="".concat(l,"px"),d.left="".concat(u,"px"),d.margin="0px",addClass(this.select,EDITOR_VISIBLE_CLASS_NAME$1)}else this.close()}},{key:"onBeforeKeyDown",value:function(){var e=this.select.selectedIndex-1,t=this.select.selectedIndex+1;switch(event.keyCode){case KEY_CODES.ARROW_UP:e>=0&&(this.select[e].selected=!0),stopImmediatePropagation(event),event.preventDefault();break;case KEY_CODES.ARROW_DOWN:t<=this.select.length-1&&(this.select[t].selected=!0),stopImmediatePropagation(event),event.preventDefault()}}}]),r}(BaseEditor),registeredEditorClasses=new WeakMap,_staticRegister$1=staticRegister("editors"),register$1=_staticRegister$1.register,getItem$1=_staticRegister$1.getItem,hasItem$1=_staticRegister$1.hasItem,getNames$1=_staticRegister$1.getNames;function RegisteredEditor(e){var t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in t||(t[e.guid]=new r(e)),t[e.guid]},Hooks.getSingleton().add("afterDestroy",(function(){t[this.guid]=null}))}function _getEditorInstance(e,t){var r;if("function"==typeof e)registeredEditorClasses.get(e)||_register(null,e),r=registeredEditorClasses.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter');r=getItem$1(e)}if(!r)throw Error('No editor registered under name "'.concat(e,'"'));return r.getInstance(t)}function _getItem$1(e){if(!hasItem$1(e))throw Error('No registered editor found under "'.concat(e,'" name'));return getItem$1(e).getConstructor()}function _register(e,t){var r=new RegisteredEditor(t);"string"==typeof e&&register$1(e,r),registeredEditorClasses.set(t,r)}function autocompleteValidator(e,t){var r=e;null==r&&(r=""),this.allowEmpty&&""===r?t(!0):this.strict&&this.source?"function"==typeof this.source?this.source(r,process$1(r,t)):process$1(r,t)(this.source):t(!0)}function process$1(e,t){var r=e;return function(e){for(var n=!1,o=0,i=e.length;o<i;o++)if(r===e[o]){n=!0;break}t(n)}}_register("base",BaseEditor),_register("autocomplete",AutocompleteEditor),_register("checkbox",CheckboxEditor),_register("date",DateEditor),_register("dropdown",DropdownEditor),_register("handsontable",HandsontableEditor),_register("numeric",NumericEditor),_register("password",PasswordEditor),_register("select",SelectEditor),_register("text",TextEditor);var sameValue=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t};function getNormalizedDate(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+6e4*t.getTimezoneOffset())}fixRegexpWellKnownSymbolLogic("search",1,(function(e,t,r){return[function(t){var r=requireObjectCoercible(this),n=null==t?void 0:t[e];return void 0!==n?n.call(t,r):new RegExp(t)[e](String(r))},function(e){var n=r(t,e,this);if(n.done)return n.value;var o=anObject(e),i=String(this),a=o.lastIndex;sameValue(a,0)||(o.lastIndex=0);var s=regexpExecAbstract(o,i);return sameValue(o.lastIndex,a)||(o.lastIndex=a),null===s?-1:s.index}]}));var dateHelpers=Object.freeze({__proto__:null,getNormalizedDate:getNormalizedDate});function dateValidator(e,t){var r=_getEditorInstance("date",this.instance),n=e,o=!0;null==n&&(n="");var i=moment(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),a=moment(new Date(n)).isValid()||i;if(this.allowEmpty&&""===n&&(a=!0,i=!0),a||(o=!1),!a&&i&&(o=!0),a&&!i)if(!0===this.correctFormat){var s=correctFormat(n,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,s,"dateValidator"),o=!0}else o=!1;t(o)}function correctFormat(e,t){var r=moment(getNormalizedDate(e)),n=moment(e,t),o=e.search(/[A-z]/g)>-1;return(r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||o?r:n).format(t)}function numericValidator(e,t){var r=e;null==r&&(r=""),this.allowEmpty&&""===r?t(!0):t(""!==r&&isNumeric(e))}var STRICT_FORMATS=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function timeValidator(e,t){var r=this.timeFormat||"h:mm:ss a",n=!0,o=e;null===o&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var a=moment(o,STRICT_FORMATS,!0).isValid()?moment(o):moment(o,r),s=a.isValid(),l=moment(o,r,!0).isValid()&&!i;if(this.allowEmpty&&""===o&&(s=!0,l=!0),s||(n=!1),!s&&l&&(n=!0),s&&!l)if(!0===this.correctFormat){var u=a.format(r),c=this.instance.toVisualRow(this.row),f=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,f,u,"timeValidator"),n=!0}else n=!1;t(n)}var _staticRegister$2=staticRegister("validators"),register$2=_staticRegister$2.register,getItem$2=_staticRegister$2.getItem,hasItem$2=_staticRegister$2.hasItem,getNames$2=_staticRegister$2.getNames;function _getItem$2(e){if("function"==typeof e)return e;if(!hasItem$2(e))throw Error('No registered validator found under "'.concat(e,'" name'));return getItem$2(e)}register$2("autocomplete",autocompleteValidator),register$2("date",dateValidator),register$2("numeric",numericValidator),register$2("time",timeValidator);var CELL_TYPE="autocomplete",autocompleteCellType={editor:_getItem$1(CELL_TYPE),renderer:_getItem(CELL_TYPE),validator:_getItem$2(CELL_TYPE)},CELL_TYPE$1="checkbox",checkboxCellType={editor:_getItem$1(CELL_TYPE$1),renderer:_getItem(CELL_TYPE$1)},CELL_TYPE$2="date",dateCellType={editor:_getItem$1(CELL_TYPE$2),renderer:_getItem("autocomplete"),validator:_getItem$2(CELL_TYPE$2)},CELL_TYPE$3="dropdown",dropdownCellType={editor:_getItem$1(CELL_TYPE$3),renderer:_getItem("autocomplete"),validator:_getItem$2("autocomplete")},CELL_TYPE$4="handsontable",handsontableCellType={editor:_getItem$1(CELL_TYPE$4),renderer:_getItem("autocomplete")},CELL_TYPE$5="numeric",numericCellType={editor:_getItem$1(CELL_TYPE$5),renderer:_getItem(CELL_TYPE$5),validator:_getItem$2(CELL_TYPE$5),dataType:"number"},CELL_TYPE$6="password",passwordCellType={editor:_getItem$1(CELL_TYPE$6),renderer:_getItem(CELL_TYPE$6),copyable:!1},CELL_TYPE$7="text",textCellType={editor:_getItem$1(CELL_TYPE$7),renderer:_getItem(CELL_TYPE$7)},CELL_TYPE$8="time",timeCellType={editor:_getItem$1("text"),renderer:_getItem("text"),validator:_getItem$2(CELL_TYPE$8)},_staticRegister$3=staticRegister("cellTypes"),register$3=_staticRegister$3.register,getItem$3=_staticRegister$3.getItem,hasItem$3=_staticRegister$3.hasItem,getNames$3=_staticRegister$3.getNames;function _getItem$3(e){if(!hasItem$3(e))throw Error('You declared cell type "'.concat(e,'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method'));return getItem$3(e)}function _register$1(e,t){var r=t.editor,n=t.renderer,o=t.validator;r&&_register(e,r),n&&register(e,n),o&&register$2(e,o),register$3(e,t)}_register$1("autocomplete",autocompleteCellType),_register$1("checkbox",checkboxCellType),_register$1("date",dateCellType),_register$1("dropdown",dropdownCellType),_register$1("handsontable",handsontableCellType),_register$1("numeric",numericCellType),_register$1("password",passwordCellType),_register$1("text",textCellType),_register$1("time",timeCellType);var getOwnPropertyNames$1=objectGetOwnPropertyNames.f,getOwnPropertyDescriptor$2=objectGetOwnPropertyDescriptor.f,defineProperty$7=objectDefineProperty.f,trim=stringTrim.trim,NUMBER="Number",NativeNumber=global_1[NUMBER],NumberPrototype=NativeNumber.prototype,BROKEN_CLASSOF=classofRaw(objectCreate(NumberPrototype))==NUMBER,toNumber=function(e){var t,r,n,o,i,a,s,l,u=toPrimitive(e,!1);if("string"==typeof u&&u.length>2)if(43===(t=(u=trim(u)).charCodeAt(0))||45===t){if(88===(r=u.charCodeAt(2))||120===r)return NaN}else if(48===t){switch(u.charCodeAt(1)){case 66:case 98:n=2,o=49;break;case 79:case 111:n=8,o=55;break;default:return+u}for(a=(i=u.slice(2)).length,s=0;s<a;s++)if((l=i.charCodeAt(s))<48||l>o)return NaN;return parseInt(i,n)}return+u};if(isForced_1(NUMBER,!NativeNumber(" 0o1")||!NativeNumber("0b1")||NativeNumber("+0x1"))){for(var NumberWrapper=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof NumberWrapper&&(BROKEN_CLASSOF?fails((function(){NumberPrototype.valueOf.call(r)})):classofRaw(r)!=NUMBER)?inheritIfRequired(new NativeNumber(toNumber(t)),r,NumberWrapper):toNumber(t)},keys$2=descriptors?getOwnPropertyNames$1(NativeNumber):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),j=0,key;keys$2.length>j;j++)has(NativeNumber,key=keys$2[j])&&!has(NumberWrapper,key)&&defineProperty$7(NumberWrapper,key,getOwnPropertyDescriptor$2(NativeNumber,key));NumberWrapper.prototype=NumberPrototype,NumberPrototype.constructor=NumberWrapper,redefine(global_1,NUMBER,NumberWrapper)}var floor$2=Math.floor,isInteger=function(e){return!isObject(e)&&isFinite(e)&&floor$2(e)===e};_export({target:"Number",stat:!0},{isInteger:isInteger});var engineIsIos=/(iphone|ipod|ipad).*applewebkit/i.test(engineUserAgent),location$1=global_1.location,set$1=global_1.setImmediate,clear=global_1.clearImmediate,process$2=global_1.process,MessageChannel=global_1.MessageChannel,Dispatch=global_1.Dispatch,counter=0,queue={},ONREADYSTATECHANGE="onreadystatechange",defer,channel,port,run$1=function(e){if(queue.hasOwnProperty(e)){var t=queue[e];delete queue[e],t()}},runner=function(e){return function(){run$1(e)}},listener=function(e){run$1(e.data)},post=function(e){global_1.postMessage(e+"",location$1.protocol+"//"+location$1.host)};set$1&&clear||(set$1=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return queue[++counter]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},defer(counter),counter},clear=function(e){delete queue[e]},"process"==classofRaw(process$2)?defer=function(e){process$2.nextTick(runner(e))}:Dispatch&&Dispatch.now?defer=function(e){Dispatch.now(runner(e))}:MessageChannel&&!engineIsIos?(channel=new MessageChannel,port=channel.port2,channel.port1.onmessage=listener,defer=functionBindContext(port.postMessage,port,1)):!global_1.addEventListener||"function"!=typeof postMessage||global_1.importScripts||fails(post)||"file:"===location$1.protocol?defer=ONREADYSTATECHANGE in documentCreateElement("script")?function(e){html.appendChild(documentCreateElement("script"))[ONREADYSTATECHANGE]=function(){html.removeChild(this),run$1(e)}}:function(e){setTimeout(runner(e),0)}:(defer=post,global_1.addEventListener("message",listener,!1)));var task={set:set$1,clear:clear},FORCED$5=!global_1.setImmediate||!global_1.clearImmediate;function _slicedToArray$4(e,t){return _arrayWithHoles$4(e)||_iterableToArrayLimit$4(e,t)||_unsupportedIterableToArray$6(e,t)||_nonIterableRest$4()}function _nonIterableRest$4(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$6(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$6(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$6(e,t):void 0}}function _arrayLikeToArray$6(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$4(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$4(e){if(Array.isArray(e))return e}function _classCallCheck$S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$M(e,t,r){return t&&_defineProperties$M(e.prototype,t),r&&_defineProperties$M(e,r),e}_export({global:!0,bind:!0,enumerable:!0,forced:FORCED$5},{setImmediate:task.set,clearImmediate:task.clear});var EditorManager=function(){function e(t,r,n){var o=this;_classCallCheck$S(this,e),this.instance=t,this.tableMeta=r,this.selection=n,this.eventManager=new EventManager(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.lastKeyCode=void 0,this.instance.addHook("afterDocumentKeyDown",(function(e){return o.onAfterDocumentKeyDown(e)}));for(var i=this.instance.rootWindow;i;)this.eventManager.addEventListener(i.document.documentElement,"keydown",(function(e){o.destroyed||o.instance.runHooks("afterDocumentKeyDown",e)})),i=getParentWindow(i);this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",(function(e){!o.destroyed&&o.activeEditor&&!o.activeEditor.isOpened()&&o.instance.isListening()&&o.openEditor("",e)})),this.instance.view.wt.update("onCellDblClick",(function(e,t,r){return o.onCellDblClick(e,t,r)}))}return _createClass$M(e,[{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(e){this.lock||this.closeEditor(e)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var e=this;if(!this.lock)if(this.activeEditor&&this.activeEditor.isWaiting())this.closeEditor(!1,!1,(function(t){t&&e.prepareEditor()}));else{var t=this.instance.selection.selectedRange.current().highlight,r=t.row,n=t.col,o=this.instance.runHooks("modifyGetCellCoords",r,n),i=r,a=n;if(Array.isArray(o)){var s=_slicedToArray$4(o,2);i=s[0],a=s[1]}this.cellProperties=this.instance.getCellMeta(i,a);var l=this.instance.rootDocument.activeElement;if(l&&l.blur(),this.cellProperties.readOnly)this.clearActiveEditor();else{var u=this.instance.getCellEditor(this.cellProperties),c=this.instance.getCell(r,n,!0);if(u&&c){var f=this.instance.colToProp(a),h=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(i),a);this.activeEditor=_getEditorInstance(u,this.instance),this.activeEditor.prepare(r,n,f,c,h,this.cellProperties)}else this.clearActiveEditor()}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(e,t){this.activeEditor&&this.activeEditor.beginEditing(e,t)}},{key:"closeEditor",value:function(e,t,r){this.activeEditor?this.activeEditor.finishEditing(e,t,r):r&&r(!1)}},{key:"closeEditorAndSaveChanges",value:function(e){this.closeEditor(!1,e)}},{key:"closeEditorAndRestoreOriginalValue",value:function(e){this.closeEditor(!0,e)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"moveSelectionAfterEnter",value:function(e){var t="function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-t.row,-t.col):this.selection.transformStart(t.row,t.col,!0)}},{key:"moveSelectionUp",value:function(e){e?this.selection.transformEnd(-1,0):this.selection.transformStart(-1,0)}},{key:"moveSelectionDown",value:function(e){e?this.selection.transformEnd(1,0):this.selection.transformStart(1,0)}},{key:"moveSelectionRight",value:function(e){e?this.selection.transformEnd(0,1):this.selection.transformStart(0,1)}},{key:"moveSelectionLeft",value:function(e){e?this.selection.transformEnd(0,-1):this.selection.transformStart(0,-1)}},{key:"onAfterDocumentKeyDown",value:function(e){if(this.instance.isListening()&&(this.instance.runHooks("beforeKeyDown",e),!this.destroyed&&229!==e.keyCode&&!isImmediatePropagationStopped(e)&&(this.lastKeyCode=e.keyCode,this.selection.isSelected()))){var t=(e.ctrlKey||e.metaKey)&&!e.altKey;if(!this.activeEditor||this.activeEditor.isWaiting()||isMetaKey(e.keyCode)||isCtrlMetaKey(e.keyCode)||t||this.isEditorOpened()){var r,n=e.shiftKey,o=n?this.selection.setRangeEnd:this.selection.setRangeStart;switch(e.keyCode){case KEY_CODES.A:!this.isEditorOpened()&&t&&(this.instance.selectAll(),e.preventDefault(),e.stopPropagation());break;case KEY_CODES.ARROW_UP:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(t),this.moveSelectionUp(n),e.preventDefault(),e.stopPropagation();break;case KEY_CODES.ARROW_DOWN:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(t),this.moveSelectionDown(n),e.preventDefault(),e.stopPropagation();break;case KEY_CODES.ARROW_RIGHT:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(t),this.moveSelectionRight(n),e.preventDefault(),e.stopPropagation();break;case KEY_CODES.ARROW_LEFT:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(t),this.moveSelectionLeft(n),e.preventDefault(),e.stopPropagation();break;case KEY_CODES.TAB:r="function"==typeof this.tableMeta.tabMoves?this.tableMeta.tabMoves(e):this.tableMeta.tabMoves,n?this.selection.transformStart(-r.row,-r.col):this.selection.transformStart(r.row,r.col,!0),e.preventDefault(),e.stopPropagation();break;case KEY_CODES.BACKSPACE:case KEY_CODES.DELETE:this.instance.emptySelectedCells(),this.prepareEditor(),e.preventDefault();break;case KEY_CODES.F2:this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,e),e.preventDefault();break;case KEY_CODES.ENTER:this.isEditorOpened()?(this.activeEditor&&this.activeEditor.state!==EditorState.WAITING&&this.closeEditorAndSaveChanges(t),this.moveSelectionAfterEnter(n)):this.instance.getSettings().enterBeginsEditing?this.cellProperties.readOnly?this.moveSelectionAfterEnter():this.activeEditor&&(this.activeEditor.enableFullEditMode(),this.openEditor(null,e)):this.moveSelectionAfterEnter(n),e.preventDefault(),stopImmediatePropagation(e);break;case KEY_CODES.ESCAPE:this.isEditorOpened()&&(this.closeEditorAndRestoreOriginalValue(t),this.activeEditor.focus()),e.preventDefault();break;case KEY_CODES.HOME:e.ctrlKey||e.metaKey?o.call(this.selection,new CellCoords(0,this.selection.selectedRange.current().from.col)):o.call(this.selection,new CellCoords(this.selection.selectedRange.current().from.row,0)),e.preventDefault(),e.stopPropagation();break;case KEY_CODES.END:e.ctrlKey||e.metaKey?o.call(this.selection,new CellCoords(this.instance.countRows()-1,this.selection.selectedRange.current().from.col)):o.call(this.selection,new CellCoords(this.selection.selectedRange.current().from.row,this.instance.countCols()-1)),e.preventDefault(),e.stopPropagation();break;case KEY_CODES.PAGE_UP:this.selection.transformStart(-this.instance.countVisibleRows(),0),e.preventDefault(),e.stopPropagation();break;case KEY_CODES.PAGE_DOWN:this.selection.transformStart(this.instance.countVisibleRows(),0),e.preventDefault(),e.stopPropagation()}}else this.openEditor("",e)}}},{key:"onCellDblClick",value:function(e,t,r){"TD"===r.nodeName&&(this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,e))}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),instances=new WeakMap;EditorManager.getInstance=function(e,t,r){var n=instances.get(e);return n||(n=new EditorManager(e,t,r),instances.set(e,n)),n};var $findIndex=arrayIteration.findIndex,FIND_INDEX="findIndex",SKIPS_HOLES$1=!0,USES_TO_LENGTH$7=arrayMethodUsesToLength(FIND_INDEX);FIND_INDEX in[]&&Array(1)[FIND_INDEX]((function(){SKIPS_HOLES$1=!1})),_export({target:"Array",proto:!0,forced:SKIPS_HOLES$1||!USES_TO_LENGTH$7},{findIndex:function(e){return $findIndex(this,e,arguments.length>1?arguments[1]:void 0)}}),addToUnscopables(FIND_INDEX);var min$5=Math.min,nativeLastIndexOf=[].lastIndexOf,NEGATIVE_ZERO$1=!!nativeLastIndexOf&&1/[1].lastIndexOf(1,-0)<0,STRICT_METHOD$4=arrayMethodIsStrict("lastIndexOf"),USES_TO_LENGTH$8=arrayMethodUsesToLength("indexOf",{ACCESSORS:!0,1:0}),FORCED$6=NEGATIVE_ZERO$1||!STRICT_METHOD$4||!USES_TO_LENGTH$8,arrayLastIndexOf=FORCED$6?function(e){if(NEGATIVE_ZERO$1)return nativeLastIndexOf.apply(this,arguments)||0;var t=toIndexedObject(this),r=toLength(t.length),n=r-1;for(arguments.length>1&&(n=min$5(n,toInteger(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in t&&t[n]===e)return n||0;return-1}:nativeLastIndexOf;_export({target:"Array",proto:!0,forced:arrayLastIndexOf!==[].lastIndexOf},{lastIndexOf:arrayLastIndexOf});var $map=arrayIteration.map,HAS_SPECIES_SUPPORT$3=arrayMethodHasSpeciesSupport("map"),USES_TO_LENGTH$9=arrayMethodUsesToLength("map");_export({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT$3||!USES_TO_LENGTH$9},{map:function(e){return $map(this,e,arguments.length>1?arguments[1]:void 0)}});var createMethod$6=function(e){return function(t,r,n,o){aFunction$1(r);var i=toObject(t),a=indexedObject(i),s=toLength(i.length),l=e?s-1:0,u=e?-1:1;if(n<2)for(;;){if(l in a){o=a[l],l+=u;break}if(l+=u,e?l<0:s<=l)throw TypeError("Reduce of empty array with no initial value")}for(;e?l>=0:s>l;l+=u)l in a&&(o=r(o,a[l],l,i));return o}},arrayReduce$1={left:createMethod$6(!1),right:createMethod$6(!0)},$reduce=arrayReduce$1.left,STRICT_METHOD$5=arrayMethodIsStrict("reduce"),USES_TO_LENGTH$a=arrayMethodUsesToLength("reduce",{1:0});_export({target:"Array",proto:!0,forced:!STRICT_METHOD$5||!USES_TO_LENGTH$a},{reduce:function(e){return $reduce(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}});var FAILS_ON_PRIMITIVES$4=fails((function(){objectKeys(1)}));function _toConsumableArray$3(e){return _arrayWithoutHoles$3(e)||_iterableToArray$3(e)||_unsupportedIterableToArray$7(e)||_nonIterableSpread$3()}function _nonIterableSpread$3(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$7(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$7(e,t):void 0}}function _iterableToArray$3(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$3(e){if(Array.isArray(e))return _arrayLikeToArray$7(e)}function _arrayLikeToArray$7(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}_export({target:"Object",stat:!0,forced:FAILS_ON_PRIMITIVES$4},{keys:function(e){return objectKeys(toObject(e))}}),fixRegexpWellKnownSymbolLogic("match",1,(function(e,t,r){return[function(t){var r=requireObjectCoercible(this),n=null==t?void 0:t[e];return void 0!==n?n.call(t,r):new RegExp(t)[e](String(r))},function(e){var n=r(t,e,this);if(n.done)return n.value;var o=anObject(e),i=String(this);if(!o.global)return regexpExecAbstract(o,i);var a=o.unicode;o.lastIndex=0;for(var s,l=[],u=0;null!==(s=regexpExecAbstract(o,i));){var c=String(s[0]);l[u]=c,""===c&&(o.lastIndex=advanceStringIndex(i,toLength(o.lastIndex),a)),u++}return 0===u?null:l}]}));var ESCAPED_HTML_CHARS={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},regEscapedChars=new RegExp(Object.keys(ESCAPED_HTML_CHARS).map((function(e){return"(".concat(e,")")})).join("|"),"gi");function isHTMLTable(e){return"TABLE"===(e&&e.nodeName||"")}function instanceToHTML(e){for(var t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],o=e.getData.apply(e,n),i=o.length,a=i>0?o[0].length:0,s=["<table>","</table>"],l=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,f=t?1:0,h=0;h<i;h+=1){for(var d=t&&0===h,p=[],y=0;y<a;y+=1){var g=!d&&r&&0===y,m="";if(d)m="<th>".concat(e.getColHeader(y-c),"</th>");else if(g)m="<th>".concat(e.getRowHeader(h-f),"</th>");else{var v=o[h][y],_=e.getCellMeta(h-c,y-f),b=_.hidden,C=_.rowspan,w=_.colspan;if(!b){var E=[];if(C&&E.push('rowspan="'.concat(C,'"')),w&&E.push('colspan="'.concat(w,'"')),isEmpty(v))m="<td ".concat(E.join(" "),"></td>");else{var S=v.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");m="<td ".concat(E.join(" "),">").concat(S,"</td>")}}}p.push(m)}var O=["<tr>"].concat(p,["</tr>"]).join("");d?l.splice(1,0,O):u.splice(-1,0,O)}return s.splice(1,0,l.join(""),u.join("")),s.join("")}function _dataToHTML(e){for(var t=e.length,r=["<table>"],n=0;n<t;n+=1){var o=e[n],i=o.length,a=[];0===n&&r.push("<tbody>");for(var s=0;s<i;s+=1){var l=o[s],u=isEmpty(l)?"":l.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(a,["</tr>"])),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function htmlToGridSettings(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,r={},n=t.createDocumentFragment(),o=t.createElement("div");n.appendChild(o);var i=e;if("string"==typeof i){var a=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(function(e){var t=e.match(/<td\b[^>]*?>/g)[0],r=e.substring(t.length,e.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return"".concat(t).concat(r).concat("</td>")}));o.insertAdjacentHTML("afterbegin","".concat(a)),i=o.querySelector("table")}if(i&&isHTMLTable(i)){var s=o.querySelector("style"),l=null,u=[];s&&(t.body.appendChild(s),s.disabled=!0,l=s.sheet,u=l?Array.from(l.cssRules):[],t.body.removeChild(s));var c=o.querySelector('meta[name$="enerator"]'),f=null!==i.querySelector("tbody th"),h=Array.from(i.querySelector("tr").cells).reduce((function(e,t){return e+t.colSpan}),0)-(f?1:0),d=i.tFoot&&Array.from(i.tFoot.rows)||[],p=[],y=!1,g=0,m=0;if(i.tHead){var v=Array.from(i.tHead.rows).filter((function(e){var t=null!==e.querySelector("td");return t&&p.push(e),!t}));y=(g=v.length)>0,g>1?r.nestedHeaders=Array.from(v).reduce((function(e,t){var r=Array.from(t.cells).reduce((function(e,t,r){if(f&&0===r)return e;var n=t.colSpan,o=t.innerHTML,i=n>1?{label:o,colspan:n}:o;return e.push(i),e}),[]);return e.push(r),e}),[]):y&&(r.colHeaders=Array.from(v[0].children).reduce((function(e,t,r){return f&&0===r||e.push(t.innerHTML),e}),[]))}p.length&&(r.fixedRowsTop=p.length),d.length&&(r.fixedRowsBottom=d.length);var _=[].concat(p,_toConsumableArray$3(Array.from(i.tBodies).reduce((function(e,t){return e.push.apply(e,_toConsumableArray$3(Array.from(t.rows))),e}),[])),_toConsumableArray$3(d));m=_.length;for(var b=new Array(m),C=0;C<m;C++)b[C]=new Array(h);for(var w=[],E=[],S=0;S<m;S++)for(var O=_[S],T=Array.from(O.cells),R=T.length,$=function(e){var t=T[e],r=t.nodeName,n=t.innerHTML,o=t.rowSpan,i=t.colSpan,a=b[S].findIndex((function(e){return void 0===e}));if("TD"===r){if(o>1||i>1){for(var s=S;s<S+o;s++)if(s<m)for(var l=a;l<a+i;l++)b[s][l]=null;var f=t.getAttribute("style");f&&f.includes("mso-ignore:colspan")||w.push({col:a,row:S,rowspan:o,colspan:i})}var h="";h="nowrap"===u.reduce((function(e,r){if(matchesCSSRules(t,r)){var n=r.style.whiteSpace;n&&(e.whiteSpace=n)}return e}),{}).whiteSpace?n.replace(/[\r\n][\x20]{0,2}/gim," ").replace(/<br(\s*|\/)>/gim,"\r\n"):c&&/excel/gi.test(c.content)?n.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):n.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),b[S][a]=h.replace(regEscapedChars,(function(e){return ESCAPED_HTML_CHARS[e]}))}else E.push(n)},I=0;I<R;I++)$(I);return w.length&&(r.mergeCells=w),E.length&&(r.rowHeaders=E),b.length&&(r.data=b),r}}var parseTableHelpers=Object.freeze({__proto__:null,instanceToHTML:instanceToHTML,_dataToHTML:_dataToHTML,htmlToGridSettings:htmlToGridSettings}),registeredPlugins=new WeakMap;function registerPlugin(e,t){var r=toUpperCaseFirst(e);Hooks.getSingleton().add("construct",(function(){registeredPlugins.has(this)||registeredPlugins.set(this,{});var e=registeredPlugins.get(this);e[r]||(e[r]=new t(this))})),Hooks.getSingleton().add("afterDestroy",(function(){registeredPlugins.has(this)&&(objectEach(registeredPlugins.get(this),(function(e){return e.destroy()})),registeredPlugins.delete(this))}))}function getPlugin(e,t){if("string"!=typeof t)throw Error('Only strings can be passed as "plugin" parameter');var r=toUpperCaseFirst(t);if(registeredPlugins.has(e)&&registeredPlugins.get(e)[r])return registeredPlugins.get(e)[r]}function getRegistredPluginNames(e){return registeredPlugins.has(e)?Object.keys(registeredPlugins.get(e)):[]}function getPluginName(e,t){var r=null;return registeredPlugins.has(e)&&objectEach(registeredPlugins.get(e),(function(e,n){e===t&&(r=n)})),r}function mouseDown(e){var t=e.isShiftKey,r=e.isLeftClick,n=e.isRightClick,o=e.coords,i=e.selection,a=e.controller,s=i.isSelected()?i.getSelectedRange().current():null,l=i.isSelectedByCorner(),u=i.isSelectedByRowHeader();if(t&&s)o.row>=0&&o.col>=0&&!a.cells?i.setRangeEnd(o):(l||u)&&o.row>=0&&o.col>=0&&!a.cells?i.setRangeEnd(new CellCoords(o.row,o.col)):l&&o.row<0&&!a.column?i.setRangeEnd(new CellCoords(s.to.row,o.col)):u&&o.col<0&&!a.row?i.setRangeEnd(new CellCoords(o.row,s.to.col)):(!l&&!u&&o.col<0||l&&o.col<0)&&!a.row?i.selectRows(Math.max(s.from.row,0),o.row):(!l&&!u&&o.row<0||u&&o.row<0)&&!a.column&&i.selectColumns(Math.max(s.from.col,0),o.col);else{var c=!i.inInSelection(o),f=r||n&&c;o.row<0&&o.col>=0&&!a.column?f&&i.selectColumns(o.col):o.col<0&&o.row>=0&&!a.row?f&&i.selectRows(o.row):o.col>=0&&o.row>=0&&!a.cells?f&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}function mouseOver(e){var t=e.isLeftClick,r=e.coords,n=e.selection,o=e.controller;if(t){var i=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),s=n.tableProps.countCols(),l=n.tableProps.countRows();a&&!o.column?n.setRangeEnd(new CellCoords(l-1,r.col)):i&&!o.row?n.setRangeEnd(new CellCoords(r.row,s-1)):o.cell||n.setRangeEnd(r)}}var handlers=new Map([["mousedown",mouseDown],["mouseover",mouseOver],["touchstart",mouseDown]]);function handleMouseEvent(e,t){var r=t.coords,n=t.selection,o=t.controller;handlers.get(e.type)({coords:r,selection:n,controller:o,isShiftKey:e.shiftKey,isLeftClick:isLeftClick(e)||"touchstart"===e.type,isRightClick:isRightClick(e)})}function _slicedToArray$5(e,t){return _arrayWithHoles$5(e)||_iterableToArrayLimit$5(e,t)||_unsupportedIterableToArray$8(e,t)||_nonIterableRest$5()}function _nonIterableRest$5(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit$5(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$5(e){if(Array.isArray(e))return e}function _construct$5(e,t,r){return(_construct$5=_isNativeReflectConstruct$r()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&_setPrototypeOf$r(o,r.prototype),o}).apply(null,arguments)}function _isNativeReflectConstruct$r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _setPrototypeOf$r(e,t){return(_setPrototypeOf$r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _toConsumableArray$4(e){return _arrayWithoutHoles$4(e)||_iterableToArray$4(e)||_unsupportedIterableToArray$8(e)||_nonIterableSpread$4()}function _nonIterableSpread$4(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$8(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$8(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$8(e,t):void 0}}function _iterableToArray$4(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$4(e){if(Array.isArray(e))return _arrayLikeToArray$8(e)}function _arrayLikeToArray$8(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$N(e,t,r){return t&&_defineProperties$N(e.prototype,t),r&&_defineProperties$N(e,r),e}var privatePool$4=new WeakMap,TableView=function(){function e(t){_classCallCheck$T(this,e),this.instance=t,this.eventManager=new EventManager(t),this.settings=t.getSettings(),this.THEAD=void 0,this.TBODY=void 0,this.wt=void 0,this.activeWt=void 0,privatePool$4.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return _createClass$N(e,[{key:"render",value:function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1}},{key:"getCellAtCoords",value:function(e,t){var r=this.wt.getCell(e,t);return r<0?null:r}},{key:"scrollViewport",value:function(e,t,r,n,o){return this.wt.scrollViewport(e,t,r,n,o)}},{key:"scrollViewportHorizontally",value:function(e,t,r){return this.wt.scrollViewportHorizontally(e,t,r)}},{key:"scrollViewportVertically",value:function(e,t,r){return this.wt.scrollViewportVertically(e,t,r)}},{key:"createElements",value:function(){var e=privatePool$4.get(this),t=this.instance,r=t.rootElement,n=t.rootDocument,o=r.getAttribute("style");o&&r.setAttribute("data-originalstyle",o),addClass(r,"handsontable"),e.table=n.createElement("TABLE"),addClass(e.table,"htCore"),this.instance.getSettings().tableClassName&&addClass(e.table,this.instance.getSettings().tableClassName),this.THEAD=n.createElement("THEAD"),e.table.appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),e.table.appendChild(this.TBODY),this.instance.table=e.table,this.instance.container.insertBefore(e.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var e=this,t=privatePool$4.get(this),r=this.instance,n=r.rootElement,o=r.rootDocument,i=r.selection,a=o.documentElement;this.eventManager.addEventListener(n,"mousedown",(function(r){if(t.selectionMouseDown=!0,!e.isTextSelectionAllowed(r.target)){var n=e.instance.rootWindow;clearTextSelection(n),r.preventDefault(),n.focus()}})),this.eventManager.addEventListener(n,"mouseup",(function(){t.selectionMouseDown=!1})),this.eventManager.addEventListener(n,"mousemove",(function(r){t.selectionMouseDown&&!e.isTextSelectionAllowed(r.target)&&(e.settings.fragmentSelection&&clearTextSelection(e.instance.rootWindow),r.preventDefault())})),this.eventManager.addEventListener(a,"keyup",(function(e){i.isInProgress()&&!e.shiftKey&&i.finish()})),this.eventManager.addEventListener(a,"mouseup",(function(r){i.isInProgress()&&isLeftClick(r)&&i.finish(),t.mouseDown=!1,!isOutsideInput(o.activeElement)&&(i.isSelected()||i.isSelectedByAnyHeader()||n.contains(r.target)||isRightClick(r))||e.instance.unlisten()})),this.eventManager.addEventListener(a,"contextmenu",(function(e){i.isInProgress()&&isRightClick(e)&&(i.finish(),t.mouseDown=!1)})),this.eventManager.addEventListener(a,"touchend",(function(){i.isInProgress()&&i.finish(),t.mouseDown=!1})),this.eventManager.addEventListener(a,"mousedown",(function(r){var i=r.target,s=r.x||r.clientX,l=r.y||r.clientY,u=r.target;if(!t.mouseDown&&n&&e.instance.view){var c=e.instance.view.wt.wtTable.holder;if(u===c){var f=getScrollbarWidth(o);if(o.elementFromPoint(s+f,l)!==c||o.elementFromPoint(s,l+f)!==c)return}else for(;u!==a;){if(null===u){if(r.isTargetWebComponent)break;return}if(u===n)return;u=u.parentNode}("function"==typeof e.settings.outsideClickDeselects?e.settings.outsideClickDeselects(i):e.settings.outsideClickDeselects)?e.instance.deselectCell():e.instance.destroyEditor(!1,!1)}})),this.eventManager.addEventListener(t.table,"selectstart",(function(t){e.settings.fragmentSelection||isInput(t.target)||t.preventDefault()}))}},{key:"translateFromRenderableToVisualCoords",value:function(e){var t=e.row,r=e.col;return _construct$5(CellCoords,_toConsumableArray$4(this.translateFromRenderableToVisualIndex(t,r)))}},{key:"translateFromRenderableToVisualIndex",value:function(e,t){var r=e>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e,n=t>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;return null===r&&(r=e),null===n&&(n=t),[r,n]}},{key:"countRenderableColumns",value:function(){return Math.min(this.instance.columnIndexMapper.getRenderableIndexesLength(),this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return Math.min(this.instance.rowIndexMapper.getRenderableIndexesLength(),this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(e,t){return this.countNotHiddenIndexes(e,t,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(e,t){return this.countNotHiddenIndexes(e,t,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(e,t,r,n){if(isNaN(e)||e<0)return 0;var o=r.getFirstNotHiddenIndex(e,t),i=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(i))return 0;var a=0;return t<0?a=i+1:t>0&&(a=n-i),a}},{key:"initializeWalkontable",value:function(){var e=this,t=privatePool$4.get(this),r={externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:t.table,preventOverflow:function(){return e.settings.preventOverflow},preventWheel:function(){return e.settings.preventWheel},stretchH:function(){return e.settings.stretchH},data:function(t,r){var n;return(n=e.instance).getDataAtCell.apply(n,_toConsumableArray$4(e.translateFromRenderableToVisualIndex(t,r)))},totalRows:function(){return e.countRenderableRows()},totalColumns:function(){return e.countRenderableColumns()},fixedColumnsLeft:function(){var t=e.instance.countCols(),r=Math.min(parseInt(e.settings.fixedColumnsLeft,10),t)-1;return e.countNotHiddenColumnIndexes(r,-1)},fixedRowsTop:function(){var t=e.instance.countRows(),r=Math.min(parseInt(e.settings.fixedRowsTop,10),t)-1;return e.countNotHiddenRowIndexes(r,-1)},fixedRowsBottom:function(){var t=e.instance.countRows(),r=Math.max(t-parseInt(e.settings.fixedRowsBottom,10),0);return e.countNotHiddenRowIndexes(r,1)},shouldRenderLeftOverlay:function(){return e.settings.fixedColumnsLeft>0||r.rowHeaders().length>0},shouldRenderTopOverlay:function(){return e.settings.fixedRowsTop>0||r.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return e.settings.fixedRowsBottom>0},minSpareRows:function(){return e.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var t=[];return e.instance.hasRowHeaders()&&t.push((function(t,r){var n=t>=0?e.instance.rowIndexMapper.getVisualFromRenderableIndex(t):t;e.appendRowHeader(n,r)})),e.instance.runHooks("afterGetRowHeaderRenderers",t),t},columnHeaders:function(){var t=[];return e.instance.hasColHeaders()&&t.push((function(t,r){var n=t>=0?e.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;e.appendColHeader(n,r)})),e.instance.runHooks("afterGetColumnHeaderRenderers",t),t},columnWidth:function(t){var r=e.instance.columnIndexMapper.getVisualFromRenderableIndex(t);return e.instance.getColWidth(null===r?t:r)},rowHeight:function(t){var r=e.instance.rowIndexMapper.getVisualFromRenderableIndex(t);return e.instance.getRowHeight(null===r?t:r)},cellRenderer:function(t,r,n){var o=_slicedToArray$5(e.translateFromRenderableToVisualIndex(t,r),2),i=o[0],a=o[1],s=e.instance.runHooks("modifyGetCellCoords",i,a),l=i,u=a;if(Array.isArray(s)){var c=_slicedToArray$5(s,2);l=c[0],u=c[1]}var f=e.instance.getCellMeta(l,u),h=e.instance.colToProp(u),d=e.instance.getDataAtRowProp(l,h);e.instance.hasHook("beforeValueRender")&&(d=e.instance.runHooks("beforeValueRender",d,f)),e.instance.runHooks("beforeRenderer",n,i,a,h,d,f),e.instance.getCellRenderer(f)(e.instance,n,i,a,h,d,f),e.instance.runHooks("afterRenderer",n,i,a,h,d,f)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return e.settings.fragmentSelection},onWindowResize:function(){e.instance&&!e.instance.isDestroyed&&e.instance.refreshDimensions()},onCellMouseDown:function(r,n,o,i){var a=e.translateFromRenderableToVisualCoords(n),s={row:!1,column:!1,cell:!1};e.instance.listen(),e.activeWt=i,t.mouseDown=!0,e.instance.runHooks("beforeOnCellMouseDown",r,a,o,s),isImmediatePropagationStopped(r)||(handleMouseEvent(r,{coords:a,selection:e.instance.selection,controller:s}),e.instance.runHooks("afterOnCellMouseDown",r,a,o),e.activeWt=e.wt)},onCellContextMenu:function(r,n,o,i){var a=e.translateFromRenderableToVisualCoords(n);e.activeWt=i,t.mouseDown=!1,e.instance.selection.isInProgress()&&e.instance.selection.finish(),e.instance.runHooks("beforeOnCellContextMenu",r,a,o),isImmediatePropagationStopped(r)||(e.instance.runHooks("afterOnCellContextMenu",r,a,o),e.activeWt=e.wt)},onCellMouseOut:function(t,r,n,o){var i=e.translateFromRenderableToVisualCoords(r);e.activeWt=o,e.instance.runHooks("beforeOnCellMouseOut",t,i,n),isImmediatePropagationStopped(t)||(e.instance.runHooks("afterOnCellMouseOut",t,i,n),e.activeWt=e.wt)},onCellMouseOver:function(r,n,o,i){var a=e.translateFromRenderableToVisualCoords(n),s={row:!1,column:!1,cell:!1};e.activeWt=i,e.instance.runHooks("beforeOnCellMouseOver",r,a,o,s),isImmediatePropagationStopped(r)||(t.mouseDown&&handleMouseEvent(r,{coords:a,selection:e.instance.selection,controller:s}),e.instance.runHooks("afterOnCellMouseOver",r,a,o),e.activeWt=e.wt)},onCellMouseUp:function(t,r,n,o){var i=e.translateFromRenderableToVisualCoords(r);e.activeWt=o,e.instance.runHooks("beforeOnCellMouseUp",t,i,n),isImmediatePropagationStopped(t)||(e.instance.runHooks("afterOnCellMouseUp",t,i,n),e.activeWt=e.wt)},onCellCornerMouseDown:function(t){t.preventDefault(),e.instance.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:function(t){t.preventDefault(),e.instance.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:function(t,r){return e.beforeRender(t,r)},onDraw:function(t){return e.onDraw(t)},onScrollVertically:function(){return e.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return e.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return e.instance.runHooks("beforeRemoveCellClassNames")},onAfterDrawSelection:function(t,r,n){var o,i=_slicedToArray$5(e.translateFromRenderableToVisualIndex(t,r),2),a=i[0],s=i[1],l=e.instance.selection.getSelectedRange(),u=l.size();if(u>0){var c=(null!=n?n:0)+1-u,f=l.peekByIndex(c);o=[f.from.row,f.from.col,f.to.row,f.to.col]}return e.instance.runHooks("afterDrawSelection",a,s,o,n)},onBeforeDrawBorders:function(t,r){var n=_slicedToArray$5(t,4),o=n[0],i=n[1],a=n[2],s=n[3],l=[e.instance.rowIndexMapper.getVisualFromRenderableIndex(o),e.instance.columnIndexMapper.getVisualFromRenderableIndex(i),e.instance.rowIndexMapper.getVisualFromRenderableIndex(a),e.instance.columnIndexMapper.getVisualFromRenderableIndex(s)];return e.instance.runHooks("beforeDrawBorders",l,r)},onBeforeTouchScroll:function(){return e.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return e.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(t,r){var n=e.instance.columnIndexMapper.getVisualFromRenderableIndex(r);return e.instance.runHooks("beforeStretchingColumnWidth",t,n)},onModifyRowHeaderWidth:function(t){return e.instance.runHooks("modifyRowHeaderWidth",t)},onModifyGetCellCoords:function(t,r,n){var o=e.instance.rowIndexMapper,i=e.instance.columnIndexMapper,a=r>=0?i.getVisualFromRenderableIndex(r):r,s=t>=0?o.getVisualFromRenderableIndex(t):t,l=e.instance.runHooks("modifyGetCellCoords",s,a,n);if(Array.isArray(l)){var u=_slicedToArray$5(l,4),c=u[0],f=u[1],h=u[2],d=u[3];return[c>=0?o.getRenderableFromVisualIndex(o.getFirstNotHiddenIndex(c,1)):c,f>=0?i.getRenderableFromVisualIndex(i.getFirstNotHiddenIndex(f,1)):f,h>=0?o.getRenderableFromVisualIndex(o.getFirstNotHiddenIndex(h,-1)):h,d>=0?i.getRenderableFromVisualIndex(i.getFirstNotHiddenIndex(d,-1)):d]}},viewportRowCalculatorOverride:function(t){var r=e.settings.viewportRowRenderingOffset;if("auto"===r&&e.settings.fixedRowsTop&&(r=10),r>0||"auto"===r){var n=e.countRenderableRows();if("number"==typeof r)t.startRow=Math.max(t.startRow-r,0),t.endRow=Math.min(t.endRow+r,n-1);else if("auto"===r){var o=t.startRow+t.endRow-t.startRow,i=Math.ceil(o/n*12);t.startRow=Math.max(t.startRow-i,0),t.endRow=Math.min(t.endRow+i,n-1)}}e.instance.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:function(t){var r=e.settings.viewportColumnRenderingOffset;if("auto"===r&&e.settings.fixedColumnsLeft&&(r=10),r>0||"auto"===r){var n=e.countRenderableColumns();if("number"==typeof r&&(t.startColumn=Math.max(t.startColumn-r,0),t.endColumn=Math.min(t.endColumn+r,n-1)),"auto"===r){var o=t.startColumn+t.endColumn-t.startColumn,i=Math.ceil(o/n*12);t.startRow=Math.max(t.startColumn-i,0),t.endColumn=Math.min(t.endColumn+i,n-1)}}e.instance.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:function(){return e.settings.rowHeaderWidth},columnHeaderHeight:function(){var t=e.instance.runHooks("modifyColumnHeaderHeight");return e.settings.columnHeaderHeight||t}};this.instance.runHooks("beforeInitWalkontable",r),this.wt=new Walkontable(r),this.activeWt=this.wt;var n=this.wt.wtTable.spreader,o=this.instance.rootElement.getBoundingClientRect(),i=o.width,a=o.height;this.setLastSize(i,a),this.eventManager.addEventListener(n,"mousedown",(function(e){e.target===n&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(n,"contextmenu",(function(e){e.target===n&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",(function(){e.settings.observeDOMVisibility&&e.wt.drawInterrupted&&(e.instance.forceFullRender=!0,e.render())}))}},{key:"isTextSelectionAllowed",value:function(e){if(isInput(e))return!0;var t=isChildOf(e,this.instance.view.wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!t)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!t)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}},{key:"isMouseDown",value:function(){return privatePool$4.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var e,t;return null!==(e=null===(t=this.instance.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&void 0!==e&&e}},{key:"isCellEdited",value:function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()}},{key:"beforeRender",value:function(e,t){e&&this.instance.runHooks("beforeRender",this.instance.forceFullRender,t)}},{key:"onDraw",value:function(e){e&&this.instance.runHooks("afterRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(e,t){if(t.firstChild){var r=t.firstChild;if(!hasClass(r,"relative"))return empty$1(t),void this.appendRowHeader(e,t);this.updateCellHeader(r.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{var n=this.instance,o=n.rootDocument,i=n.getRowHeader,a=o.createElement("div"),s=o.createElement("span");a.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),a.appendChild(s),t.appendChild(a)}this.instance.runHooks("afterGetRowHeader",e,t)}},{key:"appendColHeader",value:function(e,t){if(t.firstChild){var r=t.firstChild;hasClass(r,"relative")?this.updateCellHeader(r.querySelector(".colHeader"),e,this.instance.getColHeader):(empty$1(t),this.appendColHeader(e,t))}else{var n=this.instance.rootDocument,o=n.createElement("div"),i=n.createElement("span");o.className="relative",i.className="colHeader",this.updateCellHeader(i,e,this.instance.getColHeader),o.appendChild(i),t.appendChild(o)}this.instance.runHooks("afterGetColHeader",e,t)}},{key:"updateCellHeader",value:function(e,t,r){var n=t,o=this.wt.wtOverlays.getParentOverlay(e)||this.wt;e.parentNode&&(hasClass(e,"colHeader")?n=o.wtTable.columnFilter.sourceToRendered(t):hasClass(e,"rowHeader")&&(n=o.wtTable.rowFilter.sourceToRendered(t))),n>-1?fastInnerHTML(e,r(t)):(fastInnerText(e,String.fromCharCode(160)),addClass(e,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(e){var t=this.wt.wtViewport.getWorkspaceWidth()-e;return t>0?t:0}},{key:"maximumVisibleElementHeight",value:function(e){var t=this.wt.wtViewport.getWorkspaceHeight()-e;return t>0?t:0}},{key:"setLastSize",value:function(e,t){var r=privatePool$4.get(this),n=[e,t];r.lastWidth=n[0],r.lastHeight=n[1]}},{key:"getLastSize",value:function(){var e=privatePool$4.get(this);return{width:e.lastWidth,height:e.lastHeight}}},{key:"mainViewIsActive",value:function(){return this.wt===this.activeWt}},{key:"destroy",value:function(){this.wt.destroy(),this.eventManager.destroy()}}]),e}(),COLUMN_LABEL_BASE="ABCDEFGHIJKLMNOPQRSTUVWXYZ",COLUMN_LABEL_BASE_LENGTH=COLUMN_LABEL_BASE.length;function spreadsheetColumnLabel(e){for(var t,r=e+1,n="";r>0;)t=(r-1)%COLUMN_LABEL_BASE_LENGTH,n=String.fromCharCode(65+t)+n,r=parseInt((r-t)/COLUMN_LABEL_BASE_LENGTH,10);return n}function spreadsheetColumnIndex(e){var t=0;if(e)for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1)t+=Math.pow(COLUMN_LABEL_BASE_LENGTH,n)*(COLUMN_LABEL_BASE.indexOf(e[r])+1);return t-=1}function createSpreadsheetData(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(e=0;e<r;e++){var i=[];for(t=0;t<n;t++)i.push(spreadsheetColumnLabel(t)+(e+1));o.push(i)}return o}function createSpreadsheetObjectData(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(e=0;e<r;e++){var i={};for(t=0;t<n;t++)i["prop".concat(t)]=spreadsheetColumnLabel(t)+(e+1);o.push(i)}return o}function createEmptySpreadsheetData(e,t){for(var r,n=[],o=0;o<e;o++){r=[];for(var i=0;i<t;i++)r.push("");n.push(r)}return n}function translateRowsToColumns(e){var t,r,n,o,i=[],a=0;for(t=0,r=e.length;t<r;t++)for(n=0,o=e[t].length;n<o;n++)n===a&&(i.push([]),a+=1),i[n].push(e[t][n]);return i}function cellMethodLookupFactory(e,t){var r=void 0===t||t;return function(t,n){return function t(n){if(n){if(hasOwnProperty$1(n,e)&&void 0!==n[e])return n[e];if(hasOwnProperty$1(n,"type")&&n.type){if("string"!=typeof n.type)throw new Error('Cell "type" must be a string');var o=_getItem$3(n.type);if(hasOwnProperty$1(o,e))return o[e];if(r)return}return t(Object.getPrototypeOf(n))}}("number"==typeof t?this.getCellMeta(t,n):t)}}function dataRowToChangesArray(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=e,n=[];return Array.isArray(e)&&Array.isArray(e[0])||(r=[e]),r.forEach((function(e,r){Array.isArray(e)?e.forEach((function(e,o){n.push([r+t,o,e])})):Object.keys(e).forEach((function(o){n.push([r+t,o,e[o]])}))})),n}function countFirstRowKeys(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&isObject$1(e[0])&&(t=deepObjectSize(e[0]))),t}var dataHelpers=Object.freeze({__proto__:null,spreadsheetColumnLabel:spreadsheetColumnLabel,spreadsheetColumnIndex:spreadsheetColumnIndex,createSpreadsheetData:createSpreadsheetData,createSpreadsheetObjectData:createSpreadsheetObjectData,createEmptySpreadsheetData:createEmptySpreadsheetData,translateRowsToColumns:translateRowsToColumns,cellMethodLookupFactory:cellMethodLookupFactory,dataRowToChangesArray:dataRowToChangesArray,countFirstRowKeys:countFirstRowKeys});function _classCallCheck$U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$O(e,t,r){return t&&_defineProperties$O(e.prototype,t),r&&_defineProperties$O(e,r),e}var DataSource=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];_classCallCheck$U(this,e),this.hot=t,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return _createClass$O(e,[{key:"modifyRowData",value:function(e){var t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),void 0===t||Number.isInteger(t)?this.data[e]:t}},{key:"getData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,e):this.data}},{key:"setData",value:function(e){this.data=e}},{key:"getAtColumn",value:function(e){var t=this,r=[];return arrayEach(this.data,(function(n,o){var i=t.getAtCell(o,e);r.push(i)})),r}},{key:"getAtRow",value:function(e,t,r){var n=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=void 0===t&&void 0===r,a=null,s=null;if(a=this.modifyRowData(e),Array.isArray(a))s=[],i?a.forEach((function(t,r){s[r]=n.getAtPhysicalCell(e,r,a)})):rangeEach(t,r,(function(r){s[r-t]=n.getAtPhysicalCell(e,r,a)}));else if(isObject$1(a)||isFunction(a))if(s=o?[]:{},!i||o){var l=0,u=this.countFirstRowKeys()-1;rangeEach(l,u,(function(i){var c=n.colToProp(i);if(i>=(t||l)&&i<=(r||u)&&!Number.isInteger(c)){var f=n.getAtPhysicalCell(e,c,a);o?s.push(f):setProperty(s,c,f)}}))}else objectEach(a,(function(t,r){setProperty(s,r,n.getAtPhysicalCell(e,r,a))}));return s}},{key:"setAtCell",value:function(e,t,r){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var n=createObjectPropListener(r);this.hot.runHooks("modifySourceData",e,this.propToCol(t),n,"set"),n.isTouched()&&(r=n.value)}Number.isInteger(t)?this.data[e][t]=r:setProperty(this.data[e],t,r)}}},{key:"getAtPhysicalCell",value:function(e,t,r){var n=null;if(r&&(n="string"==typeof t?getProperty(r,t):"function"==typeof t?t(r):r[t]),this.hot.hasHook("modifySourceData")){var o=createObjectPropListener(n);this.hot.runHooks("modifySourceData",e,this.colToProp(t),o,"get"),o.isTouched()&&(n=o.value)}return n}},{key:"getAtCell",value:function(e,t){var r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),r)}},{key:"getByRange",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!1,i=null,a=null,s=null,l=null;null===t||null===r?(o=!0,i=0,s=this.countRows()-1):(i=Math.min(t.row,r.row),a=Math.min(t.col,r.col),s=Math.max(t.row,r.row),l=Math.max(t.col,r.col));var u=[];return rangeEach(i,s,(function(t){u.push(o?e.getAtRow(t,void 0,void 0,n):e.getAtRow(t,a,l,n))})),u}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}},{key:"countFirstRowKeys",value:function(){return countFirstRowKeys(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}(),arrayFill=function(e){for(var t=toObject(this),r=toLength(t.length),n=arguments.length,o=toAbsoluteIndex(n>1?arguments[1]:void 0,r),i=n>2?arguments[2]:void 0,a=void 0===i?r:toAbsoluteIndex(i,r);a>o;)t[o++]=e;return t};_export({target:"Array",proto:!0},{fill:arrayFill}),addToUnscopables("fill");var $some=arrayIteration.some,STRICT_METHOD$6=arrayMethodIsStrict("some"),USES_TO_LENGTH$b=arrayMethodUsesToLength("some");function _toConsumableArray$5(e){return _arrayWithoutHoles$5(e)||_iterableToArray$5(e)||_unsupportedIterableToArray$9(e)||_nonIterableSpread$5()}function _nonIterableSpread$5(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$9(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$9(e,t):void 0}}function _iterableToArray$5(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$5(e){if(Array.isArray(e))return _arrayLikeToArray$9(e)}function _arrayLikeToArray$9(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function getListWithInsertedItems(e,t,r){return[].concat(_toConsumableArray$5(e.slice(0,t)),_toConsumableArray$5(r),_toConsumableArray$5(e.slice(t)))}function getListWithRemovedItems(e,t){return arrayFilter(e,(function(e){return!1===t.includes(e)}))}_export({target:"Array",proto:!0,forced:!STRICT_METHOD$6||!USES_TO_LENGTH$b},{some:function(e){return $some(this,e,arguments.length>1?arguments[1]:void 0)}});var MIXIN_NAME$6="localHooks",localHooks={_localHooks:Object.create(null),addLocalHook:function(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks:function(e){for(var t=this,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];this._localHooks[e]&&arrayEach(this._localHooks[e],(function(e){return e.apply(t,n)}))},clearLocalHooks:function(){return this._localHooks={},this}};function _classCallCheck$V(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$P(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$P(e,t,r){return t&&_defineProperties$P(e.prototype,t),r&&_defineProperties$P(e,r),e}defineGetter(localHooks,"MIXIN_NAME",MIXIN_NAME$6,{writable:!1,enumerable:!1});var IndexMap=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;_classCallCheck$V(this,e),this.indexedValues=[],this.initValueOrFn=t}return _createClass$P(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(e){var t=this.getValues();if(e<t.length)return t[e]}},{key:"setValues",value:function(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(e,t){return e<this.getLength()&&(this.indexedValues[e]=t,this.runLocalHooks("change"),!0)}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,isFunction(this.initValueOrFn)?rangeEach(t-1,(function(t){return e.indexedValues.push(e.initValueOrFn(t))})):rangeEach(t-1,(function(){return e.indexedValues.push(e.initValueOrFn)})),this.runLocalHooks("change")}},{key:"init",value:function(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}}]),e}();function getDecreasedIndexes(e,t){return arrayMap(e,(function(e){return e-t.filter((function(t){return t<e})).length}))}function getIncreasedIndexes(e,t,r){var n=r[0],o=r.length;return arrayMap(e,(function(e){return e>=n?e+o:e}))}function _toConsumableArray$6(e){return _arrayWithoutHoles$6(e)||_iterableToArray$6(e)||_unsupportedIterableToArray$a(e)||_nonIterableSpread$6()}function _nonIterableSpread$6(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$a(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$a(e,t):void 0}}function _iterableToArray$6(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$6(e){if(Array.isArray(e))return _arrayLikeToArray$a(e)}function _arrayLikeToArray$a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function getListWithInsertedItems$1(e,t,r,n){var o=r[0];return[].concat(_toConsumableArray$6(e.slice(0,o)),_toConsumableArray$6(r.map((function(e,t){return isFunction(n)?n(e,t):n}))),_toConsumableArray$6(e.slice(o)))}function getListWithRemovedItems$1(e,t){return arrayFilter(e,(function(e,r){return!1===t.includes(r)}))}mixin(IndexMap,localHooks);var alterStrategies=new Map([["indexesSequence",{getListWithInsertedItems:getListWithInsertedItems,getListWithRemovedItems:getListWithRemovedItems}],["physicallyIndexed",{getListWithInsertedItems:getListWithInsertedItems$1,getListWithRemovedItems:getListWithRemovedItems$1}]]),alterUtilsFactory=function(e){if(!1===alterStrategies.has(e))throw new Error("Alter strategy with ID '".concat(e,"' does not exist."));return alterStrategies.get(e)};function _typeof$x(e){return(_typeof$x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$W(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$Q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$Q(e,t,r){return t&&_defineProperties$Q(e.prototype,t),r&&_defineProperties$Q(e,r),e}function _get$7(e,t,r){return(_get$7="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$7(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$7(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$r(e)););return e}function _inherits$r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$s(e,t)}function _setPrototypeOf$s(e,t){return(_setPrototypeOf$s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$r(e){var t=_isNativeReflectConstruct$s();return function(){var r,n=_getPrototypeOf$r(e);if(t){var o=_getPrototypeOf$r(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$r(this,r)}}function _possibleConstructorReturn$r(e,t){return!t||"object"!==_typeof$x(t)&&"function"!=typeof t?_assertThisInitialized$r(e):t}function _assertThisInitialized$r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$r(e){return(_getPrototypeOf$r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var IndexesSequence=function(e){_inherits$r(r,e);var t=_createSuper$r(r);function r(){return _classCallCheck$W(this,r),t.call(this,(function(e){return e}))}return _createClass$Q(r,[{key:"insert",value:function(e,t){var n=getIncreasedIndexes(this.indexedValues,e,t);this.indexedValues=getListWithInsertedItems(n,e,t),_get$7(_getPrototypeOf$r(r.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){var t=getListWithRemovedItems(this.indexedValues,e);this.indexedValues=getDecreasedIndexes(t,e),_get$7(_getPrototypeOf$r(r.prototype),"remove",this).call(this,e)}}]),r}(IndexMap);function _typeof$y(e){return(_typeof$y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$R(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$R(e,t,r){return t&&_defineProperties$R(e.prototype,t),r&&_defineProperties$R(e,r),e}function _get$8(e,t,r){return(_get$8="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$8(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$8(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$s(e)););return e}function _inherits$s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$t(e,t)}function _setPrototypeOf$t(e,t){return(_setPrototypeOf$t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$s(e){var t=_isNativeReflectConstruct$t();return function(){var r,n=_getPrototypeOf$s(e);if(t){var o=_getPrototypeOf$s(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$s(this,r)}}function _possibleConstructorReturn$s(e,t){return!t||"object"!==_typeof$y(t)&&"function"!=typeof t?_assertThisInitialized$s(e):t}function _assertThisInitialized$s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$s(e){return(_getPrototypeOf$s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var PhysicalIndexToValueMap=function(e){_inherits$s(r,e);var t=_createSuper$s(r);function r(){return _classCallCheck$X(this,r),t.apply(this,arguments)}return _createClass$R(r,[{key:"insert",value:function(e,t){this.indexedValues=getListWithInsertedItems$1(this.indexedValues,e,t,this.initValueOrFn),_get$8(_getPrototypeOf$s(r.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=getListWithRemovedItems$1(this.indexedValues,e),_get$8(_getPrototypeOf$s(r.prototype),"remove",this).call(this,e)}}]),r}(IndexMap);function _typeof$z(e){return(_typeof$z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$Y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$S(e,t,r){return t&&_defineProperties$S(e.prototype,t),r&&_defineProperties$S(e,r),e}function _inherits$t(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$u(e,t)}function _setPrototypeOf$u(e,t){return(_setPrototypeOf$u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$t(e){var t=_isNativeReflectConstruct$u();return function(){var r,n=_getPrototypeOf$t(e);if(t){var o=_getPrototypeOf$t(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$t(this,r)}}function _possibleConstructorReturn$t(e,t){return!t||"object"!==_typeof$z(t)&&"function"!=typeof t?_assertThisInitialized$t(e):t}function _assertThisInitialized$t(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$t(e){return(_getPrototypeOf$t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var TrimmingMap=function(e){_inherits$t(r,e);var t=_createSuper$t(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _classCallCheck$Y(this,r),t.call(this,e)}return _createClass$S(r,[{key:"getTrimmedIndexes",value:function(){return arrayReduce(this.getValues(),(function(e,t,r){return t&&e.push(r),e}),[])}}]),r}(PhysicalIndexToValueMap);function _typeof$A(e){return(_typeof$A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$Z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$T(e,t,r){return t&&_defineProperties$T(e.prototype,t),r&&_defineProperties$T(e,r),e}function _inherits$u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$v(e,t)}function _setPrototypeOf$v(e,t){return(_setPrototypeOf$v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$u(e){var t=_isNativeReflectConstruct$v();return function(){var r,n=_getPrototypeOf$u(e);if(t){var o=_getPrototypeOf$u(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$u(this,r)}}function _possibleConstructorReturn$u(e,t){return!t||"object"!==_typeof$A(t)&&"function"!=typeof t?_assertThisInitialized$u(e):t}function _assertThisInitialized$u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$v(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$u(e){return(_getPrototypeOf$u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var HidingMap=function(e){_inherits$u(r,e);var t=_createSuper$u(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _classCallCheck$Z(this,r),t.call(this,e)}return _createClass$T(r,[{key:"getHiddenIndexes",value:function(){return arrayReduce(this.getValues(),(function(e,t,r){return t&&e.push(r),e}),[])}}]),r}(PhysicalIndexToValueMap);function _classCallCheck$_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$U(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$U(e,t,r){return t&&_defineProperties$U(e.prototype,t),r&&_defineProperties$U(e,r),e}var registeredMaps=0,MapCollection=function(){function e(){_classCallCheck$_(this,e),this.collection=new Map}return _createClass$U(e,[{key:"register",value:function(e,t){var r=this;!1===this.collection.has(e)&&(this.collection.set(e,t),t.addLocalHook("change",(function(){return r.runLocalHooks("change",t)})),registeredMaps+=1)}},{key:"unregister",value:function(e){var t=this.collection.get(e);isDefined(t)&&(t.clearLocalHooks(),this.collection.delete(e),this.runLocalHooks("change",t),registeredMaps-=1)}},{key:"get",value:function(e){return isUndefined(e)?Array.from(this.collection.values()):this.collection.get(e)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(e){this.collection.forEach((function(t){t.remove(e)}))}},{key:"insertToEvery",value:function(e,t){this.collection.forEach((function(r){r.insert(e,t)}))}},{key:"initEvery",value:function(e){this.collection.forEach((function(t){t.init(e)}))}}]),e}();function getRegisteredMapsCounter(){return registeredMaps}function _typeof$B(e){return(_typeof$B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$$(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$V(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$V(e,t,r){return t&&_defineProperties$V(e.prototype,t),r&&_defineProperties$V(e,r),e}function _inherits$v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$w(e,t)}function _setPrototypeOf$w(e,t){return(_setPrototypeOf$w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$v(e){var t=_isNativeReflectConstruct$w();return function(){var r,n=_getPrototypeOf$v(e);if(t){var o=_getPrototypeOf$v(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$v(this,r)}}function _possibleConstructorReturn$v(e,t){return!t||"object"!==_typeof$B(t)&&"function"!=typeof t?_assertThisInitialized$v(e):t}function _assertThisInitialized$v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$w(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$v(e){return(_getPrototypeOf$v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}mixin(MapCollection,localHooks);var AggregatedCollection=function(e){_inherits$v(r,e);var t=_createSuper$v(r);function r(e,n){var o;return _classCallCheck$$(this,r),(o=t.call(this)).mergedValuesCache=[],o.aggregationFunction=e,o.fallbackValue=n,o}return _createClass$V(r,[{key:"getMergedValues",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===e)return this.mergedValuesCache;if(0===this.getLength())return[];for(var t=arrayMap(this.get(),(function(e){return e.getValues()})),r=[],n=isDefined(t[0])&&t[0].length||0,o=0;o<n;o+=1){for(var i=[],a=0;a<this.getLength();a+=1)i.push(t[a][o]);r.push(i)}return arrayMap(r,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(e,t){var r=this.getMergedValues(t)[e];return isDefined(r)?r:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(MapCollection);function _toConsumableArray$7(e){return _arrayWithoutHoles$7(e)||_iterableToArray$7(e)||_unsupportedIterableToArray$b(e)||_nonIterableSpread$7()}function _nonIterableSpread$7(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$b(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$b(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$b(e,t):void 0}}function _iterableToArray$7(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$7(e){if(Array.isArray(e))return _arrayLikeToArray$b(e)}function _arrayLikeToArray$b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$10(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$W(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$W(e,t,r){return t&&_defineProperties$W(e.prototype,t),r&&_defineProperties$W(e,r),e}var IndexMapper=function(){function e(){var t=this;_classCallCheck$10(this,e),this.indexesSequence=new IndexesSequence,this.trimmingMapsCollection=new AggregatedCollection((function(e){return e.some((function(e){return!0===e}))}),!1),this.hidingMapsCollection=new AggregatedCollection((function(e){return e.some((function(e){return!0===e}))}),!1),this.variousMapsCollection=new MapCollection,this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",(function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("change",t.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(function(e){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",e,t.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(function(e){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",e,t.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(function(e){t.runLocalHooks("change",e,t.variousMapsCollection)}))}return _createClass$W(e,[{key:"executeBatchOperations",value:function(e){var t=this.isBatched;this.isBatched=!0,e(),this.isBatched=t,this.updateCache()}},{key:"registerMap",value:function(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error('Map with name "'.concat(e,'" has been already registered.'));t instanceof TrimmingMap?this.trimmingMapsCollection.register(e,t):t instanceof HidingMap?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);var r=this.getNumberOfIndexes();return r>0&&t.init(r),t}},{key:"unregisterMap",value:function(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}},{key:"getPhysicalFromVisualIndex",value:function(e){var t=this.notTrimmedIndexesCache[e];return isDefined(t)?t:null}},{key:"getPhysicalFromRenderableIndex",value:function(e){var t=this.renderablePhysicalIndexesCache[e];return isDefined(t)?t:null}},{key:"getVisualFromPhysicalIndex",value:function(e){var t=this.fromPhysicalToVisualIndexesCache.get(e);return isDefined(t)?t:null}},{key:"getVisualFromRenderableIndex",value:function(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}},{key:"getRenderableFromVisualIndex",value:function(e){var t=this.fromVisualToRenderableIndexesCache.get(e);return isDefined(t)?t:null}},{key:"getFirstNotHiddenIndex",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e-t,o=this.getPhysicalFromVisualIndex(e);return null===o?!0===r&&n!==e-t?this.getFirstNotHiddenIndex(n,-t,!1,n):null:!1===this.isHidden(o)?e:this.getFirstNotHiddenIndex(e+t,t,r,n)}},{key:"initToLength",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=_toConsumableArray$7(new Array(t).keys()),this.notHiddenIndexesCache=_toConsumableArray$7(new Array(t).keys()),this.executeBatchOperations((function(){e.indexesSequence.init(t),e.trimmingMapsCollection.initEvery(t)})),this.executeBatchOperations((function(){e.hidingMapsCollection.initEvery(t),e.variousMapsCollection.initEvery(t)})),this.runLocalHooks("init")}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(e){this.indexesSequence.setValues(e)}},{key:"getNotTrimmedIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notTrimmedIndexesCache;var r=this.getIndexesSequence();return r.filter((function(t){return!1===e.isTrimmed(t)}))}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notHiddenIndexesCache;var r=this.getIndexesSequence();return r.filter((function(t){return!1===e.isHidden(t)}))}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.renderablePhysicalIndexesCache;var r=this.getNotTrimmedIndexes();return r.filter((function(t){return!1===e.isHidden(t)}))}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(e,t){var r=this;"number"==typeof e&&(e=[e]);var n=arrayMap(e,(function(e){return r.getPhysicalFromVisualIndex(e)})),o=this.getNotTrimmedIndexesLength(),i=e.length,a=getListWithRemovedItems(this.getIndexesSequence(),n),s=o-i;if(t+i<o){var l=a.filter((function(e){return!1===r.isTrimmed(e)}))[t];s=a.indexOf(l)}this.setIndexesSequence(getListWithInsertedItems(a,s,n))}},{key:"isTrimmed",value:function(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}},{key:"isHidden",value:function(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}},{key:"insertIndexes",value:function(e,t){var r=this,n=this.getNotTrimmedIndexes()[e],o=isDefined(n)?n:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),a=arrayMap(new Array(t).fill(o),(function(e,t){return e+t}));this.executeBatchOperations((function(){r.indexesSequence.insert(i,a),r.trimmingMapsCollection.insertToEvery(i,a),r.hidingMapsCollection.insertToEvery(i,a),r.variousMapsCollection.insertToEvery(i,a)}))}},{key:"removeIndexes",value:function(e){var t=this;this.executeBatchOperations((function(){t.indexesSequence.remove(e),t.trimmingMapsCollection.removeFromEvery(e),t.hidingMapsCollection.removeFromEvery(e),t.variousMapsCollection.removeFromEvery(e)}))}},{key:"updateCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===e||!1===this.isBatched&&!0===t)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderabIendexes(),this.runLocalHooks("cacheUpdated",this.indexesSequenceChanged,this.trimmedIndexesChanged,this.hiddenIndexesChanged),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var t=0;t<e;t+=1){var r=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(r,t)}}},{key:"cacheFromVisualToRenderabIendexes",value:function(){var e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var t=0;t<e;t+=1){var r=this.getPhysicalFromRenderableIndex(t),n=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(n,t)}}}]),e}();mixin(IndexMapper,localHooks);var holder=new WeakMap,rootInstanceSymbol=Symbol("rootInstance");function registerAsRootInstance(e){holder.set(e,!0)}function hasValidParameter(e){return e===rootInstanceSymbol}function isRootInstance(e){return holder.has(e)}function _templateObject$3(){var e=_taggedTemplateLiteral$3(['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'],['Language with code "','" was not found. You should register particular language\\x20\n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.']);return _templateObject$3=function(){return e},e}function _taggedTemplateLiteral$3(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function extendNotExistingKeys(e,t){return objectEach(t,(function(t,r){isUndefined(e[r])&&(e[r]=t)})),e}function normalizeLanguageCode(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(e);return t?"".concat(t[1].toLowerCase(),"-").concat(t[2].toUpperCase()):e}function getValidLanguageCode(e){var t=normalizeLanguageCode(e);return hasLanguage(t)||(t=DEFAULT_LANGUAGE_CODE,warnUserAboutLanguageRegistration(e)),t}function warnUserAboutLanguageRegistration(e){isDefined(e)&&error(toSingleLine(_templateObject$3(),e))}var CONTEXT_MENU_ITEMS_NAMESPACE="ContextMenu:items",CONTEXTMENU_ITEMS_NO_ITEMS="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".noItems"),CONTEXTMENU_ITEMS_ROW_ABOVE="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".insertRowAbove"),CONTEXTMENU_ITEMS_ROW_BELOW="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".insertRowBelow"),CONTEXTMENU_ITEMS_INSERT_LEFT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".insertColumnOnTheLeft"),CONTEXTMENU_ITEMS_INSERT_RIGHT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".insertColumnOnTheRight"),CONTEXTMENU_ITEMS_REMOVE_ROW="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".removeRow"),CONTEXTMENU_ITEMS_REMOVE_COLUMN="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".removeColumn"),CONTEXTMENU_ITEMS_UNDO="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".undo"),CONTEXTMENU_ITEMS_REDO="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".redo"),CONTEXTMENU_ITEMS_READ_ONLY="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".readOnly"),CONTEXTMENU_ITEMS_CLEAR_COLUMN="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".clearColumn"),CONTEXTMENU_ITEMS_COPY="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".copy"),CONTEXTMENU_ITEMS_CUT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".cut"),CONTEXTMENU_ITEMS_FREEZE_COLUMN="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".freezeColumn"),CONTEXTMENU_ITEMS_UNFREEZE_COLUMN="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".unfreezeColumn"),CONTEXTMENU_ITEMS_MERGE_CELLS="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".mergeCells"),CONTEXTMENU_ITEMS_UNMERGE_CELLS="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".unmergeCells"),CONTEXTMENU_ITEMS_ADD_COMMENT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".addComment"),CONTEXTMENU_ITEMS_EDIT_COMMENT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".editComment"),CONTEXTMENU_ITEMS_REMOVE_COMMENT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".removeComment"),CONTEXTMENU_ITEMS_READ_ONLY_COMMENT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".readOnlyComment"),CONTEXTMENU_ITEMS_ALIGNMENT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".align"),CONTEXTMENU_ITEMS_ALIGNMENT_LEFT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".align.left"),CONTEXTMENU_ITEMS_ALIGNMENT_CENTER="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".align.center"),CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".align.right"),CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".align.justify"),CONTEXTMENU_ITEMS_ALIGNMENT_TOP="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".align.top"),CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".align.middle"),CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".align.bottom"),CONTEXTMENU_ITEMS_BORDERS="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".borders"),CONTEXTMENU_ITEMS_BORDERS_TOP="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".borders.top"),CONTEXTMENU_ITEMS_BORDERS_RIGHT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".borders.right"),CONTEXTMENU_ITEMS_BORDERS_BOTTOM="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".borders.bottom"),CONTEXTMENU_ITEMS_BORDERS_LEFT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".borders.left"),CONTEXTMENU_ITEMS_REMOVE_BORDERS="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".borders.remove"),CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".nestedHeaders.insertChildRow"),CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".nestedHeaders.detachFromParent"),CONTEXTMENU_ITEMS_HIDE_COLUMN="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".hideColumn"),CONTEXTMENU_ITEMS_SHOW_COLUMN="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".showColumn"),CONTEXTMENU_ITEMS_HIDE_ROW="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".hideRow"),CONTEXTMENU_ITEMS_SHOW_ROW="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".showRow"),FILTERS_NAMESPACE="Filters:",FILTERS_CONDITIONS_NAMESPACE="".concat(FILTERS_NAMESPACE,"conditions"),FILTERS_CONDITIONS_NONE="".concat(FILTERS_CONDITIONS_NAMESPACE,".none"),FILTERS_CONDITIONS_EMPTY="".concat(FILTERS_CONDITIONS_NAMESPACE,".isEmpty"),FILTERS_CONDITIONS_NOT_EMPTY="".concat(FILTERS_CONDITIONS_NAMESPACE,".isNotEmpty"),FILTERS_CONDITIONS_EQUAL="".concat(FILTERS_CONDITIONS_NAMESPACE,".isEqualTo"),FILTERS_CONDITIONS_NOT_EQUAL="".concat(FILTERS_CONDITIONS_NAMESPACE,".isNotEqualTo"),FILTERS_CONDITIONS_BEGINS_WITH="".concat(FILTERS_CONDITIONS_NAMESPACE,".beginsWith"),FILTERS_CONDITIONS_ENDS_WITH="".concat(FILTERS_CONDITIONS_NAMESPACE,".endsWith"),FILTERS_CONDITIONS_CONTAINS="".concat(FILTERS_CONDITIONS_NAMESPACE,".contains"),FILTERS_CONDITIONS_NOT_CONTAIN="".concat(FILTERS_CONDITIONS_NAMESPACE,".doesNotContain"),FILTERS_CONDITIONS_BY_VALUE="".concat(FILTERS_CONDITIONS_NAMESPACE,".byValue"),FILTERS_CONDITIONS_GREATER_THAN="".concat(FILTERS_CONDITIONS_NAMESPACE,".greaterThan"),FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL="".concat(FILTERS_CONDITIONS_NAMESPACE,".greaterThanOrEqualTo"),FILTERS_CONDITIONS_LESS_THAN="".concat(FILTERS_CONDITIONS_NAMESPACE,".lessThan"),FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL="".concat(FILTERS_CONDITIONS_NAMESPACE,".lessThanOrEqualTo"),FILTERS_CONDITIONS_BETWEEN="".concat(FILTERS_CONDITIONS_NAMESPACE,".isBetween"),FILTERS_CONDITIONS_NOT_BETWEEN="".concat(FILTERS_CONDITIONS_NAMESPACE,".isNotBetween"),FILTERS_CONDITIONS_AFTER="".concat(FILTERS_CONDITIONS_NAMESPACE,".after"),FILTERS_CONDITIONS_BEFORE="".concat(FILTERS_CONDITIONS_NAMESPACE,".before"),FILTERS_CONDITIONS_TODAY="".concat(FILTERS_CONDITIONS_NAMESPACE,".today"),FILTERS_CONDITIONS_TOMORROW="".concat(FILTERS_CONDITIONS_NAMESPACE,".tomorrow"),FILTERS_CONDITIONS_YESTERDAY="".concat(FILTERS_CONDITIONS_NAMESPACE,".yesterday"),FILTERS_DIVS_FILTER_BY_CONDITION="".concat(FILTERS_NAMESPACE,"labels.filterByCondition"),FILTERS_DIVS_FILTER_BY_VALUE="".concat(FILTERS_NAMESPACE,"labels.filterByValue"),FILTERS_LABELS_CONJUNCTION="".concat(FILTERS_NAMESPACE,"labels.conjunction"),FILTERS_LABELS_DISJUNCTION="".concat(FILTERS_NAMESPACE,"labels.disjunction"),FILTERS_VALUES_BLANK_CELLS="".concat(FILTERS_NAMESPACE,"values.blankCells"),FILTERS_BUTTONS_SELECT_ALL="".concat(FILTERS_NAMESPACE,"buttons.selectAll"),FILTERS_BUTTONS_CLEAR="".concat(FILTERS_NAMESPACE,"buttons.clear"),FILTERS_BUTTONS_OK="".concat(FILTERS_NAMESPACE,"buttons.ok"),FILTERS_BUTTONS_CANCEL="".concat(FILTERS_NAMESPACE,"buttons.cancel"),FILTERS_BUTTONS_PLACEHOLDER_SEARCH="".concat(FILTERS_NAMESPACE,"buttons.placeholder.search"),FILTERS_BUTTONS_PLACEHOLDER_VALUE="".concat(FILTERS_NAMESPACE,"buttons.placeholder.value"),FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE="".concat(FILTERS_NAMESPACE,"buttons.placeholder.secondValue"),constants=Object.freeze({__proto__:null,CONTEXT_MENU_ITEMS_NAMESPACE:CONTEXT_MENU_ITEMS_NAMESPACE,CONTEXTMENU_ITEMS_NO_ITEMS:CONTEXTMENU_ITEMS_NO_ITEMS,CONTEXTMENU_ITEMS_ROW_ABOVE:CONTEXTMENU_ITEMS_ROW_ABOVE,CONTEXTMENU_ITEMS_ROW_BELOW:CONTEXTMENU_ITEMS_ROW_BELOW,CONTEXTMENU_ITEMS_INSERT_LEFT:CONTEXTMENU_ITEMS_INSERT_LEFT,CONTEXTMENU_ITEMS_INSERT_RIGHT:CONTEXTMENU_ITEMS_INSERT_RIGHT,CONTEXTMENU_ITEMS_REMOVE_ROW:CONTEXTMENU_ITEMS_REMOVE_ROW,CONTEXTMENU_ITEMS_REMOVE_COLUMN:CONTEXTMENU_ITEMS_REMOVE_COLUMN,CONTEXTMENU_ITEMS_UNDO:CONTEXTMENU_ITEMS_UNDO,CONTEXTMENU_ITEMS_REDO:CONTEXTMENU_ITEMS_REDO,CONTEXTMENU_ITEMS_READ_ONLY:CONTEXTMENU_ITEMS_READ_ONLY,CONTEXTMENU_ITEMS_CLEAR_COLUMN:CONTEXTMENU_ITEMS_CLEAR_COLUMN,CONTEXTMENU_ITEMS_COPY:CONTEXTMENU_ITEMS_COPY,CONTEXTMENU_ITEMS_CUT:CONTEXTMENU_ITEMS_CUT,CONTEXTMENU_ITEMS_FREEZE_COLUMN:CONTEXTMENU_ITEMS_FREEZE_COLUMN,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,CONTEXTMENU_ITEMS_MERGE_CELLS:CONTEXTMENU_ITEMS_MERGE_CELLS,CONTEXTMENU_ITEMS_UNMERGE_CELLS:CONTEXTMENU_ITEMS_UNMERGE_CELLS,CONTEXTMENU_ITEMS_ADD_COMMENT:CONTEXTMENU_ITEMS_ADD_COMMENT,CONTEXTMENU_ITEMS_EDIT_COMMENT:CONTEXTMENU_ITEMS_EDIT_COMMENT,CONTEXTMENU_ITEMS_REMOVE_COMMENT:CONTEXTMENU_ITEMS_REMOVE_COMMENT,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,CONTEXTMENU_ITEMS_ALIGNMENT:CONTEXTMENU_ITEMS_ALIGNMENT,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:CONTEXTMENU_ITEMS_ALIGNMENT_TOP,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,CONTEXTMENU_ITEMS_BORDERS:CONTEXTMENU_ITEMS_BORDERS,CONTEXTMENU_ITEMS_BORDERS_TOP:CONTEXTMENU_ITEMS_BORDERS_TOP,CONTEXTMENU_ITEMS_BORDERS_RIGHT:CONTEXTMENU_ITEMS_BORDERS_RIGHT,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:CONTEXTMENU_ITEMS_BORDERS_BOTTOM,CONTEXTMENU_ITEMS_BORDERS_LEFT:CONTEXTMENU_ITEMS_BORDERS_LEFT,CONTEXTMENU_ITEMS_REMOVE_BORDERS:CONTEXTMENU_ITEMS_REMOVE_BORDERS,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,CONTEXTMENU_ITEMS_HIDE_COLUMN:CONTEXTMENU_ITEMS_HIDE_COLUMN,CONTEXTMENU_ITEMS_SHOW_COLUMN:CONTEXTMENU_ITEMS_SHOW_COLUMN,CONTEXTMENU_ITEMS_HIDE_ROW:CONTEXTMENU_ITEMS_HIDE_ROW,CONTEXTMENU_ITEMS_SHOW_ROW:CONTEXTMENU_ITEMS_SHOW_ROW,FILTERS_NAMESPACE:FILTERS_NAMESPACE,FILTERS_CONDITIONS_NAMESPACE:FILTERS_CONDITIONS_NAMESPACE,FILTERS_CONDITIONS_NONE:FILTERS_CONDITIONS_NONE,FILTERS_CONDITIONS_EMPTY:FILTERS_CONDITIONS_EMPTY,FILTERS_CONDITIONS_NOT_EMPTY:FILTERS_CONDITIONS_NOT_EMPTY,FILTERS_CONDITIONS_EQUAL:FILTERS_CONDITIONS_EQUAL,FILTERS_CONDITIONS_NOT_EQUAL:FILTERS_CONDITIONS_NOT_EQUAL,FILTERS_CONDITIONS_BEGINS_WITH:FILTERS_CONDITIONS_BEGINS_WITH,FILTERS_CONDITIONS_ENDS_WITH:FILTERS_CONDITIONS_ENDS_WITH,FILTERS_CONDITIONS_CONTAINS:FILTERS_CONDITIONS_CONTAINS,FILTERS_CONDITIONS_NOT_CONTAIN:FILTERS_CONDITIONS_NOT_CONTAIN,FILTERS_CONDITIONS_BY_VALUE:FILTERS_CONDITIONS_BY_VALUE,FILTERS_CONDITIONS_GREATER_THAN:FILTERS_CONDITIONS_GREATER_THAN,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,FILTERS_CONDITIONS_LESS_THAN:FILTERS_CONDITIONS_LESS_THAN,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,FILTERS_CONDITIONS_BETWEEN:FILTERS_CONDITIONS_BETWEEN,FILTERS_CONDITIONS_NOT_BETWEEN:FILTERS_CONDITIONS_NOT_BETWEEN,FILTERS_CONDITIONS_AFTER:FILTERS_CONDITIONS_AFTER,FILTERS_CONDITIONS_BEFORE:FILTERS_CONDITIONS_BEFORE,FILTERS_CONDITIONS_TODAY:FILTERS_CONDITIONS_TODAY,FILTERS_CONDITIONS_TOMORROW:FILTERS_CONDITIONS_TOMORROW,FILTERS_CONDITIONS_YESTERDAY:FILTERS_CONDITIONS_YESTERDAY,FILTERS_DIVS_FILTER_BY_CONDITION:FILTERS_DIVS_FILTER_BY_CONDITION,FILTERS_DIVS_FILTER_BY_VALUE:FILTERS_DIVS_FILTER_BY_VALUE,FILTERS_LABELS_CONJUNCTION:FILTERS_LABELS_CONJUNCTION,FILTERS_LABELS_DISJUNCTION:FILTERS_LABELS_DISJUNCTION,FILTERS_VALUES_BLANK_CELLS:FILTERS_VALUES_BLANK_CELLS,FILTERS_BUTTONS_SELECT_ALL:FILTERS_BUTTONS_SELECT_ALL,FILTERS_BUTTONS_CLEAR:FILTERS_BUTTONS_CLEAR,FILTERS_BUTTONS_OK:FILTERS_BUTTONS_OK,FILTERS_BUTTONS_CANCEL:FILTERS_BUTTONS_CANCEL,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:FILTERS_BUTTONS_PLACEHOLDER_SEARCH,FILTERS_BUTTONS_PLACEHOLDER_VALUE:FILTERS_BUTTONS_PLACEHOLDER_VALUE,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE}),_dictionary;function _defineProperty$3(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var dictionary=(_dictionary={languageCode:"en-US"},_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_NO_ITEMS,"No available options"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_ROW_ABOVE,"Insert row above"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_ROW_BELOW,"Insert row below"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_INSERT_LEFT,"Insert column left"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_INSERT_RIGHT,"Insert column right"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_REMOVE_ROW,["Remove row","Remove rows"]),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_REMOVE_COLUMN,["Remove column","Remove columns"]),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_UNDO,"Undo"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_REDO,"Redo"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_READ_ONLY,"Read only"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_CLEAR_COLUMN,"Clear column"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_ALIGNMENT,"Alignment"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,"Left"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,"Center"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,"Right"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,"Justify"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_ALIGNMENT_TOP,"Top"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,"Middle"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,"Bottom"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_FREEZE_COLUMN,"Freeze column"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,"Unfreeze column"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_BORDERS,"Borders"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_BORDERS_TOP,"Top"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_BORDERS_RIGHT,"Right"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_BORDERS_BOTTOM,"Bottom"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_BORDERS_LEFT,"Left"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_REMOVE_BORDERS,"Remove border(s)"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_ADD_COMMENT,"Add comment"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_EDIT_COMMENT,"Edit comment"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_REMOVE_COMMENT,"Delete comment"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,"Read-only comment"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_MERGE_CELLS,"Merge cells"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_UNMERGE_CELLS,"Unmerge cells"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_COPY,"Copy"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_CUT,"Cut"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,"Insert child row"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,"Detach from parent"),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_HIDE_COLUMN,["Hide column","Hide columns"]),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_SHOW_COLUMN,["Show column","Show columns"]),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_HIDE_ROW,["Hide row","Hide rows"]),_defineProperty$3(_dictionary,CONTEXTMENU_ITEMS_SHOW_ROW,["Show row","Show rows"]),_defineProperty$3(_dictionary,FILTERS_CONDITIONS_NONE,"None"),_defineProperty$3(_dictionary,FILTERS_CONDITIONS_EMPTY,"Is empty"),_defineProperty$3(_dictionary,FILTERS_CONDITIONS_NOT_EMPTY,"Is not empty"),_defineProperty$3(_dictionary,FILTERS_CONDITIONS_EQUAL,"Is equal to"),_defineProperty$3(_dictionary,FILTERS_CONDITIONS_NOT_EQUAL,"Is not equal to"),_defineProperty$3(_dictionary,FILTERS_CONDITIONS_BEGINS_WITH,"Begins with"),_defineProperty$3(_dictionary,FILTERS_CONDITIONS_ENDS_WITH,"Ends with"),_defineProperty$3(_dictionary,FILTERS_CONDITIONS_CONTAINS,"Contains"),_defineProperty$3(_dictionary,FILTERS_CONDITIONS_NOT_CONTAIN,"Does not contain"),_defineProperty$3(_dictionary,FILTERS_CONDITIONS_GREATER_THAN,"Greater than"),_defineProperty$3(_dictionary,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,"Greater than or equal to"),_defineProperty$3(_dictionary,FILTERS_CONDITIONS_LESS_THAN,"Less than"),_defineProperty$3(_dictionary,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,"Less than or equal to"),_defineProperty$3(_dictionary,FILTERS_CONDITIONS_BETWEEN,"Is between"),_defineProperty$3(_dictionary,FILTERS_CONDITIONS_NOT_BETWEEN,"Is not between"),_defineProperty$3(_dictionary,FILTERS_CONDITIONS_AFTER,"After"),_defineProperty$3(_dictionary,FILTERS_CONDITIONS_BEFORE,"Before"),_defineProperty$3(_dictionary,FILTERS_CONDITIONS_TODAY,"Today"),_defineProperty$3(_dictionary,FILTERS_CONDITIONS_TOMORROW,"Tomorrow"),_defineProperty$3(_dictionary,FILTERS_CONDITIONS_YESTERDAY,"Yesterday"),_defineProperty$3(_dictionary,FILTERS_VALUES_BLANK_CELLS,"Blank cells"),_defineProperty$3(_dictionary,FILTERS_DIVS_FILTER_BY_CONDITION,"Filter by condition"),_defineProperty$3(_dictionary,FILTERS_DIVS_FILTER_BY_VALUE,"Filter by value"),_defineProperty$3(_dictionary,FILTERS_LABELS_CONJUNCTION,"And"),_defineProperty$3(_dictionary,FILTERS_LABELS_DISJUNCTION,"Or"),_defineProperty$3(_dictionary,FILTERS_BUTTONS_SELECT_ALL,"Select all"),_defineProperty$3(_dictionary,FILTERS_BUTTONS_CLEAR,"Clear"),_defineProperty$3(_dictionary,FILTERS_BUTTONS_OK,"OK"),_defineProperty$3(_dictionary,FILTERS_BUTTONS_CANCEL,"Cancel"),_defineProperty$3(_dictionary,FILTERS_BUTTONS_PLACEHOLDER_SEARCH,"Search"),_defineProperty$3(_dictionary,FILTERS_BUTTONS_PLACEHOLDER_VALUE,"Value"),_defineProperty$3(_dictionary,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,"Second value"),_dictionary),DEFAULT_LANGUAGE_CODE=dictionary.languageCode,_staticRegister$4=staticRegister("languagesDictionaries"),registerGloballyLanguageDictionary=_staticRegister$4.register,getGlobalLanguageDictionary=_staticRegister$4.getItem,hasGlobalLanguageDictionary=_staticRegister$4.hasItem,getGlobalLanguagesDictionaries=_staticRegister$4.getValues;function registerLanguage(e,t){var r=e,n=t;return isObject$1(e)&&(r=(n=e).languageCode),extendLanguageDictionary(r,n),registerGloballyLanguageDictionary(r,deepClone(n)),deepClone(n)}function getLanguage(e){return hasLanguage(e)?deepClone(getGlobalLanguageDictionary(e)):null}function hasLanguage(e){return hasGlobalLanguageDictionary(e)}function extendLanguageDictionary(e,t){e!==DEFAULT_LANGUAGE_CODE&&extendNotExistingKeys(t,getGlobalLanguageDictionary(DEFAULT_LANGUAGE_CODE))}function getLanguages(){return getGlobalLanguagesDictionaries()}function pluralize(e,t){return Array.isArray(e)&&Number.isInteger(t)?e[t]:e}registerLanguage(dictionary);var _staticRegister$5=staticRegister("phraseFormatters"),registerGloballyPhraseFormatter=_staticRegister$5.register,getGlobalPhraseFormatters=_staticRegister$5.getValues;function register$4(e,t){registerGloballyPhraseFormatter(e,t)}function getAll(){return getGlobalPhraseFormatters()}function getTranslatedPhrase(e,t,r){var n=getLanguage(e);if(null===n)return null;var o=n[t];if(isUndefined(o))return null;var i=getFormattedPhrase(o,r);return Array.isArray(i)?i[0]:i}function getFormattedPhrase(e,t){var r=e;return arrayEach(getAll(),(function(n){r=n(e,t)})),r}register$4("pluralize",pluralize);var eventManager=new EventManager,pressedKeys=new Set,refCount=0;function startObserving(e){0===refCount&&(eventManager.addEventListener(e,"keydown",(function(e){pressedKeys.has(e.keyCode)||pressedKeys.add(e.keyCode)})),eventManager.addEventListener(e,"keyup",(function(e){pressedKeys.has(e.keyCode)&&pressedKeys.delete(e.keyCode)})),eventManager.addEventListener(e,"visibilitychange",(function(){e.hidden&&pressedKeys.clear()})),eventManager.addEventListener(e.defaultView,"blur",(function(){pressedKeys.clear()}))),refCount+=1}function stopObserving(){refCount>0&&(refCount-=1),0===refCount&&_resetState()}function _resetState(){eventManager.clearEvents(),pressedKeys.clear(),refCount=0}function isPressedCtrlKey(){return Array.from(pressedKeys.values()).some((function(e){return isCtrlMetaKey(e)}))}function _typeof$C(e){return(_typeof$C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _slicedToArray$6(e,t){return _arrayWithHoles$6(e)||_iterableToArrayLimit$6(e,t)||_unsupportedIterableToArray$c(e,t)||_nonIterableRest$6()}function _nonIterableRest$6(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$c(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$c(e,t):void 0}}function _arrayLikeToArray$c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$6(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$6(e){if(Array.isArray(e))return e}function _classCallCheck$11(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$X(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$X(e,t,r){return t&&_defineProperties$X(e.prototype,t),r&&_defineProperties$X(e,r),e}function _get$9(e,t,r){return(_get$9="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$9(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$9(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$w(e)););return e}function _inherits$w(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$x(e,t)}function _setPrototypeOf$x(e,t){return(_setPrototypeOf$x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$w(e){var t=_isNativeReflectConstruct$x();return function(){var r,n=_getPrototypeOf$w(e);if(t){var o=_getPrototypeOf$w(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$w(this,r)}}function _possibleConstructorReturn$w(e,t){return!t||"object"!==_typeof$C(t)&&"function"!=typeof t?_assertThisInitialized$w(e):t}function _assertThisInitialized$w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$x(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$w(e){return(_getPrototypeOf$w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}_export({target:"Object",stat:!0,sham:!descriptors},{getOwnPropertyDescriptors:function(e){for(var t,r,n=toIndexedObject(e),o=objectGetOwnPropertyDescriptor.f,i=ownKeys(n),a={},s=0;i.length>s;)void 0!==(r=o(n,t=i[s++]))&&createProperty(a,t,r);return a}});var VisualSelection=function(e){_inherits$w(r,e);var t=_createSuper$w(r);function r(e,n){var o;return _classCallCheck$11(this,r),(o=t.call(this,e,null)).visualCellRange=n||null,o.commit(),o}return _createClass$X(r,[{key:"add",value:function(e){return null===this.visualCellRange?this.visualCellRange=new CellRange(e):this.visualCellRange.expand(e),this}},{key:"clear",value:function(){return this.visualCellRange=null,_get$9(_getPrototypeOf$w(r.prototype),"clear",this).call(this)}},{key:"findVisibleCoordsInRange",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r,o=this.findVisibleCoordsInRowsRange(e.row,t.row,r);if(null===o)return null;var i=this.findVisibleCoordsInColumnsRange(e.col,t.col,n);return null===i?null:new CellCoords(o,i)}},{key:"findVisibleCoordsInRowsRange",value:function(e,t,r){var n=this.settings.visualToRenderableCoords({row:e,col:-1}).row;return t===e&&null===n?null:null===n?this.findVisibleCoordsInRowsRange(e+r,t,r):e}},{key:"findVisibleCoordsInColumnsRange",value:function(e,t,r){var n=this.settings.visualToRenderableCoords({row:-1,col:e}).col;return t===e&&null===n?null:null===n?this.findVisibleCoordsInColumnsRange(e+r,t,r):e}},{key:"findVisibleHeaderRange",value:function(e,t,r,n){var o=this.findVisibleCoordsInRowsRange(e.row,t.row,r),i=this.findVisibleCoordsInRowsRange(t.row,e.row,-r),a=this.findVisibleCoordsInColumnsRange(e.col,t.col,n),s=this.findVisibleCoordsInColumnsRange(t.col,e.col,-n);return null===o&&null===i&&null===a&&null===s?null:[new CellCoords(o,a),new CellCoords(i,s)]}},{key:"commit",value:function(){if(null===this.visualCellRange)return this;var e=this.visualCellRange,t=e.from,r=e.to,n=this.getRowSearchDirection(this.visualCellRange),o=this.getColumnSearchDirection(this.visualCellRange),i=this.findVisibleCoordsInRange(t,r,n,o),a=this.findVisibleCoordsInRange(r,t,-n,-o);if(null===i||null===a){var s=null;if("header"===this.settings.type){var l=_slicedToArray$6(this.findVisibleHeaderRange(t,r,n,o),2),u=l[0],c=l[1];s=this.createRenderableCellRange(u,c)}this.cellRange=s}else this.cellRange=this.createRenderableCellRange(i,a);return this}},{key:"adjustCoordinates",value:function(e){var t=this.getRowSearchDirection(e),r=this.getColumnSearchDirection(e),n=e.from.clone().normalize(),o=e.to.clone().normalize(),i=this.findVisibleCoordsInRange(n,o,t,r);if(null!==i){if(null===this.cellRange){var a=this.settings.visualToRenderableCoords(i);this.cellRange=new CellRange(a)}return e.setHighlight(i),this}return e.setHighlight(e.from),this}},{key:"getCorners",value:function(){var e=this.cellRange,t=e.from,r=e.to,n=null===t.row||null===r.row,o=null===t.col||null===r.col,i=new CellCoords(n?null:Math.min(t.row,r.row),o?null:Math.min(t.col,r.col)),a=new CellCoords(n?null:Math.max(t.row,r.row),o?null:Math.max(t.col,r.col));return[i.row,i.col,a.row,a.col]}},{key:"getVisualCorners",value:function(){var e=this.settings.renderableToVisualCoords(this.cellRange.getTopLeftCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomRightCorner());return[e.row,e.col,t.row,t.col]}},{key:"createRenderableCellRange",value:function(e,t){var r=this.settings.visualToRenderableCoords(e),n=this.settings.visualToRenderableCoords(t);return new CellRange(r,r,n)}},{key:"getRowSearchDirection",value:function(e){return e.from.row<e.to.row?1:-1}},{key:"getColumnSearchDirection",value:function(e){return e.from.col<e.to.col?1:-1}}]),r}(Selection);function ownKeys$1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$1(Object(r),!0).forEach((function(t){_defineProperty$4(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$1(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$4(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectWithoutProperties(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}function createHighlight(e){var t=e.activeHeaderClassName,r=_objectWithoutProperties(e,["activeHeaderClassName"]);return new VisualSelection(_objectSpread({highlightHeaderClassName:t},r))}function ownKeys$2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$1(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$2(Object(r),!0).forEach((function(t){_defineProperty$5(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$2(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$5(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectWithoutProperties$1(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose$1(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _objectWithoutPropertiesLoose$1(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}function createHighlight$1(e){var t=e.layerLevel,r=e.areaCornerVisible,n=_objectWithoutProperties$1(e,["layerLevel","areaCornerVisible"]);return new VisualSelection(_objectSpread$1({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n))}function ownKeys$3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$2(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$3(Object(r),!0).forEach((function(t){_defineProperty$6(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$3(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$6(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectWithoutProperties$2(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose$2(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _objectWithoutPropertiesLoose$2(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}function createHighlight$2(e){var t=e.cellCornerVisible,r=_objectWithoutProperties$2(e,["cellCornerVisible"]);return new VisualSelection(_objectSpread$2({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},r))}function ownKeys$4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$3(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$4(Object(r),!0).forEach((function(t){_defineProperty$7(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$4(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$7(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectWithoutProperties$3(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose$3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _objectWithoutPropertiesLoose$3(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}function createHighlight$3(e){var t=e.border,r=e.visualCellRange,n=_objectWithoutProperties$3(e,["border","visualCellRange"]);return new VisualSelection(_objectSpread$3(_objectSpread$3({},t),n),r)}var nativeAssign=Object.assign,defineProperty$8=Object.defineProperty,objectAssign=!nativeAssign||fails((function(){if(descriptors&&1!==nativeAssign({b:1},nativeAssign(defineProperty$8({},"a",{enumerable:!0,get:function(){defineProperty$8(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach((function(e){t[e]=e})),7!=nativeAssign({},e)[r]||objectKeys(nativeAssign({},t)).join("")!=n}))?function(e,t){for(var r=toObject(e),n=arguments.length,o=1,i=objectGetOwnPropertySymbols.f,a=objectPropertyIsEnumerable.f;n>o;)for(var s,l=indexedObject(arguments[o++]),u=i?objectKeys(l).concat(i(l)):objectKeys(l),c=u.length,f=0;c>f;)s=u[f++],descriptors&&!a.call(l,s)||(r[s]=l[s]);return r}:nativeAssign;function ownKeys$5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$4(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$5(Object(r),!0).forEach((function(t){_defineProperty$8(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$5(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$8(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function createHighlight$4(e){var t=Object.assign({},e);return new VisualSelection(_objectSpread$4({className:"fill",border:{width:1,color:"#ff0000"}},t))}function ownKeys$6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$5(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$6(Object(r),!0).forEach((function(t){_defineProperty$9(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$6(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$9(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectWithoutProperties$4(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose$4(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _objectWithoutPropertiesLoose$4(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}function createHighlight$5(e){var t=e.headerClassName,r=e.rowClassName,n=e.columnClassName,o=_objectWithoutProperties$4(e,["headerClassName","rowClassName","columnClassName"]);return new VisualSelection(_objectSpread$5({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:r,highlightColumnClassName:n},o))}function ownKeys$7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$6(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$7(Object(r),!0).forEach((function(t){_defineProperty$a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$7(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}_export({target:"Object",stat:!0,forced:Object.assign!==objectAssign},{assign:objectAssign});var _staticRegister$6=staticRegister("highlight/types"),register$5=_staticRegister$6.register,getItem$4=_staticRegister$6.getItem;function createHighlight$6(e,t){return getItem$4(e)(_objectSpread$6({type:e},t))}function _toConsumableArray$8(e){return _arrayWithoutHoles$8(e)||_iterableToArray$8(e)||_unsupportedIterableToArray$d(e)||_nonIterableSpread$8()}function _nonIterableSpread$8(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$d(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$d(e,t):void 0}}function _iterableToArray$8(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$8(e){if(Array.isArray(e))return _arrayLikeToArray$d(e)}function _arrayLikeToArray$d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ownKeys$8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$7(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$8(Object(r),!0).forEach((function(t){_defineProperty$b(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$8(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck$12(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$Y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$Y(e,t,r){return t&&_defineProperties$Y(e.prototype,t),r&&_defineProperties$Y(e,r),e}register$5("active-header",createHighlight),register$5("area",createHighlight$1),register$5("cell",createHighlight$2),register$5("custom-selection",createHighlight$3),register$5("fill",createHighlight$4),register$5("header",createHighlight$5);var ACTIVE_HEADER_TYPE="active-header",AREA_TYPE="area",CELL_TYPE$9="cell",FILL_TYPE="fill",HEADER_TYPE="header",CUSTOM_SELECTION="custom-selection",Highlight=function(){function e(t){_classCallCheck$12(this,e),this.options=t,this.layerLevel=0,this.cell=createHighlight$6(CELL_TYPE$9,t),this.fill=createHighlight$6(FILL_TYPE,t),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return _createClass$Y(e,[{key:"isEnabledFor",value:function(e){var t="current"===e?CELL_TYPE$9:e,r=this.options.disableHighlight;return"string"==typeof r&&(r=[r]),!1===r||Array.isArray(r)&&!r.includes(t)}},{key:"useLayerLevel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=e,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var e,t=this.layerLevel;return this.areas.has(t)?e=this.areas.get(t):(e=createHighlight$6(AREA_TYPE,_objectSpread$7({layerLevel:t},this.options)),this.areas.set(t,e)),e}},{key:"getAreas",value:function(){return _toConsumableArray$8(this.areas.values())}},{key:"createOrGetHeader",value:function(){var e,t=this.layerLevel;return this.headers.has(t)?e=this.headers.get(t):(e=createHighlight$6(HEADER_TYPE,_objectSpread$7({},this.options)),this.headers.set(t,e)),e}},{key:"getHeaders",value:function(){return _toConsumableArray$8(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var e,t=this.layerLevel;return this.activeHeaders.has(t)?e=this.activeHeaders.get(t):(e=createHighlight$6(ACTIVE_HEADER_TYPE,_objectSpread$7({},this.options)),this.activeHeaders.set(t,e)),e}},{key:"getActiveHeaders",value:function(){return _toConsumableArray$8(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return _toConsumableArray$8(this.customSelections.values())}},{key:"addCustomSelection",value:function(e){this.customSelections.push(createHighlight$6(CUSTOM_SELECTION,_objectSpread$7(_objectSpread$7({},this.options),e)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),arrayEach(this.areas.values(),(function(e){e.clear()})),arrayEach(this.headers.values(),(function(e){e.clear()})),arrayEach(this.activeHeaders.values(),(function(e){e.clear()}))}},{key:Symbol.iterator,value:function(){return[this.cell,this.fill].concat(_toConsumableArray$8(this.areas.values()),_toConsumableArray$8(this.headers.values()),_toConsumableArray$8(this.activeHeaders.values()),_toConsumableArray$8(this.customSelections))[Symbol.iterator]()}}]),e}();function _classCallCheck$13(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$Z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$Z(e,t,r){return t&&_defineProperties$Z(e.prototype,t),r&&_defineProperties$Z(e,r),e}var SelectionRange=function(){function e(){_classCallCheck$13(this,e),this.ranges=[]}return _createClass$Z(e,[{key:"isEmpty",value:function(){return 0===this.size()}},{key:"set",value:function(e){return this.clear(),this.ranges.push(new CellRange(e)),this}},{key:"add",value:function(e){return this.ranges.push(new CellRange(e)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(e){return this.ranges.some((function(t){return t.includes(e)}))}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=this.size()+t-1;return r>=0&&(e=this.ranges[r]),e}},{key:Symbol.iterator,value:function(){return this.ranges[Symbol.iterator]()}}]),e}();function _classCallCheck$14(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$_(e,t,r){return t&&_defineProperties$_(e.prototype,t),r&&_defineProperties$_(e,r),e}var Transformation=function(){function e(t,r){_classCallCheck$14(this,e),this.range=t,this.options=r}return _createClass$_(e,[{key:"transformStart",value:function(e,t,r){var n=new CellCoords(e,t),o=this.range.current().highlight,i=this.options.visualToRenderableCoords(o),a=i.row,s=i.col,l=o,u=0,c=0;if(this.runLocalHooks("beforeTransformStart",n),null!==a&&null!==s){var f=this.options.countRows(),h=this.options.countCols(),d=this.options.fixedRowsBottom(),p=this.options.minSpareRows(),y=this.options.minSpareCols(),g=this.options.autoWrapRow(),m=this.options.autoWrapCol();a+e>f-1?r&&p>0&&!(d&&a>=f-d-1)?(this.runLocalHooks("insertRowRequire",f),f=this.options.countRows()):m&&(n.row=1-f,n.col=s+n.col===h-1?1-h:1):m&&a+n.row<0&&s+n.col>=0&&(n.row=f-1,n.col=s+n.col===0?h-1:-1),s+n.col>h-1?r&&y>0?(this.runLocalHooks("insertColRequire",h),h=this.options.countCols()):g&&(n.row=a+n.row===f-1?1-f:1,n.col=1-h):g&&s+n.col<0&&a+n.row>=0&&(n.row=a+n.row===0?f-1:-1,n.col=h-1);var v=new CellCoords(a+n.row,s+n.col);u=0,c=0,v.row<0?(u=-1,v.row=0):v.row>0&&v.row>=f&&(u=1,v.row=f-1),v.col<0?(c=-1,v.col=0):v.col>0&&v.col>=h&&(c=1,v.col=h-1),l=this.options.renderableToVisualCoords(v)}return this.runLocalHooks("afterTransformStart",l,u,c),l}},{key:"transformEnd",value:function(e,t){var r=new CellCoords(e,t),n=this.range.current(),o=n.to,i=0,a=0;this.runLocalHooks("beforeTransformEnd",r);var s=this.options.visualToRenderableCoords(n.highlight),l=s.row,u=s.col;if(null!==l&&null!==u){var c=this.options.countRows(),f=this.options.countCols(),h=this.options.visualToRenderableCoords(n.to),d=h.row,p=h.col,y=new CellCoords(d+r.row,p+r.col);i=0,a=0,y.row<0?(i=-1,y.row=0):y.row>0&&y.row>=c&&(i=1,y.row=c-1),y.col<0?(a=-1,y.col=0):y.col>0&&y.col>=f&&(a=1,y.col=f-1),o=this.options.renderableToVisualCoords(y)}return this.runLocalHooks("afterTransformEnd",o,i,a),o}}]),e}();function _slicedToArray$7(e,t){return _arrayWithHoles$7(e)||_iterableToArrayLimit$7(e,t)||_unsupportedIterableToArray$e(e,t)||_nonIterableRest$7()}function _nonIterableRest$7(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$e(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$e(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$e(e,t):void 0}}function _arrayLikeToArray$e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$7(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$7(e){if(Array.isArray(e))return e}function _typeof$D(e){return(_typeof$D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}mixin(Transformation,localHooks);var SELECTION_TYPE_UNRECOGNIZED=0,SELECTION_TYPE_EMPTY=1,SELECTION_TYPE_ARRAY=2,SELECTION_TYPE_OBJECT=3,SELECTION_TYPES=[SELECTION_TYPE_OBJECT,SELECTION_TYPE_ARRAY],ARRAY_TYPE_PATTERN=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],rootCall=Symbol("root"),childCall=Symbol("child");function detectSelectionType(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rootCall;if(t!==rootCall&&t!==childCall)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(e),n=t===rootCall,o=SELECTION_TYPE_UNRECOGNIZED;if(r){var i=e[0];if(0===e.length)o=SELECTION_TYPE_EMPTY;else if(n&&i instanceof CellRange)o=SELECTION_TYPE_OBJECT;else if(n&&Array.isArray(i))o=detectSelectionType(i,childCall);else if(e.length>=2&&e.length<=4){var a=!e.some((function(e,t){return!ARRAY_TYPE_PATTERN[t].includes(_typeof$D(e))}));a&&(o=SELECTION_TYPE_ARRAY)}}return o}function normalizeSelectionFactory(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.keepDirection,n=void 0!==r&&r,o=t.propToCol;if(!SELECTION_TYPES.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(t){var r=e===SELECTION_TYPE_OBJECT,i=r?t.from.row:t[0],a=r?t.from.col:t[1],s=r?t.to.row:t[2],l=r?t.to.col:t[3];if("function"==typeof o&&("string"==typeof a&&(a=o(a)),"string"==typeof l&&(l=o(l))),isUndefined(s)&&(s=i),isUndefined(l)&&(l=a),!n){var u=i,c=a,f=s,h=l;i=Math.min(u,f),a=Math.min(c,h),s=Math.max(u,f),l=Math.max(c,h)}return[i,a,s,l]}}function transformSelectionToColumnDistance(e){var t=detectSelectionType(e);if(t===SELECTION_TYPE_UNRECOGNIZED||t===SELECTION_TYPE_EMPTY)return[];var r=normalizeSelectionFactory(t),n=new Set;return arrayEach(e,(function(e){var t=_slicedToArray$7(r(e),4),o=t[1],i=t[3],a=Math.max(o,0),s=i-a+1;arrayEach(Array.from(new Array(s),(function(e,t){return a+t})),(function(e){n.has(e)||n.add(e)}))})),arrayReduce(Array.from(n).sort((function(e,t){return e-t})),(function(e,t,r,n){return 0!==r&&t===n[r-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e}),[])}function transformSelectionToRowDistance(e){var t=detectSelectionType(e);if(t===SELECTION_TYPE_UNRECOGNIZED||t===SELECTION_TYPE_EMPTY)return[];var r=normalizeSelectionFactory(t),n=new Set;return arrayEach(e,(function(e){var t=_slicedToArray$7(r(e),3),o=t[0],i=t[2],a=Math.max(o,0),s=i-a+1;arrayEach(Array.from(new Array(s),(function(e,t){return a+t})),(function(e){n.has(e)||n.add(e)}))})),arrayReduce(Array.from(n).sort((function(e,t){return e-t})),(function(e,t,r,n){return 0!==r&&t===n[r-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e}),[])}function isValidCoord(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;return"number"==typeof e&&e>=0&&e<t}function _slicedToArray$8(e,t){return _arrayWithHoles$8(e)||_iterableToArrayLimit$8(e,t)||_unsupportedIterableToArray$f(e,t)||_nonIterableRest$8()}function _nonIterableRest$8(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$f(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$f(e,t):void 0}}function _arrayLikeToArray$f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$8(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$8(e){if(Array.isArray(e))return e}function _templateObject$4(){var e=_taggedTemplateLiteral$4(["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, \n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."],["Unsupported format of the selection ranges was passed. To select cells pass\\x20\n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20\n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."]);return _templateObject$4=function(){return e},e}function _taggedTemplateLiteral$4(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _classCallCheck$15(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$$(e,t,r){return t&&_defineProperties$$(e.prototype,t),r&&_defineProperties$$(e,r),e}var Selection$1=function(){function e(t,r){var n=this;_classCallCheck$15(this,e),this.settings=t,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new SelectionRange,this.highlight=new Highlight({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disableHighlight:this.settings.disableVisualSelection,cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(e){return n.tableProps.visualToRenderableCoords(e)},renderableToVisualCoords:function(e){return n.tableProps.renderableToVisualCoords(e)}}),this.transformation=new Transformation(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(e){return n.tableProps.visualToRenderableCoords(e)},renderableToVisualCoords:function(e){return n.tableProps.renderableToVisualCoords(e)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(t))})),this.transformation.addLocalHook("afterTransformStart",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(t))})),this.transformation.addLocalHook("beforeTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(t))})),this.transformation.addLocalHook("afterTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(t))})),this.transformation.addLocalHook("insertRowRequire",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(t))})),this.transformation.addLocalHook("insertColRequire",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks.apply(n,["insertColRequire"].concat(t))}))}return _createClass$$(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n="multiple"===this.settings.selectionMode,o=isUndefined(t)?isPressedCtrlKey():t,i=e.row<0,a=e.col<0,s=i&&a;this.selectedByCorner=s,this.runLocalHooks("beforeSetRangeStart".concat(r?"Only":""),e),(!n||n&&!o&&isUndefined(t))&&this.selectedRange.clear(),this.selectedRange.add(e),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!s&&a&&this.selectedByRowHeader.add(this.getLayerLevel()),!s&&i&&this.selectedByColumnHeader.add(this.getLayerLevel()),r||this.setRangeEnd(e)}},{key:"setRangeStartOnly",value:function(e,t){this.setRangeStart(e,t,!0)}},{key:"setRangeEnd",value:function(e){if(!this.selectedRange.isEmpty()){this.runLocalHooks("beforeSetRangeEnd",e),this.begin();var t=this.selectedRange.current();"single"!==this.settings.selectionMode&&t.setTo(new CellCoords(e.row,e.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(CELL_TYPE$9)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().adjustCoordinates(t);var r=this.getLayerLevel();r<this.highlight.layerLevel&&(arrayEach(this.highlight.getAreas(),(function(e){e.clear()})),arrayEach(this.highlight.getHeaders(),(function(e){e.clear()})),arrayEach(this.highlight.getActiveHeaders(),(function(e){e.clear()}))),this.highlight.useLayerLevel(r);var n=this.highlight.createOrGetArea(),o=this.highlight.createOrGetHeader(),i=this.highlight.createOrGetActiveHeader();if(n.clear(),o.clear(),i.clear(),this.highlight.isEnabledFor(AREA_TYPE)&&(this.isMultiple()||r>=1)&&(n.add(t.from).add(t.to).commit(),1===r)){var a=this.selectedRange.previous();this.highlight.useLayerLevel(r-1).createOrGetArea().add(a.from).commit().adjustCoordinates(a),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(HEADER_TYPE)){var s=0===this.tableProps.countRowsTranslated(),l=0===this.tableProps.countColsTranslated(),u=t;(s||l)&&(u=t.clone()),s&&(u.from.row=-1),l&&(u.from.col=-1),"single"===this.settings.selectionMode?(this.isSelectedByAnyHeader()&&u.from.normalize(),o.add(u.from).commit()):o.add(u.from).add(u.to).commit()}if(this.isEntireRowSelected())this.tableProps.countCols()===t.getWidth()&&i.add(new CellCoords(t.from.row,-1)).add(new CellCoords(t.to.row,-1)).commit();if(this.isEntireColumnSelected())this.tableProps.countRows()===t.getHeight()&&i.add(new CellCoords(-1,t.from.col)).add(new CellCoords(-1,t.to.col)).commit();this.runLocalHooks("afterSetRangeEnd",e)}}},{key:"isMultiple",value:function(){var e=createObjectPropListener(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}},{key:"transformStart",value:function(e,t,r){this.setRangeStart(this.transformation.transformStart(e,t,r))}},{key:"transformEnd",value:function(e,t){this.setRangeEnd(this.transformation.transformEnd(e,t))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&this.isEntireRowSelected(e)}},{key:"isEntireRowSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===e?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e)}},{key:"isSelectedByColumnHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(e)}},{key:"isEntireColumnSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===e?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(e){return this.selectedRange.includes(e)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(e){return(!Number.isInteger(e)||e===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.tableProps.countRows(),n=this.tableProps.countCols();if(e||t||0!==r&&0!==n){var o=new CellCoords(t?-1:0,e?-1:0);this.clear(),this.setRangeStartOnly(o),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(new CellCoords(r-1,n-1)),this.finish()}}},{key:"selectCells",value:function(e){var t=this,r=detectSelectionType(e);if(r===SELECTION_TYPE_EMPTY)return!1;if(r===SELECTION_TYPE_UNRECOGNIZED)throw new Error(toSingleLine(_templateObject$4()));var n=normalizeSelectionFactory(r,{propToCol:function(e){return t.tableProps.propToCol(e)},keepDirection:!0}),o=this.tableProps.countRows(),i=this.tableProps.countCols(),a=!e.some((function(e){var t=_slicedToArray$8(n(e),4),r=t[0],a=t[1],s=t[2],l=t[3];return!(isValidCoord(r,o)&&isValidCoord(a,i)&&isValidCoord(s,o)&&isValidCoord(l,i))}));return a&&(this.clear(),arrayEach(e,(function(e){var r=_slicedToArray$8(n(e),4),o=r[0],i=r[1],a=r[2],s=r[3];t.setRangeStartOnly(new CellCoords(o,i),!1),t.setRangeEnd(new CellCoords(a,s)),t.finish()}))),a}},{key:"selectColumns",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r="string"==typeof e?this.tableProps.propToCol(e):e,n="string"==typeof t?this.tableProps.propToCol(t):t,o=this.tableProps.countCols(),i=this.tableProps.countRows(),a=isValidCoord(r,o)&&isValidCoord(n,o);return a&&(this.setRangeStartOnly(new CellCoords(-1,r)),this.setRangeEnd(new CellCoords(i-1,n)),this.finish()),a}},{key:"selectRows",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=this.tableProps.countRows(),n=this.tableProps.countCols(),o=isValidCoord(e,r)&&isValidCoord(t,r);return o&&(this.setRangeStartOnly(new CellCoords(e,-1)),this.setRangeEnd(new CellCoords(t,n-1)),this.finish()),o}},{key:"refresh",value:function(){if(this.highlight.getCustomSelections().forEach((function(e){e.commit()})),this.isSelected()){var e=this.highlight.getCell(),t=this.getLayerLevel();e.commit().adjustCoordinates(this.selectedRange.current());for(var r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);var n=this.highlight.createOrGetArea(),o=this.highlight.createOrGetHeader(),i=this.highlight.createOrGetActiveHeader();n.commit(),o.commit(),i.commit()}this.highlight.useLayerLevel(t)}}}]),e}();mixin(Selection$1,localHooks);var SheetClip=createCommonjsModule((function(e,t){(e=>{const r=/^(\r\n|\n\r|\r|\n)/,n=/^[^\t\r\n]+/,o=/^\t/,i={parse(e){const t=[[""]];if(0===e.length)return t;let i,a=0,s=0;for(;e.length>0&&i!==e.length;)if(i=e.length,e.match(o))e=e.replace(o,""),a+=1,t[s][a]="";else if(e.match(r))e=e.replace(r,""),a=0,s+=1,t[s]=[""];else{let r="";if(e.startsWith('"')){let t=0,n=!0;for(;n;){const o=e.slice(0,1);'"'===o&&(t+=1),r+=o,(0===(e=e.slice(1)).length||e.match(/^[\t\r\n]/)&&t%2==0)&&(n=!1)}r=r.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(e=>new Array(Math.floor(e.length/2)).fill('"').join("")))}else{const t=e.match(n);r=t?t[0]:"",e=e.slice(r.length)}t[s][a]=r}return t},stringify(e){let t,r,n,o,i,a="";for(t=0,r=e.length;t<r;t+=1){for(o=e[t].length,n=0;n<o;n+=1)n>0&&(a+="\t"),i=e[t][n],"string"==typeof i?i.indexOf("\n")>-1?a+=`"${i.replace(/"/g,'""')}"`:a+=i:a+=null==i?"":i;t!==r-1&&(a+="\n")}return a}};t.parse=i.parse,t.stringify=i.stringify})()}));function _typeof$E(e){return(_typeof$E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$16(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$10(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$10(e,t,r){return t&&_defineProperties$10(e.prototype,t),r&&_defineProperties$10(e,r),e}var copyableLookup=cellMethodLookupFactory("copyable",!1),DataMap=function(){function e(t,r,n){_classCallCheck$16(this,e),this.instance=t,this.tableMeta=n,this.dataSource=r,this.duckSchema=this.dataSource&&this.dataSource[0]?duckSchema(this.dataSource[0]):{},this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return _createClass$10(e,null,[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),_createClass$10(e,[{key:"createMap",value:function(){var e=this.getSchema();if(void 0===e)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var t,r=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,r){var n=0,o=0,i=!1;if("function"==typeof r){var a=deepObjectSize(e);n=a>0?a:this.countFirstRowKeys(),i=!0}else{var s=this.tableMeta.maxCols;n=Math.min(s,r.length)}for(t=0;t<n;t++){var l=i?r(t):r[t];if(isObject$1(l)){if(void 0!==l.data){var u=i?o:t;this.colToPropCache[u]=l.data,this.propToColCache.set(l.data,u)}o+=1}}}else this.recursiveDuckColumns(e)}},{key:"countFirstRowKeys",value:function(){return countFirstRowKeys(this.dataSource)}},{key:"recursiveDuckColumns",value:function(e,t,r){var n,o=this,i=t,a=r;return void 0===i&&(i=0,a=""),"object"!==_typeof$E(e)||Array.isArray(e)||objectEach(e,(function(e,t){null===e?(n=a+t,o.colToPropCache.push(n),o.propToColCache.set(n,i),i+=1):i=o.recursiveDuckColumns(e,i,"".concat(t,"."))})),i}},{key:"colToProp",value:function(e){if(!1===Number.isInteger(e))return e;var t=this.instance.toPhysicalColumn(e);return null===t?e:this.colToPropCache&&isDefined(this.colToPropCache[t])?this.colToPropCache[t]:t}},{key:"propToCol",value:function(e){var t=this.propToColCache.get(e);if(isDefined(t))return this.instance.toVisualColumn(t);var r=this.instance.toVisualColumn(e);return null===r?e:r}},{key:"getSchema",value:function(){var e=this.tableMeta.dataSchema;return e?"function"==typeof e?e():e:this.duckSchema}},{key:"createRow",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,o=this.instance.countSourceRows(),i=o,a=0,s=e;("number"!=typeof s||s>=o)&&(s=o),s<this.instance.countRows()&&(i=this.instance.toPhysicalRow(s));var l=this.instance.runHooks("beforeCreateRow",s,r,n);if(!1===l||null===i)return 0;for(var u=this.tableMeta.maxRows,c=this.instance.countCols(),f=[],h=function(){var e=null;"array"===t.instance.dataType?t.tableMeta.dataSchema?e=deepClone(t.getSchema()):(e=[],rangeEach(c-1,(function(){return e.push(null)}))):"function"===t.instance.dataType?e=t.tableMeta.dataSchema(s):deepExtend(e={},t.getSchema()),f.push(e),a+=1};a<r&&o+a<u;)h();return this.instance.rowIndexMapper.insertIndexes(s,a),this.spliceData.apply(this,[i,0].concat(f)),this.instance.runHooks("afterCreateRow",s,a,n),this.instance.forceFullRender=!0,a}},{key:"createCol",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var n=this.dataSource,o=this.tableMeta.maxCols,i=e;("number"!=typeof i||i>=this.instance.countSourceCols())&&(i=this.instance.countSourceCols());var a=this.instance.runHooks("beforeCreateCol",i,t,r);if(!1===a)return 0;var s=this.instance.countSourceCols();i<this.instance.countCols()&&(s=this.instance.toPhysicalColumn(i));for(var l=this.instance.countSourceRows(),u=this.instance.countCols(),c=0,f=s;c<t&&u<o;){if("number"!=typeof i||i>=u)if(l>0)for(var h=0;h<l;h+=1)void 0===n[h]&&(n[h]=[]),n[h].push(null);else n.push([null]);else for(var d=0;d<l;d++)n[d].splice(f,0,null);c+=1,f+=1,u+=1}return this.instance.columnIndexMapper.insertIndexes(i,c),this.instance.runHooks("afterCreateCol",i,c,r),this.instance.forceFullRender=!0,c}},{key:"removeRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,n=Number.isInteger(e)?e:-t,o=this.visualRowsToPhysical(n,t),i=this.instance.countSourceRows();n=(i+n)%i;var a=this.instance.runHooks("beforeRemoveRow",n,o.length,o,r);if(!1===a)return!1;var s=this.dataSource,l=o.length,u=this.filterData(n,l,o);if(u&&(s.length=0,Array.prototype.push.apply(s,u)),n<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(o);var c=isDefined(this.tableMeta.columns)||isDefined(this.tableMeta.dataSchema);0===this.instance.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===c&&this.instance.columnIndexMapper.setIndexesSequence([])}return this.instance.runHooks("afterRemoveRow",n,l,o,r),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if("object"===this.instance.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var n="number"!=typeof e?-t:e;n=(this.instance.countCols()+n)%this.instance.countCols();var o=this.visualColumnsToPhysical(n,t),i=o.slice(0).sort((function(e,t){return t-e})),a=this.instance.runHooks("beforeRemoveCol",n,t,o,r);if(!1===a)return!1;for(var s=!0,l=i.length,u=this.dataSource,c=0;c<l;c++)s&&o[0]!==o[c]-c&&(s=!1);if(s)for(var f=0,h=this.instance.countSourceRows();f<h;f++)u[f].splice(o[0],t);else for(var d=0,p=this.instance.countSourceRows();d<p;d++)for(var y=0;y<l;y++)u[d].splice(i[y],1);return n<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(o),0===this.instance.columnIndexMapper.getNotTrimmedIndexesLength()&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",n,t,o,r),this.instance.forceFullRender=!0,!0}},{key:"spliceCol",value:function(e,t,r){for(var n=this.instance.getDataAtCol(e),o=n.slice(t,t+r),i=n.slice(t+r),a=arguments.length,s=new Array(a>3?a-3:0),l=3;l<a;l++)s[l-3]=arguments[l];extendArray(s,i);for(var u=0;u<r;)s.push(null),u+=1;return to2dArray(s),this.instance.populateFromArray(t,e,s,null,null,"spliceCol"),o}},{key:"spliceRow",value:function(e,t,r){for(var n=this.instance.getSourceDataAtRow(e),o=n.slice(t,t+r),i=n.slice(t+r),a=arguments.length,s=new Array(a>3?a-3:0),l=3;l<a;l++)s[l-3]=arguments[l];extendArray(s,i);for(var u=0;u<r;)s.push(null),u+=1;return this.instance.populateFromArray(e,t,[s],null,null,"spliceRow"),o}},{key:"spliceData",value:function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];var i,a=this.instance.runHooks("beforeDataSplice",e,t,n);!1!==a&&(i=this.dataSource).splice.apply(i,[e,t].concat(n))}},{key:"filterData",value:function(e,t,r){if(!1!==this.instance.runHooks("beforeDataFilter",e,t,r))return this.dataSource.filter((function(e,t){return-1===r.indexOf(t)}))}},{key:"get",value:function(e,t){var r=this.instance.toPhysicalRow(e),n=this.dataSource[r],o=this.instance.runHooks("modifyRowData",r),i=null;if((n=isNaN(o)?o:n)&&n.hasOwnProperty&&hasOwnProperty$1(n,t))i=n[t];else if("string"==typeof t&&t.indexOf(".")>-1){var a=t.split("."),s=n;if(!s)return null;for(var l=0,u=a.length;l<u;l++)if(void 0===(s=s[a[l]]))return null;i=s}else"function"==typeof t&&(i=t(this.dataSource.slice(r,r+1)[0]));if(this.instance.hasHook("modifyData")){var c=createObjectPropListener(i);this.instance.runHooks("modifyData",r,this.propToCol(t),c,"get"),c.isTouched()&&(i=c.value)}return i}},{key:"getCopyable",value:function(e,t){return copyableLookup.call(this.instance,e,this.propToCol(t))?this.get(e,t):""}},{key:"set",value:function(e,t,r){var n=this.instance.toPhysicalRow(e),o=r,i=this.dataSource[n],a=this.instance.runHooks("modifyRowData",n);if(i=isNaN(a)?a:i,this.instance.hasHook("modifyData")){var s=createObjectPropListener(o);this.instance.runHooks("modifyData",n,this.propToCol(t),s,"set"),s.isTouched()&&(o=s.value)}if(i&&i.hasOwnProperty&&hasOwnProperty$1(i,t))i[t]=o;else if("string"==typeof t&&t.indexOf(".")>-1){var l,u=t.split("."),c=i,f=0;for(f=0,l=u.length-1;f<l;f++)void 0===c[u[f]]&&(c[u[f]]={}),c=c[u[f]];c[u[f]]=o}else"function"==typeof t?t(this.dataSource.slice(n,n+1)[0],o):i[t]=o}},{key:"visualRowsToPhysical",value:function(e,t){for(var r,n=this.instance.countSourceRows(),o=[],i=(n+e)%n,a=t;i<n&&a;)r=this.instance.toPhysicalRow(i),o.push(r),a-=1,i+=1;return o}},{key:"visualColumnsToPhysical",value:function(e,t){for(var r=this.instance.countCols(),n=[],o=(r+e)%r,i=t;o<r&&i;){var a=this.instance.toPhysicalColumn(o);n.push(a),i-=1,o+=1}return n}},{key:"clear",value:function(){for(var e=0;e<this.instance.countSourceRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")}},{key:"getLength",value:function(){var e,t=this.tableMeta.maxRows;e=t<0||0===t?0:t||1/0;var r=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,e)}},{key:"getAll",value:function(){var t={row:0,col:0},r={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return t.row-r.row!=0||this.instance.countSourceRows()?this.getRange(t,r,e.DESTINATION_RENDERER):[]}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(t,r,n){var o,i,a,s=[],l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(0===l||0===u)return[];var c=n===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,f=Math.min(Math.max(l-1,0),Math.max(t.row,r.row)),h=Math.min(Math.max(u-1,0),Math.max(t.col,r.col));for(o=Math.min(t.row,r.row);o<=f;o++){a=[];var d=o>=0?this.instance.toPhysicalRow(o):o;for(i=Math.min(t.col,r.col);i<=h&&null!==d;i++)a.push(c.call(this,o,this.colToProp(i)));null!==d&&s.push(a)}return s}},{key:"getText",value:function(t,r){return SheetClip.stringify(this.getRange(t,r,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(t,r){return SheetClip.stringify(this.getRange(t,r,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.tableMeta=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}]),e}();function expandMetaType(e,t){var r="string"==typeof e?_getItem$3(e):e;if(isObject$1(r)){var n=isObject$1(t),o={};return objectEach(r,(function(e,r){(!n||n&&!hasOwnProperty$1(t,r))&&(o[r]=e)})),o}}function columnFactory(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function r(){}inherit(r,e);for(var n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}function isUnsignedNumber(e){return Number.isInteger(e)&&e>=0}function assert(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function isNullish(e){return null==e}function _typeof$F(e){return(_typeof$F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var metaSchemaFactory=function(){return{licenseKey:void 0,data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,selectionMode:"multiple",fillHandle:{autoInsertRow:!1},fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!0,autoWrapCol:!0,persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",activeHeaderClassName:"ht__active_highlight",className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow:function(e){var t,r,n,o;for(t=0,r=this.countCols();t<r;t++)if(""!==(n=this.getDataAtCell(e,t))&&null!==n&&isDefined(n))return"object"===_typeof$F(n)&&(o=this.getCellMeta(e,t),isObjectEqual(this.getSchema()[o.prop],n));return!0},isEmptyCol:function(e){var t,r,n;for(t=0,r=this.countRows();t<r;t++)if(""!==(n=this.getDataAtCell(t,e))&&null!==n&&isDefined(n))return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,allowEmpty:!0,invalidCellClassName:"htInvalid",placeholder:void 0,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,skipColumnOnPaste:!1,skipRowOnPaste:!1,search:!1,type:"text",copyable:!0,editor:void 0,visibleRows:10,trimDropdown:!0,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,copyPaste:!0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,multiColumnSorting:void 0,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:!1,manualColumnFreeze:void 0,trimWhitespace:!0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,numericFormat:void 0,language:"en-US",selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:"DD/MM/YYYY",correctFormat:!1,defaultDate:void 0,strict:void 0,allowHtml:!1,renderAllRows:void 0,preventOverflow:!1,preventWheel:!1,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,headerTooltips:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,observeChanges:void 0,sortByRelevance:!0,filter:!0,filteringCaseSensitive:!1,dragToScroll:!0,nestedRows:void 0}};function _defineProperties$11(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$11(e,t,r){return t&&_defineProperties$11(e.prototype,t),r&&_defineProperties$11(e,r),e}function _classCallCheck$17(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function createTableMetaEmptyClass(){return function e(){_classCallCheck$17(this,e)}}var GlobalMeta=function(){function e(){_classCallCheck$17(this,e),this.metaCtor=createTableMetaEmptyClass(),this.meta=this.metaCtor.prototype,extend(this.meta,metaSchemaFactory())}return _createClass$11(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){extend(this.meta,e),extend(this.meta,expandMetaType(e.type,e))}}]),e}();function _classCallCheck$18(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$12(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$12(e,t,r){return t&&_defineProperties$12(e.prototype,t),r&&_defineProperties$12(e,r),e}var TableMeta=function(){function e(t){_classCallCheck$18(this,e);var r=t.getMetaConstructor();this.meta=new r}return _createClass$12(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){extend(this.meta,e),extend(this.meta,expandMetaType(e.type,e))}}]),e}();function _classCallCheck$19(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$13(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$13(e,t,r){return t&&_defineProperties$13(e.prototype,t),r&&_defineProperties$13(e,r),e}var LazyFactoryMap=function(){function e(t){_classCallCheck$19(this,e),this.valueFactory=t,this.data=[],this.index=[],this.holes=new Set}return _createClass$13(e,[{key:"obtain",value:function(e){assert((function(){return isUnsignedNumber(e)}),"Expecting an unsigned number.");var t,r=this._getStorageIndexByKey(e);if(r>=0)void 0===(t=this.data[r])&&(t=this.valueFactory(e),this.data[r]=t);else if(t=this.valueFactory(e),this.holes.size>0){var n=this.holes.values().next().value;this.holes.delete(n),this.data[n]=t,this.index[e]=n}else this.data.push(t),this.index[e]=this.data.length-1;return t}},{key:"insert",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;assert((function(){return isUnsignedNumber(e)||isNullish(e)}),"Expecting an unsigned number or null/undefined argument.");for(var n=[],o=this.data.length,i=0;i<r;i++)n.push(o+i),this.data.push(void 0);(t=this.index).splice.apply(t,[isNullish(e)?this.index.length:e,0].concat(n))}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;assert((function(){return isUnsignedNumber(e)||isNullish(e)}),"Expecting an unsigned number or null/undefined argument.");for(var r=this.index.splice(isNullish(e)?this.index.length-t:e,t),n=0;n<r.length;n++){var o=r[n];"number"==typeof o&&this.holes.add(o)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var e=this;return arrayFilter(this.data,(function(t,r){return!e.holes.has(r)}))[Symbol.iterator]()}},{key:"entries",value:function(){for(var e=[],t=0;t<this.data.length;t++){var r=this._getKeyByStorageIndex(t);-1!==r&&e.push([r,this.data[t]])}var n=0;return{next:function(){if(n<e.length){var t=e[n];return n+=1,{value:t,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(e){return this.index.length>e?this.index[e]:-1}},{key:"_getKeyByStorageIndex",value:function(e){return this.index.indexOf(e)}},{key:Symbol.iterator,value:function(){return this.entries()}}]),e}();function _classCallCheck$1a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$14(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$14(e,t,r){return t&&_defineProperties$14(e.prototype,t),r&&_defineProperties$14(e,r),e}var COLUMNS_PROPS_CONFLICTS=["data","width"],ColumnMeta=function(){function e(t){var r=this;_classCallCheck$1a(this,e),this.globalMeta=t,this.metas=new LazyFactoryMap((function(){return r._createMeta()}))}return _createClass$14(e,[{key:"updateMeta",value:function(e,t){var r=this.getMeta(e);extend(r,t),extend(r,expandMetaType(t.type,r))}},{key:"createColumn",value:function(e,t){this.metas.insert(e,t)}},{key:"removeColumn",value:function(e,t){this.metas.remove(e,t)}},{key:"getMeta",value:function(e){return this.metas.obtain(e)}},{key:"getMetaConstructor",value:function(e){return this.metas.obtain(e).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return columnFactory(this.globalMeta.getMetaConstructor(),COLUMNS_PROPS_CONFLICTS).prototype}}]),e}();function _toConsumableArray$9(e){return _arrayWithoutHoles$9(e)||_iterableToArray$9(e)||_unsupportedIterableToArray$g(e)||_nonIterableSpread$9()}function _nonIterableSpread$9(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$g(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$g(e,t):void 0}}function _iterableToArray$9(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$9(e){if(Array.isArray(e))return _arrayLikeToArray$g(e)}function _arrayLikeToArray$g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$1b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$15(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$15(e,t,r){return t&&_defineProperties$15(e.prototype,t),r&&_defineProperties$15(e,r),e}var CellMeta=function(){function e(t){var r=this;_classCallCheck$1b(this,e),this.columnMeta=t,this.metas=new LazyFactoryMap((function(){return r._createRow()}))}return _createClass$15(e,[{key:"updateMeta",value:function(e,t,r){var n=this.getMeta(e,t);extend(n,r),extend(n,expandMetaType(r.type,n))}},{key:"createRow",value:function(e,t){this.metas.insert(e,t)}},{key:"createColumn",value:function(e,t){for(var r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,t)}},{key:"removeRow",value:function(e,t){this.metas.remove(e,t)}},{key:"removeColumn",value:function(e,t){for(var r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,t)}},{key:"getMeta",value:function(e,t,r){var n=this.metas.obtain(e).obtain(t);return void 0===r?n:n[r]}},{key:"setMeta",value:function(e,t,r,n){this.metas.obtain(e).obtain(t)[r]=n}},{key:"removeMeta",value:function(e,t,r){delete this.metas.obtain(e).obtain(t)[r]}},{key:"getMetas",value:function(){for(var e=[],t=Array.from(this.metas.values()),r=0;r<t.length;r++)e.push.apply(e,_toConsumableArray$9(t[r].values()));return e}},{key:"getMetasAtRow",value:function(e){assert((function(){return isUnsignedNumber(e)}),"Expecting an unsigned number.");var t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var e=this;return new LazyFactoryMap((function(t){return e._createMeta(t)}))}},{key:"_createMeta",value:function(e){return new(this.columnMeta.getMetaConstructor(e))}}]),e}();function _classCallCheck$1c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$16(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$16(e,t,r){return t&&_defineProperties$16(e.prototype,t),r&&_defineProperties$16(e,r),e}var MetaManager=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck$1c(this,e),this.globalMeta=new GlobalMeta,this.globalMeta.updateMeta(t),this.tableMeta=new TableMeta(this.globalMeta),this.columnMeta=new ColumnMeta(this.globalMeta),this.cellMeta=new CellMeta(this.columnMeta)}return _createClass$16(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(e){this.globalMeta.updateMeta(e)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(e){this.tableMeta.updateMeta(e)}},{key:"getColumnMeta",value:function(e){return this.columnMeta.getMeta(e)}},{key:"updateColumnMeta",value:function(e,t){this.columnMeta.updateMeta(e,t)}},{key:"getCellMeta",value:function(e,t,r){return this.cellMeta.getMeta(e,t,r)}},{key:"setCellMeta",value:function(e,t,r,n){this.cellMeta.setMeta(e,t,r,n)}},{key:"updateCellMeta",value:function(e,t,r){this.cellMeta.updateMeta(e,t,r)}},{key:"removeCellMeta",value:function(e,t,r){this.cellMeta.removeMeta(e,t,r)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(e){return this.cellMeta.getMetasAtRow(e)}},{key:"createRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(e,t)}},{key:"removeRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(e,t)}},{key:"createColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}},{key:"removeColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();function _typeof$G(e){return(_typeof$G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _slicedToArray$9(e,t){return _arrayWithHoles$9(e)||_iterableToArrayLimit$9(e,t)||_unsupportedIterableToArray$h(e,t)||_nonIterableRest$9()}function _nonIterableRest$9(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit$9(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$9(e){if(Array.isArray(e))return e}function _toConsumableArray$a(e){return _arrayWithoutHoles$a(e)||_iterableToArray$a(e)||_unsupportedIterableToArray$h(e)||_nonIterableSpread$a()}function _nonIterableSpread$a(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$h(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$h(e,t):void 0}}function _iterableToArray$a(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$a(e){if(Array.isArray(e))return _arrayLikeToArray$h(e)}function _arrayLikeToArray$h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var activeGuid=null;function Core(e,t){var r,n,o,i,a=this,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=!1,u=this,c=new EventManager(u),f=!0;t.language=getValidLanguageCode(t.language);var h=new MetaManager(t),d=h.getTableMeta(),p=h.getGlobalMeta();hasValidParameter(s)&&registerAsRootInstance(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,startObserving(this.rootDocument),this.isDestroyed=!1,this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),isRootInstance(this)&&_injectProductInfo(t.licenseKey,e),this.guid="ht_".concat(randomString()),this.columnIndexMapper=new IndexMapper,this.rowIndexMapper=new IndexMapper,n=new DataSource(u),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);var y=function(e){var t=e.row,r=e.col;return new CellCoords(t>=0?u.rowIndexMapper.getRenderableFromVisualIndex(t):t,r>=0?u.columnIndexMapper.getRenderableFromVisualIndex(r):r)},g=function(e){var t=e.row,r=e.col;return new CellCoords(t>=0?u.rowIndexMapper.getVisualFromRenderableIndex(t):t,r>=0?u.columnIndexMapper.getVisualFromRenderableIndex(r):r)},m=new Selection$1(d,{countCols:function(){return u.countCols()},countRows:function(){return u.countRows()},propToCol:function(e){return r.propToCol(e)},isEditorOpened:function(){return!!u.getActiveEditor()&&u.getActiveEditor().isOpened()},countColsTranslated:function(){return a.view.countRenderableColumns()},countRowsTranslated:function(){return a.view.countRenderableRows()},visualToRenderableCoords:y,renderableToVisualCoords:g});this.selection=m;var v=function(e,t,r){r&&a.selection.refresh()};function _(e){var t=normalizeLanguageCode(e);hasLanguage(t)?(u.runHooks("beforeLanguageChange",t),p.language=t,u.runHooks("afterLanguageChange",t)):warnUserAboutLanguageRegistration(e)}function b(e,t){var r="className"===e?u.rootElement:u.table;if(f)addClass(r,t);else{var n=[],o=[];p[e]&&(n=Array.isArray(p[e])?p[e]:stringToArray(p[e])),t&&(o=Array.isArray(t)?t:stringToArray(t));var i=getDifferenceOfArrays(n,o),a=getDifferenceOfArrays(o,n);i.length&&removeClass(r,i),a.length&&addClass(r,a)}p[e]=t}function C(){var e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function w(e){var t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):e}function E(e,t,n){if(e.length){var o=u.getActiveEditor(),i=u.runHooks("beforeChange",e,t||"edit"),a=!0;if(!1!==i){var s,l=new C;l.onQueueEmpty=function(e){o&&a&&o.cancelChanges(),n(e)};for(var c=e.length-1;c>=0;c--)if(null===e[c])e.splice(c,1);else{var f=_slicedToArray$9(e[c],4),h=f[0],p=f[1],y=f[3],g=r.propToCol(p),m=u.getCellMeta(h,g);"numeric"===m.type&&"string"==typeof y&&((s=y).length>0&&/^\s*[+-.]?\s*(?:(?:\d+(?:(\.|,)\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/.test(s))&&(e[c][3]=w(y)),u.getCellValidator(m)&&(l.addValidatorToQueue(),u.validateCell(e[c][3],m,function(t,r){return function(n){if("boolean"!=typeof n)throw new Error("Validation error: result is not boolean");if(!1===n&&!1===r.allowInvalid){a=!1,e.splice(t,1),r.valid=!0;var o=u.getCell(r.visualRow,r.visualCol);null!==o&&removeClass(o,d.invalidCellClassName)}l.removeValidatorFormQueue()}}(c,m),t))}l.checkIfQueueIsEmpty()}else o&&o.cancelChanges()}}function S(e,t){var n=e.length-1;if(!(n<0)){for(;n>=0;n--){var a=!1;if(null!==e[n]){if(null!==e[n][2]&&void 0!==e[n][2]||null!==e[n][3]&&void 0!==e[n][3]){if(d.allowInsertRow)for(;e[n][0]>u.countRows()-1;){var s=r.createRow(void 0,void 0,t);if(!(s>=1)){a=!0;break}h.createRow(null,s)}if("array"===u.dataType&&(!d.columns||0===d.columns.length)&&d.allowInsertColumn)for(;r.propToCol(e[n][1])>u.countCols()-1;){var l=r.createCol(void 0,void 0,t);if(!(l>=1)){a=!0;break}h.createColumn(null,l)}a||r.set(e[n][0],e[n][1],e[n][3])}}else e.splice(n,1)}u.forceFullRender=!0,o.adjustRowsAndCols(),u.runHooks("beforeChangeRender",e,t),i.lockEditor(),u._refreshBorders(null),i.unlockEditor(),u.view.wt.wtOverlays.adjustElementsSize(),u.runHooks("afterChange",e,t||"edit");var c=u.getActiveEditor();c&&isDefined(c.refreshValue)&&c.refreshValue()}}function O(e,t,r){return Array.isArray(e)?e:[[e,t,r]]}this.columnIndexMapper.addLocalHook("cacheUpdated",v),this.rowIndexMapper.addLocalHook("cacheUpdated",v),this.selection.addLocalHook("beforeSetRangeStart",(function(e){a.runHooks("beforeSetRangeStart",e)})),this.selection.addLocalHook("beforeSetRangeStartOnly",(function(e){a.runHooks("beforeSetRangeStartOnly",e)})),this.selection.addLocalHook("beforeSetRangeEnd",(function(e){a.runHooks("beforeSetRangeEnd",e),e.row<0&&(e.row=a.view.wt.wtTable.getFirstVisibleRow()),e.col<0&&(e.col=a.view.wt.wtTable.getFirstVisibleColumn())})),this.selection.addLocalHook("afterSetRangeEnd",(function(e){var t=createObjectPropListener(!1),r=a.selection.getSelectedRange(),n=r.current(),o=n.from,i=n.to,s=r.size()-1;a.runHooks("afterSelection",o.row,o.col,i.row,i.col,t,s),a.runHooks("afterSelectionByProp",o.row,u.colToProp(o.col),i.row,u.colToProp(i.col),t,s);var c=a.selection.isSelectedByAnyHeader(),f=a.selection.selectedRange.current(),h=!0;l&&(h=!1),t.isTouched()&&(h=!t.value);var d=a.selection.isSelectedByRowHeader(),p=a.selection.isSelectedByColumnHeader();!1!==h&&(c?d?a.view.scrollViewportVertically(u.rowIndexMapper.getRenderableFromVisualIndex(e.row)):p&&a.view.scrollViewportHorizontally(u.columnIndexMapper.getRenderableFromVisualIndex(e.col)):f&&!a.selection.isMultiple()?a.view.scrollViewport(y(f.from)):a.view.scrollViewport(y(e))),d&&p?addClass(a.rootElement,["ht__selection--rows","ht__selection--columns"]):d?(removeClass(a.rootElement,"ht__selection--columns"),addClass(a.rootElement,"ht__selection--rows")):p?(removeClass(a.rootElement,"ht__selection--rows"),addClass(a.rootElement,"ht__selection--columns")):removeClass(a.rootElement,["ht__selection--rows","ht__selection--columns"]),a._refreshBorders(null)})),this.selection.addLocalHook("afterSelectionFinished",(function(e){var t=e.length-1,r=e[t],n=r.from,o=r.to;a.runHooks("afterSelectionEnd",n.row,n.col,o.row,o.col,t),a.runHooks("afterSelectionEndByProp",n.row,u.colToProp(n.col),o.row,u.colToProp(o.col),t)})),this.selection.addLocalHook("afterIsMultipleSelection",(function(e){var t=a.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)})),this.selection.addLocalHook("beforeModifyTransformStart",(function(e){a.runHooks("modifyTransformStart",e)})),this.selection.addLocalHook("afterModifyTransformStart",(function(e,t,r){a.runHooks("afterModifyTransformStart",e,t,r)})),this.selection.addLocalHook("beforeModifyTransformEnd",(function(e){a.runHooks("modifyTransformEnd",e)})),this.selection.addLocalHook("afterModifyTransformEnd",(function(e,t,r){a.runHooks("afterModifyTransformEnd",e,t,r)})),this.selection.addLocalHook("afterDeselect",(function(){i.destroyEditor(),a._refreshBorders(),removeClass(a.rootElement,["ht__selection--rows","ht__selection--columns"]),a.runHooks("afterDeselect")})),this.selection.addLocalHook("insertRowRequire",(function(e){a.alter("insert_row",e,1,"auto")})),this.selection.addLocalHook("insertColRequire",(function(e){a.alter("insert_col",e,1,"auto")})),o={alter:function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,l=function(e){if(0===e.length)return[];var t=_toConsumableArray$a(e);return t.sort((function(e,t){var r=_slicedToArray$9(e,1)[0],n=_slicedToArray$9(t,1)[0];return r===n?0:r>n?1:-1})),arrayReduce(t,(function(e,t){var r=_slicedToArray$9(t,2),n=r[0],o=r[1],i=e[e.length-1],a=_slicedToArray$9(i,2),s=a[0]+a[1];if(n<=s){var l=Math.max(o-(s-n),0);i[1]+=l}else e.push([n,o]);return e}),[t[0]])};switch(e){case"insert_row":var c=u.countSourceRows();if(d.maxRows===c)return;if(t=isDefined(t)?t:c,n=r.createRow(t,i,a)){h.createRow(u.toPhysicalRow(t),i);var f=m.selectedRange.current(),p=null==f?void 0:f.from,y=null==p?void 0:p.row;if(isDefined(y)&&y>=t){var g=f.to,v=g.row,_=g.col,b=p.col;m.isSelectedByRowHeader()&&(b=-1),m.getSelectedRange().pop(),m.setRangeStartOnly(new CellCoords(y+n,b),!0),m.setRangeEnd(new CellCoords(v+n,_))}else u._refreshBorders()}break;case"insert_col":if(n=r.createCol(t,i,a)){if(h.createColumn(u.toPhysicalColumn(t),i),Array.isArray(d.colHeaders)){var C=[t,0];C.length+=n,Array.prototype.splice.apply(d.colHeaders,C)}var w=m.selectedRange.current(),E=null==w?void 0:w.from,S=null==E?void 0:E.col;if(isDefined(S)&&S>=t){var O=w.to,T=O.row,R=O.col,$=E.row;m.isSelectedByColumnHeader()&&($=-1),m.getSelectedRange().pop(),m.setRangeStartOnly(new CellCoords($,S+n),!0),m.setRangeEnd(new CellCoords(T,R+n))}else u._refreshBorders()}break;case"remove_row":var I=function(e){var t=0;arrayEach(e,(function(e){var n=_slicedToArray$9(e,2),o=n[0],i=n[1],s=isEmpty(o)?u.countRows()-1:Math.max(o-t,0);if(Number.isInteger(o)&&(o=Math.max(o-t,0)),r.removeRow(o,i,a)){h.removeRow(u.toPhysicalRow(s),i);var l=u.countRows(),c=d.fixedRowsTop;c>=s+1&&(d.fixedRowsTop-=Math.min(i,c-s));var f=d.fixedRowsBottom;f&&s>=l-f&&(d.fixedRowsBottom-=Math.min(i,f)),t+=i}}))};Array.isArray(t)?I(l(t)):I([[t,i]]),o.adjustRowsAndCols(),u._refreshBorders();break;case"remove_col":var A=function(e){var t=0;arrayEach(e,(function(e){var n=_slicedToArray$9(e,2),o=n[0],i=n[1],s=isEmpty(o)?u.countCols()-1:Math.max(o-t,0),l=u.toPhysicalColumn(s);if(Number.isInteger(o)&&(o=Math.max(o-t,0)),r.removeCol(o,i,a)){h.removeColumn(l,i);var c=d.fixedColumnsLeft;c>=s+1&&(d.fixedColumnsLeft-=Math.min(i,c-s)),Array.isArray(d.colHeaders)&&(void 0===l&&(l=-1),d.colHeaders.splice(l,i)),t+=i}}))};Array.isArray(t)?A(l(t)):A([[t,i]]),o.adjustRowsAndCols(),u._refreshBorders();break;default:throw new Error('There is no such action "'.concat(e,'"'))}s||o.adjustRowsAndCols()},adjustRowsAndCols:function(){if(d.minRows){var e=u.countRows();if(e<d.minRows)for(var t=0,n=d.minRows;t<n-e;t++)r.createRow(u.countRows(),1,"auto")}if(d.minSpareRows){var o=u.countEmptyRows(!0);if(o<d.minSpareRows)for(;o<d.minSpareRows&&u.countSourceRows()<d.maxRows;o++)r.createRow(u.countRows(),1,"auto")}var i;if((d.minCols||d.minSpareCols)&&(i=u.countEmptyCols(!0)),d.minCols&&!d.columns&&u.countCols()<d.minCols)for(;u.countCols()<d.minCols;i++)r.createCol(u.countCols(),1,"auto");if(d.minSpareCols&&!d.columns&&"array"===u.dataType&&i<d.minSpareCols)for(;i<d.minSpareCols&&u.countCols()<d.maxCols;i++)r.createCol(u.countCols(),1,"auto");var a=u.countRows(),s=u.countCols();0!==a&&0!==s||m.deselect(),m.isSelected()&&arrayEach(m.selectedRange,(function(e){var t=!1,r=e.from.row,n=e.from.col,o=e.to.row,i=e.to.col;r>a-1?(t=!0,o>(r=a-1)&&(o=r)):o>a-1&&(t=!0,r>(o=a-1)&&(r=o)),n>s-1?(t=!0,i>(n=s-1)&&(i=n)):i>s-1&&(t=!0,n>(i=s-1)&&(n=i)),t&&u.selectCell(r,n,o,i)})),u.view&&u.view.wt.wtOverlays.adjustElementsSize()},populateFromArray:function(e,t,r,n,o,i,a){var s,l,c,f,h,p,y,g,m=[],v={};if(0===(l=t.length))return!1;switch(o){case"shift_down":for(h=r?r.col-e.col+1:0,p=r?r.row-e.row+1:0,c=0,f=(t=translateRowsToColumns(t)).length,y=Math.max(f,h);c<y;c++)if(c<f){var _;for(s=0,l=t[c].length;s<p-l;s++)t[c].push(t[c][s%l]);t[c].unshift(e.col+c,e.row,0),(_=u).spliceCol.apply(_,_toConsumableArray$a(t[c]))}else{var b;t[c%f][0]=e.col+c,(b=u).spliceCol.apply(b,_toConsumableArray$a(t[c%f]))}break;case"shift_right":for(h=r?r.col-e.col+1:0,p=r?r.row-e.row+1:0,s=0,l=t.length,g=Math.max(l,p);s<g;s++)if(s<l){var C;for(c=0,f=t[s].length;c<h-f;c++)t[s].push(t[s][c%f]);t[s].unshift(e.row+s,e.col,0),(C=u).spliceRow.apply(C,_toConsumableArray$a(t[s]))}else{var w;t[s%l][0]=e.row+s,(w=u).spliceRow.apply(w,_toConsumableArray$a(t[s%l]))}break;case"overwrite":default:v.row=e.row,v.col=e.col;var E,S={row:r&&e?r.row-e.row+1:1,col:r&&e?r.col-e.col+1:1},O=0,T=0,R=!0,$=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=t[e%t.length];return null!==r?n[r%n.length]:n},I=t.length,A=r?r.row-e.row+1:0;for(l=r?A:Math.max(I,A),s=0;s<l&&!(r&&v.row>r.row&&A>I||!d.allowInsertRow&&v.row>u.countRows()-1||v.row>=d.maxRows);s++){var P=s-O,k=$(P).length,N=r?r.col-e.col+1:0;if(f=r?N:Math.max(k,N),v.col=e.col,E=u.getCellMeta(v.row,v.col),"CopyPaste.paste"!==n&&"Autofill.fill"!==n||!E.skipRowOnPaste){for(T=0,c=0;c<f&&!(r&&v.col>r.col&&N>k||!d.allowInsertColumn&&v.col>u.countCols()-1||v.col>=d.maxCols);c++)if(E=u.getCellMeta(v.row,v.col),"CopyPaste.paste"!==n&&"Autofill.fill"!==n||!E.skipColumnOnPaste)if(E.readOnly)v.col+=1;else{var M=c-T,D=$(P,M),L=u.getDataAtCell(v.row,v.col),x={row:P,col:M};if("Autofill.fill"===n){var H=u.runHooks("beforeAutofillInsidePopulate",x,i,t,a,{},S);H&&(D=isUndefined(H.value)?D:H.value)}if(null!==D&&"object"===_typeof$G(D))if(Array.isArray(D)&&null===L&&(L=[]),null===L||"object"!==_typeof$G(L))R=!1;else isObjectEqual(duckSchema(Array.isArray(L)?L:L[0]||L),duckSchema(Array.isArray(D)?D:D[0]||D))?D=deepClone(D):R=!1;else null!==L&&"object"===_typeof$G(L)&&(R=!1);R&&m.push([v.row,v.col,D]),R=!0,v.col+=1}else T+=1,v.col+=1,f+=1;v.row+=1}else O+=1,v.row+=1,l+=1}u.setDataAtCell(m,null,null,n||"populateFromArray")}}},this.batch=function(e){var t=this;this.columnIndexMapper.executeBatchOperations((function(){t.rowIndexMapper.executeBatchOperations((function(){e()}))}))},this.init=function(){n.setData(d.data),u.runHooks("beforeInit"),isMobileBrowser()&&addClass(u.rootElement,"mobile"),this.updateSettings(d,!0),this.view=new TableView(this),i=EditorManager.getInstance(u,d,m),u.runHooks("init"),this.forceFullRender=!0,this.view.render(),"object"===_typeof$G(f)&&(u.runHooks("afterChange",f[0],f[1]),f=!1),u.runHooks("afterInit")},this.validateCell=function(e,t,r,n){var o,i=u.getCellValidator(t);function a(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(n&&!0!==t.hidden){var o=t.visualCol,i=t.visualRow,a=u.getCell(i,o,!0);a&&"TH"!==a.nodeName&&u.view.wt.wtSettings.settings.cellRenderer(i,o,a),r(e)}else r(e)}isRegExp(i)&&(o=i,i=function(e,t){t(o.test(e))}),isFunction(i)?(e=u.runHooks("beforeValidate",e,t.visualRow,t.prop,n),u._registerImmediate((function(){i.call(t,e,(function(r){u&&(r=u.runHooks("afterValidate",r,e,t.visualRow,t.prop,n),t.valid=r,a(r),u.runHooks("postAfterValidate",r,e,t.visualRow,t.prop,n))}))}))):u._registerImmediate((function(){t.valid=!0,a(t.valid,!1)}))},this.setDataAtCell=function(e,t,o,i){var a,s,l,c=O(e,t,o),f=[],h=i;for(a=0,s=c.length;a<s;a++){if("object"!==_typeof$G(c[a]))throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof c[a][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");l=c[a][1]>=this.countCols()?c[a][1]:r.colToProp(c[a][1]),f.push([c[a][0],l,n.getAtCell(this.toPhysicalRow(c[a][0]),c[a][1]),c[a][2]])}h||"object"!==_typeof$G(e)||(h=t),u.runHooks("afterSetDataAtCell",f,h),E(f,h,(function(){S(f,h)}))},this.setDataAtRowProp=function(e,t,r,o){var i,a,s=O(e,t,r),l=[],c=o;for(i=0,a=s.length;i<a;i++)l.push([s[i][0],s[i][1],n.getAtCell(this.toPhysicalRow(s[i][0]),s[i][1]),s[i][2]]);c||"object"!==_typeof$G(e)||(c=t),u.runHooks("afterSetDataAtRowProp",l,c),E(l,c,(function(){S(l,c)}))},this.listen=function(){u&&!u.isListening()&&(activeGuid=u.guid,u.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(activeGuid=null,u.runHooks("afterUnlisten"))},this.isListening=function(){return activeGuid===u.guid},this.destroyEditor=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];u._refreshBorders(e,t)},this.populateFromArray=function(e,t,r,n,i,a,s,l,u){if("object"!==_typeof$G(r)||"object"!==_typeof$G(r[0]))throw new Error("populateFromArray parameter `input` must be an array of arrays");var c="number"==typeof n?new CellCoords(n,i):null;return o.populateFromArray(new CellCoords(e,t),r,c,a,s,l,u)},this.spliceCol=function(e,t,n){for(var o,i=arguments.length,a=new Array(i>3?i-3:0),s=3;s<i;s++)a[s-3]=arguments[s];return(o=r).spliceCol.apply(o,[e,t,n].concat(a))},this.spliceRow=function(e,t,n){for(var o,i=arguments.length,a=new Array(i>3?i-3:0),s=3;s<i;s++)a[s-3]=arguments[s];return(o=r).spliceRow.apply(o,[e,t,n].concat(a))},this.getSelected=function(){if(m.isSelected())return arrayMap(m.getSelectedRange(),(function(e){var t=e.from,r=e.to;return[t.row,t.col,r.row,r.col]}))},this.getSelectedLast=function(){var e,t=this.getSelected();return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(m.isSelected())return Array.from(m.getSelectedRange())},this.getSelectedRangeLast=function(){var e,t=this.getSelectedRange();return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(e){var t=this;if(m.isSelected()&&0!==this.countRows()&&0!==this.countCols()){var r=[];arrayEach(m.getSelectedRange(),(function(e){var n=e.getTopLeftCorner(),o=e.getBottomRightCorner();rangeEach(n.row,o.row,(function(e){rangeEach(n.col,o.col,(function(n){t.getCellMeta(e,n).readOnly||r.push([e,n,null])}))}))})),r.length>0&&this.setDataAtCell(r,e)}},this.render=function(){u.view&&(u.renderCall=!0,u.forceFullRender=!0,i.lockEditor(),u._refreshBorders(null),i.unlockEditor())},this.refreshDimensions=function(){if(u.view){var e=u.view.getLastSize(),t=e.width,r=e.height,n=u.rootElement.getBoundingClientRect(),o=n.width,i=n.height,a=o!==t||i!==r;!1===u.runHooks("beforeRefreshDimensions",{width:t,height:r},{width:o,height:i},a)||((a||u.view.wt.wtOverlays.scrollableElement===u.rootWindow)&&(u.view.setLastSize(o,i),u.render()),u.runHooks("afterRefreshDimensions",{width:t,height:r},{width:o,height:i},a))}},this.loadData=function(e){if(Array.isArray(d.dataSchema)?u.dataType="array":isFunction(d.dataSchema)?u.dataType="function":u.dataType="object",r&&r.destroy(),r=new DataMap(u,e,d),"object"===_typeof$G(e)&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error("loadData only accepts array of objects or array of arrays (".concat(_typeof$G(e)," given)"));var t,i=r.getSchema();e=[];var a,s=0;for(s=0,a=d.startRows;s<a;s++)if("object"!==u.dataType&&"function"!==u.dataType||!d.dataSchema)if("array"===u.dataType)t=deepClone(i[0]),e.push(t);else{t=[];for(var l=0,c=d.startCols;l<c;l++)t.push(null);e.push(t)}else t=deepClone(i),e.push(t)}Array.isArray(e[0])&&(u.dataType="array"),d.data=e,u.runHooks("beforeLoadData",e,f),r.dataSource=e,n.data=e,n.dataType=u.dataType,n.colToProp=r.colToProp.bind(r),n.propToCol=r.propToCol.bind(r),n.countCachedColumns=r.countCachedColumns.bind(r),h.clearCellsCache(),u.initIndexMappers(),o.adjustRowsAndCols(),u.runHooks("afterLoadData",e,f),f?f=[null,"loadData"]:(u.runHooks("afterChange",null,"loadData"),u.render())},this.initIndexMappers=function(){var e=d.columns,t=0;if(Array.isArray(e))t=e.length;else if(isFunction(e))if("array"===u.dataType)for(var n=this.countSourceCols(),o=0;o<n;o+=1)e(o)&&(t+=1);else"object"!==u.dataType&&"function"!==u.dataType||(t=r.colToPropCache.length);else if(isDefined(d.dataSchema)){var i=r.getSchema();t=Array.isArray(i)?i.length:deepObjectSize(i)}else t=this.countSourceCols();this.columnIndexMapper.initToLength(t),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,n,o){return isUndefined(e)?r.getAll():r.getRange(new CellCoords(e,t),new CellCoords(n,o),r.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,n,o){return r.getCopyableText(new CellCoords(e,t),new CellCoords(n,o))},this.getCopyableData=function(e,t){return r.getCopyable(e,r.colToProp(t))},this.getSchema=function(){return r.getSchema()},this.updateSettings=function(e){var t,n,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=!1;if(isDefined(e.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(isDefined(e.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(isDefined(e.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(t in e)"data"!==t&&("language"!==t?"className"===t?b("className",e.className):"tableClassName"===t&&u.table?(b("tableClassName",e.tableClassName),u.view.wt.wtOverlays.syncOverlayTableClassNames()):Hooks.getSingleton().isRegistered(t)||Hooks.getSingleton().isDeprecated(t)?(isFunction(e[t])||Array.isArray(e[t]))&&(e[t].initialHook=!0,u.addHook(t,e[t])):!a&&hasOwnProperty$1(e,t)&&(p[t]=e[t]):_(e.language));void 0===e.data&&void 0===d.data?u.loadData(null):void 0!==e.data?u.loadData(e.data):void 0!==e.columns&&(r.createMap(),u.initIndexMappers());var l=u.countCols(),c=d.columns;if(c&&isFunction(c)&&(s=!0),void 0===e.cell&&void 0===e.cells&&void 0===e.columns||h.clearCache(),l>0)for(t=0,n=0;t<l;t++){if(c){var y=s?c(t):c[n];y&&h.updateColumnMeta(n,y)}n+=1}isDefined(e.cell)&&objectEach(e.cell,(function(e){u.setCellMetaObject(e.row,e.col,e)})),u.runHooks("afterCellMetaReset");var g=u.rootElement.style.height;""!==g&&(g=parseInt(u.rootElement.style.height,10));var m=e.height;if(isFunction(m)&&(m=m()),a){var v=u.rootElement.getAttribute("style");v&&u.rootElement.setAttribute("data-initialstyle",u.rootElement.getAttribute("style"))}if(null===m){var C=u.rootElement.getAttribute("data-initialstyle");C&&(C.indexOf("height")>-1||C.indexOf("overflow")>-1)?u.rootElement.setAttribute("style",C):(u.rootElement.style.height="",u.rootElement.style.overflow="")}else void 0!==m&&(u.rootElement.style.height=isNaN(m)?"".concat(m):"".concat(m,"px"),u.rootElement.style.overflow="hidden");if(void 0!==e.width){var w=e.width;isFunction(w)&&(w=w()),u.rootElement.style.width=isNaN(w)?"".concat(w):"".concat(w,"px")}a||(u.view&&(u.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked(),u.view.wt.exportSettingsAsClassNames()),u.runHooks("afterUpdateSettings",e)),o.adjustRowsAndCols(),u.view&&!f&&(u.forceFullRender=!0,i.lockEditor(),u._refreshBorders(null),i.unlockEditor()),a||!u.view||""!==g&&""!==m&&void 0!==m||g===m||u.view.wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var e=u.getSelectedLast();if(d.getValue){if(isFunction(d.getValue))return d.getValue.call(u);if(e)return u.getData()[e[0][0]][d.getValue]}else if(e)return u.getDataAtCell(e[0],e[1])},this.getSettings=function(){return d},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,r,n,i){o.alter(e,t,r,n,i)},this.getCell=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t,o=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;n=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;o=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===o||null===n?null:u.view.getCellAtCoords(new CellCoords(o,n),r)},this.getCoords=function(e){var t=this.view.wt.wtTable.getCoords(e);if(null===t)return null;var r=t.row,n=t.col,o=r,i=n;return r>=0&&(o=this.rowIndexMapper.getVisualFromRenderableIndex(r)),n>=0&&(i=this.columnIndexMapper.getVisualFromRenderableIndex(n)),new CellCoords(o,i)},this.colToProp=function(e){return r.colToProp(e)},this.propToCol=function(e){return r.propToCol(e)},this.toVisualRow=function(e){return a.rowIndexMapper.getVisualFromPhysicalIndex(e)},this.toVisualColumn=function(e){return a.columnIndexMapper.getVisualFromPhysicalIndex(e)},this.toPhysicalRow=function(e){return a.rowIndexMapper.getPhysicalFromVisualIndex(e)},this.toPhysicalColumn=function(e){return a.columnIndexMapper.getPhysicalFromVisualIndex(e)},this.getDataAtCell=function(e,t){return r.get(e,r.colToProp(t))},this.getDataAtRowProp=function(e,t){return r.get(e,t)},this.getDataAtCol=function(e){var t;return(t=[]).concat.apply(t,_toConsumableArray$a(r.getRange(new CellCoords(0,e),new CellCoords(d.data.length-1,e),r.DESTINATION_RENDERER)))},this.getDataAtProp=function(e){var t,n=r.getRange(new CellCoords(0,r.propToCol(e)),new CellCoords(d.data.length-1,r.propToCol(e)),r.DESTINATION_RENDERER);return(t=[]).concat.apply(t,_toConsumableArray$a(n))},this.getSourceData=function(e,t,r,o){return void 0===e?n.getData():n.getByRange(new CellCoords(e,t),new CellCoords(r,o))},this.getSourceDataArray=function(e,t,r,o){return void 0===e?n.getData(!0):n.getByRange(new CellCoords(e,t),new CellCoords(r,o),!0)},this.getSourceDataAtCol=function(e){return n.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,r,o){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=O(e,t,r),s=this.hasHook("afterSetSourceDataAtCell"),l=[];s&&arrayEach(a,(function(e){var t=_slicedToArray$9(e,3),r=t[0],o=t[1],i=t[2];l.push([r,o,n.getAtCell(r,o),i])})),arrayEach(a,(function(e){var t=_slicedToArray$9(e,3),r=t[0],o=t[1],i=t[2];n.setAtCell(r,o,i)})),s&&this.runHooks("afterSetSourceDataAtCell",l,o),i||this.render();var c=u.getActiveEditor();c&&isDefined(c.refreshValue)&&c.refreshValue()},this.getSourceDataAtRow=function(e){return n.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return n.getAtCell(e,t)},this.getDataAtRow=function(e){return r.getRange(new CellCoords(e,0),new CellCoords(e,this.countCols()-1),r.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,r,n){var o=this,i=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,r,n],a=i[0],s=i[1],l=i[2],u=i[3],c=null,f=null;void 0===l&&(l=a),void 0===u&&(u=s);var h="mixed";return rangeEach(Math.max(Math.min(a,l),0),Math.max(a,l),(function(e){var t=!0;return rangeEach(Math.max(Math.min(s,u),0),Math.max(s,u),(function(r){var n=o.getCellMeta(e,r);return f=n.type,c?t=c===f:c=f,t})),h=t?f:"mixed",t})),h},this.removeCellMeta=function(e,t,r){var n=[this.toPhysicalRow(e),this.toPhysicalColumn(t)],o=n[0],i=n[1],a=h.getCellMeta(o,i,r);!1!==u.runHooks("beforeRemoveCellMeta",e,t,r,a)&&(h.removeCellMeta(o,i,r),u.runHooks("afterRemoveCellMeta",e,t,r,a)),a=null},this.spliceCellsMeta=function(e){for(var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];if(o.length>0&&!Array.isArray(o[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");r>0&&h.removeRow(this.toPhysicalRow(e),r),o.length>0&&arrayEach(o.reverse(),(function(r){h.createRow(t.toPhysicalRow(e)),arrayEach(r,(function(r,n){return t.setCellMetaObject(e,n,r)}))}))},this.setCellMetaObject=function(e,t,r){var n=this;"object"===_typeof$G(r)&&objectEach(r,(function(r,o){n.setCellMeta(e,t,o,r)}))},this.setCellMeta=function(e,t,r,n){if(!1!==u.runHooks("beforeSetCellMeta",e,t,r,n)){var o=e,i=t;e<this.countRows()&&(o=this.toPhysicalRow(e)),t<this.countCols()&&(i=this.toPhysicalColumn(t)),h.setCellMeta(o,i,r,n),u.runHooks("afterSetCellMeta",e,t,r,n)}},this.getCellsMeta=function(){return h.getCellsMeta()},this.getCellMeta=function(e,t){var n=this.toPhysicalRow(e),o=this.toPhysicalColumn(t);null===n&&(n=e),null===o&&(o=t);var i=r.colToProp(t),a=h.getCellMeta(n,o);if(a.row=n,a.col=o,a.visualRow=e,a.visualCol=t,a.prop=i,a.instance=u,u.runHooks("beforeGetCellMeta",e,t,a),u.hasHook("beforeGetCellMeta")&&hasOwnProperty$1(a,"type")&&h.updateCellMeta(n,o,{type:a.type}),a.cells){var s=a.cells(n,o,i);s&&h.updateCellMeta(n,o,s)}return u.runHooks("afterGetCellMeta",e,t,a),a},this.getCellMetaAtRow=function(e){return h.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===u.dataType||d.columns)};var T=cellMethodLookupFactory("renderer");this.getCellRenderer=function(e,t){return _getItem(T.call(this,e,t))},this.getCellEditor=cellMethodLookupFactory("editor");var R=cellMethodLookupFactory("validator");this.getCellValidator=function(e,t){var r=R.call(this,e,t);return"string"==typeof r&&(r=_getItem$2(r)),r},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,r){var n=new C;e&&(n.onQueueEmpty=e);for(var o=u.countRows()-1;o>=0;)if(void 0===t||-1!==t.indexOf(o)){for(var i=u.countCols()-1;i>=0;)void 0===r||-1!==r.indexOf(i)?(n.addValidatorToQueue(),u.validateCell(u.getDataAtCell(o,i),u.getCellMeta(o,i),(function(e){if("boolean"!=typeof e)throw new Error("Validation error: result is not boolean");!1===e&&(n.valid=!1),n.removeValidatorFormQueue()}),"validateCells"),i-=1):i-=1;o-=1}else o-=1;n.checkIfQueueIsEmpty()},this.getRowHeader=function(e){var t=d.rowHeaders,r=e;return void 0!==r&&(r=u.runHooks("modifyRowHeader",r)),void 0===r?(t=[],rangeEach(u.countRows()-1,(function(e){t.push(u.getRowHeader(e))}))):Array.isArray(t)&&void 0!==t[r]?t=t[r]:isFunction(t)?t=t(r):t&&"string"!=typeof t&&"number"!=typeof t&&(t=r+1),t},this.hasRowHeaders=function(){return!!d.rowHeaders},this.hasColHeaders=function(){if(void 0!==d.colHeaders&&null!==d.colHeaders)return!!d.colHeaders;for(var e=0,t=u.countCols();e<t;e++)if(u.getColHeader(e))return!0;return!1},this.getColHeader=function(e){var t=u.runHooks("modifyColHeader",e),r=d.colHeaders;if(void 0===t){for(var n=[],o=u.countCols(),i=0;i<o;i++)n.push(u.getColHeader(i));r=n}else{var a=u.toPhysicalColumn(t),s=function(e){for(var t=[],r=u.countCols(),n=0;n<r;n++)isFunction(d.columns)&&d.columns(n)&&t.push(n);return t[e]}(a);!1===d.colHeaders?r=null:d.columns&&isFunction(d.columns)&&d.columns(s)&&d.columns(s).title?r=d.columns(s).title:d.columns&&d.columns[a]&&d.columns[a].title?r=d.columns[a].title:Array.isArray(d.colHeaders)&&void 0!==d.colHeaders[a]?r=d.colHeaders[a]:isFunction(d.colHeaders)?r=d.colHeaders(a):d.colHeaders&&"string"!=typeof d.colHeaders&&"number"!=typeof d.colHeaders&&(r=spreadsheetColumnLabel(t))}return r},this._getColWidthFromSettings=function(e){var t;e>=0&&(t=u.getCellMeta(0,e).width);if(void 0!==t&&t!==d.width||(t=d.colWidths),null!=t){switch(_typeof$G(t)){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(e){var t=u._getColWidthFromSettings(e);return void 0===(t=u.runHooks("modifyColWidth",t,e))&&(t=ViewportColumnsCalculator.DEFAULT_WIDTH),t},this._getRowHeightFromSettings=function(e){var t=d.rowHeights;if(null!=t){switch(_typeof$G(t)){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var t=u._getRowHeightFromSettings(e);return t=u.runHooks("modifyRowHeight",t,e)},this.countSourceRows=function(){return n.countRows()},this.countSourceCols=function(){return n.countFirstRowKeys()},this.countRows=function(){return r.getLength()},this.countCols=function(){var e=d.maxCols,t=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t)},this.countRenderedRows=function(){return u.view.wt.drawn?u.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return u.view.wt.drawn?u.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return u.view.wt.drawn?u.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return u.view.wt.drawn?u.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return rangeEachReverse(u.countRows()-1,(function(r){if(u.isEmptyRow(r))t+=1;else if(!0===e)return!1})),t},this.countEmptyCols=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(u.countRows()<1)return 0;var t=0;return rangeEachReverse(u.countCols()-1,(function(r){if(u.isEmptyCol(r))t+=1;else if(!0===e)return!1})),t},this.isEmptyRow=function(e){return d.isEmptyRow.call(u,e)},this.isEmptyCol=function(e){return d.isEmptyCol.call(u,e)},this.selectCell=function(e,t,r,n){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!isUndefined(e)&&!isUndefined(t)&&this.selectCells([[e,t,r,n]],o,i)},this.selectCells=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===t&&(l=!0);var n=m.selectCells(e);return n&&r&&u.listen(),l=!1,n},this.selectColumns=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return m.selectColumns(e,t)},this.selectRows=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return m.selectRows(e,t)},this.deselectCell=function(){m.deselect()},this.selectAll=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=e&&this.hasRowHeaders(),r=e&&this.hasColHeaders();l=!0,m.selectAll(t,r),l=!1};var $=function(e,t){return e.getFirstNotHiddenIndex(t,1,!0)};function I(e){return function(){throw new Error('The "'.concat(e,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.scrollViewportTo=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!r,a=!n,s=e,l=t;if(o){var c=Number.isInteger(e),f=Number.isInteger(t),h=c?$(this.rowIndexMapper,e):void 0,d=f?$(this.columnIndexMapper,t):void 0;if(null===h||null===d)return!1;s=c?u.rowIndexMapper.getRenderableFromVisualIndex(h):void 0,l=f?u.columnIndexMapper.getRenderableFromVisualIndex(d):void 0}var p=Number.isInteger(s),y=Number.isInteger(l);return p&&y?u.view.scrollViewport(new CellCoords(s,l),i,n,r,a):p&&!1===y?u.view.scrollViewportVertically(s,i,r):!(!y||!1!==p)&&u.view.scrollViewportHorizontally(l,n,a)},this.destroy=function(){if(u._clearTimeouts(),u._clearImmediates(),u.view&&u.view.destroy(),n&&n.destroy(),n=null,h.clearCache(),stopObserving(),isRootInstance(u)){var e=this.rootDocument.querySelector("#hot-display-license-info");e&&e.parentNode.removeChild(e)}empty$1(u.rootElement),c.destroy(),i&&i.destroy(),u.batch((function(){u.runHooks("afterDestroy")})),Hooks.getSingleton().destroy(u),objectEach(u,(function(e,t,r){isFunction(e)?r[t]=I(t):"guid"!==t&&(r[t]=null)})),u.isDestroyed=!0,r&&r.destroy(),u.rowIndexMapper=null,u.columnIndexMapper=null,r=null,o=null,m=null,i=null,u=null},this.getActiveEditor=function(){return i.getActiveEditor()},this.getPlugin=function(e){return getPlugin(this,e)},this.getInstance=function(){return u},this.addHook=function(e,t){Hooks.getSingleton().add(e,t,u)},this.hasHook=function(e){return Hooks.getSingleton().has(e,u)},this.addHookOnce=function(e,t){Hooks.getSingleton().once(e,t,u)},this.removeHook=function(e,t){Hooks.getSingleton().remove(e,t,u)},this.runHooks=function(e,t,r,n,o,i,a){return Hooks.getSingleton().run(u,e,t,r,n,o,i,a)},this.getTranslatedPhrase=function(e,t){return getTranslatedPhrase(d.language,e,t)},this.toHTML=function(){return instanceToHTML(a)},this.toTableElement=function(){var e=a.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",instanceToHTML(a)),e.firstElementChild},this.timeouts=[],this._registerTimeout=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=e;"function"==typeof r&&(r=setTimeout(r,t)),this.timeouts.push(r)},this._clearTimeouts=function(){arrayEach(this.timeouts,(function(e){clearTimeout(e)}))},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){arrayEach(this.immediates,(function(e){clearImmediate(e)}))},this._refreshBorders=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];i.destroyEditor(e),u.view.render(),t&&m.isSelected()&&i.prepareEditor()},Hooks.getSingleton().run(u,"construct")}function jQueryWrapper(e){var t="undefined"!=typeof window&&window.jQuery;t&&(t.fn.handsontable=function(t){var r,n=this.first(),o=n.data("handsontable");if("string"!=typeof t){var i=t||{};return o?o.updateSettings(i):(o=new e.Core(n[0],i),n.data("handsontable",o),o.init()),n}if(o){if(void 0===o[t])throw new Error("Handsontable do not provide action: ".concat(t));for(var a,s=arguments.length,l=new Array(s>1?s-1:0),u=1;u<s;u++)l[u-1]=arguments[u];r=(a=o[t]).call.apply(a,[o].concat(l)),"destroy"===t&&n.removeData()}return r})}function _classCallCheck$1d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$17(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$17(e,t,r){return t&&_defineProperties$17(e.prototype,t),r&&_defineProperties$17(e,r),e}var GhostTable=function(){function e(t){_classCallCheck$1d(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return _createClass$17(e,[{key:"addRow",value:function(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var r={row:e};this.rows.push(r),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}},{key:"addColumnHeadersRow",value:function(e){var t=this.hot.getColHeader(0);if(null!=t){var r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tHead.appendChild(this.createColumnHeadersRow()),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}},{key:"addColumn",value:function(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var r={col:e};this.columns.push(r),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(e)&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}},{key:"getHeights",value:function(e){this.injected||this.injectTable(),arrayEach(this.rows,(function(t){e(t.row,outerHeight(t.table)-1)}))}},{key:"getWidths",value:function(e){this.injected||this.injectTable(),arrayEach(this.columns,(function(t){e(t.col,outerWidth(t.table))}))}},{key:"setSettings",value:function(e){this.settings=e}},{key:"setSetting",value:function(e,t){this.settings||(this.settings={}),this.settings[e]=t}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(e){return this.settings?this.settings[e]:null}},{key:"createColGroupsCol",value:function(){var e=this,t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1)),this.samples.forEach((function(r){arrayEach(r.strings,(function(r){t.appendChild(e.createColElement(r.col))}))})),t}},{key:"createRow",value:function(e){var t=this,r=this.hot.rootDocument,n=r.createDocumentFragment(),o=r.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,o),n.appendChild(o)),this.samples.forEach((function(o){arrayEach(o.strings,(function(o){var i=o.col,a=t.hot.getCellMeta(e,i);a.col=i,a.row=e;var s=t.hot.getCellRenderer(a),l=r.createElement("td");l.setAttribute("ghost-table",1),s(t.hot,l,e,i,t.hot.colToProp(i),o.value,a),n.appendChild(l)}))})),n}},{key:"createColumnHeadersRow",value:function(){var e=this,t=this.hot.rootDocument,r=t.createDocumentFragment();if(this.hot.hasRowHeaders()){var n=t.createElement("th");this.hot.view.appendColHeader(-1,n),r.appendChild(n)}return this.samples.forEach((function(n){arrayEach(n.strings,(function(n){var o=n.col,i=t.createElement("th");e.hot.view.appendColHeader(o,i),r.appendChild(i)}))})),r}},{key:"createCol",value:function(e){var t=this,r=this.hot.rootDocument,n=r.createDocumentFragment();return this.samples.forEach((function(o){arrayEach(o.strings,(function(o){var i=o.row,a=t.hot.getCellMeta(i,e);a.col=e,a.row=i;var s=t.hot.getCellRenderer(a),l=r.createElement("td"),u=r.createElement("tr");l.setAttribute("ghost-table",1),s(t.hot,l,i,e,t.hot.colToProp(e),o.value,a),u.appendChild(l),n.appendChild(u)}))})),n}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(e){var t=this.hot.rootDocument.createElement("col");return t.style.width="".concat(this.hot.view.wt.wtTable.getStretchedColumnWidth(e),"px"),t}},{key:"createTable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.hot.rootDocument,r=t.createDocumentFragment(),n=t.createElement("table"),o=t.createElement("thead"),i=t.createElement("tbody"),a=t.createElement("colgroup"),s=t.createElement("tr"),l=t.createElement("th");return this.isVertical()&&n.appendChild(a),this.isHorizontal()&&(s.appendChild(l),o.appendChild(s),n.style.tableLayout="auto",n.style.width="auto"),n.appendChild(o),this.isVertical()&&i.appendChild(s),n.appendChild(i),addClass(n,e),r.appendChild(n),{fragment:r,table:n,tHead:o,tBody:i,colGroup:a,tr:s,th:l}}},{key:"createContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.hot.rootDocument,r=t.createDocumentFragment(),n=t.createElement("div"),o="htGhostTable htAutoSize ".concat(e.trim());return addClass(n,o),r.appendChild(n),{fragment:r,container:n}}},{key:"isVertical",value:function(){return!(!this.rows.length||this.columns.length)}},{key:"isHorizontal",value:function(){return!(!this.columns.length||this.rows.length)}}]),e}();function _classCallCheck$1e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$18(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$18(e,t,r){return t&&_defineProperties$18(e.prototype,t),r&&_defineProperties$18(e,r),e}var privatePool$5=new WeakMap,initializedPlugins=null,BasePlugin=function(){function e(t){var r=this;_classCallCheck$1e(this,e),defineGetter(this,"hot",t,{writable:!1}),privatePool$5.set(this,{hooks:{}}),initializedPlugins=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",(function(){return r.onAfterPluginsInitialized()})),this.hot.addHook("afterUpdateSettings",(function(e){return r.onUpdateSettings(e)})),this.hot.addHook("beforeInit",(function(){return r.init()}))}return _createClass$18(e,[{key:"init",value:function(){this.pluginName=getPluginName(this.hot,this),this.isEnabled&&this.isEnabled()&&this.enablePlugin(),initializedPlugins||(initializedPlugins=getRegistredPluginNames(this.hot)),initializedPlugins.indexOf(this.pluginName)>=0&&initializedPlugins.splice(initializedPlugins.indexOf(this.pluginName),1),initializedPlugins.length||this.hot.runHooks("afterPluginsInitialized"),this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(e,t){privatePool$5.get(this).hooks[e]=privatePool$5.get(this).hooks[e]||[];var r=privatePool$5.get(this).hooks[e];this.hot.addHook(e,t),r.push(t),privatePool$5.get(this).hooks[e]=r}},{key:"removeHooks",value:function(e){var t=this;arrayEach(privatePool$5.get(this).hooks[e]||[],(function(r){t.hot.removeHook(e,r)}))}},{key:"clearHooks",value:function(){var e=this,t=privatePool$5.get(this).hooks;objectEach(t,(function(t,r){return e.removeHooks(r)})),t.length=0}},{key:"callOnPluginsReady",value:function(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}},{key:"onAfterPluginsInitialized",value:function(){arrayEach(this.pluginsInitializedCallbacks,(function(e){return e()})),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin())}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var e=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),objectEach(this,(function(t,r){"hot"!==r&&(e[r]=null)})),delete this.t,delete this.hot}}]),e}();function _classCallCheck$1f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$19(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$19(e,t,r){return t&&_defineProperties$19(e.prototype,t),r&&_defineProperties$19(e,r),e}var Storage=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;_classCallCheck$1f(this,e),this.rootWindow=r,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}return _createClass$19(e,[{key:"saveValue",value:function(e,t){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(e),JSON.stringify(t)),-1===this.savedKeys.indexOf(e)&&(this.savedKeys.push(e),this.saveSavedKeys())}},{key:"loadValue",value:function(e,t){var r=void 0===e?t:e,n=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(r));return null===n?void 0:JSON.parse(n)}},{key:"reset",value:function(e){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(e))}},{key:"resetAll",value:function(){var e=this;arrayEach(this.savedKeys,(function(t,r){e.rootWindow.localStorage.removeItem("".concat(e.prefix,"_").concat(e.savedKeys[r]))})),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var e=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),t="string"==typeof e?JSON.parse(e):void 0;this.savedKeys=t||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),e}();function _typeof$H(e){return(_typeof$H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$1g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1a(e,t,r){return t&&_defineProperties$1a(e.prototype,t),r&&_defineProperties$1a(e,r),e}function _get$a(e,t,r){return(_get$a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$a(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$a(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$x(e)););return e}function _inherits$x(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$y(e,t)}function _setPrototypeOf$y(e,t){return(_setPrototypeOf$y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$x(e){var t=_isNativeReflectConstruct$y();return function(){var r,n=_getPrototypeOf$x(e);if(t){var o=_getPrototypeOf$x(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$x(this,r)}}function _possibleConstructorReturn$x(e,t){return!t||"object"!==_typeof$H(t)&&"function"!=typeof t?_assertThisInitialized$x(e):t}function _assertThisInitialized$x(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$x(e){return(_getPrototypeOf$x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Hooks.getSingleton().register("persistentStateSave"),Hooks.getSingleton().register("persistentStateLoad"),Hooks.getSingleton().register("persistentStateReset");var PersistentState=function(e){_inherits$x(r,e);var t=_createSuper$x(r);function r(e){var n;return _classCallCheck$1g(this,r),(n=t.call(this,e)).storage=void 0,n}return _createClass$1a(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().persistentState}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.storage||(this.storage=new Storage(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(function(t,r){return e.saveValue(t,r)})),this.addHook("persistentStateLoad",(function(t,r){return e.loadValue(t,r)})),this.addHook("persistentStateReset",(function(){return e.resetValue()})),_get$a(_getPrototypeOf$x(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,_get$a(_getPrototypeOf$x(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$a(_getPrototypeOf$x(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(e,t){t.value=this.storage.loadValue(e)}},{key:"saveValue",value:function(e,t){this.storage.saveValue(e,t)}},{key:"resetValue",value:function(e){void 0===e?this.storage.resetAll():this.storage.reset(e)}},{key:"destroy",value:function(){_get$a(_getPrototypeOf$x(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);function _defineProperty$c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck$1h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1b(e,t,r){return t&&_defineProperties$1b(e.prototype,t),r&&_defineProperties$1b(e,r),e}registerPlugin("persistentState",PersistentState);var SamplesGenerator=function(){function e(t){_classCallCheck$1h(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return _createClass$1b(e,null,[{key:"SAMPLE_COUNT",get:function(){return 3}}]),_createClass$1b(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(e){this.customSampleCount=e}},{key:"setAllowDuplicates",value:function(e){this.allowDuplicates=e}},{key:"generateRowSamples",value:function(e,t){return this.generateSamples("row",t,e)}},{key:"generateColumnSamples",value:function(e,t){return this.generateSamples("col",t,e)}},{key:"generateSamples",value:function(e,t,r){var n=this,o=new Map,i="number"==typeof r?{from:r,to:r}:r;return rangeEach(i.from,i.to,(function(r){var i=n.generateSample(e,t,r);o.set(r,i)})),o}},{key:"generateSample",value:function(e,t,r){var n=this;if("row"!==e&&"col"!==e)throw new Error("Unsupported sample type");var o=new Map,i="row"===e?"col":"row",a=[];return rangeEach(t.from,t.to,(function(t){var s,l="row"===e?n.dataFactory(r,t):n.dataFactory(t,r),u=l.value,c=l.bundleCountSeed,f=c>0;s=isObject$1(u)?Object.keys(u).length:Array.isArray(u)?u.length:stringify(u).length,f&&(s+=c),o.has(s)||o.set(s,{needed:n.getSampleCount(),strings:[]});var h=o.get(s);h.needed&&((!(a.indexOf(u)>-1)||n.allowDuplicates||f)&&(h.strings.push(_defineProperty$c({value:u},i,t)),a.push(u),h.needed-=1))})),o}}]),e}();function _typeof$I(e){return(_typeof$I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _slicedToArray$a(e,t){return _arrayWithHoles$a(e)||_iterableToArrayLimit$a(e,t)||_unsupportedIterableToArray$i(e,t)||_nonIterableRest$a()}function _nonIterableRest$a(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$i(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$i(e,t):void 0}}function _arrayLikeToArray$i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$a(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$a(e){if(Array.isArray(e))return e}function _classCallCheck$1i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _get$b(e,t,r){return(_get$b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$b(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$b(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$y(e)););return e}function _defineProperties$1c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1c(e,t,r){return t&&_defineProperties$1c(e.prototype,t),r&&_defineProperties$1c(e,r),e}function _inherits$y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$z(e,t)}function _setPrototypeOf$z(e,t){return(_setPrototypeOf$z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$y(e){var t=_isNativeReflectConstruct$z();return function(){var r,n=_getPrototypeOf$y(e);if(t){var o=_getPrototypeOf$y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$y(this,r)}}function _possibleConstructorReturn$y(e,t){return!t||"object"!==_typeof$I(t)&&"function"!=typeof t?_assertThisInitialized$y(e):t}function _assertThisInitialized$y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$z(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$y(e){return(_getPrototypeOf$y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var privatePool$6=new WeakMap,COLUMN_SIZE_MAP_NAME="autoColumnSize",AutoColumnSize=function(e){_inherits$y(r,e);var t=_createSuper$y(r);function r(e){var n;return _classCallCheck$1i(this,r),n=t.call(this,e),privatePool$6.set(_assertThisInitialized$y(n),{cachedColumnHeaders:[]}),n.ghostTable=new GhostTable(n.hot),n.samplesGenerator=new SamplesGenerator((function(e,t){var r=n.hot.getCellMeta(e,t),o="";r.spanned||(o=n.hot.getDataAtCell(e,t));var i=0;if(r.label){var a=r.label,s=a.value,l=a.property,u="";if(s)u="function"==typeof s?s(e,t,n.hot.colToProp(t),o):s;else if(l){var c=n.hot.getDataAtRowProp(e,l);u=null!==c?c:""}i=u.length}return{value:o,bundleCountSeed:i}})),n.firstCalculation=!0,n.inProgress=!1,n.measuredColumns=0,n.columnWidthsMap=new PhysicalIndexToValueMap,n.hot.columnIndexMapper.registerMap(COLUMN_SIZE_MAP_NAME,n.columnWidthsMap),n.addHook("beforeColumnResize",(function(e,t,r){return n.onBeforeColumnResize(e,t,r)})),n}return _createClass$1c(r,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),_createClass$1c(r,[{key:"isEnabled",value:function(){return!1!==this.hot.getSettings().autoColumnSize&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().autoColumnSize;t&&null!==t.useHeaders&&void 0!==t.useHeaders&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return e.onAfterLoadData()})),this.addHook("beforeChange",(function(t){return e.onBeforeChange(t)})),this.addHook("beforeRender",(function(t){return e.onBeforeRender(t)})),this.addHook("modifyColWidth",(function(t,r){return e.getColumnWidth(r,t)})),this.addHook("afterInit",(function(){return e.onAfterInit()})),_get$b(_getPrototypeOf$y(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),_get$b(_getPrototypeOf$y(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var e=this;_get$b(_getPrototypeOf$y(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",(function(t,r,n){return e.onBeforeColumnResize(t,r,n)}))}},{key:"calculateVisibleColumnsWidth",value:function(){if(this.hot.countRows()){var e=this.hot.renderCall,t=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();-1!==t&&-1!==r&&this.calculateColumnsWidth({from:t,to:r},void 0,e)}}},{key:"calculateColumnsWidth",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="number"==typeof t?{from:t,to:t}:t,i="number"==typeof r?{from:r,to:r}:r;rangeEach(o.from,o.to,(function(t){var r=e.hot.toPhysicalColumn(t);(null===r&&(r=t),n||null===e.columnWidthsMap.getValueAtIndex(r)&&!e.hot._getColWidthFromSettings(r))&&arrayEach(e.samplesGenerator.generateColumnSamples(t,i),(function(t){var r=_slicedToArray$a(t,2),n=r[0],o=r[1];return e.ghostTable.addColumn(n,o)}))})),this.ghostTable.columns.length&&(this.hot.batch((function(){e.ghostTable.getWidths((function(t,r){var n=e.hot.toPhysicalColumn(t);e.columnWidthsMap.setValueAtIndex(n,r)}))})),this.measuredColumns=o.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},n=0,o=this.hot.countCols()-1,i=null;this.inProgress=!0;var a=function a(){if(!e.hot)return cancelAnimationFrame(i),void(e.inProgress=!1);e.calculateColumnsWidth({from:n,to:Math.min(n+r.CALCULATION_STEP,o)},t),(n=n+r.CALCULATION_STEP+1)<o?i=requestAnimationFrame(a):(cancelAnimationFrame(i),e.inProgress=!1,e.hot.view.wt.wtOverlays.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},t),this.firstCalculation=!1,n=s+1),n<o?a():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var e=this.hot.getSettings().autoColumnSize,t=e&&hasOwnProperty$1(e,"samplingRatio")?this.hot.getSettings().autoColumnSize.samplingRatio:void 0,r=e&&hasOwnProperty$1(e,"allowSampleDuplicates")?this.hot.getSettings().autoColumnSize.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view.wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var e=r.SYNC_CALCULATION_LIMIT,t=this.hot.countCols()-1;return isObject$1(this.hot.getSettings().autoColumnSize)&&(isPercentValue(e=this.hot.getSettings().autoColumnSize.syncLimit)?e=valueAccordingPercent(t,e):e>>=0),Math.min(e,t)}},{key:"getColumnWidth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=t;return void 0===n&&(n=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&"number"==typeof n&&(n=Math.max(n,ViewportColumnsCalculator.DEFAULT_WIDTH))),n}},{key:"getFirstVisibleColumn",value:function(){var e=this.hot.view.wt;if(e.wtViewport.columnsVisibleCalculator){var t=e.wtTable.getFirstVisibleColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){var r=e.wtTable.getFirstRenderedColumn();if(-1!==r)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)}return-1}},{key:"getLastVisibleColumn",value:function(){var e=this.hot.view.wt;if(e.wtViewport.columnsVisibleCalculator){var t=e.wtTable.getLastVisibleColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){var r=e.wtTable.getLastRenderedColumn();if(-1!==r)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var e=this.hot.getColHeader(),t=privatePool$6.get(this).cachedColumnHeaders;return arrayReduce(e,(function(e,r,n){var o=t.length;return(o-1<n||t[n]!==r)&&e.push(n),o-1<n?t.push(r):t[n]=r,e}),[])}},{key:"clearCache",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length?this.hot.batch((function(){arrayEach(t,(function(t){e.columnWidthsMap.setValueAtIndex(t,null)}))})):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!arrayFilter(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),(function(e){return null===e})).length}},{key:"onBeforeRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var e=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout((function(){e.hot&&e.recalculateAllColumnsWidth()}),0)}},{key:"onBeforeChange",value:function(e){var t=this,r=arrayMap(e,(function(e){var r=_slicedToArray$a(e,2)[1];return t.hot.toPhysicalColumn(t.hot.propToCol(r))}));this.clearCache(Array.from(new Set(r)))}},{key:"onBeforeColumnResize",value:function(e,t,r){var n=e;return r&&(this.calculateColumnsWidth(t,void 0,!0),n=this.getColumnWidth(t,void 0,!1)),n}},{key:"onAfterInit",value:function(){privatePool$6.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(COLUMN_SIZE_MAP_NAME),this.ghostTable.clean(),_get$b(_getPrototypeOf$y(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);registerPlugin("autoColumnSize",AutoColumnSize);var DIRECTIONS={horizontal:"horizontal",vertical:"vertical"};function getDeltas(e,t,r,n){var o=r.length,i=r?r[0].length:0,a=[],s=t.row-e.row,l=t.col-e.col;if(-1!==["down","up"].indexOf(n)){for(var u=[],c=0;c<l;c++){var f=parseInt(r[0][c],10),h=parseInt(r[o-1][c],10),d=("down"===n?h-f:f-h)/(o-1)||0;u.push(d)}a.push(u)}if(-1!==["right","left"].indexOf(n))for(var p=0;p<s;p++){var y=parseInt(r[p][0],10),g=parseInt(r[p][i-1],10),m=("right"===n?g-y:y-g)/(i-1)||0;a.push([m])}return a}function getDragDirectionAndRange(e,t){var r,n,o;return t[0]===e[0]&&t[1]<e[1]?(o="left",r=new CellCoords(t[0],t[1]),n=new CellCoords(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(o="right",r=new CellCoords(t[0],e[3]+1),n=new CellCoords(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(o="up",r=new CellCoords(t[0],t[1]),n=new CellCoords(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(o="down",r=new CellCoords(e[2]+1,t[1]),n=new CellCoords(t[2],t[3])),r&&r.normalize(),n&&n.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:n}}function getMappedFillHandleSetting(e){var t={};return!0===e?(t.directions=Object.keys(DIRECTIONS),t.autoInsertRow=!0):isObject$1(e)?(isDefined(e.autoInsertRow)?e.direction===DIRECTIONS.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,isDefined(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(DIRECTIONS)):"string"==typeof e?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}function _typeof$J(e){return(_typeof$J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray$b(e){return _arrayWithoutHoles$b(e)||_iterableToArray$b(e)||_unsupportedIterableToArray$j(e)||_nonIterableSpread$b()}function _nonIterableSpread$b(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray$b(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$b(e){if(Array.isArray(e))return _arrayLikeToArray$j(e)}function _slicedToArray$b(e,t){return _arrayWithHoles$b(e)||_iterableToArrayLimit$b(e,t)||_unsupportedIterableToArray$j(e,t)||_nonIterableRest$b()}function _nonIterableRest$b(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$j(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$j(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$j(e,t):void 0}}function _arrayLikeToArray$j(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$b(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$b(e){if(Array.isArray(e))return e}function _classCallCheck$1j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1d(e,t,r){return t&&_defineProperties$1d(e.prototype,t),r&&_defineProperties$1d(e,r),e}function _get$c(e,t,r){return(_get$c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$c(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$c(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$z(e)););return e}function _inherits$z(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$A(e,t)}function _setPrototypeOf$A(e,t){return(_setPrototypeOf$A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$z(e){var t=_isNativeReflectConstruct$A();return function(){var r,n=_getPrototypeOf$z(e);if(t){var o=_getPrototypeOf$z(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$z(this,r)}}function _possibleConstructorReturn$z(e,t){return!t||"object"!==_typeof$J(t)&&"function"!=typeof t?_assertThisInitialized$z(e):t}function _assertThisInitialized$z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$A(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$z(e){return(_getPrototypeOf$z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Hooks.getSingleton().register("modifyAutofillRange"),Hooks.getSingleton().register("beforeAutofill"),Hooks.getSingleton().register("afterAutofill");var INSERT_ROW_ALTER_ACTION_NAME="insert_row",INTERVAL_FOR_ADDING_ROW=200,Autofill=function(e){_inherits$z(r,e);var t=_createSuper$z(r);function r(e){var n;return _classCallCheck$1j(this,r),(n=t.call(this,e)).eventManager=new EventManager(_assertThisInitialized$z(n)),n.addingStarted=!1,n.mouseDownOnCellCorner=!1,n.mouseDragOutside=!1,n.handleDraggedCells=0,n.directions=[],n.autoInsertRow=!1,n}return _createClass$1d(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(function(t){return e.onAfterCellCornerMouseDown(t)})),this.addHook("afterOnCellCornerDblClick",(function(t){return e.onCellCornerDblClick(t)})),this.addHook("beforeOnCellMouseOver",(function(t,r){return e.onBeforeCellMouseOver(r)})),_get$c(_getPrototypeOf$z(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$c(_getPrototypeOf$z(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),_get$c(_getPrototypeOf$z(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var e=this,t=this.hot.getSelectedRangeLast(),r=t.getTopLeftCorner(),n=r.row,o=r.col,i=t.getBottomRightCorner(),a=i.row,s=i.col,l=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:o,endRow:a,endCol:s}]),u=[],c=[],f=[];return arrayEach(l,(function(e){for(var t=e.startRow;t<=e.endRow;t+=1)-1===u.indexOf(t)&&u.push(t);for(var r=e.startCol;r<=e.endCol;r+=1)-1===c.indexOf(r)&&c.push(r)})),arrayEach(u,(function(t){var r=[];arrayEach(c,(function(n){r.push(e.hot.getCopyableData(t,n))})),f.push(r)})),f}},{key:"fillIn",value:function(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;var e=_slicedToArray$b(this.hot.selection.highlight.getFill().getVisualCorners(),4),t=e[0],r=e[1],n=e[2],o=e[3],i=this.hot.getSelectedRangeLast(),a=i.getTopLeftCorner(),s=i.getBottomRightCorner(),l=[Math.min(a.row,t),Math.min(a.col,r),Math.max(s.row,n),Math.max(s.col,o)];this.resetSelectionOfDraggedArea();var u=[a.row,a.col,s.row,s.col],c=getDragDirectionAndRange(u,l=this.hot.runHooks("modifyAutofillRange",l,u)),f=c.directionOfDrag,h=c.startOfDragCoords,d=c.endOfDragCoords;if(h&&h.row>-1&&h.col>-1){var p=this.getSelectionData();if(!1===this.hot.runHooks("beforeAutofill",h,d,p))return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var y=getDeltas(h,d,p,f),g=p;if(["up","left"].indexOf(f)>-1){g=[];var m=null,v=null;if("up"===f){v=(m=d.row-h.row+1)%p.length;for(var _=0;_<m;_++)g.push(p[(_+(p.length-v))%p.length])}else{v=(m=d.col-h.col+1)%p[0].length;for(var b=0;b<p.length;b++){g.push([]);for(var C=0;C<m;C++)g[b].push(p[b][(C+(p[b].length-v))%p[b].length])}}}this.hot.populateFromArray(h.row,h.col,g,d.row,d.col,"".concat(this.pluginName,".fill"),null,f,y),this.setSelection(l),this.hot.runHooks("afterAutofill",h,d,p)}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}},{key:"getCoordsOfDragAndDropBorders",value:function(e){var t=this.hot.getSelectedRangeLast(),r=t.getBottomRightCorner(),n=e;if(this.directions.includes(DIRECTIONS.vertical)&&this.directions.includes(DIRECTIONS.horizontal)){var o=t.getTopLeftCorner();(r.col<=e.col||o.col>=e.col)&&(n=new CellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(n=new CellCoords(e.row,r.col))}else if(this.directions.includes(DIRECTIONS.vertical))n=new CellCoords(e.row,r.col);else{if(!this.directions.includes(DIRECTIONS.horizontal))return;n=new CellCoords(r.row,e.col)}return this.reduceSelectionAreaIfNeeded(n)}},{key:"showBorder",value:function(e){var t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}},{key:"addRow",value:function(){var e=this;this.hot._registerTimeout((function(){e.hot.alter(INSERT_ROW_ALTER_ACTION_NAME,void 0,1,"".concat(e.pluginName,".fill")),e.addingStarted=!1}),INTERVAL_FOR_ADDING_ROW)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){var e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&t[2]===r-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(e){for(var t,r=this.hot.getData(),n=this.hot.countRows(),o=e[2]+1;o<n;o++){for(var i=e[1];i<=e[3];i++){if(r[o][i])return-1}var a=r[o][e[1]-1],s=r[o][e[3]+1];(a||s)&&(t=o)}return t}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(e,t){this.hot.selection.highlight.getFill().clear().add(new CellCoords(e[0],e[1])).add(new CellCoords(t,e[3])).commit()}},{key:"setSelection",value:function(e){var t;(t=this.hot).selectCell.apply(t,_toConsumableArray$b(arrayMap(e,(function(e){return Math.max(e,0)}))).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return-1!==t&&void 0!==t&&(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(e){var t=this.hot.rootDocument.documentElement,r=offset(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+outerHeight(this.hot.table),n=offset(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+outerWidth(this.hot.table);return e.clientY>r&&e.clientX<=n}},{key:"registerEvents",value:function(){var e=this,t=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()})),this.eventManager.addEventListener(t,"mousemove",(function(t){return e.onMouseMove(t)}))}},{key:"onCellCornerDblClick",value:function(){this.selectAdjacent()&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(e){var t=this.getIfMouseWasDraggedOutside(e);!1===this.addingStarted&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var e=getMappedFillHandleSetting(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}},{key:"destroy",value:function(){_get$c(_getPrototypeOf$z(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);function _typeof$K(e){return(_typeof$K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$1k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1e(e,t,r){return t&&_defineProperties$1e(e.prototype,t),r&&_defineProperties$1e(e,r),e}function _get$d(e,t,r){return(_get$d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$d(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$d(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$A(e)););return e}function _inherits$A(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$B(e,t)}function _setPrototypeOf$B(e,t){return(_setPrototypeOf$B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$A(e){var t=_isNativeReflectConstruct$B();return function(){var r,n=_getPrototypeOf$A(e);if(t){var o=_getPrototypeOf$A(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$A(this,r)}}function _possibleConstructorReturn$A(e,t){return!t||"object"!==_typeof$K(t)&&"function"!=typeof t?_assertThisInitialized$A(e):t}function _assertThisInitialized$A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$B(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$A(e){return(_getPrototypeOf$A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}registerPlugin("autofill",Autofill);var PERSISTENT_STATE_KEY="manualRowHeights",privatePool$7=new WeakMap,ManualRowResize=function(e){_inherits$A(r,e);var t=_createSuper$A(r);function r(e){var n;_classCallCheck$1k(this,r);var o=(n=t.call(this,e)).hot.rootDocument;return n.currentTH=null,n.currentRow=null,n.selectedRows=[],n.currentHeight=null,n.newSize=null,n.startY=null,n.startHeight=null,n.startOffset=null,n.handle=o.createElement("DIV"),n.guide=o.createElement("DIV"),n.eventManager=new EventManager(_assertThisInitialized$A(n)),n.pressed=null,n.dblclick=0,n.autoresizeTimeout=null,n.rowHeightsMap=void 0,privatePool$7.set(_assertThisInitialized$A(n),{config:void 0}),addClass(n.handle,"manualRowResizer"),addClass(n.guide,"manualRowResizerGuide"),n}return _createClass$1e(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().manualRowResize}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.rowHeightsMap=new PhysicalIndexToValueMap,this.rowHeightsMap.addLocalHook("init",(function(){return e.onMapInit()})),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",(function(t,r){return e.onModifyRowHeight(t,r)})),this.bindEvents(),_get$d(_getPrototypeOf$A(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$d(_getPrototypeOf$A(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){privatePool$7.get(this).config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),_get$d(_getPrototypeOf$A(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",PERSISTENT_STATE_KEY,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var e={};return this.hot.runHooks("persistentStateLoad",PERSISTENT_STATE_KEY,e),e.value}},{key:"setManualSize",value:function(e,t){var r=this.hot.toPhysicalRow(e),n=Math.max(t,ViewportRowsCalculator.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(r,n),n}},{key:"setupHandlePosition",value:function(e){var t=this;this.currentTH=e;var r=this.hot.view,n=r.wt,o=r.wt.wtTable.getCoords(this.currentTH),i=o.row;if(!(i<0)){var a,s=outerWidth(this.currentTH),l=this.currentTH.getBoundingClientRect(),u=i<n.getSetting("fixedRowsTop"),c=i>=r.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");u?a=n.wtOverlays.topLeftCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col):c&&(a=n.wtOverlays.bottomLeftCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),a||(a=n.wtOverlays.leftOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.selectedRows=[];var f=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&f)arrayEach(this.hot.getSelectedRange(),(function(e){rangeEach(e.getTopLeftCorner().row,e.getBottomLeftCorner().row,(function(e){t.selectedRows.includes(e)||t.selectedRows.push(e)}))}));this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=a.top-6,this.startHeight=parseInt(l.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style.left="".concat(a.left,"px"),this.handle.style.width="".concat(s,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var e=parseInt(outerWidth(this.handle),10),t=parseInt(this.handle.style.left,10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);addClass(this.handle,"active"),addClass(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style.left="".concat(t,"px"),this.guide.style.width="".concat(r-e,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){removeClass(this.handle,"active"),removeClass(this.guide,"active")}},{key:"checkIfRowHeader",value:function(e){if(e!==this.hot.rootElement){var t=e.parentNode;return"TBODY"===t.tagName||this.checkIfRowHeader(t)}return!1}},{key:"getTHFromTargetElement",value:function(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getTHFromTargetElement(e.parentNode):null}},{key:"getActualRowHeight",value:function(e){var t=this.hot.view.wt.wtTable.getRowHeight(e);return void 0!==t&&this.newSize<t?t:this.newSize}},{key:"onMouseOver",value:function(e){if(this.checkIfRowHeader(e.target)){var t=this.getTHFromTargetElement(e.target);t&&(this.pressed||this.setupHandlePosition(t))}}},{key:"afterMouseDownTimeout",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.wt.wtOverlays.adjustElementsSize(!0)},r=function(r,n){var o=e.hot.runHooks("beforeRowResize",e.getActualRowHeight(r),r,!0);void 0!==o&&(e.newSize=o),e.setManualSize(r,e.newSize),e.hot.runHooks("afterRowResize",e.getActualRowHeight(r),r,!0),n&&t()};this.dblclick>=2&&(this.selectedRows.length>1?(arrayEach(this.selectedRows,(function(e){r(e)})),t()):arrayEach(this.selectedRows,(function(e){r(e,!0)})));this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(e){var t=this;hasClass(e.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((function(){return t.afterMouseDownTimeout()}),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=e.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(e){var t=this;this.pressed&&(this.currentHeight=this.startHeight+(e.pageY-this.startY),arrayEach(this.selectedRows,(function(e){t.newSize=t.setManualSize(e,t.currentHeight)})),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.wt.wtOverlays.adjustElementsSize(!0)},r=function(r,n){e.hot.runHooks("beforeRowResize",e.getActualRowHeight(r),r,!1),n&&t(),e.saveManualRowHeights(),e.hot.runHooks("afterRowResize",e.getActualRowHeight(r),r,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight)this.selectedRows.length>1?(arrayEach(this.selectedRows,(function(e){r(e)})),t()):arrayEach(this.selectedRows,(function(e){r(e,!0)}));this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var e=this,t=this.hot,r=t.rootElement,n=t.rootWindow;this.eventManager.addEventListener(r,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(r,"mousedown",(function(t){return e.onMouseDown(t)})),this.eventManager.addEventListener(n,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(n,"mouseup",(function(){return e.onMouseUp()}))}},{key:"onModifyRowHeight",value:function(e,t){var r=e;if(this.enabled){var n=this.hot.toPhysicalRow(t),o=this.rowHeightsMap.getValueAtIndex(n);this.hot.getSettings().manualRowResize&&o&&(r=o)}return r}},{key:"onMapInit",value:function(){var e=this,t=privatePool$7.get(this),r=this.hot.getSettings().manualRowResize,n=this.loadManualRowHeights();this.hot.batch((function(){void 0!==n?n.forEach((function(t,r){e.rowHeightsMap.setValueAtIndex(r,t)})):Array.isArray(r)?(r.forEach((function(t,r){e.rowHeightsMap.setValueAtIndex(r,t)})),t.config=r):!0===r&&Array.isArray(t.config)&&t.config.forEach((function(t,r){e.rowHeightsMap.setValueAtIndex(r,t)}))}))}},{key:"destroy",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),_get$d(_getPrototypeOf$A(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);function _typeof$L(e){return(_typeof$L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _slicedToArray$c(e,t){return _arrayWithHoles$c(e)||_iterableToArrayLimit$c(e,t)||_unsupportedIterableToArray$k(e,t)||_nonIterableRest$c()}function _nonIterableRest$c(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$k(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$k(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$k(e,t):void 0}}function _arrayLikeToArray$k(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$c(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$c(e){if(Array.isArray(e))return e}function _classCallCheck$1l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _get$e(e,t,r){return(_get$e="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$e(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$B(e)););return e}function _defineProperties$1f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1f(e,t,r){return t&&_defineProperties$1f(e.prototype,t),r&&_defineProperties$1f(e,r),e}function _inherits$B(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$C(e,t)}function _setPrototypeOf$C(e,t){return(_setPrototypeOf$C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$B(e){var t=_isNativeReflectConstruct$C();return function(){var r,n=_getPrototypeOf$B(e);if(t){var o=_getPrototypeOf$B(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$B(this,r)}}function _possibleConstructorReturn$B(e,t){return!t||"object"!==_typeof$L(t)&&"function"!=typeof t?_assertThisInitialized$B(e):t}function _assertThisInitialized$B(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$C(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$B(e){return(_getPrototypeOf$B=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}registerPlugin("manualRowResize",ManualRowResize);var ROW_WIDTHS_MAP_NAME="autoRowSize",AutoRowSize=function(e){_inherits$B(r,e);var t=_createSuper$B(r);function r(e){var n;return _classCallCheck$1l(this,r),(n=t.call(this,e)).rowHeightsMap=void 0,n.headerHeight=null,n.ghostTable=new GhostTable(n.hot),n.samplesGenerator=new SamplesGenerator((function(e,t){var r;return e>=0?r=n.hot.getDataAtCell(e,t):-1===e&&(r=n.hot.getColHeader(t)),{value:r}})),n.firstCalculation=!0,n.inProgress=!1,n.measuredRows=0,n.rowHeightsMap=new PhysicalIndexToValueMap,n.hot.rowIndexMapper.registerMap(ROW_WIDTHS_MAP_NAME,n.rowHeightsMap),n.addHook("beforeRowResize",(function(e,t,r){return n.onBeforeRowResize(e,t,r)})),n}return _createClass$1f(r,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),_createClass$1f(r,[{key:"isEnabled",value:function(){return!0===this.hot.getSettings().autoRowSize||isObject$1(this.hot.getSettings().autoRowSize)}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return e.onAfterLoadData()})),this.addHook("beforeChange",(function(t){return e.onBeforeChange(t)})),this.addHook("beforeColumnResize",(function(){return e.recalculateAllRowsHeight()})),this.addHook("beforeRender",(function(t){return e.onBeforeRender(t)})),this.addHook("modifyRowHeight",(function(t,r){return e.getRowHeight(r,t)})),this.addHook("modifyColumnHeaderHeight",(function(){return e.getColumnHeaderHeight()})),_get$e(_getPrototypeOf$B(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var e=this;this.headerHeight=null,_get$e(_getPrototypeOf$B(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",(function(t,r,n){return e.onBeforeRowResize(t,r,n)}))}},{key:"calculateRowsHeight",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="number"==typeof t?{from:t,to:t}:t,i="number"==typeof r?{from:r,to:r}:r;if(null!==this.hot.getColHeader(0)){var a=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(a.get(-1))}rangeEach(o.from,o.to,(function(t){(n||null===e.rowHeightsMap.getValueAtIndex(t))&&arrayEach(e.samplesGenerator.generateRowSamples(t,i),(function(t){var r=_slicedToArray$c(t,2),n=r[0],o=r[1];return e.ghostTable.addRow(n,o)}))})),this.ghostTable.rows.length&&(this.hot.batch((function(){e.ghostTable.getHeights((function(t,r){t<0?e.headerHeight=r:e.rowHeightsMap.setValueAtIndex(e.hot.toPhysicalRow(t),r)}))})),this.measuredRows=o.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},n=0,o=this.hot.countRows()-1,i=null;this.inProgress=!0;var a=function a(){if(!e.hot)return cancelAnimationFrame(i),void(e.inProgress=!1);e.calculateRowsHeight({from:n,to:Math.min(n+r.CALCULATION_STEP,o)},t),(n=n+r.CALCULATION_STEP+1)<o?i=requestAnimationFrame(a):(cancelAnimationFrame(i),e.inProgress=!1,e.hot.view.wt.wtOverlays.adjustElementsSize(!0),e.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&e.hot.view.wt.wtOverlays.leftOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},t),this.firstCalculation=!1,n=s+1),n<o?a():(this.inProgress=!1,this.hot.view.wt.wtOverlays.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var e=this.hot.getSettings().autoRowSize,t=e&&hasOwnProperty$1(e,"samplingRatio")?this.hot.getSettings().autoRowSize.samplingRatio:void 0,r=e&&hasOwnProperty$1(e,"allowSampleDuplicates")?this.hot.getSettings().autoRowSize.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}},{key:"recalculateAllRowsHeight",value:function(){isVisible(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var e=r.SYNC_CALCULATION_LIMIT,t=this.hot.countRows()-1;return isObject$1(this.hot.getSettings().autoRowSize)&&(isPercentValue(e=this.hot.getSettings().autoRowSize.syncLimit)?e=valueAccordingPercent(t,e):e>>=0),Math.min(e,t)}},{key:"getRowHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e)),n=t;return null!==r&&r>(t||0)&&(n=r),n}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var e=this.hot.view.wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var e=this.hot.view.wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(e){var t=this,r="number"==typeof e?{from:e,to:e}:e,n=r.from,o=r.to;this.hot.batch((function(){rangeEach(Math.min(n,o),Math.max(n,o),(function(e){t.rowHeightsMap.setValueAtIndex(e,null)}))}))}},{key:"isNeedRecalculate",value:function(){return!!arrayFilter(this.rowHeightsMap.getValues().slice(0,this.measuredRows),(function(e){return null===e})).length}},{key:"onBeforeRender",value:function(){var e=this.hot.renderCall,t=this.hot.getSettings().fixedRowsBottom,r=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(-1!==r&&-1!==n){if(this.calculateRowsHeight({from:r,to:n},void 0,e),t){var o=this.hot.countRows()-1;this.calculateRowsHeight({from:o-t,to:o})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(e,t){this.clearCacheByRange({from:e,to:t}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(e,t,r){var n=e;return r&&(this.calculateRowsHeight(t,void 0,!0),n=this.getRowHeight(t)),n}},{key:"onAfterLoadData",value:function(){var e=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout((function(){e.hot&&e.recalculateAllRowsHeight()}),0)}},{key:"onBeforeChange",value:function(e){var t=null;1===e.length?t=e[0][0]:e.length>1&&(t={from:e[0][0],to:e[e.length-1][0]}),null!==t&&this.clearCacheByRange(t)}},{key:"destroy",value:function(){this.hot.rowIndexMapper.unregisterMap(ROW_WIDTHS_MAP_NAME),this.ghostTable.clean(),_get$e(_getPrototypeOf$B(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);registerPlugin("autoRowSize",AutoRowSize);var $every=arrayIteration.every,STRICT_METHOD$7=arrayMethodIsStrict("every"),USES_TO_LENGTH$c=arrayMethodUsesToLength("every");function _classCallCheck$1m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1g(e,t,r){return t&&_defineProperties$1g(e.prototype,t),r&&_defineProperties$1g(e,r),e}_export({target:"Array",proto:!0,forced:!STRICT_METHOD$7||!USES_TO_LENGTH$c},{every:function(e){return $every(this,e,arguments.length>1?arguments[1]:void 0)}});var inheritedColumnProperties=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],SORT_EMPTY_CELLS_DEFAULT=!1,SHOW_SORT_INDICATOR_DEFAULT=!0,HEADER_ACTION_DEFAULT=!0,ColumnStatesManager=function(){function e(){_classCallCheck$1m(this,e),this.sortedColumnsStates=[],this.sortEmptyCells=SORT_EMPTY_CELLS_DEFAULT,this.indicator=SHOW_SORT_INDICATOR_DEFAULT,this.headerAction=HEADER_ACTION_DEFAULT,this.compareFunctionFactory=void 0}return _createClass$1g(e,[{key:"updateAllColumnsProperties",value:function(e){var t=this;isObject$1(e)&&objectEach(e,(function(e,r){inheritedColumnProperties.includes(r)&&(t[r]=e)}))}},{key:"getAllColumnsProperties",value:function(){var e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(e.compareFunctionFactory=this.compareFunctionFactory),e}},{key:"getFirstSortedColumn",value:function(){var e;return this.getNumberOfSortedColumns()>0&&(e=this.sortedColumnsStates[0].column),e}},{key:"getSortOrderOfColumn",value:function(e){var t,r=this.sortedColumnsStates.find((function(t){var r=t.column;return e===r}));return isObject$1(r)&&(t=r.sortOrder),t}},{key:"getSortedColumns",value:function(){return arrayMap(this.sortedColumnsStates,(function(e){return e.column}))}},{key:"getIndexOfColumnInSortQueue",value:function(e){return this.getSortedColumns().indexOf(e)}},{key:"getNumberOfSortedColumns",value:function(){return this.sortedColumnsStates.length}},{key:"isListOfSortedColumnsEmpty",value:function(){return 0===this.getNumberOfSortedColumns()}},{key:"isColumnSorted",value:function(e){return this.getSortedColumns().includes(e)}},{key:"getSortStates",value:function(){return deepClone(this.sortedColumnsStates)}},{key:"getColumnSortState",value:function(e){if(this.isColumnSorted(e))return deepClone(this.sortedColumnsStates[this.getIndexOfColumnInSortQueue(e)])}},{key:"setSortStates",value:function(e){this.sortedColumnsStates=e}},{key:"destroy",value:function(){this.sortedColumnsStates.length=0,this.sortedColumnsStates=null}}]),e}(),ASC_SORT_STATE="asc",DESC_SORT_STATE="desc",HEADER_SPAN_CLASS="colHeader";function isValidColumnState(e){if(isUndefined(e))return!1;var t=e.column,r=e.sortOrder;return Number.isInteger(t)&&[ASC_SORT_STATE,DESC_SORT_STATE].includes(r)}function areValidSortStates(e){if(!1===Array.isArray(e)||!1===e.every((function(e){return isObject$1(e)})))return!1;var t=e.map((function(e){return e.column}));return new Set(t).size===t.length&&e.every(isValidColumnState)}function getNextSortOrder(e){if(e!==DESC_SORT_STATE)return e===ASC_SORT_STATE?DESC_SORT_STATE:ASC_SORT_STATE}function getHeaderSpanElement(e){return e.querySelector(".".concat(HEADER_SPAN_CLASS))}function isFirstLevelColumnHeader(e,t){if(e<0||!t.parentNode)return!1;var r=t.parentNode.parentNode.childNodes;return-1===Array.from(r).indexOf(t.parentNode)-r.length}function wasHeaderClickedProperly(e,t,r){return-1===e&&t>=0&&!1===isRightClick(r)}var HEADER_CLASS_ASC_SORT="ascending",HEADER_CLASS_DESC_SORT="descending",HEADER_CLASS_INDICATOR_DISABLED="indicatorDisabled",HEADER_SORT_CLASS="columnSorting",HEADER_ACTION_CLASS="sortAction",orderToCssClass=new Map([[ASC_SORT_STATE,HEADER_CLASS_ASC_SORT],[DESC_SORT_STATE,HEADER_CLASS_DESC_SORT]]);function getClassesToAdd(e,t,r,n){var o=[HEADER_SORT_CLASS];if(n&&o.push(HEADER_ACTION_CLASS),!1===r)o.push(HEADER_CLASS_INDICATOR_DISABLED);else if(e.isColumnSorted(t)){var i=e.getSortOrderOfColumn(t);o.push(orderToCssClass.get(i))}return o}function getClassedToRemove(){return Array.from(orderToCssClass.values()).concat(HEADER_ACTION_CLASS,HEADER_CLASS_INDICATOR_DISABLED,HEADER_SORT_CLASS)}function compareFunctionFactory(e,t,r){return function(t,n){var o=r.sortEmptyCells;return"string"==typeof t&&(t=t.toLowerCase()),"string"==typeof n&&(n=n.toLowerCase()),t===n?DO_NOT_SWAP:isEmpty(t)?isEmpty(n)?DO_NOT_SWAP:o&&"asc"===e?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:isEmpty(n)?o&&"asc"===e?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:isNaN(t)&&!isNaN(n)?"asc"===e?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:!isNaN(t)&&isNaN(n)?"asc"===e?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:(isNaN(t)||isNaN(n)||(t=parseFloat(t),n=parseFloat(n)),t<n?"asc"===e?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:t>n?"asc"===e?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP)}}var COLUMN_DATA_TYPE="default";function compareFunctionFactory$1(e,t,r){return function(t,n){var o=parseFloat(t),i=parseFloat(n),a=r.sortEmptyCells;if(o===i||isNaN(o)&&isNaN(i))return DO_NOT_SWAP;if(a){if(isEmpty(t))return"asc"===e?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND;if(isEmpty(n))return"asc"===e?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND}return isNaN(o)?FIRST_AFTER_SECOND:isNaN(i)?FIRST_BEFORE_SECOND:o<i?"asc"===e?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:o>i?"asc"===e?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}}var COLUMN_DATA_TYPE$1="numeric";function compareFunctionFactory$2(e,t,r){return function(n,o){var i=r.sortEmptyCells;if(n===o)return DO_NOT_SWAP;if(isEmpty(n))return isEmpty(o)?DO_NOT_SWAP:i&&"asc"===e?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND;if(isEmpty(o))return i&&"asc"===e?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND;var a=t.dateFormat,s=moment(n,a),l=moment(o,a);return s.isValid()?l.isValid()?l.isAfter(s)?"asc"===e?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:l.isBefore(s)?"asc"===e?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP:FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND}}var COLUMN_DATA_TYPE$2="date",_staticRegister$7=staticRegister("sorting.compareFunctionFactory"),registerCompareFunctionFactory=_staticRegister$7.register,getGloballyCompareFunctionFactory=_staticRegister$7.getItem,hasGloballyCompareFunctionFactory=_staticRegister$7.hasItem,_staticRegister2=staticRegister("sorting.mainSortComparator"),registerRootComparator=_staticRegister2.register,getRootComparator=_staticRegister2.getItem;function getCompareFunctionFactory(e){return hasGloballyCompareFunctionFactory(e)?getGloballyCompareFunctionFactory(e):getGloballyCompareFunctionFactory(COLUMN_DATA_TYPE)}function _defineProperties$1h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1h(e,t,r){return t&&_defineProperties$1h(e.prototype,t),r&&_defineProperties$1h(e,r),e}function _classCallCheck$1n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}registerCompareFunctionFactory(COLUMN_DATA_TYPE$1,compareFunctionFactory$1),registerCompareFunctionFactory(COLUMN_DATA_TYPE$2,compareFunctionFactory$2),registerCompareFunctionFactory(COLUMN_DATA_TYPE,compareFunctionFactory);var NodeStructure=function e(t){_classCallCheck$1n(this,e),this.data=t,this.next=null,this.prev=null},LinkedList=function(){function e(){_classCallCheck$1n(this,e),this.first=null,this.last=null}return _createClass$1h(e,[{key:"push",value:function(e){var t=new NodeStructure(e);if(null===this.first)this.first=t,this.last=t;else{var r=this.last;this.last=t,t.prev=r,r.next=t}}},{key:"unshift",value:function(e){var t=new NodeStructure(e);if(null===this.first)this.first=t,this.last=t;else{var r=this.first;this.first=t,t.next=r,r.prev=t}}},{key:"inorder",value:function(e){for(var t=this.first;t;)e(t),t=t.next}},{key:"remove",value:function(e){if(null===this.first)return!1;for(var t,r,n=this.first;n;){if(n.data===e)return t=n.next,r=n.prev,t&&(t.prev=r),r&&(r.next=t),n===this.first&&(this.first=t),n===this.last&&(this.last=r),!0;n=n.next}return!1}},{key:"hasCycle",value:function(){for(var e=this.first,t=this.first;;){if(null===e)return!1;if(null===(e=e.next))return!1;if((e=e.next)===(t=t.next))return!0}}},{key:"pop",value:function(){if(null===this.last)return null;var e=this.last;return this.last=this.last.prev,e}},{key:"shift",value:function(){if(null===this.first)return null;var e=this.first;return this.first=this.first.next,e}},{key:"recursiveReverse",value:function(){if(this.first){!function e(t,r){r&&(e(r,r.next),r.next=t)}(this.first,this.first.next),this.first.next=null;var e=this.first;this.first=this.last,this.last=e}}},{key:"reverse",value:function(){if(this.first&&this.first.next){for(var e,t=this.first.next,r=this.first;t;)e=t.next,t.next=r,r.prev=t,r=t,t=e;this.first.next=null,this.last.prev=null,e=this.first,this.first=r,this.last=e}}}]),e}(),defaultCompareFunction=function(e,t){var r=e.toString(),n=t.toString();return r===n?0:r<n?-1:1};function mergeSort(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:defaultCompareFunction,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(Math.abs(n-r)<=1)return[];var o=Math.ceil((r+n)/2);return mergeSort(e,t,r,o),mergeSort(e,t,o,n),merge(e,t,r,o,n)}function merge(e,t,r,n,o){for(var i=new LinkedList,a=new LinkedList,s=n-r,l=o-n,u=Math.max(s,l),c=o-r,f=0;f<u;f+=1)f<s&&i.push(e[r+f]),f<l&&a.push(e[n+f]);for(var h=0;h<c;)i.first&&a.first?t(i.first.data,a.first.data)>0?e[r+h]=a.shift().data:e[r+h]=i.shift().data:i.first?e[r+h]=i.shift().data:e[r+h]=a.shift().data,h+=1;return e}var DO_NOT_SWAP=0,FIRST_BEFORE_SECOND=-1,FIRST_AFTER_SECOND=1;function sort(e,t){for(var r=getRootComparator(t),n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];mergeSort(e,r.apply(void 0,o))}function _toArray(e){return _arrayWithHoles$d(e)||_iterableToArray$c(e)||_unsupportedIterableToArray$l(e)||_nonIterableRest$d()}function _nonIterableRest$d(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$l(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$l(e,t):void 0}}function _arrayLikeToArray$l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArray$c(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithHoles$d(e){if(Array.isArray(e))return e}function rootComparator(e,t){return function(r,n){var o,i,a,s,l,u,c=_toArray(r).slice(1),f=_toArray(n).slice(1);return i=e[o=0],a=t[o],s=c[o],l=f[o],((u=a.columnSorting).compareFunctionFactory?u.compareFunctionFactory:getCompareFunctionFactory(a.type))(i,a,u)(s,l)}}function _typeof$M(e){return(_typeof$M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray$c(e){return _arrayWithoutHoles$c(e)||_iterableToArray$d(e)||_unsupportedIterableToArray$m(e)||_nonIterableSpread$c()}function _nonIterableSpread$c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$m(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$m(e,t):void 0}}function _iterableToArray$d(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$c(e){if(Array.isArray(e))return _arrayLikeToArray$m(e)}function _arrayLikeToArray$m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ownKeys$9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$8(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$9(Object(r),!0).forEach((function(t){_defineProperty$d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$9(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectWithoutProperties$5(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose$5(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _objectWithoutPropertiesLoose$5(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}function _classCallCheck$1o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1i(e,t,r){return t&&_defineProperties$1i(e.prototype,t),r&&_defineProperties$1i(e,r),e}function _get$f(e,t,r){return(_get$f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$f(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$f(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$C(e)););return e}function _inherits$C(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$D(e,t)}function _setPrototypeOf$D(e,t){return(_setPrototypeOf$D=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$C(e){var t=_isNativeReflectConstruct$D();return function(){var r,n=_getPrototypeOf$C(e);if(t){var o=_getPrototypeOf$C(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$C(this,r)}}function _possibleConstructorReturn$C(e,t){return!t||"object"!==_typeof$M(t)&&"function"!=typeof t?_assertThisInitialized$C(e):t}function _assertThisInitialized$C(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$D(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$C(e){return(_getPrototypeOf$C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var APPEND_COLUMN_CONFIG_STRATEGY="append",REPLACE_COLUMN_CONFIG_STRATEGY="replace",PLUGIN_KEY="columnSorting";registerRootComparator(PLUGIN_KEY,rootComparator),Hooks.getSingleton().register("beforeColumnSort"),Hooks.getSingleton().register("afterColumnSort");var ColumnSorting=function(e){_inherits$C(r,e);var t=_createSuper$C(r);function r(e){var n;return _classCallCheck$1o(this,r),(n=t.call(this,e)).columnStatesManager=new ColumnStatesManager,n.columnMetaCache=null,n.pluginKey=PLUGIN_KEY,n.indexesSequenceCache=null,n}return _createClass$1i(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.columnMetaCache=new PhysicalIndexToValueMap((function(t){var r=e.hot.toVisualColumn(t);return null===r&&(r=t),e.getMergedPluginSettings(r)})),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",(function(t,r){return e.onAfterGetColHeader(t,r)})),this.addHook("beforeOnCellMouseDown",(function(t,r,n,o){return e.onBeforeOnCellMouseDown(t,r,n,o)})),this.addHook("afterOnCellMouseDown",(function(t,r){return e.onAfterOnCellMouseDown(t,r)})),this.addHook("afterInit",(function(){return e.loadOrSortBySettings()})),this.addHook("afterLoadData",(function(t,r){return e.onAfterLoadData(r)})),this.hot.view&&this.loadOrSortBySettings(),_get$f(_getPrototypeOf$C(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var e=this,t=function(t,r){var n=getHeaderSpanElement(r);!1!==isFirstLevelColumnHeader(t,r)&&null!==n&&e.updateHeaderClasses(n)};this.hot.addHook("afterGetColHeader",t),this.hot.addHookOnce("afterRender",(function(){e.hot.removeHook("afterGetColHeader",t)})),this.hot.batch((function(){null!==e.indexesSequenceCache&&(e.hot.rowIndexMapper.setIndexesSequence(e.indexesSequenceCache.getValues()),e.hot.rowIndexMapper.unregisterMap(e.pluginKey)),e.hot.columnIndexMapper.unregisterMap("".concat(e.pluginKey,".columnMeta"))})),_get$f(_getPrototypeOf$C(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(e){var t=this,r=this.getSortConfig(),n=this.getNormalizedSortConfigs(e),o=this.areValidSortConfigs(n);if(!1!==this.hot.runHooks("beforeColumnSort",r,n,o)){if(0===r.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new IndexesSequence),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),o){var i=arrayMap(n,(function(e){return n=(r=e).column,o=_objectWithoutProperties$5(r,["column"]),_objectSpread$8({column:t.hot.columnIndexMapper.getPhysicalFromVisualIndex(n)},o);var r,n,o}));this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(),this.saveAllSortSettings()}this.hot.runHooks("afterColumnSort",r,this.getSortConfig(),o),o&&(this.hot.render(),this.hot.view.wt.draw(!0))}}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(e){var t=this,r=function(e){var r=e.column,n=_objectWithoutProperties$5(e,["column"]);return _objectSpread$8({column:t.hot.toVisualColumn(r)},n)};if(isDefined(e)){var n=this.hot.toPhysicalColumn(e),o=this.columnStatesManager.getColumnSortState(n);return isDefined(o)?r(o):void 0}return arrayMap(this.columnStatesManager.getSortStates(),(function(e){return r(e)}))}},{key:"setSortConfig",value:function(e){var t=this,r=this.getNormalizedSortConfigs(e);if(this.areValidSortConfigs(r)){var n=arrayMap(r,(function(e){return n=(r=e).column,o=_objectWithoutProperties$5(r,["column"]),_objectSpread$8({column:t.hot.toPhysicalColumn(n)},o);var r,n,o}));this.columnStatesManager.setSortStates(n)}}},{key:"getNormalizedSortConfigs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e].slice(0,1)}},{key:"areValidSortConfigs",value:function(e){if(!1===Array.isArray(e))return!1;var t=e.map((function(e){return e.column})),r=this.hot.countCols(),n=t.every((function(e){return e<=r&&e>=0}));return areValidSortStates(e)&&n}},{key:"saveAllSortSettings",value:function(){var e=this.columnStatesManager.getAllColumnsProperties();e.initialConfig=this.columnStatesManager.getSortStates(),this.hot.runHooks("persistentStateSave","columnSorting",e)}},{key:"getAllSavedSortSettings",value:function(){var e=this,t={};this.hot.runHooks("persistentStateLoad","columnSorting",t);var r=t.value;return isDefined(r)&&Array.isArray(r.initialConfig)&&(r.initialConfig=arrayMap(r.initialConfig,(function(t){var r=t.column,n=_objectWithoutProperties$5(t,["column"]);return _objectSpread$8({column:e.hot.toVisualColumn(r)},n)}))),r}},{key:"getColumnNextConfig",value:function(e){var t=this.hot.toPhysicalColumn(e);if(this.columnStatesManager.isColumnSorted(t)){var r=this.getSortConfig(e),n=getNextSortOrder(r.sortOrder);return isDefined(n)?(r.sortOrder=n,r):void 0}var o=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<o)return{column:e,sortOrder:getNextSortOrder()}}},{key:"getNextSortConfig",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:APPEND_COLUMN_CONFIG_STRATEGY,r=this.hot.toPhysicalColumn(e),n=this.columnStatesManager.getIndexOfColumnInSortQueue(r),o=this.columnStatesManager.isColumnSorted(r),i=this.getSortConfig(),a=this.getColumnNextConfig(e);if(o){if(isUndefined(a))return[].concat(_toConsumableArray$c(i.slice(0,n)),_toConsumableArray$c(i.slice(n+1)));if(t===APPEND_COLUMN_CONFIG_STRATEGY)return[].concat(_toConsumableArray$c(i.slice(0,n)),_toConsumableArray$c(i.slice(n+1)),[a]);if(t===REPLACE_COLUMN_CONFIG_STRATEGY)return[].concat(_toConsumableArray$c(i.slice(0,n)),[a],_toConsumableArray$c(i.slice(n+1)))}return isDefined(a)?i.concat(a):i}},{key:"getPluginColumnConfig",value:function(e){if(isObject$1(e)){var t=e[this.pluginKey];if(isObject$1(t))return t}return{}}},{key:"getMergedPluginSettings",value:function(e){var t=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),n=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(n);return Array.isArray(o.columns)?Object.assign(r,t,this.getPluginColumnConfig(o.columns[e])):isFunction(o.columns)?Object.assign(r,t,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,t)}},{key:"getFirstCellSettings",value:function(e){var t=this.hot.getCellMeta(0,e),r=Object.create(t);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}},{key:"getNumberOfRowsToSort",value:function(e){var t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}},{key:"sortByPresetSortStates",value:function(){var e=this;if(this.columnStatesManager.isListOfSortedColumnsEmpty())this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());else{for(var t=[],r=this.columnStatesManager.getSortedColumns(),n=this.hot.countRows(),o=function(t){return arrayMap(r,(function(r){return e.hot.getDataAtCell(t,e.hot.toVisualColumn(r))}))},i=0;i<this.getNumberOfRowsToSort(n);i+=1)t.push([this.hot.toPhysicalRow(i)].concat(o(i)));var a=arrayMap(t,(function(e){return e[0]}));sort(t,this.pluginKey,arrayMap(r,(function(t){return e.columnStatesManager.getSortOrderOfColumn(t)})),arrayMap(r,(function(t){return e.getFirstCellSettings(e.hot.toVisualColumn(t))})));for(var s=t.length;s<n;s+=1)t.push([s].concat(o(s)));var l=arrayMap(t,(function(e){return e[0]})),u=new Map(arrayMap(a,(function(e,t){return[e,l[t]]}))),c=arrayMap(this.hot.rowIndexMapper.getIndexesSequence(),(function(e){return u.has(e)?u.get(e):e}));this.hot.rowIndexMapper.setIndexesSequence(c)}}},{key:"loadOrSortBySettings",value:function(){var e=this.getAllSavedSortSettings();if(isObject$1(e))this.sortBySettings(e);else{var t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}},{key:"sortBySettings",value:function(e){if(isObject$1(e)){this.columnStatesManager.updateAllColumnsProperties(e);var t=e.initialConfig;(Array.isArray(t)||isObject$1(t))&&this.sort(t)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(e,t){var r=getHeaderSpanElement(t);if(!1!==isFirstLevelColumnHeader(e,t)&&null!==r){var n=this.hot.columnIndexMapper.getPhysicalFromVisualIndex(e),o=this.getFirstCellSettings(e)[this.pluginKey],i=o.indicator,a=o.headerAction;this.updateHeaderClasses(r,this.columnStatesManager,n,i,a)}}},{key:"updateHeaderClasses",value:function(e){if(removeClass(e,getClassedToRemove()),!1!==this.enabled){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];addClass(e,getClassesToAdd.apply(void 0,r))}}},{key:"onUpdateSettings",value:function(e){_get$f(_getPrototypeOf$C(r.prototype),"onUpdateSettings",this).call(this),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),isDefined(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}},{key:"onAfterLoadData",value:function(e){!0===e&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&"SPAN"===e.target.nodeName}},{key:"onBeforeOnCellMouseDown",value:function(e,t,r,n){!1!==wasHeaderClickedProperly(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&isPressedCtrlKey()&&(n.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(e,t){!1!==wasHeaderClickedProperly(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(isPressedCtrlKey()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col)),this.sort(this.getColumnNextConfig(t.col)))}},{key:"destroy",value:function(){this.columnStatesManager.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),_get$f(_getPrototypeOf$C(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);function _classCallCheck$1p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1j(e,t,r){return t&&_defineProperties$1j(e.prototype,t),r&&_defineProperties$1j(e,r),e}registerPlugin(PLUGIN_KEY,ColumnSorting);var CommentEditor=function(){function e(t){_classCallCheck$1p(this,e),this.container=null,this.rootDocument=t,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return _createClass$1j(e,null,[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),_createClass$1j(e,[{key:"setPosition",value:function(e,t){this.editorStyle.left="".concat(e,"px"),this.editorStyle.top="".concat(t,"px")}},{key:"setSize",value:function(e,t){if(e&&t){var r=this.getInputElement();r.style.width="".concat(e,"px"),r.style.height="".concat(t,"px")}}},{key:"resetSize",value:function(){var e=this.getInputElement();e.style.width="",e.style.height=""}},{key:"setReadOnlyState",value:function(e){this.getInputElement().readOnly=e}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.editorStyle.display="none",this.hidden=!0}},{key:"isVisible",value:function(){return"block"===this.editorStyle.display}},{key:"setValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e||"";this.getInputElement().value=t}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var t=this.rootDocument.createElement("div"),r=this.rootDocument.createElement("textarea");return this.container=this.rootDocument.querySelector(".".concat(e.CLASS_EDITOR_CONTAINER)),this.container||(this.container=this.rootDocument.createElement("div"),addClass(this.container,e.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container)),addClass(t,e.CLASS_EDITOR),addClass(r,e.CLASS_INPUT),t.appendChild(r),this.container.appendChild(t),t}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(e.CLASS_INPUT))}},{key:"destroy",value:function(){var e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}]),e}(),KEY="---------";function separatorItem(){return{name:KEY}}function normalizeSelection(e){return arrayMap(e,(function(e){return{start:e.getTopLeftCorner(),end:e.getBottomRightCorner()}}))}function isSeparator(e){return hasClass(e,"htSeparator")}function hasSubMenu(e){return hasClass(e,"htSubmenu")}function isDisabled(e){return hasClass(e,"htDisabled")}function isSelectionDisabled(e){return hasClass(e,"htSelectionDisabled")}function getValidSelection(e){var t=e.getSelected();return t?t[0]<0?null:t:null}function prepareVerticalAlignClass(e,t){if(-1!==e.indexOf(t))return e;var r=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(t)}function prepareHorizontalAlignClass(e,t){if(-1!==e.indexOf(t))return e;var r=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(t)}function getAlignmentClasses(e,t){var r={};return arrayEach(e,(function(e){e.forAll((function(e,n){e>=0&&n>=0&&(r[e]||(r[e]=[]),r[e][n]=t(e,n))}))})),r}function align(e,t,r,n,o){arrayEach(e,(function(e){e.forAll((function(e,i){e>=0&&i>=0&&applyAlignClassName(e,i,t,r,n,o)}))}))}function applyAlignClassName(e,t,r,n,o,i){var a=o(e,t),s=n;a.className&&(s="vertical"===r?prepareVerticalAlignClass(a.className,n):prepareHorizontalAlignClass(a.className,n)),i(e,t,"className",s)}function checkSelectionConsistency(e,t){var r=!1;return Array.isArray(e)&&arrayEach(e,(function(e){return e.forAll((function(e,n){if(e>=0&&n>=0&&t(e,n))return r=!0,!1})),r})),r}function markLabelAsSelected(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function isItemHidden(e,t){return!e.hidden||!("function"==typeof e.hidden&&e.hidden.call(t))}function shiftSeparators(e,t){for(var r=e.slice(0);0<r.length&&r[0].name===t;)r.shift();return r}function popSeparators(e,t){var r=e.slice(0);return r.reverse(),(r=shiftSeparators(r,t)).reverse(),r}function removeDuplicatedSeparators(e){var t=[];return arrayEach(e,(function(e,r){r>0?t[t.length-1].name!==e.name&&t.push(e):t.push(e)})),t}function filterSeparators(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:KEY,r=e.slice(0);return r=removeDuplicatedSeparators(r=popSeparators(r=shiftSeparators(r,t),t))}function _classCallCheck$1q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1k(e,t,r){return t&&_defineProperties$1k(e.prototype,t),r&&_defineProperties$1k(e,r),e}var DEFAULT_DISPLAY_DELAY=250,DEFAULT_HIDE_DELAY=250,DisplaySwitch=function(){function e(t){_classCallCheck$1q(this,e),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}return _createClass$1k(e,[{key:"hide",value:function(){var e=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout((function(){!1===e.wasLastActionShow&&e.runLocalHooks("hide")}),DEFAULT_HIDE_DELAY)}},{key:"show",value:function(e){this.wasLastActionShow=!0,this.showDebounced(e)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:DEFAULT_DISPLAY_DELAY;this.showDebounced=debounce((function(t){e.wasLastActionShow&&e.runLocalHooks("show",t.from.row,t.from.col)}),t)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),e}();function _typeof$N(e){return(_typeof$N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty$e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck$1r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1l(e,t,r){return t&&_defineProperties$1l(e.prototype,t),r&&_defineProperties$1l(e,r),e}function _get$g(e,t,r){return(_get$g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$g(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$g(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$D(e)););return e}function _inherits$D(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$E(e,t)}function _setPrototypeOf$E(e,t){return(_setPrototypeOf$E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$D(e){var t=_isNativeReflectConstruct$E();return function(){var r,n=_getPrototypeOf$D(e);if(t){var o=_getPrototypeOf$D(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$D(this,r)}}function _possibleConstructorReturn$D(e,t){return!t||"object"!==_typeof$N(t)&&"function"!=typeof t?_assertThisInitialized$D(e):t}function _assertThisInitialized$D(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$E(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$D(e){return(_getPrototypeOf$D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}mixin(DisplaySwitch,localHooks);var privatePool$8=new WeakMap,META_COMMENT="comment",META_COMMENT_VALUE="value",META_STYLE="style",META_READONLY="readOnly",Comments=function(e){_inherits$D(r,e);var t=_createSuper$D(r);function r(e){var n;return _classCallCheck$1r(this,r),(n=t.call(this,e)).editor=null,n.displaySwitch=null,n.eventManager=null,n.range={},n.mouseDown=!1,n.contextMenuEvent=!1,n.timer=null,privatePool$8.set(_assertThisInitialized$D(n),{tempEditorDimensions:{},cellBelowCursor:null}),n}return _createClass$1l(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().comments}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.editor||(this.editor=new CommentEditor(this.hot.rootDocument)),this.eventManager||(this.eventManager=new EventManager(this)),this.displaySwitch||(this.displaySwitch=new DisplaySwitch(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",(function(t){return e.addToContextMenu(t)})),this.addHook("afterRenderer",(function(t,r,n,o,i,a){return e.onAfterRenderer(t,a)})),this.addHook("afterScrollHorizontally",(function(){return e.hide()})),this.addHook("afterScrollVertically",(function(){return e.hide()})),this.addHook("afterBeginEditing",(function(){return e.onAfterBeginEditing()})),this.displaySwitch.addLocalHook("hide",(function(){return e.hide()})),this.displaySwitch.addLocalHook("show",(function(t,r){return e.showAtCell(t,r)})),this.registerListeners(),_get$g(_getPrototypeOf$D(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$g(_getPrototypeOf$D(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){_get$g(_getPrototypeOf$D(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var e=this,t=this.hot.rootDocument;this.eventManager.addEventListener(t,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(t,"mousedown",(function(t){return e.onMouseDown(t)})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()})),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",(function(){return e.onEditorBlur()})),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",(function(t){return e.onEditorMouseDown(t)})),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",(function(t){return e.onEditorMouseUp(t)}))}},{key:"setRange",value:function(e){this.range=e}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(e){var t=closest(e.target,"TD","TBODY");return!!(t&&hasClass(t,"htCommentCell")&&closest(t,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(e){return this.editor.getInputElement()===e.target}},{key:"setComment",value:function(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var t=this.editor.getValue(),r="";null!=e?r=e:null!=t&&(r=t);var n=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(n,o,_defineProperty$e({},META_COMMENT_VALUE,r)),this.hot.render()}},{key:"setCommentAtCell",value:function(e,t,r){this.setRange({from:new CellCoords(e,t)}),this.setComment(r)}},{key:"removeComment",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,META_COMMENT,void 0),e&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:new CellCoords(e,t)}),this.removeComment(r)}},{key:"getComment",value:function(){var e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,META_COMMENT_VALUE)}},{key:"getCommentAtCell",value:function(e,t){return this.getCommentMeta(e,t,META_COMMENT_VALUE)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var e=this.range.from,t=e.row,r=e.col;if(t<0||t>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;var n=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.refreshEditor(!0),this.editor.setValue(n[META_COMMENT]?n[META_COMMENT][META_COMMENT_VALUE]:""),this.editor.hidden&&this.editor.show(),!0}},{key:"showAtCell",value:function(e,t){return this.setRange({from:new CellCoords(e,t)}),this.show()}},{key:"hide",value:function(){this.editor.hidden||this.editor.hide()}},{key:"refreshEditor",value:function(){var e,t,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(r||this.range.from&&this.editor.isVisible()){var n=this.hot,o=n.rowIndexMapper,i=n.columnIndexMapper,a=this.range.from,s=a.row,l=a.col,u=o.getRenderableFromVisualIndex(s),c=i.getRenderableFromVisualIndex(l),f=null===u;null===u&&(u=o.getRenderableFromVisualIndex(o.getFirstNotHiddenIndex(s,-1))),null===c&&(c=i.getRenderableFromVisualIndex(i.getFirstNotHiddenIndex(l,-1)));var h=null===u,d=null===c;u=null!==(e=u)&&void 0!==e?e:0,c=null!==(t=c)&&void 0!==t?t:0;var p=this.hot,y=p.rootWindow,g=p.view.wt,m=g.wtTable,v=g.wtOverlays,_=g.wtViewport,b=v.scrollableElement,C=m.getCell({row:u,col:c}),w=offset(C),E=d?0:m.getStretchedColumnWidth(c),S=f&&!h?outerHeight(C):0,O=w.top,T=w.left;_.hasVerticalScroll()&&b!==y&&(O-=v.topOverlay.getScrollPosition()),_.hasHorizontalScroll()&&b!==y&&(T-=v.leftOverlay.getScrollPosition());var R=T+E,$=O+S,I=this.getCommentMeta(s,l,META_STYLE),A=this.getCommentMeta(s,l,META_READONLY);I?this.editor.setSize(I.width,I.height):this.editor.resetSize(),this.editor.setReadOnlyState(A),this.editor.setPosition(R,$)}}},{key:"checkSelectionCommentsConsistency",value:function(){var e=this.hot.getSelectedRangeLast();if(!e)return!1;var t=!1,r=e.getTopLeftCorner();return this.getCommentMeta(r.row,r.col,META_COMMENT_VALUE)&&(t=!0),t}},{key:"updateCommentMeta",value:function(e,t,r){var n,o=this.hot.getCellMeta(e,t)[META_COMMENT];o?deepExtend(n=deepClone(o),r):n=r,this.hot.setCellMeta(e,t,META_COMMENT,n)}},{key:"getCommentMeta",value:function(e,t,r){var n=this.hot.getCellMeta(e,t);if(n[META_COMMENT])return n[META_COMMENT][r]}},{key:"onMouseDown",value:function(e){if(this.mouseDown=!0,this.hot.view&&this.hot.view.wt){if(!this.contextMenuEvent&&!this.targetIsCommentTextArea(e)){var t=closest(e.target,"TD","TBODY"),r=null;t&&(r=this.hot.view.wt.wtTable.getCoords(t),r={row:this.hot.rowIndexMapper.getVisualFromRenderableIndex(r.row),col:this.hot.columnIndexMapper.getVisualFromRenderableIndex(r.col)}),(!t||this.range.from&&r&&(this.range.from.row!==r.row||this.range.from.col!==r.col))&&this.hide()}this.contextMenuEvent=!1}}},{key:"onMouseOver",value:function(e){var t=privatePool$8.get(this),r=this.hot.rootDocument;if(t.cellBelowCursor=r.elementFromPoint(e.clientX,e.clientY),!(this.mouseDown||this.editor.isFocused()||hasClass(e.target,"wtBorder")||t.cellBelowCursor!==e.target)&&this.editor)if(this.targetIsCellWithComment(e)){var n=this.hot.view.wt.wtTable.getCoords(e.target),o={from:new CellCoords(this.hot.rowIndexMapper.getVisualFromRenderableIndex(n.row),this.hot.columnIndexMapper.getVisualFromRenderableIndex(n.col))};this.displaySwitch.show(o)}else isChildOf(e.target,r)&&!this.targetIsCommentTextArea(e)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onAfterRenderer",value:function(e,t){t[META_COMMENT]&&t[META_COMMENT][META_COMMENT_VALUE]&&addClass(e,t.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(e){privatePool$8.get(this).tempEditorDimensions={width:outerWidth(e.target),height:outerHeight(e.target)}}},{key:"onEditorMouseUp",value:function(e){var t=privatePool$8.get(this),r=outerWidth(e.target),n=outerHeight(e.target);r===t.tempEditorDimensions.width+1&&n===t.tempEditorDimensions.height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,_defineProperty$e({},META_STYLE,{width:r,height:n}))}},{key:"onContextMenuAddComment",value:function(){var e=this;this.displaySwitch.cancelHiding();var t=this.hot.getSelectedRangeLast();this.contextMenuEvent=!0,this.setRange({from:t.highlight}),this.show(),setTimeout((function(){e.hot&&(e.hot.deselectCell(),e.editor.focus())}),10)}},{key:"onContextMenuRemoveComment",value:function(){var e=this,t=this.hot.getSelectedRangeLast();this.contextMenuEvent=!0,t.forAll((function(t,r){t>=0&&r>=0&&e.removeCommentAtCell(t,r,!1)})),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var e=this,t=this.hot.getSelectedRangeLast();this.contextMenuEvent=!0,t.forAll((function(t,r){if(t>=0&&r>=0){var n=!!e.getCommentMeta(t,r,META_READONLY);e.updateCommentMeta(t,r,_defineProperty$e({},META_READONLY,!n))}}))}},{key:"addToContextMenu",value:function(e){var t=this,r=function(){return t.hot.rowIndexMapper.getRenderableIndexesLength()>0&&t.hot.columnIndexMapper.getRenderableIndexesLength()>0};e.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return t.checkSelectionCommentsConsistency()?t.hot.getTranslatedPhrase(CONTEXTMENU_ITEMS_EDIT_COMMENT):t.hot.getTranslatedPhrase(CONTEXTMENU_ITEMS_ADD_COMMENT)},callback:function(){return t.onContextMenuAddComment()},disabled:function(){return!r()||!(t.hot.getSelectedLast()&&!t.hot.selection.isSelectedByCorner())}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback:function(){return t.onContextMenuRemoveComment()},disabled:function(){return!r()||!(t.hot.getSelectedLast()&&!t.hot.selection.isSelectedByCorner())}},{key:"commentsReadOnly",name:function(){var e=this,t=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);return checkSelectionConsistency(this.getSelectedRangeLast(),(function(t,r){var n=e.getCellMeta(t,r)[META_COMMENT];if(n&&(n=n[META_READONLY]),n)return!0}))&&(t=markLabelAsSelected(t)),t},callback:function(){return t.onContextMenuMakeReadOnly()},disabled:function(){return!r()||!(t.hot.getSelectedLast()&&!t.hot.selection.isSelectedByCorner()&&t.checkSelectionCommentsConsistency())}})}},{key:"getDisplayDelaySetting",value:function(){var e=this.hot.getSettings().comments;if(isObject$1(e))return e.displayDelay}},{key:"onAfterBeginEditing",value:function(){this.hide()}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),_get$g(_getPrototypeOf$D(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);function _classCallCheck$1s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1m(e,t,r){return t&&_defineProperties$1m(e.prototype,t),r&&_defineProperties$1m(e,r),e}registerPlugin("comments",Comments);var CommandExecutor=function(){function e(t){_classCallCheck$1s(this,e),this.hot=t,this.commands={},this.commonCallback=null}return _createClass$1m(e,[{key:"registerCommand",value:function(e,t){this.commands[e]=t}},{key:"setCommonCallback",value:function(e){this.commonCallback=e}},{key:"execute",value:function(e){for(var t=this,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var i=e.split(":"),a=i[0],s=2===i.length?i[1]:null,l=this.commands[a];if(!l)throw new Error("Menu command '".concat(a,"' not exists."));if(s&&l.submenu&&(l=findSubCommand(s,l.submenu.items)),!0!==l.disabled&&("function"!=typeof l.disabled||!0!==l.disabled.call(this.hot))&&!hasOwnProperty$1(l,"submenu")){var u=[];"function"==typeof l.callback&&u.push(l.callback),"function"==typeof this.commonCallback&&u.push(this.commonCallback),n.unshift(i.join(":")),arrayEach(u,(function(e){return e.apply(t.hot,n)}))}}}]),e}();function findSubCommand(e,t){var r;return arrayEach(t,(function(t){var n=t.key?t.key.split(":"):null;if(Array.isArray(n)&&n[1]===e)return r=t,!1})),r}var KEY$1="alignment";function alignmentItem(){return{key:KEY$1,name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT)},disabled:function(){return 0===this.countRows()||0===this.countCols()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(KEY$1,":left"),name:function(){var e=this,t=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_LEFT);return checkSelectionConsistency(this.getSelectedRange(),(function(t,r){var n=e.getCellMeta(t,r).className;if(n&&-1!==n.indexOf("htLeft"))return!0}))&&(t=markLabelAsSelected(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),r=getAlignmentClasses(t,(function(t,r){return e.getCellMeta(t,r).className})),n="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",r,t,n,o),align(t,n,o,(function(t,r){return e.getCellMeta(t,r)}),(function(t,r,n,o){return e.setCellMeta(t,r,n,o)})),this.render()},disabled:!1},{key:"".concat(KEY$1,":center"),name:function(){var e=this,t=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_CENTER);return checkSelectionConsistency(this.getSelectedRange(),(function(t,r){var n=e.getCellMeta(t,r).className;if(n&&-1!==n.indexOf("htCenter"))return!0}))&&(t=markLabelAsSelected(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),r=getAlignmentClasses(t,(function(t,r){return e.getCellMeta(t,r).className})),n="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",r,t,n,o),align(t,n,o,(function(t,r){return e.getCellMeta(t,r)}),(function(t,r,n,o){return e.setCellMeta(t,r,n,o)})),this.render()},disabled:!1},{key:"".concat(KEY$1,":right"),name:function(){var e=this,t=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT);return checkSelectionConsistency(this.getSelectedRange(),(function(t,r){var n=e.getCellMeta(t,r).className;if(n&&-1!==n.indexOf("htRight"))return!0}))&&(t=markLabelAsSelected(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),r=getAlignmentClasses(t,(function(t,r){return e.getCellMeta(t,r).className})),n="horizontal",o="htRight";this.runHooks("beforeCellAlignment",r,t,n,o),align(t,n,o,(function(t,r){return e.getCellMeta(t,r)}),(function(t,r,n,o){return e.setCellMeta(t,r,n,o)})),this.render()},disabled:!1},{key:"".concat(KEY$1,":justify"),name:function(){var e=this,t=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY);return checkSelectionConsistency(this.getSelectedRange(),(function(t,r){var n=e.getCellMeta(t,r).className;if(n&&-1!==n.indexOf("htJustify"))return!0}))&&(t=markLabelAsSelected(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),r=getAlignmentClasses(t,(function(t,r){return e.getCellMeta(t,r).className})),n="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",r,t,n,o),align(t,n,o,(function(t,r){return e.getCellMeta(t,r)}),(function(t,r,n,o){return e.setCellMeta(t,r,n,o)})),this.render()},disabled:!1},{name:KEY},{key:"".concat(KEY$1,":top"),name:function(){var e=this,t=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_TOP);return checkSelectionConsistency(this.getSelectedRange(),(function(t,r){var n=e.getCellMeta(t,r).className;if(n&&-1!==n.indexOf("htTop"))return!0}))&&(t=markLabelAsSelected(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),r=getAlignmentClasses(t,(function(t,r){return e.getCellMeta(t,r).className})),n="vertical",o="htTop";this.runHooks("beforeCellAlignment",r,t,n,o),align(t,n,o,(function(t,r){return e.getCellMeta(t,r)}),(function(t,r,n,o){return e.setCellMeta(t,r,n,o)})),this.render()},disabled:!1},{key:"".concat(KEY$1,":middle"),name:function(){var e=this,t=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE);return checkSelectionConsistency(this.getSelectedRange(),(function(t,r){var n=e.getCellMeta(t,r).className;if(n&&-1!==n.indexOf("htMiddle"))return!0}))&&(t=markLabelAsSelected(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),r=getAlignmentClasses(t,(function(t,r){return e.getCellMeta(t,r).className})),n="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",r,t,n,o),align(t,n,o,(function(t,r){return e.getCellMeta(t,r)}),(function(t,r,n,o){return e.setCellMeta(t,r,n,o)})),this.render()},disabled:!1},{key:"".concat(KEY$1,":bottom"),name:function(){var e=this,t=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM);return checkSelectionConsistency(this.getSelectedRange(),(function(t,r){var n=e.getCellMeta(t,r).className;if(n&&-1!==n.indexOf("htBottom"))return!0}))&&(t=markLabelAsSelected(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),r=getAlignmentClasses(t,(function(t,r){return e.getCellMeta(t,r).className})),n="vertical",o="htBottom";this.runHooks("beforeCellAlignment",r,t,n,o),align(t,n,o,(function(t,r){return e.getCellMeta(t,r)}),(function(t,r,n,o){return e.setCellMeta(t,r,n,o)})),this.render()},disabled:!1}]}}}function _slicedToArray$d(e,t){return _arrayWithHoles$e(e)||_iterableToArrayLimit$d(e,t)||_unsupportedIterableToArray$n(e,t)||_nonIterableRest$e()}function _nonIterableRest$e(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$n(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$n(e,t):void 0}}function _arrayLikeToArray$n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$d(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$e(e){if(Array.isArray(e))return e}var KEY$2="clear_column";function clearColumnItem(){return{key:KEY$2,name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback:function(e,t){var r=t[0].start.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(t[0].start.row,t[0].end.row),r,"ContextMenu.clearColumn")},disabled:function(){var e=getValidSelection(this);if(!e)return!0;var t=_slicedToArray$d(e[0],3),r=t[0],n=t[1],o=[r,0,t[2],this.countCols()-1].join(",")===e.join(",");return n<0||this.countCols()>=this.getSettings().maxCols||o}}}var KEY$3="col_left";function columnLeftItem(){return{key:KEY$3,name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_INSERT_LEFT)},callback:function(e,t){var r=this.selection.isSelectedByCorner(),n=0;r||(n=t[Math.max(t.length-1,0)].start.col);this.alter("insert_col",n,1,"ContextMenu.columnLeft"),r&&this.selectAll()},disabled:function(){return!this.isColumnModificationAllowed()||(!getValidSelection(this)||(this.selection.isSelectedByCorner()?0===this.countCols():this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols))},hidden:function(){return!this.getSettings().allowInsertColumn}}}var KEY$4="col_right";function columnRightItem(){return{key:KEY$4,name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback:function(e,t){var r=this.selection.isSelectedByCorner(),n=0;if(r)n=this.countCols();else{var o,i=t[Math.max(t.length-1,0)],a=null==i||null===(o=i.end)||void 0===o?void 0:o.col;n=isDefined(a)?a+1:0}this.alter("insert_col",n,1,"ContextMenu.columnRight"),r&&this.selectAll()},disabled:function(){return!this.isColumnModificationAllowed()||(!getValidSelection(this)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols))},hidden:function(){return!this.getSettings().allowInsertColumn}}}var KEY$5="make_read_only";function readOnlyItem(){return{key:KEY$5,name:function(){var e=this,t=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_READ_ONLY);return checkSelectionConsistency(this.getSelectedRange(),(function(t,r){return e.getCellMeta(t,r).readOnly}))&&(t=markLabelAsSelected(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),r=checkSelectionConsistency(t,(function(t,r){return e.getCellMeta(t,r).readOnly}));arrayEach(t,(function(t){t.forAll((function(t,n){t>=0&&n>=0&&e.setCellMeta(t,n,"readOnly",!r)}))})),this.render()},disabled:function(){return!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))}}}var KEY$6="redo";function redoItem(){return{key:KEY$6,name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REDO)},callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}}function _slicedToArray$e(e,t){return _arrayWithHoles$f(e)||_iterableToArrayLimit$e(e,t)||_unsupportedIterableToArray$o(e,t)||_nonIterableRest$f()}function _nonIterableRest$f(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$o(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$o(e,t):void 0}}function _arrayLikeToArray$o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$e(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$f(e){if(Array.isArray(e))return e}var KEY$7="remove_col";function removeColumnItem(){return{key:KEY$7,name:function(){var e=this.getSelected(),t=0;if(e)if(e.length>1)t=1;else{var r=_slicedToArray$e(e[0],4);r[1]-r[3]!=0&&(t=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_COLUMN,t)},callback:function(){this.alter("remove_col",transformSelectionToColumnDistance(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;if(!getValidSelection(this))return!0;var e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function _slicedToArray$f(e,t){return _arrayWithHoles$g(e)||_iterableToArrayLimit$f(e,t)||_unsupportedIterableToArray$p(e,t)||_nonIterableRest$g()}function _nonIterableRest$g(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$p(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$p(e,t):void 0}}function _arrayLikeToArray$p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$f(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$g(e){if(Array.isArray(e))return e}var KEY$8="remove_row";function removeRowItem(){return{key:KEY$8,name:function(){var e=this.getSelected(),t=0;if(e)if(e.length>1)t=1;else{var r=_slicedToArray$f(e[0],3);r[0]-r[2]!=0&&(t=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_ROW,t)},callback:function(){this.alter("remove_row",transformSelectionToRowDistance(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){if(!getValidSelection(this))return!0;var e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden:function(){return!this.getSettings().allowRemoveRow}}}var KEY$9="row_above";function rowAboveItem(){return{key:KEY$9,name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ROW_ABOVE)},callback:function(e,t){var r=this.selection.isSelectedByCorner(),n=0;r||(n=t[Math.max(t.length-1,0)].start.row);this.alter("insert_row",n,1,"ContextMenu.rowAbove"),r&&this.selectAll()},disabled:function(){return!getValidSelection(this)||(this.selection.isSelectedByCorner()?0===this.countRows():this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden:function(){return!this.getSettings().allowInsertRow}}}var KEY$a="row_below";function rowBelowItem(){return{key:KEY$a,name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ROW_BELOW)},callback:function(e,t){var r=this.selection.isSelectedByCorner(),n=0;if(r)n=this.countRows();else{var o,i=t[Math.max(t.length-1,0)],a=null==i||null===(o=i.end)||void 0===o?void 0:o.row;n=isDefined(a)?a+1:0}this.alter("insert_row",n,1,"ContextMenu.rowBelow"),r&&this.selectAll()},disabled:function(){return!getValidSelection(this)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden:function(){return!this.getSettings().allowInsertRow}}}var KEY$b="no_items";function noItemsItem(){return{key:KEY$b,name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}}var KEY$c="undo",_predefinedItems2;function undoItem(){return{key:KEY$c,name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNDO)},callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}}}function _defineProperty$f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ITEMS=[KEY$9,KEY$a,KEY$3,KEY$4,KEY$2,KEY$8,KEY$7,KEY$c,KEY$6,KEY$5,KEY$1,KEY,KEY$b],_predefinedItems=(_predefinedItems2={},_defineProperty$f(_predefinedItems2,KEY,separatorItem),_defineProperty$f(_predefinedItems2,KEY$b,noItemsItem),_defineProperty$f(_predefinedItems2,KEY$9,rowAboveItem),_defineProperty$f(_predefinedItems2,KEY$a,rowBelowItem),_defineProperty$f(_predefinedItems2,KEY$3,columnLeftItem),_defineProperty$f(_predefinedItems2,KEY$4,columnRightItem),_defineProperty$f(_predefinedItems2,KEY$2,clearColumnItem),_defineProperty$f(_predefinedItems2,KEY$8,removeRowItem),_defineProperty$f(_predefinedItems2,KEY$7,removeColumnItem),_defineProperty$f(_predefinedItems2,KEY$c,undoItem),_defineProperty$f(_predefinedItems2,KEY$6,redoItem),_defineProperty$f(_predefinedItems2,KEY$5,readOnlyItem),_defineProperty$f(_predefinedItems2,KEY$1,alignmentItem),_predefinedItems2);function predefinedItems(){var e={};return objectEach(_predefinedItems,(function(t,r){e[r]=t()})),e}function _classCallCheck$1t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1n(e,t,r){return t&&_defineProperties$1n(e.prototype,t),r&&_defineProperties$1n(e,r),e}var ItemsFactory=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;_classCallCheck$1t(this,e),this.hot=t,this.predefinedItems=predefinedItems(),this.defaultOrderPattern=r}return _createClass$1n(e,[{key:"setPredefinedItems",value:function(e){var t=this,r={};this.defaultOrderPattern.length=0,objectEach(e,(function(e,n){var o="";e.name===KEY?(r[KEY]=e,o=KEY):isNaN(parseInt(n,10))?(e.key=void 0===e.key?n:e.key,r[n]=e,o=e.key):(r[e.key]=e,o=e.key),t.defaultOrderPattern.push(o)})),this.predefinedItems=r}},{key:"getItems",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return _getItems(e,this.defaultOrderPattern,this.predefinedItems)}}]),e}();function _getItems(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=[],o=e;return o&&o.items?o=o.items:Array.isArray(o)||(o=t),isObject$1(o)?objectEach(o,(function(e,t){var o=r["string"==typeof e?e:t];o||(o=e),isObject$1(e)?extend(o,e):"string"==typeof o&&(o={name:o}),void 0===o.key&&(o.key=t),n.push(o)})):arrayEach(o,(function(e,t){var o=r[e];!o&&ITEMS.indexOf(e)>=0||(o||(o={name:e,key:"".concat(t)}),isObject$1(e)&&extend(o,e),void 0===o.key&&(o.key=t),n.push(o))})),n}function _classCallCheck$1u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1o(e,t,r){return t&&_defineProperties$1o(e.prototype,t),r&&_defineProperties$1o(e,r),e}var Cursor=function(){function e(t,r){_classCallCheck$1u(this,e);var n,o,i,a,s,l,u=getWindowScrollTop(r),c=getWindowScrollLeft(r);this.rootWindow=r,this.type=this.getSourceType(t),"literal"===this.type?(n=parseInt(t.top,10),i=parseInt(t.left,10),s=t.height||0,l=t.width||0,o=n,a=i,n+=u,i+=c):"event"===this.type&&(n=parseInt(t.pageY,10),i=parseInt(t.pageX,10),s=t.target.clientHeight,l=t.target.clientWidth,o=n-u,a=i-c),this.top=n,this.topRelative=o,this.left=i,this.leftRelative=a,this.scrollTop=u,this.scrollLeft=c,this.cellHeight=s,this.cellWidth=l}return _createClass$1o(e,[{key:"getSourceType",value:function(e){var t="literal";return e instanceof Event&&(t="event"),t}},{key:"fitsAbove",value:function(e){return this.topRelative>=e.offsetHeight}},{key:"fitsBelow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}},{key:"fitsOnRight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}},{key:"fitsOnLeft",value:function(e){return this.leftRelative>=e.offsetWidth}}]),e}();function _classCallCheck$1v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1p(e,t,r){return t&&_defineProperties$1p(e.prototype,t),r&&_defineProperties$1p(e,r),e}var MIN_WIDTH=215,Menu=function(){function e(t,r){_classCallCheck$1v(this,e),this.hot=t,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:MIN_WIDTH,container:this.hot.rootDocument.documentElement},this.eventManager=new EventManager(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return _createClass$1p(e,[{key:"registerEvents",value:function(){for(var e=this,t=this.hot.rootWindow;t;)this.eventManager.addEventListener(t.document,"mousedown",(function(t){return e.onDocumentMouseDown(t)})),this.eventManager.addEventListener(t.document,"contextmenu",(function(t){return e.onDocumentContextMenu(t)})),t=getParentWindow(t)}},{key:"setMenuItems",value:function(e){this.menuItems=e}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.offset[e]=t}},{key:"isSubMenu",value:function(){return null!==this.parentMenu}},{key:"open",value:function(){var e=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var t=debounce((function(t){return e.openSubMenu(t)}),300),r=this.options.minWidth||MIN_WIDTH,n=!1,o=arrayFilter(this.menuItems,(function(t){return t.key===KEY$b&&(n=!0),isItemHidden(t,e.hot)}));if(o.length<1&&!n)o.push(predefinedItems()[KEY$b]);else if(0===o.length)return;o=filterSeparators(o,KEY);var i=!1,a={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(e){return isDefined(e)&&e<r?r:e},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(t,r,n,o,i,a){return e.menuItemRenderer(t,r,n,o,i,a)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",beforeKeyDown:function(t){return e.onBeforeKeyDown(t)},afterOnCellMouseOver:function(r,n){e.isAllSubMenusClosed()?t(n.row):e.openSubMenu(n.row)},rowHeights:function(e){return o[e].name===KEY?1:23},afterOnCellContextMenu:function(t){t.preventDefault(),isWindowsOS()&&i&&e.hasSelectedItem()&&e.close(!0)},beforeOnCellMouseUp:function(t){e.hasSelectedItem()&&(i=!e.isCommandPassive(e.getSelectedItem()),e.executeCommand(t))},afterOnCellMouseUp:function(t){isWindowsOS()&&isRightClick(t)||!i||!e.hasSelectedItem()||e.close(!0)},afterUnlisten:function(){!e.hasSelectedItem()&&e.isOpened()&&e.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new Core(this.container,a),this.hotMenu.addHook("afterInit",(function(){return e.onAfterInit()})),this.hotMenu.addHook("afterSelection",(function(){return e.onAfterSelection.apply(e,arguments)})),this.hotMenu.init(),this.hotMenu.listen(),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isOpened()&&(e&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(t){if(!this.hotMenu)return!1;var r=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!r||!hasSubMenu(r))return!1;var n=this.hotMenu.getSourceDataAtRow(t),o=new e(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(n.submenu.items),o.open(),o.setPosition(r.getBoundingClientRect()),this.hotSubMenus[n.key]=o,o}},{key:"closeSubMenu",value:function(e){var t=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[t.key];r&&(r.destroy(),delete this.hotSubMenus[t.key])}},{key:"closeAllSubMenus",value:function(){var e=this;arrayEach(this.hotMenu.getData(),(function(t,r){return e.closeSubMenu(r)}))}},{key:"isAllSubMenusClosed",value:function(){return 0===Object.keys(this.hotSubMenus).length}},{key:"destroy",value:function(){var e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}},{key:"isOpened",value:function(){return null!==this.hotMenu}},{key:"executeCommand",value:function(e){if(this.isOpened()&&this.hasSelectedItem()){var t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),!this.isCommandPassive(t)){var r=this.hot.getSelectedRange(),n=r?normalizeSelection(r):[];this.runLocalHooks("executeCommand",t.key,n,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,n,e)}}}},{key:"isCommandPassive",value:function(e){var t=e.isCommand,r=e.name,n=e.disabled,o=e.submenu,i=!0===n||"function"==typeof n&&!0===n.call(this.hot);return!1===t||r===KEY||!0===i||o}},{key:"setPosition",value:function(e){var t=new Cursor(e,this.container.ownerDocument.defaultView);this.options.keepInViewport?(t.fitsBelow(this.container)?this.setPositionBelowCursor(t):t.fitsAbove(this.container)?this.setPositionAboveCursor(t):this.setPositionBelowCursor(t),t.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(t):this.setPositionOnLeftOfCursor(t)):(this.setPositionBelowCursor(t),this.setPositionOnRightOfCursor(t))}},{key:"setPositionAboveCursor",value:function(e){var t=this.offset.above+e.top-this.container.offsetHeight;this.isSubMenu()&&(t=e.top+e.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(t,"px")}},{key:"setPositionBelowCursor",value:function(e){var t=this.offset.below+e.top;this.isSubMenu()&&(t=e.top-1),this.container.style.top="".concat(t,"px")}},{key:"setPositionOnRightOfCursor",value:function(e){var t;t=this.isSubMenu()?1+e.left+e.cellWidth:this.offset.right+1+e.left,this.container.style.left="".concat(t,"px")}},{key:"setPositionOnLeftOfCursor",value:function(e){var t=getScrollbarWidth(this.hot.rootDocument),r=this.offset.left+e.left-this.container.offsetWidth+t+4;this.container.style.left="".concat(r,"px")}},{key:"selectFirstCell",value:function(){var e=this.hotMenu.getCell(0,0);isSeparator(e)||isDisabled(e)||isSelectionDisabled(e)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var e=this.hotMenu.countRows()-1,t=this.hotMenu.getCell(e,0);isSeparator(t)||isDisabled(t)||isSelectionDisabled(t)?this.selectPrevCell(e,0):this.hotMenu.selectCell(e,0)}},{key:"selectNextCell",value:function(e,t){var r=e+1,n=r<this.hotMenu.countRows()?this.hotMenu.getCell(r,t):null;n&&(isSeparator(n)||isDisabled(n)||isSelectionDisabled(n)?this.selectNextCell(r,t):this.hotMenu.selectCell(r,t))}},{key:"selectPrevCell",value:function(e,t){var r=e-1,n=r>=0?this.hotMenu.getCell(r,t):null;n&&(isSeparator(n)||isDisabled(n)||isSelectionDisabled(n)?this.selectPrevCell(r,t):this.hotMenu.selectCell(r,t))}},{key:"menuItemRenderer",value:function(e,t,r,n,o,i){var a,s=this,l=e.getSourceDataAtRow(r),u=this.hot.rootDocument.createElement("div"),c=function(e){return e.disableSelection},f=i;"function"==typeof f&&(f=f.call(this.hot)),empty$1(t),addClass(u,"htItemWrapper"),t.appendChild(u),a=l,new RegExp(KEY,"i").test(a.name)?addClass(t,"htSeparator"):"function"==typeof l.renderer?(addClass(t,"htCustomMenuRenderer"),t.appendChild(l.renderer(e,u,r,n,o,f))):fastInnerHTML(u,f),!function(e){return!0===e.disabled||"function"==typeof e.disabled&&!0===e.disabled.call(s.hot)}(l)?c(l)?(addClass(t,"htSelectionDisabled"),this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()}))):!function(e){return hasOwnProperty$1(e,"submenu")}(l)?(removeClass(t,["htSubmenu","htDisabled"]),c(l)?this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()})):this.eventManager.addEventListener(t,"mouseenter",(function(){return e.selectCell(r,n,void 0,void 0,!1,!1)}))):(addClass(t,"htSubmenu"),c(l)?this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()})):this.eventManager.addEventListener(t,"mouseenter",(function(){return e.selectCell(r,n,void 0,void 0,!1,!1)}))):(addClass(t,"htDisabled"),this.eventManager.addEventListener(t,"mouseenter",(function(){return e.deselectCell()})))}},{key:"createContainer",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=this.options.container.ownerDocument,n=t;return n&&(isFunction(n)&&(n=null===(n=n.call(this.hot))||isUndefined(n)?"":n.toString()),n=n.replace(/[^A-z0-9]/g,"_"),n="".concat(this.options.className,"Sub_").concat(n),e=r.querySelector(".".concat(this.options.className,".").concat(n))),e||(addClass(e=r.createElement("div"),"htMenu ".concat(this.options.className)),n&&addClass(e,n),this.options.container.appendChild(e)),e}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onBeforeKeyDown",value:function(e){if(isInput(e.target)&&this.container.contains(e.target))stopImmediatePropagation(e);else{var t=this.hotMenu.getSelectedLast(),r=!1;switch(this.keyEvent=!0,e.keyCode){case KEY_CODES.ESCAPE:this.close(),r=!0;break;case KEY_CODES.ENTER:t&&(this.hotMenu.getSourceDataAtRow(t[0]).submenu?r=!0:(this.executeCommand(e),this.close(!0)));break;case KEY_CODES.ARROW_DOWN:t?this.selectNextCell(t[0],t[1]):this.selectFirstCell(),r=!0;break;case KEY_CODES.ARROW_UP:t?this.selectPrevCell(t[0],t[1]):this.selectLastCell(),r=!0;break;case KEY_CODES.ARROW_RIGHT:if(t){var n=this.openSubMenu(t[0]);n&&n.selectFirstCell()}r=!0;break;case KEY_CODES.ARROW_LEFT:t&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen(),r=!0)}r&&(e.preventDefault(),stopImmediatePropagation(e)),this.keyEvent=!1}}},{key:"onAfterInit",value:function(){var e=this.hotMenu.view.wt.wtTable,t=this.hotMenu.getSettings().data,r=e.hider.style,n=e.holder.style,o=parseInt(r.width,10),i=arrayReduce(t,(function(e,t){return e+(t.name===KEY?1:26)}),0);n.width="".concat(o+3,"px"),n.height="".concat(i+3,"px"),r.height=n.height}},{key:"onAfterSelection",value:function(e,t,r,n,o){!1===this.keyEvent&&(o.value=!0)}},{key:"onDocumentMouseDown",value:function(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!isChildOf(e.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||isChildOf(e.target,".htMenu")||!isChildOf(e.target,this.container.ownerDocument)&&!isChildOf(e.target,this.hot.rootDocument)||this.close(!0))}},{key:"onDocumentContextMenu",value:function(e){this.isOpened()&&hasClass(e.target,"htCore")&&isChildOf(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}]),e}();function _typeof$O(e){return(_typeof$O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$1w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _get$h(e,t,r){return(_get$h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$h(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$h(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$E(e)););return e}function _defineProperties$1q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1q(e,t,r){return t&&_defineProperties$1q(e.prototype,t),r&&_defineProperties$1q(e,r),e}function _inherits$E(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$F(e,t)}function _setPrototypeOf$F(e,t){return(_setPrototypeOf$F=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$E(e){var t=_isNativeReflectConstruct$F();return function(){var r,n=_getPrototypeOf$E(e);if(t){var o=_getPrototypeOf$E(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$E(this,r)}}function _possibleConstructorReturn$E(e,t){return!t||"object"!==_typeof$O(t)&&"function"!=typeof t?_assertThisInitialized$E(e):t}function _assertThisInitialized$E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$F(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$E(e){return(_getPrototypeOf$E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}mixin(Menu,localHooks),Hooks.getSingleton().register("afterContextMenuDefaultOptions"),Hooks.getSingleton().register("beforeContextMenuShow"),Hooks.getSingleton().register("afterContextMenuShow"),Hooks.getSingleton().register("afterContextMenuHide"),Hooks.getSingleton().register("afterContextMenuExecute");var ContextMenu=function(e){_inherits$E(r,e);var t=_createSuper$E(r);function r(e){var n;return _classCallCheck$1w(this,r),(n=t.call(this,e)).eventManager=new EventManager(_assertThisInitialized$E(n)),n.commandExecutor=new CommandExecutor(n.hot),n.itemsFactory=null,n.menu=null,n}return _createClass$1q(r,null,[{key:"DEFAULT_ITEMS",get:function(){return[KEY$9,KEY$a,KEY,KEY$3,KEY$4,KEY,KEY$8,KEY$7,KEY,KEY$c,KEY$6,KEY,KEY$5,KEY,KEY$1]}}]),_createClass$1q(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().contextMenu}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().contextMenu;"function"==typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new Menu(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(function(){return e.onMenuBeforeOpen()})),this.menu.addLocalHook("afterOpen",(function(){return e.onMenuAfterOpen()})),this.menu.addLocalHook("afterClose",(function(){return e.onMenuAfterClose()})),this.menu.addLocalHook("executeCommand",(function(){for(var t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(t=e.executeCommand).call.apply(t,[e].concat(n))})),this.addHook("afterOnCellContextMenu",(function(t){return e.onAfterOnCellContextMenu(t)})),_get$h(_getPrototypeOf$E(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$h(_getPrototypeOf$E(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),_get$h(_getPrototypeOf$E(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(e){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),this.menu.isOpened())){var t=0,r=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var n=this.hot.rootWindow.frameElement.getBoundingClientRect(),o=n.top,i=n.left;t=o-getWindowScrollTop(e.view),r=i-getWindowScrollLeft(e.view)}else t=-1*getWindowScrollTop(this.menu.hotMenu.rootWindow),r=-1*getWindowScrollLeft(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(e.pageY,10)+t,left:parseInt(e.pageX,10)+r})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(e){var t;null===this.itemsFactory&&this.prepareMenuItems();for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];(t=this.commandExecutor).execute.apply(t,[e].concat(n))}},{key:"prepareMenuItems",value:function(){var e=this;this.itemsFactory=new ItemsFactory(this.hot,r.DEFAULT_ITEMS);var t=this.hot.getSettings().contextMenu,n={items:this.itemsFactory.getItems(t)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);var o=this.itemsFactory.getItems(t);this.hot.runHooks("beforeContextMenuSetItems",o),this.menu.setMenuItems(o),arrayEach(o,(function(t){return e.commandExecutor.registerCommand(t.key,t)}))}},{key:"onAfterOnCellContextMenu",value:function(e){var t=this.hot.getSettings(),r=t.rowHeaders,n=t.colHeaders;var o=e.target;this.close(),hasClass(o,"handsontableInput")||(e.preventDefault(),e.stopPropagation(),(r||n||function(e){return"TD"===e.nodeName||"TD"===e.parentNode.nodeName}(o)||hasClass(o,"current")&&hasClass(o,"wtBorder"))&&this.open(e))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),_get$h(_getPrototypeOf$E(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);function copyItem(e){return{key:"copy",name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY)},callback:function(){e.copy()},disabled:function(){if(0===this.countRows()||0===this.countCols())return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}function cutItem(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_CUT)},callback:function(){e.cut()},disabled:function(){if(0===this.countRows()||0===this.countCols())return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}function _classCallCheck$1x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1r(e,t,r){return t&&_defineProperties$1r(e.prototype,t),r&&_defineProperties$1r(e,r),e}ContextMenu.SEPARATOR={name:KEY},registerPlugin("contextMenu",ContextMenu);var ClipboardData=function(){function e(){_classCallCheck$1x(this,e),this.data={}}return _createClass$1r(e,[{key:"setData",value:function(e,t){this.data[e]=t}},{key:"getData",value:function(e){return this.data[e]||void 0}}]),e}();function _classCallCheck$1y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var PasteEvent=function e(){_classCallCheck$1y(this,e),this.clipboardData=new ClipboardData};function _classCallCheck$1z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1s(e,t,r){return t&&_defineProperties$1s(e.prototype,t),r&&_defineProperties$1s(e,r),e}collection("WeakSet",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),collectionWeak);var FocusableWrapper=function(){function e(t){_classCallCheck$1z(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new EventManager(this),this.listenersCount=new WeakSet,this.container=t}return _createClass$1s(e,[{key:"useSecondaryElement",value:function(){var e=createOrGetSecondaryElement(this.container);this.listenersCount.has(e)||(this.listenersCount.add(e),forwardEventsToLocalHooks(this.eventManager,e,this)),this.mainElement=e}},{key:"setFocusableElement",value:function(e){this.listenersCount.has(e)||(this.listenersCount.add(e),forwardEventsToLocalHooks(this.eventManager,e,this)),this.mainElement=e}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",isMobileBrowser()||selectElementIfAllowed(this.mainElement)}}]),e}();mixin(FocusableWrapper,localHooks);var refCounter=new WeakMap;function createElement(e){var t=new FocusableWrapper(e),r=refCounter.get(e);return r=isNaN(r)?0:r,refCounter.set(e,r+1),t}function deactivateElement(e){e.eventManager.clear()}var runLocalHooks=function(e,t){return function(r){return t.runLocalHooks(e,r)}};function forwardEventsToLocalHooks(e,t,r){e.addEventListener(t,"copy",runLocalHooks("copy",r)),e.addEventListener(t,"cut",runLocalHooks("cut",r)),e.addEventListener(t,"paste",runLocalHooks("paste",r))}var secondaryElements=new WeakMap;function createOrGetSecondaryElement(e){var t=secondaryElements.get(e);if(t)return t.parentElement||e.appendChild(t),t;var r=(e.defaultView?e:e.ownerDocument).createElement("textarea");return secondaryElements.set(e,r),r.setAttribute("data-hot-input",""),r.className="HandsontableCopyPaste",r.tabIndex=-1,r.autocomplete="off",r.wrap="hard",r.value=" ",e.appendChild(r),r}function destroyElement(e){if(e instanceof FocusableWrapper){var t=refCounter.get(e.container);if((t=isNaN(t)?0:t)>0&&(t-=1),deactivateElement(e),t<=0){t=0;var r=secondaryElements.get(e.container);r&&r.parentNode&&(r.parentNode.removeChild(r),secondaryElements.delete(e.container)),e.mainElement=null}refCounter.set(e.container,t)}}function _slicedToArray$g(e,t){return _arrayWithHoles$h(e)||_iterableToArrayLimit$g(e,t)||_unsupportedIterableToArray$q(e,t)||_nonIterableRest$h()}function _nonIterableRest$h(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$q(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$q(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$q(e,t):void 0}}function _arrayLikeToArray$q(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$g(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$h(e){if(Array.isArray(e))return e}function _typeof$P(e){return(_typeof$P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$1A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1t(e,t,r){return t&&_defineProperties$1t(e.prototype,t),r&&_defineProperties$1t(e,r),e}function _get$i(e,t,r){return(_get$i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$i(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$i(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$F(e)););return e}function _inherits$F(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$G(e,t)}function _setPrototypeOf$G(e,t){return(_setPrototypeOf$G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$F(e){var t=_isNativeReflectConstruct$G();return function(){var r,n=_getPrototypeOf$F(e);if(t){var o=_getPrototypeOf$F(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$F(this,r)}}function _possibleConstructorReturn$F(e,t){return!t||"object"!==_typeof$P(t)&&"function"!=typeof t?_assertThisInitialized$F(e):t}function _assertThisInitialized$F(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$G(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$F(e){return(_getPrototypeOf$F=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Hooks.getSingleton().register("afterCopyLimit"),Hooks.getSingleton().register("modifyCopyableRange"),Hooks.getSingleton().register("beforeCut"),Hooks.getSingleton().register("afterCut"),Hooks.getSingleton().register("beforePaste"),Hooks.getSingleton().register("afterPaste"),Hooks.getSingleton().register("beforeCopy"),Hooks.getSingleton().register("afterCopy");var ROWS_LIMIT=1e3,COLUMNS_LIMIT=1e3,privatePool$9=new WeakMap,META_HEAD=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),CopyPaste=function(e){_inherits$F(r,e);var t=_createSuper$F(r);function r(e){var n;return _classCallCheck$1A(this,r),(n=t.call(this,e)).columnsLimit=COLUMNS_LIMIT,n.copyableRanges=[],n.focusableElement=void 0,n.pasteMode="overwrite",n.rowsLimit=ROWS_LIMIT,n.uiContainer=n.hot.rootDocument.body,privatePool$9.set(_assertThisInitialized$F(n),{isTriggeredByCopy:!1,isTriggeredByCut:!1,isBeginEditing:!1,isFragmentSelectionEnabled:!1}),n}return _createClass$1t(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().copyPaste}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings(),n=t.copyPaste,o=t.fragmentSelection;privatePool$9.get(this).isFragmentSelectionEnabled=!!o,"object"===_typeof$P(n)&&(this.pasteMode=n.pasteMode||this.pasteMode,this.rowsLimit=isNaN(n.rowsLimit)?this.rowsLimit:n.rowsLimit,this.columnsLimit=isNaN(n.columnsLimit)?this.columnsLimit:n.columnsLimit,this.uiContainer=n.uiContainer||this.uiContainer),this.addHook("afterContextMenuDefaultOptions",(function(t){return e.onAfterContextMenuDefaultOptions(t)})),this.addHook("afterOnCellMouseUp",(function(){return e.onAfterOnCellMouseUp()})),this.addHook("afterSelectionEnd",(function(){return e.onAfterSelectionEnd()})),this.addHook("beforeKeyDown",(function(){return e.onBeforeKeyDown()})),this.focusableElement=createElement(this.uiContainer),this.focusableElement.addLocalHook("copy",(function(t){return e.onCopy(t)})).addLocalHook("cut",(function(t){return e.onCut(t)})).addLocalHook("paste",(function(t){return e.onPaste(t)})),_get$i(_getPrototypeOf$F(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),_get$i(_getPrototypeOf$F(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&destroyElement(this.focusableElement),_get$i(_getPrototypeOf$F(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){privatePool$9.get(this).isTriggeredByCopy=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"cut",value:function(){privatePool$9.get(this).isTriggeredByCut=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(e){var t=this,r=[],n=[],o=[];return arrayEach(e,(function(e){rangeEach(e.startRow,e.endRow,(function(e){-1===n.indexOf(e)&&n.push(e)})),rangeEach(e.startCol,e.endCol,(function(e){-1===o.indexOf(e)&&o.push(e)}))})),arrayEach(n,(function(e){var n=[];arrayEach(o,(function(r){n.push(t.hot.getCopyableData(e,r))})),r.push(n)})),SheetClip.stringify(r)}},{key:"getRangedData",value:function(e){var t=this,r=[],n=[],o=[];return arrayEach(e,(function(e){rangeEach(e.startRow,e.endRow,(function(e){-1===n.indexOf(e)&&n.push(e)})),rangeEach(e.startCol,e.endCol,(function(e){-1===o.indexOf(e)&&o.push(e)}))})),arrayEach(n,(function(e){var n=[];arrayEach(o,(function(r){n.push(t.hot.getCopyableData(e,r))})),r.push(n)})),r}},{key:"paste",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(e||t){var r=new PasteEvent;e&&r.clipboardData.setData("text/plain",e),t&&r.clipboardData.setData("text/html",t),this.getOrCreateFocusableElement(),this.onPaste(r)}}},{key:"setCopyableText",value:function(){var e=this.hot.getSelectedRangeLast();if(e){var t=e.getTopLeftCorner(),r=e.getBottomRightCorner(),n=t.row,o=t.col,i=r.row,a=r.col,s=Math.min(i,n+this.rowsLimit-1),l=Math.min(a,o+this.columnsLimit-1);this.copyableRanges.length=0,this.copyableRanges.push({startRow:n,startCol:o,endRow:s,endCol:l}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges),i===s&&a===l||this.hot.runHooks("afterCopyLimit",i-n+1,a-o+1,this.rowsLimit,this.columnsLimit)}}},{key:"getOrCreateFocusableElement",value:function(){var e=this.hot.getActiveEditor(),t=e?e.TEXTAREA:void 0;t?this.focusableElement.setFocusableElement(t):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var e=this.hot.getActiveEditor();return e&&e.isOpened()}},{key:"populateValues",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(e.length){for(var r=e.length,n=e[0].length,o=[],i=t.getTopLeftCorner(),a=i.row,s=i.col,l=t.getBottomRightCorner(),u=l.row,c=l.col,f=a,h=s,d=a,p=s;o.length<r||f<=u;){var y=this.hot.getCellMeta(f,s),g=y.skipRowOnPaste,m=y.visualRow;if(f=m+1,!0!==g){d=m,h=s;for(var v=[],_=o.length%r;v.length<n||h<=c;){var b=this.hot.getCellMeta(a,h),C=b.skipColumnOnPaste,w=b.visualCol;if(h=w+1,!0!==C){p=w;var E=v.length%n;v.push(e[_][E])}}o.push(v)}}return this.hot.populateFromArray(a,s,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,s,d,p]}}},{key:"onCopy",value:function(e){var t=privatePool$9.get(this);if((this.hot.isListening()||t.isTriggeredByCopy)&&!this.isEditorOpened()){this.setCopyableText(),t.isTriggeredByCopy=!1;var r=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",r,this.copyableRanges)){var n=SheetClip.stringify(r);if(e&&e.clipboardData){var o=_dataToHTML(r,this.hot.rootDocument);e.clipboardData.setData("text/plain",n),e.clipboardData.setData("text/html",[META_HEAD,o].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",n);this.hot.runHooks("afterCopy",r,this.copyableRanges)}e.preventDefault()}}},{key:"onCut",value:function(e){var t=privatePool$9.get(this);if((this.hot.isListening()||t.isTriggeredByCut)&&!this.isEditorOpened()){this.setCopyableText(),t.isTriggeredByCut=!1;var r=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",r,this.copyableRanges)){var n=SheetClip.stringify(r);if(e&&e.clipboardData){var o=_dataToHTML(r,this.hot.rootDocument);e.clipboardData.setData("text/plain",n),e.clipboardData.setData("text/html",[META_HEAD,o].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",n);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",r,this.copyableRanges)}e.preventDefault()}}},{key:"onPaste",value:function(e){if(this.hot.isListening()&&!this.isEditorOpened()){var t;if(e&&e.preventDefault&&e.preventDefault(),e&&void 0!==e.clipboardData){var r=e.clipboardData.getData("text/html");if(r&&/(<table)|(<TABLE)/g.test(r))t=htmlToGridSettings(r,this.hot.rootDocument).data;else t=e.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(t=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof t&&(t=SheetClip.parse(t)),(!t||0!==t.length)&&!1!==this.hot.runHooks("beforePaste",t,this.copyableRanges)){var n=_slicedToArray$g(this.populateValues(t),4),o=n[0],i=n[1],a=n[2],s=n[3];this.hot.selectCell(o,i,Math.min(this.hot.countRows()-1,a),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",t,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(e){e.items.push({name:"---------"},copyItem(this),cutItem(this))}},{key:"onAfterOnCellMouseUp",value:function(){this.hot.isListening()&&!this.isEditorOpened()&&(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){var e=privatePool$9.get(this).isFragmentSelectionEnabled;this.isEditorOpened()||(this.getOrCreateFocusableElement(),e&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&getSelectionText()||(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(this.hot.isListening()&&!this.isEditorOpened()){var e=this.hot.rootDocument.activeElement,t=this.hot.getActiveEditor();!t||e!==this.focusableElement.getFocusableElement()&&e!==t.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(destroyElement(this.focusableElement),this.focusableElement=null),_get$i(_getPrototypeOf$F(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);function createId(e,t){return"border_row".concat(e,"col").concat(t)}function createDefaultCustomBorder(){return{width:1,color:"#000"}}function createSingleEmptyBorder(){return{hide:!0}}function createDefaultHtBorder(){return{width:1,color:"#000",cornerVisible:!1}}function createEmptyBorders(e,t){return{id:createId(e,t),border:createDefaultHtBorder(),row:e,col:t,top:createSingleEmptyBorder(),right:createSingleEmptyBorder(),bottom:createSingleEmptyBorder(),left:createSingleEmptyBorder()}}function extendDefaultBorder(e,t){return hasOwnProperty$1(t,"border")&&(e.border=t.border),hasOwnProperty$1(t,"top")&&(t.top?(isObject$1(t.top)||(t.top=createDefaultCustomBorder()),e.top=t.top):(t.top=createSingleEmptyBorder(),e.top=t.top)),hasOwnProperty$1(t,"right")&&(t.right?(isObject$1(t.right)||(t.right=createDefaultCustomBorder()),e.right=t.right):(t.right=createSingleEmptyBorder(),e.right=t.right)),hasOwnProperty$1(t,"bottom")&&(t.bottom?(isObject$1(t.bottom)||(t.bottom=createDefaultCustomBorder()),e.bottom=t.bottom):(t.bottom=createSingleEmptyBorder(),e.bottom=t.bottom)),hasOwnProperty$1(t,"left")&&(t.left?(isObject$1(t.left)||(t.left=createDefaultCustomBorder()),e.left=t.left):(t.left=createSingleEmptyBorder(),e.left=t.left)),e}function checkSelectionBorders(e,t){var r=!1;return arrayEach(e.getSelectedRange(),(function(n){n.forAll((function(n,o){if(!(n<0||o<0)){var i=e.getCellMeta(n,o).borders;if(i){if(!t)return r=!0,!1;if(!hasOwnProperty$1(i[t],"hide")||!1===i[t].hide)return r=!0,!1}}}))})),r}function markSelected(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function bottom(e){return{key:"borders:bottom",name:function(){var e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_BOTTOM);return checkSelectionBorders(this,"bottom")&&(e=markSelected(e)),e},callback:function(t,r){var n=checkSelectionBorders(this,"bottom");e.prepareBorder(r,"bottom",n)}}}function left(e){return{key:"borders:left",name:function(){var e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_LEFT);return checkSelectionBorders(this,"left")&&(e=markSelected(e)),e},callback:function(t,r){var n=checkSelectionBorders(this,"left");e.prepareBorder(r,"left",n)}}}function noBorders(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback:function(t,r){e.prepareBorder(r,"noBorders")},disabled:function(){return!checkSelectionBorders(this)}}}function right(e){return{key:"borders:right",name:function(){var e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_RIGHT);return checkSelectionBorders(this,"right")&&(e=markSelected(e)),e},callback:function(t,r){var n=checkSelectionBorders(this,"right");e.prepareBorder(r,"right",n)}}}function top(e){return{key:"borders:top",name:function(){var e=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_TOP);return checkSelectionBorders(this,"top")&&(e=markSelected(e)),e},callback:function(t,r){var n=checkSelectionBorders(this,"top");e.prepareBorder(r,"top",n)}}}function _typeof$Q(e){return(_typeof$Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _slicedToArray$h(e,t){return _arrayWithHoles$i(e)||_iterableToArrayLimit$h(e,t)||_unsupportedIterableToArray$r(e,t)||_nonIterableRest$i()}function _nonIterableRest$i(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$r(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$r(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$r(e,t):void 0}}function _arrayLikeToArray$r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$h(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$i(e){if(Array.isArray(e))return e}function _classCallCheck$1B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1u(e,t,r){return t&&_defineProperties$1u(e.prototype,t),r&&_defineProperties$1u(e,r),e}function _get$j(e,t,r){return(_get$j="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$j(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$j(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$G(e)););return e}function _inherits$G(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$H(e,t)}function _setPrototypeOf$H(e,t){return(_setPrototypeOf$H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$G(e){var t=_isNativeReflectConstruct$H();return function(){var r,n=_getPrototypeOf$G(e);if(t){var o=_getPrototypeOf$G(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$G(this,r)}}function _possibleConstructorReturn$G(e,t){return!t||"object"!==_typeof$Q(t)&&"function"!=typeof t?_assertThisInitialized$G(e):t}function _assertThisInitialized$G(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$H(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$G(e){return(_getPrototypeOf$G=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}registerPlugin("CopyPaste",CopyPaste);var CustomBorders=function(e){_inherits$G(r,e);var t=_createSuper$G(r);function r(e){var n;return _classCallCheck$1B(this,r),(n=t.call(this,e)).savedBorders=[],n}return _createClass$1u(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().customBorders}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",(function(t){return e.onAfterContextMenuDefaultOptions(t)})),this.addHook("init",(function(){return e.onAfterInit()})),_get$j(_getPrototypeOf$G(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),_get$j(_getPrototypeOf$G(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),_get$j(_getPrototypeOf$G(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(e,t){var r=this,n=t?Object.keys(t):["top","right","bottom","left"],o=normalizeSelectionFactory(detectSelectionType(e));arrayEach(e,(function(e){for(var i=_slicedToArray$h(o(e),4),a=i[0],s=i[1],l=i[2],u=i[3],c=function(e){for(var o=function(o){arrayEach(n,(function(n){r.prepareBorderFromCustomAdded(e,o,t,n)}))},i=s;i<=u;i+=1)o(i)},f=a;f<=l;f+=1)c(f)})),this.hot.view.render()}},{key:"getBorders",value:function(e){var t=this;if(!Array.isArray(e))return this.savedBorders;var r=normalizeSelectionFactory(detectSelectionType(e)),n=[];return arrayEach(e,(function(e){for(var o=_slicedToArray$h(r(e),4),i=o[0],a=o[1],s=o[2],l=o[3],u=function(e){for(var r=function(r){arrayEach(t.savedBorders,(function(t){t.row===e&&t.col===r&&n.push(t)}))},o=a;o<=l;o+=1)r(o)},c=i;c<=s;c+=1)u(c)})),n}},{key:"clearBorders",value:function(e){var t=this;e?this.setBorders(e):(arrayEach(this.savedBorders,(function(e){t.clearBordersFromSelectionSettings(e.id),t.clearNullCellRange(),t.hot.removeCellMeta(e.row,e.col,"borders")})),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);var r=new CellRange(new CellCoords(e.row,e.col));this.checkCustomSelections(e,r,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:r})}},{key:"prepareBorderFromCustomAdded",value:function(e,t,r,n){var o=this.hot.countRows(),i=this.hot.countCols();if(!(e>=o||t>=i)){var a=createEmptyBorders(e,t);r&&(a=extendDefaultBorder(a,r),arrayEach(this.hot.selection.highlight.customSelections,(function(e){if(a.id===e.settings.id)return Object.assign(e.settings,r),a.id=e.settings.id,a.left=e.settings.left,a.right=e.settings.right,a.top=e.settings.top,a.bottom=e.settings.bottom,!1}))),this.hot.setCellMeta(e,t,"borders",a),this.insertBorderIntoSettings(a,n)}}},{key:"prepareBorderFromCustomAddedRange",value:function(e){var t=this,r=e.range,n=Math.min(r.to.row,this.hot.countRows()-1),o=Math.min(r.to.col,this.hot.countCols()-1);rangeEach(r.from.row,n,(function(n){rangeEach(r.from.col,o,(function(o){var i=createEmptyBorders(n,o),a=0;n===r.from.row&&hasOwnProperty$1(e,"top")&&(a+=1,i.top=e.top),n===r.to.row&&hasOwnProperty$1(e,"bottom")&&(a+=1,i.bottom=e.bottom),o===r.from.col&&hasOwnProperty$1(e,"left")&&(a+=1,i.left=e.left),o===r.to.col&&hasOwnProperty$1(e,"right")&&(a+=1,i.right=e.right),a>0&&(t.hot.setCellMeta(n,o,"borders",i),t.insertBorderIntoSettings(i))}))}))}},{key:"removeAllBorders",value:function(e,t){var r=createId(e,t);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}},{key:"setBorder",value:function(e,t,r,n){var o=this.hot.getCellMeta(e,t).borders;(o&&void 0!==o.border||(o=createEmptyBorders(e,t)),n)?(o[r]=createSingleEmptyBorder(),4===this.countHide(o)?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(o,r,n)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",o))):(o[r]=createDefaultCustomBorder(),this.checkCustomSelectionsFromContextMenu(o,r,n)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",o))}},{key:"prepareBorder",value:function(e,t,r){var n=this;arrayEach(e,(function(e){var o=e.start,i=e.end;if(o.row===i.row&&o.col===i.col)"noBorders"===t?n.removeAllBorders(o.row,o.col):n.setBorder(o.row,o.col,t,r);else switch(t){case"noBorders":rangeEach(o.col,i.col,(function(e){rangeEach(o.row,i.row,(function(t){n.removeAllBorders(t,e)}))}));break;case"top":rangeEach(o.col,i.col,(function(e){n.setBorder(o.row,e,t,r)}));break;case"right":rangeEach(o.row,i.row,(function(e){n.setBorder(e,i.col,t,r)}));break;case"bottom":rangeEach(o.col,i.col,(function(e){n.setBorder(i.row,e,t,r)}));break;case"left":rangeEach(o.row,i.row,(function(e){n.setBorder(e,o.col,t,r)}))}}))}},{key:"createCustomBorders",value:function(e){var t=this;arrayEach(e,(function(e){e.range?t.prepareBorderFromCustomAddedRange(e):t.prepareBorderFromCustomAdded(e.row,e.col,e)}))}},{key:"countHide",value:function(e){return arrayReduce(Object.values(e),(function(e,t){var r=e;return t.hide&&(r+=1),r}),0)}},{key:"clearBordersFromSelectionSettings",value:function(e){var t=arrayMap(this.hot.selection.highlight.customSelections,(function(e){return e.settings.id})).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}},{key:"clearNullCellRange",value:function(){var e=this;arrayEach(this.hot.selection.highlight.customSelections,(function(t,r){if(null===t.cellRange)return e.hot.selection.highlight.customSelections[r].destroy(),e.hot.selection.highlight.customSelections.splice(r,1),!1}))}},{key:"hideBorders",value:function(){var e=this;arrayEach(this.savedBorders,(function(t){e.clearBordersFromSelectionSettings(t.id),e.clearNullCellRange()}))}},{key:"spliceBorder",value:function(e){var t=arrayMap(this.savedBorders,(function(e){return e.id})).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}},{key:"checkSavedBorders",value:function(e){var t=this,r=!1;return 4===this.countHide(e)?(this.spliceBorder(e.id),r=!0):arrayEach(this.savedBorders,(function(n,o){if(e.id===n.id)return t.savedBorders[o]=e,r=!0,!1})),r}},{key:"checkCustomSelectionsFromContextMenu",value:function(e,t,r){var n=!1;return arrayEach(this.hot.selection.highlight.customSelections,(function(o){if(e.id===o.settings.id)return objectEach(o.instanceBorders,(function(e){e.toggleHiddenClass(t,r)})),n=!0,!1})),n}},{key:"checkCustomSelections",value:function(e,t,r){var n=this.countHide(e),o=!1;return 4===n?(this.removeAllBorders(e.row,e.col),o=!0):arrayEach(this.hot.selection.highlight.customSelections,(function(n){if(e.id===n.settings.id)return n.visualCellRange=t,n.commit(),r&&objectEach(n.instanceBorders,(function(t){t.changeBorderStyle(r,e)})),o=!0,!1})),o}},{key:"changeBorderSettings",value:function(){var e=this.hot.getSettings().customBorders;Array.isArray(e)?(e.length||(this.savedBorders=e),this.createCustomBorders(e)):void 0!==e&&this.createCustomBorders(this.savedBorders)}},{key:"onAfterContextMenuDefaultOptions",value:function(e){this.hot.getSettings().customBorders&&e.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[top(this),right(this),bottom(this),left(this),noBorders(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){_get$j(_getPrototypeOf$G(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);function _typeof$R(e){return(_typeof$R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$1C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1v(e,t,r){return t&&_defineProperties$1v(e.prototype,t),r&&_defineProperties$1v(e,r),e}function _get$k(e,t,r){return(_get$k="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$k(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$k(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$H(e)););return e}function _inherits$H(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$I(e,t)}function _setPrototypeOf$I(e,t){return(_setPrototypeOf$I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$H(e){var t=_isNativeReflectConstruct$I();return function(){var r,n=_getPrototypeOf$H(e);if(t){var o=_getPrototypeOf$H(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$H(this,r)}}function _possibleConstructorReturn$H(e,t){return!t||"object"!==_typeof$R(t)&&"function"!=typeof t?_assertThisInitialized$H(e):t}function _assertThisInitialized$H(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$I(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$H(e){return(_getPrototypeOf$H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}registerPlugin("customBorders",CustomBorders);var DragToScroll=function(e){_inherits$H(r,e);var t=_createSuper$H(r);function r(e){var n;return _classCallCheck$1C(this,r),(n=t.call(this,e)).eventManager=new EventManager(_assertThisInitialized$H(n)),n.boundaries=null,n.callback=null,n.listening=!1,n}return _createClass$1v(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().dragToScroll}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterOnCellMouseDown",(function(t){return e.setupListening(t)})),this.addHook("afterOnCellCornerMouseDown",(function(t){return e.setupListening(t)})),this.registerEvents(),_get$k(_getPrototypeOf$H(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$k(_getPrototypeOf$H(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),_get$k(_getPrototypeOf$H(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(e){this.boundaries=e}},{key:"setCallback",value:function(e){this.callback=e}},{key:"check",value:function(e,t){var r=0,n=0;t<this.boundaries.top?n=t-this.boundaries.top:t>this.boundaries.bottom&&(n=t-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,n)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var e=this,t=this.hot.rootWindow;t;)this.eventManager.addEventListener(t.document,"contextmenu",(function(){return e.unlisten()})),this.eventManager.addEventListener(t.document,"mouseup",(function(){return e.unlisten()})),this.eventManager.addEventListener(t.document,"mousemove",(function(t){return e.onMouseMove(t)})),t=getParentWindow(t)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(e){if(!isRightClick(e)){var t=this.hot.view.wt.wtTable.holder;t!==this.hot.rootWindow&&(this.setBoundaries(t.getBoundingClientRect()),this.setCallback((function(e,r){e<0?t.scrollLeft-=50:e>0&&(t.scrollLeft+=50),r<0?t.scrollTop-=20:r>0&&(t.scrollTop+=20)})),this.listen())}}},{key:"onMouseMove",value:function(e){this.isListening()&&this.check(e.clientX,e.clientY)}},{key:"destroy",value:function(){_get$k(_getPrototypeOf$H(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);function _slicedToArray$i(e,t){return _arrayWithHoles$j(e)||_iterableToArrayLimit$i(e,t)||_unsupportedIterableToArray$s(e,t)||_nonIterableRest$j()}function _nonIterableRest$j(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$s(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$s(e,t):void 0}}function _arrayLikeToArray$s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$i(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$j(e){if(Array.isArray(e))return e}function freezeColumnItem(e){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback:function(t,r){var n=_slicedToArray$i(r,1)[0].start.col;e.freezeColumn(n),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var e=this.getSelectedRange(),t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsLeft-1)&&(t=!0),t}}}function _slicedToArray$j(e,t){return _arrayWithHoles$k(e)||_iterableToArrayLimit$j(e,t)||_unsupportedIterableToArray$t(e,t)||_nonIterableRest$k()}function _nonIterableRest$k(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$t(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$t(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$t(e,t):void 0}}function _arrayLikeToArray$t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$j(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$k(e){if(Array.isArray(e))return e}function unfreezeColumnItem(e){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback:function(t,r){var n=_slicedToArray$j(r,1)[0].start.col;e.unfreezeColumn(n),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var e=this.getSelectedRange(),t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsLeft)&&(t=!0),t}}}function _typeof$S(e){return(_typeof$S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$1D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1w(e,t,r){return t&&_defineProperties$1w(e.prototype,t),r&&_defineProperties$1w(e,r),e}function _get$l(e,t,r){return(_get$l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$l(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$I(e)););return e}function _inherits$I(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$J(e,t)}function _setPrototypeOf$J(e,t){return(_setPrototypeOf$J=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$I(e){var t=_isNativeReflectConstruct$J();return function(){var r,n=_getPrototypeOf$I(e);if(t){var o=_getPrototypeOf$I(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$I(this,r)}}function _possibleConstructorReturn$I(e,t){return!t||"object"!==_typeof$S(t)&&"function"!=typeof t?_assertThisInitialized$I(e):t}function _assertThisInitialized$I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$J(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$I(e){return(_getPrototypeOf$I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}registerPlugin("dragToScroll",DragToScroll);var privatePool$a=new WeakMap,ManualColumnFreeze=function(e){_inherits$I(r,e);var t=_createSuper$I(r);function r(e){var n;return _classCallCheck$1D(this,r),n=t.call(this,e),privatePool$a.set(_assertThisInitialized$I(n),{afterFirstUse:!1}),n}return _createClass$1w(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnFreeze}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",(function(t){return e.addContextMenuEntry(t)})),this.addHook("beforeColumnMove",(function(t,r){return e.onBeforeColumnMove(t,r)})),_get$l(_getPrototypeOf$I(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){privatePool$a.get(this).afterFirstUse=!1,_get$l(_getPrototypeOf$I(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$l(_getPrototypeOf$I(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(e){var t=privatePool$a.get(this),r=this.hot.getSettings();t.afterFirstUse||(t.afterFirstUse=!0),r.fixedColumnsLeft===this.hot.countCols()||e<=r.fixedColumnsLeft-1||(this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsLeft),r.fixedColumnsLeft+=1)}},{key:"unfreezeColumn",value:function(e){var t=privatePool$a.get(this),r=this.hot.getSettings();t.afterFirstUse||(t.afterFirstUse=!0),r.fixedColumnsLeft<=0||e>r.fixedColumnsLeft-1||(r.fixedColumnsLeft-=1,this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsLeft))}},{key:"addContextMenuEntry",value:function(e){e.items.push({name:"---------"},freezeColumnItem(this),unfreezeColumnItem(this))}},{key:"onBeforeColumnMove",value:function(e,t){if(privatePool$a.get(this).afterFirstUse){var r=this.hot.getSettings().fixedColumnsLeft;if(t<r)return!1;if(e.some((function(e){return e<r})))return!1}}}]),r}(BasePlugin);function _classCallCheck$1E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1x(e,t,r){return t&&_defineProperties$1x(e.prototype,t),r&&_defineProperties$1x(e,r),e}registerPlugin("manualColumnFreeze",ManualColumnFreeze);var STATE_INITIALIZED=0,STATE_BUILT=1,STATE_APPENDED=2,UNIT="px",BaseUI=function(){function e(t){_classCallCheck$1E(this,e),this.hot=t,this._element=null,this.state=STATE_INITIALIZED}return _createClass$1x(e,[{key:"appendTo",value:function(e){e.appendChild(this._element),this.state=STATE_APPENDED}},{key:"build",value:function(){this.state===STATE_INITIALIZED&&(this._element=this.hot.rootDocument.createElement("div"),this.state=STATE_BUILT)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=STATE_INITIALIZED}},{key:"isAppended",value:function(){return this.state===STATE_APPENDED}},{key:"isBuilt",value:function(){return this.state>=STATE_BUILT}},{key:"setPosition",value:function(e,t){isNumeric(e)&&(this._element.style.top=e+UNIT),isNumeric(t)&&(this._element.style.left=t+UNIT)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(e,t){isNumeric(e)&&(this._element.style.width=e+UNIT),isNumeric(t)&&(this._element.style.height=t+UNIT)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(e,t){isNumeric(e)&&(this._element.style.marginTop=e+UNIT),isNumeric(t)&&(this._element.style.marginLeft=t+UNIT)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();function _typeof$T(e){return(_typeof$T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$1F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1y(e,t,r){return t&&_defineProperties$1y(e.prototype,t),r&&_defineProperties$1y(e,r),e}function _get$m(e,t,r){return(_get$m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$m(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$m(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$J(e)););return e}function _inherits$J(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$K(e,t)}function _setPrototypeOf$K(e,t){return(_setPrototypeOf$K=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$J(e){var t=_isNativeReflectConstruct$K();return function(){var r,n=_getPrototypeOf$J(e);if(t){var o=_getPrototypeOf$J(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$J(this,r)}}function _possibleConstructorReturn$J(e,t){return!t||"object"!==_typeof$T(t)&&"function"!=typeof t?_assertThisInitialized$J(e):t}function _assertThisInitialized$J(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$K(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$J(e){return(_getPrototypeOf$J=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var CSS_CLASSNAME="ht__manualColumnMove--backlight",BacklightUI=function(e){_inherits$J(r,e);var t=_createSuper$J(r);function r(){return _classCallCheck$1F(this,r),t.apply(this,arguments)}return _createClass$1y(r,[{key:"build",value:function(){_get$m(_getPrototypeOf$J(r.prototype),"build",this).call(this),addClass(this._element,CSS_CLASSNAME)}}]),r}(BaseUI);function _typeof$U(e){return(_typeof$U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$1G(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1z(e,t,r){return t&&_defineProperties$1z(e.prototype,t),r&&_defineProperties$1z(e,r),e}function _get$n(e,t,r){return(_get$n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$n(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$n(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$K(e)););return e}function _inherits$K(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$L(e,t)}function _setPrototypeOf$L(e,t){return(_setPrototypeOf$L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$K(e){var t=_isNativeReflectConstruct$L();return function(){var r,n=_getPrototypeOf$K(e);if(t){var o=_getPrototypeOf$K(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$K(this,r)}}function _possibleConstructorReturn$K(e,t){return!t||"object"!==_typeof$U(t)&&"function"!=typeof t?_assertThisInitialized$K(e):t}function _assertThisInitialized$K(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$L(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$K(e){return(_getPrototypeOf$K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var CSS_CLASSNAME$1="ht__manualColumnMove--guideline",GuidelineUI=function(e){_inherits$K(r,e);var t=_createSuper$K(r);function r(){return _classCallCheck$1G(this,r),t.apply(this,arguments)}return _createClass$1z(r,[{key:"build",value:function(){_get$n(_getPrototypeOf$K(r.prototype),"build",this).call(this),addClass(this._element,CSS_CLASSNAME$1)}}]),r}(BaseUI);function _typeof$V(e){return(_typeof$V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$1H(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1A(e,t,r){return t&&_defineProperties$1A(e.prototype,t),r&&_defineProperties$1A(e,r),e}function _get$o(e,t,r){return(_get$o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$o(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$o(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$L(e)););return e}function _inherits$L(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$M(e,t)}function _setPrototypeOf$M(e,t){return(_setPrototypeOf$M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$L(e){var t=_isNativeReflectConstruct$M();return function(){var r,n=_getPrototypeOf$L(e);if(t){var o=_getPrototypeOf$L(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$L(this,r)}}function _possibleConstructorReturn$L(e,t){return!t||"object"!==_typeof$V(t)&&"function"!=typeof t?_assertThisInitialized$L(e):t}function _assertThisInitialized$L(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$M(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$L(e){return(_getPrototypeOf$L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Hooks.getSingleton().register("beforeColumnMove"),Hooks.getSingleton().register("afterColumnMove");var privatePool$b=new WeakMap,CSS_PLUGIN="ht__manualColumnMove",CSS_SHOW_UI="show-ui",CSS_ON_MOVING="on-moving--columns",CSS_AFTER_SELECTION="after-selection--columns",ManualColumnMove=function(e){_inherits$L(r,e);var t=_createSuper$L(r);function r(e){var n;return _classCallCheck$1H(this,r),n=t.call(this,e),privatePool$b.set(_assertThisInitialized$L(n),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),n.eventManager=new EventManager(_assertThisInitialized$L(n)),n.backlight=new BacklightUI(e),n.guideline=new GuidelineUI(e),n}return _createClass$1A(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualColumnMove}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(t,r,n,o){return e.onBeforeOnCellMouseDown(t,r,n,o)})),this.addHook("beforeOnCellMouseOver",(function(t,r,n,o){return e.onBeforeOnCellMouseOver(t,r,n,o)})),this.addHook("afterScrollVertically",(function(){return e.onAfterScrollVertically()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData()})),this.buildPluginUI(),this.registerEvents(),addClass(this.hot.rootElement,CSS_PLUGIN),_get$o(_getPrototypeOf$L(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),_get$o(_getPrototypeOf$L(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){removeClass(this.hot.rootElement,CSS_PLUGIN),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),_get$o(_getPrototypeOf$L(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(e,t){return this.moveColumns([e],t)}},{key:"moveColumns",value:function(e,t){var r=privatePool$b.get(this),n=r.cachedDropIndex,o=this.isMovePossible(e,t),i=this.hot.runHooks("beforeColumnMove",e,t,n,o);if(r.cachedDropIndex=void 0,!1!==i){o&&this.hot.columnIndexMapper.moveIndexes(e,t);var a=o&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,n,o,a),a}}},{key:"dragColumn",value:function(e,t){return this.dragColumns([e],t)}},{key:"dragColumns",value:function(e,t){var r=this.countFinalIndex(e,t);return privatePool$b.get(this).cachedDropIndex=t,this.moveColumns(e,r)}},{key:"isMovePossible",value:function(e,t){var r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),n=e.length+t>r,o=t<0,i=e.some((function(e){return e<0})),a=e.some((function(e){return e>=r}));return!(n||o||i||a)}},{key:"isColumnOrderChanged",value:function(e,t){return e.some((function(e,r){return e-r!==t}))}},{key:"countFinalIndex",value:function(e,t){var r=arrayReduce(e,(function(e,r){return r<t&&(e+=1),e}),0);return t-r}},{key:"getColumnsWidth",value:function(e,t){for(var r=this.hot.columnIndexMapper,n=0,o=e;o<=t;o+=1){var i=r.getRenderableFromVisualIndex(o);o<0?n+=this.hot.view.wt.wtViewport.getRowHeaderWidth()||0:null!==i&&(n+=this.hot.view.wt.wtTable.getStretchedColumnWidth(i)||0)}return n}},{key:"moveBySettingsOrLoad",value:function(){var e=this.hot.getSettings().manualColumnMove;if(Array.isArray(e))this.moveColumns(e,0);else if(void 0!==e){var t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}},{key:"isFixedColumnsLeft",value:function(e){return e<this.hot.getSettings().fixedColumnsLeft}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}},{key:"prepareColumnsToMoving",value:function(e,t){var r=[];return rangeEach(e,t,(function(e){r.push(e)})),r}},{key:"refreshPositions",value:function(){var e=privatePool$b.get(this),t=this.hot.view.wt.wtTable.getFirstVisibleColumn(),r=this.hot.view.wt.wtTable.getLastVisibleColumn(),n=this.hot.view.wt.wtTable,o=this.hot.view.wt.wtOverlays.scrollableElement,i="number"==typeof o.scrollX?o.scrollX:o.scrollLeft,a=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,e.coords-1),s=e.target.eventPageX-(e.rootElementOffset-(void 0===o.scrollX?i:0)),l=n.hider.offsetWidth,u=n.TBODY.offsetLeft,c=this.backlight.getOffset().left,f=this.backlight.getSize().width,h=0;if(e.rootElementOffset+n.holder.offsetWidth+i<e.target.eventPageX&&e.coords<e.countCols&&(e.coords+=1),e.hasRowHeaders&&(h=this.hot.view.wt.wtOverlays.leftOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsLeft(e.coords)&&(a+=i),a+=h,e.coords<0)e.fixedColumns>0?e.target.col=0:e.target.col=t>0?t-1:t;else if(e.target.TD.offsetWidth/2+a<=s){var d=e.coords>=e.countCols?e.countCols-1:e.coords;e.target.col=d+1,a+=e.target.TD.offsetWidth,e.target.col>r&&r<e.countCols&&this.hot.scrollViewportTo(void 0,r+1,void 0,!0)}else e.target.col=e.coords,e.target.col<=t&&e.target.col>=e.fixedColumns&&t>0&&this.hot.scrollViewportTo(void 0,t-1);e.target.col<=t&&e.target.col>=e.fixedColumns&&t>0&&this.hot.scrollViewportTo(void 0,t-1);var p=s,y=a;s+f+c>=l?p=l-f-c:s+c<u+h&&(p=u+h+Math.abs(c)),a>=l-1?y=l-1:0===y?y=1:void 0!==o.scrollX&&e.coords<e.fixedColumns&&(y-=e.rootElementOffset<=o.scrollX?e.rootElementOffset:0),this.backlight.setPosition(null,p),this.guideline.setPosition(null,y)}},{key:"registerEvents",value:function(){var e=this,t=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(t,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()}))}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(e,t,r,n){var o=this.hot.view.wt.wtTable,i=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),s=privatePool$b.get(this),l=hasClass(e.target,"sortAction");if(!a||!i||s.pressed||0!==e.button||l)return s.pressed=!1,s.columnsToMove.length=0,void removeClass(this.hot.rootElement,[CSS_ON_MOVING,CSS_SHOW_UI]);var u=this.guideline.isBuilt()&&!this.guideline.isAppended(),c=this.backlight.isBuilt()&&!this.backlight.isAppended();u&&c&&(this.guideline.appendTo(o.hider),this.backlight.appendTo(o.hider));var f=a.from,h=a.to,d=Math.min(f.col,h.col),p=Math.max(f.col,h.col);if(t.row<0&&t.col>=d&&t.col<=p){n.column=!0,s.pressed=!0,s.target.eventPageX=e.pageX,s.coords=t.col,s.target.TD=r,s.target.col=t.col,s.columnsToMove=this.prepareColumnsToMoving(d,p),s.hasRowHeaders=!!this.hot.getSettings().rowHeaders,s.countCols=this.hot.countCols(),s.fixedColumns=this.hot.getSettings().fixedColumnsLeft,s.rootElementOffset=offset(this.hot.rootElement).left;var y=s.hasRowHeaders?-1:0,g=o.holder.scrollTop+o.getColumnHeaderHeight(0)+1,m=t.col<s.fixedColumns,v=this.hot.view.wt.wtOverlays.scrollableElement,_=v.scrollX?v.scrollX-s.rootElementOffset:0,b=e.offsetX-(m?_:0),C=Math.abs(this.getColumnsWidth(d,t.col-1)+b);this.backlight.setPosition(g,this.getColumnsWidth(y,d-1)+C),this.backlight.setSize(this.getColumnsWidth(d,p),o.hider.offsetHeight-g),this.backlight.setOffset(null,-1*C),addClass(this.hot.rootElement,CSS_ON_MOVING)}else removeClass(this.hot.rootElement,CSS_AFTER_SELECTION),s.pressed=!1,s.columnsToMove.length=0}},{key:"onMouseMove",value:function(e){var t=privatePool$b.get(this);if(t.pressed){if(e.target===this.backlight.element){var r=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout((function(){this.backlight.setPosition(r)}))}t.target.eventPageX=e.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(e,t,r,n){var o=this.hot.getSelectedRangeLast(),i=privatePool$b.get(this);o&&i.pressed&&(i.columnsToMove.indexOf(t.col)>-1?removeClass(this.hot.rootElement,CSS_SHOW_UI):addClass(this.hot.rootElement,CSS_SHOW_UI),n.row=!0,n.column=!0,n.cell=!0,i.coords=t.col,i.target.TD=r)}},{key:"onMouseUp",value:function(){var e=privatePool$b.get(this),t=e.target.col,r=e.columnsToMove.length;if(e.coords=void 0,e.pressed=!1,e.backlightWidth=0,removeClass(this.hot.rootElement,[CSS_ON_MOVING,CSS_SHOW_UI,CSS_AFTER_SELECTION]),this.hot.selection.isSelectedByColumnHeader()&&addClass(this.hot.rootElement,CSS_AFTER_SELECTION),!(r<1||void 0===t)){var n=e.columnsToMove[0],o=this.hot.toPhysicalColumn(n),i=this.dragColumns(e.columnsToMove,t);if(e.columnsToMove.length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize(!0);var a=this.hot.toVisualColumn(o),s=a+r-1;this.hot.selectColumns(a,s)}}}},{key:"onAfterScrollVertically",value:function(){var e=this.hot.view.wt.wtTable,t=e.getColumnHeaderHeight(0)+1+e.holder.scrollTop;this.backlight.setPosition(t),this.backlight.setSize(null,e.hider.offsetHeight-t)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),_get$o(_getPrototypeOf$L(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);function _typeof$W(e){return(_typeof$W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$1I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1B(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1B(e,t,r){return t&&_defineProperties$1B(e.prototype,t),r&&_defineProperties$1B(e,r),e}function _get$p(e,t,r){return(_get$p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$p(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$p(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$M(e)););return e}function _inherits$M(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$N(e,t)}function _setPrototypeOf$N(e,t){return(_setPrototypeOf$N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$M(e){var t=_isNativeReflectConstruct$N();return function(){var r,n=_getPrototypeOf$M(e);if(t){var o=_getPrototypeOf$M(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$M(this,r)}}function _possibleConstructorReturn$M(e,t){return!t||"object"!==_typeof$W(t)&&"function"!=typeof t?_assertThisInitialized$M(e):t}function _assertThisInitialized$M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$N(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$M(e){return(_getPrototypeOf$M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}registerPlugin("ManualColumnMove",ManualColumnMove);var PERSISTENT_STATE_KEY$1="manualColumnWidths",privatePool$c=new WeakMap,ManualColumnResize=function(e){_inherits$M(r,e);var t=_createSuper$M(r);function r(e){var n;_classCallCheck$1I(this,r);var o=(n=t.call(this,e)).hot.rootDocument;return n.currentTH=null,n.currentCol=null,n.selectedCols=[],n.currentWidth=null,n.newSize=null,n.startY=null,n.startWidth=null,n.startOffset=null,n.handle=o.createElement("DIV"),n.guide=o.createElement("DIV"),n.eventManager=new EventManager(_assertThisInitialized$M(n)),n.pressed=null,n.dblclick=0,n.autoresizeTimeout=null,n.columnWidthsMap=void 0,privatePool$c.set(_assertThisInitialized$M(n),{config:void 0}),addClass(n.handle,"manualColumnResizer"),addClass(n.guide,"manualColumnResizerGuide"),n}return _createClass$1B(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().manualColumnResize}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.columnWidthsMap=new PhysicalIndexToValueMap,this.columnWidthsMap.addLocalHook("init",(function(){return e.onMapInit()})),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",(function(t,r){return e.onModifyColWidth(t,r)})),this.addHook("beforeStretchingColumnWidth",(function(t,r){return e.onBeforeStretchingColumnWidth(t,r)})),this.addHook("beforeColumnResize",(function(t,r,n){return e.onBeforeColumnResize(t,r,n)})),this.bindEvents(),_get$p(_getPrototypeOf$M(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$p(_getPrototypeOf$M(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){privatePool$c.get(this).config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),_get$p(_getPrototypeOf$M(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",PERSISTENT_STATE_KEY$1,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var e={};return this.hot.runHooks("persistentStateLoad",PERSISTENT_STATE_KEY$1,e),e.value}},{key:"setManualSize",value:function(e,t){var r=Math.max(t,20),n=this.hot.toPhysicalColumn(e);return this.columnWidthsMap.setValueAtIndex(n,r),r}},{key:"clearManualSize",value:function(e){var t=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(t,null)}},{key:"onMapInit",value:function(){var e=this,t=privatePool$c.get(this),r=this.hot.getSettings().manualColumnResize,n=this.loadManualColumnWidths();void 0!==n?this.hot.batch((function(){n.forEach((function(t,r){e.columnWidthsMap.setValueAtIndex(r,t)}))})):Array.isArray(r)?(this.hot.batch((function(){r.forEach((function(t,r){e.columnWidthsMap.setValueAtIndex(r,t)}))})),t.config=r):!0===r&&Array.isArray(t.config)&&this.hot.batch((function(){t.config.forEach((function(t,r){e.columnWidthsMap.setValueAtIndex(r,t)}))}))}},{key:"setupHandlePosition",value:function(e){var t=this;if(e.parentNode){this.currentTH=e;var r=this.hot.view.wt,n=r.wtTable.getCoords(this.currentTH),o=n.col;if(!(o<0)){var i,a=outerHeight(this.currentTH),s=this.currentTH.getBoundingClientRect();o<r.getSetting("fixedColumnsLeft")&&(i=r.wtOverlays.topLeftCornerOverlay.getRelativeCellPosition(this.currentTH,n.row,n.col)),i||(i=r.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,n.row,n.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),this.selectedCols=[];var l=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&l)arrayEach(this.hot.getSelectedRange(),(function(e){rangeEach(e.getTopLeftCorner().col,e.getBottomRightCorner().col,(function(e){t.selectedCols.includes(e)||t.selectedCols.push(e)}))}));this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=i.left-6,this.startWidth=parseInt(s.width,10),this.handle.style.top="".concat(i.top,"px"),this.handle.style.left="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(a,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style.left="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var e=parseInt(outerHeight(this.handle),10),t=parseInt(this.handle.style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);addClass(this.handle,"active"),addClass(this.guide,"active"),this.guide.style.top="".concat(t,"px"),this.guide.style.left=this.handle.style.left,this.guide.style.height="".concat(r-e,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.left=this.handle.style.left}},{key:"hideHandleAndGuide",value:function(){removeClass(this.handle,"active"),removeClass(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(e){if(e!==this.hot.rootElement){var t=e.parentNode;return"THEAD"===t.tagName||this.checkIfColumnHeader(t)}return!1}},{key:"getTHFromTargetElement",value:function(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getTHFromTargetElement(e.parentNode):null}},{key:"onMouseOver",value:function(e){if(this.checkIfColumnHeader(e.target)){var t=this.getTHFromTargetElement(e.target);if(!t)return;var r=t.getAttribute("colspan");!t||null!==r&&1!==r||this.pressed||this.setupHandlePosition(t)}}},{key:"afterMouseDownTimeout",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.wt.wtOverlays.adjustElementsSize(!0)},r=function(r,n){var o=e.hot.runHooks("beforeColumnResize",e.newSize,r,!0);void 0!==o&&(e.newSize=o),"all"===e.hot.getSettings().stretchH?e.clearManualSize(r):e.setManualSize(r,e.newSize),e.saveManualColumnWidths(),e.hot.runHooks("afterColumnResize",e.newSize,r,!0),n&&t()};this.dblclick>=2&&(this.selectedCols.length>1?(arrayEach(this.selectedCols,(function(e){r(e)})),t()):arrayEach(this.selectedCols,(function(e){r(e,!0)})));this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(e){var t=this;hasClass(e.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((function(){return t.afterMouseDownTimeout()}),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=e.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(e){var t=this;this.pressed&&(this.currentWidth=this.startWidth+(e.pageX-this.startX),arrayEach(this.selectedCols,(function(e){t.newSize=t.setManualSize(e,t.currentWidth)})),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.wt.wtOverlays.adjustElementsSize(!0)},r=function(r,n){e.hot.runHooks("beforeColumnResize",e.newSize,r,!1),n&&t(),e.saveManualColumnWidths(),e.hot.runHooks("afterColumnResize",e.newSize,r,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth)this.selectedCols.length>1?(arrayEach(this.selectedCols,(function(e){r(e)})),t()):arrayEach(this.selectedCols,(function(e){r(e,!0)}));this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var e=this,t=this.hot,r=t.rootWindow,n=t.rootElement;this.eventManager.addEventListener(n,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(n,"mousedown",(function(t){return e.onMouseDown(t)})),this.eventManager.addEventListener(r,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(r,"mouseup",(function(){return e.onMouseUp()}))}},{key:"onModifyColWidth",value:function(e,t){var r=e;if(this.enabled){var n=this.hot.toPhysicalColumn(t),o=this.columnWidthsMap.getValueAtIndex(n);this.hot.getSettings().manualColumnResize&&o&&(r=o)}return r}},{key:"onBeforeStretchingColumnWidth",value:function(e,t){var r=this.columnWidthsMap.getValueAtIndex(t);return null===r&&(r=e),r}},{key:"onBeforeColumnResize",value:function(){this.hot.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),_get$p(_getPrototypeOf$M(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);function _classCallCheck$1J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1C(e,t,r){return t&&_defineProperties$1C(e.prototype,t),r&&_defineProperties$1C(e,r),e}registerPlugin("manualColumnResize",ManualColumnResize);var STATE_INITIALIZED$1=0,STATE_BUILT$1=1,STATE_APPENDED$1=2,UNIT$1="px",BaseUI$1=function(){function e(t){_classCallCheck$1J(this,e),this.hot=t,this._element=null,this.state=STATE_INITIALIZED$1}return _createClass$1C(e,[{key:"appendTo",value:function(e){e.appendChild(this._element),this.state=STATE_APPENDED$1}},{key:"build",value:function(){this.state===STATE_INITIALIZED$1&&(this._element=this.hot.rootDocument.createElement("div"),this.state=STATE_BUILT$1)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=STATE_INITIALIZED$1}},{key:"isAppended",value:function(){return this.state===STATE_APPENDED$1}},{key:"isBuilt",value:function(){return this.state>=STATE_BUILT$1}},{key:"setPosition",value:function(e,t){void 0!==e&&(this._element.style.top=e+UNIT$1),void 0!==t&&(this._element.style.left=t+UNIT$1)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(e,t){e&&(this._element.style.width=e+UNIT$1),t&&(this._element.style.height=t+UNIT$1)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(e,t){e&&(this._element.style.marginTop=e+UNIT$1),t&&(this._element.style.marginLeft=t+UNIT$1)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),e}();function _typeof$X(e){return(_typeof$X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$1K(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1D(e,t,r){return t&&_defineProperties$1D(e.prototype,t),r&&_defineProperties$1D(e,r),e}function _get$q(e,t,r){return(_get$q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$q(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$q(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$N(e)););return e}function _inherits$N(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$O(e,t)}function _setPrototypeOf$O(e,t){return(_setPrototypeOf$O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$N(e){var t=_isNativeReflectConstruct$O();return function(){var r,n=_getPrototypeOf$N(e);if(t){var o=_getPrototypeOf$N(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$N(this,r)}}function _possibleConstructorReturn$N(e,t){return!t||"object"!==_typeof$X(t)&&"function"!=typeof t?_assertThisInitialized$N(e):t}function _assertThisInitialized$N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$O(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$N(e){return(_getPrototypeOf$N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var CSS_CLASSNAME$2="ht__manualRowMove--backlight",BacklightUI$1=function(e){_inherits$N(r,e);var t=_createSuper$N(r);function r(){return _classCallCheck$1K(this,r),t.apply(this,arguments)}return _createClass$1D(r,[{key:"build",value:function(){_get$q(_getPrototypeOf$N(r.prototype),"build",this).call(this),addClass(this._element,CSS_CLASSNAME$2)}}]),r}(BaseUI$1);function _typeof$Y(e){return(_typeof$Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$1L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1E(e,t,r){return t&&_defineProperties$1E(e.prototype,t),r&&_defineProperties$1E(e,r),e}function _get$r(e,t,r){return(_get$r="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$r(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$r(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$O(e)););return e}function _inherits$O(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$P(e,t)}function _setPrototypeOf$P(e,t){return(_setPrototypeOf$P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$O(e){var t=_isNativeReflectConstruct$P();return function(){var r,n=_getPrototypeOf$O(e);if(t){var o=_getPrototypeOf$O(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$O(this,r)}}function _possibleConstructorReturn$O(e,t){return!t||"object"!==_typeof$Y(t)&&"function"!=typeof t?_assertThisInitialized$O(e):t}function _assertThisInitialized$O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$P(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$O(e){return(_getPrototypeOf$O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var CSS_CLASSNAME$3="ht__manualRowMove--guideline",GuidelineUI$1=function(e){_inherits$O(r,e);var t=_createSuper$O(r);function r(){return _classCallCheck$1L(this,r),t.apply(this,arguments)}return _createClass$1E(r,[{key:"build",value:function(){_get$r(_getPrototypeOf$O(r.prototype),"build",this).call(this),addClass(this._element,CSS_CLASSNAME$3)}}]),r}(BaseUI$1);function _typeof$Z(e){return(_typeof$Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$1M(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1F(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1F(e,t,r){return t&&_defineProperties$1F(e.prototype,t),r&&_defineProperties$1F(e,r),e}function _get$s(e,t,r){return(_get$s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$s(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$s(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$P(e)););return e}function _inherits$P(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$Q(e,t)}function _setPrototypeOf$Q(e,t){return(_setPrototypeOf$Q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$P(e){var t=_isNativeReflectConstruct$Q();return function(){var r,n=_getPrototypeOf$P(e);if(t){var o=_getPrototypeOf$P(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$P(this,r)}}function _possibleConstructorReturn$P(e,t){return!t||"object"!==_typeof$Z(t)&&"function"!=typeof t?_assertThisInitialized$P(e):t}function _assertThisInitialized$P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$Q(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$P(e){return(_getPrototypeOf$P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Hooks.getSingleton().register("beforeRowMove"),Hooks.getSingleton().register("afterRowMove");var privatePool$d=new WeakMap,CSS_PLUGIN$1="ht__manualRowMove",CSS_SHOW_UI$1="show-ui",CSS_ON_MOVING$1="on-moving--rows",CSS_AFTER_SELECTION$1="after-selection--rows",ManualRowMove=function(e){_inherits$P(r,e);var t=_createSuper$P(r);function r(e){var n;return _classCallCheck$1M(this,r),n=t.call(this,e),privatePool$d.set(_assertThisInitialized$P(n),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),n.eventManager=new EventManager(_assertThisInitialized$P(n)),n.backlight=new BacklightUI$1(e),n.guideline=new GuidelineUI$1(e),n}return _createClass$1F(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().manualRowMove}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(t,r,n,o){return e.onBeforeOnCellMouseDown(t,r,n,o)})),this.addHook("beforeOnCellMouseOver",(function(t,r,n,o){return e.onBeforeOnCellMouseOver(t,r,n,o)})),this.addHook("afterScrollHorizontally",(function(){return e.onAfterScrollHorizontally()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData()})),this.buildPluginUI(),this.registerEvents(),addClass(this.hot.rootElement,CSS_PLUGIN$1),_get$s(_getPrototypeOf$P(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),_get$s(_getPrototypeOf$P(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){removeClass(this.hot.rootElement,CSS_PLUGIN$1),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),_get$s(_getPrototypeOf$P(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(e,t){return this.moveRows([e],t)}},{key:"moveRows",value:function(e,t){var r=privatePool$d.get(this),n=r.cachedDropIndex,o=this.isMovePossible(e,t),i=this.hot.runHooks("beforeRowMove",e,t,n,o);if(r.cachedDropIndex=void 0,!1!==i){o&&this.hot.rowIndexMapper.moveIndexes(e,t);var a=o&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,n,o,a),a}}},{key:"dragRow",value:function(e,t){return this.dragRows([e],t)}},{key:"dragRows",value:function(e,t){var r=this.countFinalIndex(e,t);return privatePool$d.get(this).cachedDropIndex=t,this.moveRows(e,r)}},{key:"isMovePossible",value:function(e,t){var r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),n=e.length+t>r,o=t<0,i=e.some((function(e){return e<0})),a=e.some((function(e){return e>=r}));return!(n||o||i||a)}},{key:"isRowOrderChanged",value:function(e,t){return e.some((function(e,r){return e-r!==t}))}},{key:"countFinalIndex",value:function(e,t){var r=arrayReduce(e,(function(e,r){return r<t&&(e+=1),e}),0);return t-r}},{key:"getRowsHeight",value:function(e,t){for(var r=this.hot.rowIndexMapper,n=0,o=e;o<=t;o++){var i=r.getRenderableFromVisualIndex(o);null!==i&&(n+=this.hot.view.wt.wtTable.getRowHeight(i)||23)}return n}},{key:"moveBySettingsOrLoad",value:function(){var e=this.hot.getSettings().manualRowMove;if(Array.isArray(e))this.moveRows(e,0);else if(void 0!==e){var t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}},{key:"isFixedRowTop",value:function(e){return e<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(e){return e>this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}},{key:"prepareRowsToMoving",value:function(){var e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;var r=e.from,n=e.to;return rangeEach(Math.min(r.row,n.row),Math.max(r.row,n.row),(function(e){t.push(e)})),t}},{key:"refreshPositions",value:function(){var e=privatePool$d.get(this),t=e.target.coords,r=this.hot.view.wt.wtTable.getFirstVisibleRow(),n=this.hot.view.wt.wtTable.getLastVisibleRow(),o=this.hot.getSettings().fixedRowsTop,i=this.hot.countRows();t.row<o&&r>0&&this.hot.scrollViewportTo(r-1),t.row>=n&&n<i&&this.hot.scrollViewportTo(n+1,void 0,!0);var a=this.hot.view.wt.wtTable,s=e.target.TD,l=offset(this.hot.rootElement),u=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1),c=e.target.eventPageY-l.top+a.holder.scrollTop,f=a.hider.offsetHeight,h=a.TBODY.offsetTop,d=this.backlight.getOffset().top,p=this.backlight.getSize().height;this.isFixedRowTop(t.row)&&(u+=a.holder.scrollTop),t.row<0?e.target.row=r>0?r-1:r:s.offsetHeight/2+u<=c?(e.target.row=t.row+1,u+=0===t.row?s.offsetHeight-1:s.offsetHeight):e.target.row=t.row;var y=c,g=u;c+p+d>=f?y=f-p-d:c+d<h&&(y=h+Math.abs(d)),u>=f-1&&(g=f-1);var m=0;this.hot.view.wt.wtOverlays.topOverlay&&(m=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.TABLE.offsetHeight),t.row>=o&&g-a.holder.scrollTop<m&&this.hot.scrollViewportTo(t.row),this.backlight.setPosition(y),this.guideline.setPosition(g)}},{key:"registerEvents",value:function(){var e=this,t=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(t,"mousemove",(function(t){return e.onMouseMove(t)})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()}))}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(e,t,r,n){var o=this.hot.view.wt,i=o.wtTable,a=o.wtViewport,s=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast(),u=privatePool$d.get(this);if(!l||!s||u.pressed||0!==e.button)return u.pressed=!1,u.rowsToMove.length=0,void removeClass(this.hot.rootElement,[CSS_ON_MOVING$1,CSS_SHOW_UI$1]);var c=this.guideline.isBuilt()&&!this.guideline.isAppended(),f=this.backlight.isBuilt()&&!this.backlight.isAppended();c&&f&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));var h=l.from,d=l.to,p=Math.min(h.row,d.row),y=Math.max(h.row,d.row);if(t.col<0&&t.row>=p&&t.row<=y){n.row=!0,u.pressed=!0,u.target.eventPageY=e.pageY,u.target.coords=t,u.target.TD=r,u.rowsToMove=this.prepareRowsToMoving();var g=i.holder.scrollLeft+a.getRowHeaderWidth();this.backlight.setPosition(null,g),this.backlight.setSize(i.hider.offsetWidth-g,this.getRowsHeight(p,y)),this.backlight.setOffset(-1*(this.getRowsHeight(p,t.row-1)+e.offsetY),null),addClass(this.hot.rootElement,CSS_ON_MOVING$1),this.refreshPositions()}else removeClass(this.hot.rootElement,CSS_AFTER_SELECTION$1),u.pressed=!1,u.rowsToMove.length=0}},{key:"onMouseMove",value:function(e){var t=privatePool$d.get(this);if(t.pressed){if(e.target===this.backlight.element){var r=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout((function(){this.backlight.setPosition(null,r)}))}t.target.eventPageY=e.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(e,t,r,n){var o=this.hot.getSelectedRangeLast(),i=privatePool$d.get(this);o&&i.pressed&&(i.rowsToMove.indexOf(t.row)>-1?removeClass(this.hot.rootElement,CSS_SHOW_UI$1):addClass(this.hot.rootElement,CSS_SHOW_UI$1),n.row=!0,n.column=!0,n.cell=!0,i.target.coords=t,i.target.TD=r)}},{key:"onMouseUp",value:function(){var e=privatePool$d.get(this),t=e.target.row,r=e.rowsToMove.length;if(e.pressed=!1,e.backlightHeight=0,removeClass(this.hot.rootElement,[CSS_ON_MOVING$1,CSS_SHOW_UI$1,CSS_AFTER_SELECTION$1]),this.hot.selection.isSelectedByRowHeader()&&addClass(this.hot.rootElement,CSS_AFTER_SELECTION$1),!(r<1||void 0===t)){var n=e.rowsToMove[0],o=this.hot.toPhysicalRow(n),i=this.dragRows(e.rowsToMove,t);if(e.rowsToMove.length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize(!0);var a=this.hot.toVisualRow(o),s=a+r-1;this.hot.selectRows(a,s)}}}},{key:"onAfterScrollHorizontally",value:function(){var e=this.hot.view.wt.wtTable,t=this.hot.view.wt.wtViewport.getRowHeaderWidth()+e.holder.scrollLeft;this.backlight.setPosition(null,t),this.backlight.setSize(e.hider.offsetWidth-t)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),_get$s(_getPrototypeOf$P(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);function _templateObject4$1(){var e=_taggedTemplateLiteral$5(["The merged cell declared at [",", ",'] has "rowspan" \n      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has "rowspan"\\x20\n      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.']);return _templateObject4$1=function(){return e},e}function _templateObject3$1(){var e=_taggedTemplateLiteral$5(["The merged cell declared at [",", ",'] has both "rowspan" \n      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has both "rowspan"\\x20\n      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.']);return _templateObject3$1=function(){return e},e}function _templateObject2$1(){var e=_taggedTemplateLiteral$5(["The merged cell declared at [",", ","] is positioned \n      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup."],["The merged cell declared at [",", ","] is positioned\\x20\n      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup."]);return _templateObject2$1=function(){return e},e}function _templateObject$5(){var e=_taggedTemplateLiteral$5(["The merged cell declared with {row: ",", col: ",", \n      rowspan: ",", colspan: ","} contains negative values, which is \n      not supported. It will not be added to the collection."],["The merged cell declared with {row: ",", col: ",",\\x20\n      rowspan: ",", colspan: ","} contains negative values, which is\\x20\n      not supported. It will not be added to the collection."]);return _templateObject$5=function(){return e},e}function _taggedTemplateLiteral$5(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _classCallCheck$1N(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1G(e,t,r){return t&&_defineProperties$1G(e.prototype,t),r&&_defineProperties$1G(e,r),e}registerPlugin("ManualRowMove",ManualRowMove);var MergedCellCoords=function(){function e(t,r,n,o){_classCallCheck$1N(this,e),this.row=t,this.col=r,this.rowspan=n,this.colspan=o,this.removed=!1}return _createClass$1G(e,[{key:"normalize",value:function(e){var t=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col)}},{key:"includes",value:function(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}},{key:"includesHorizontally",value:function(e){return this.col<=e&&this.col+this.colspan-1>=e}},{key:"includesVertically",value:function(e){return this.row<=e&&this.row+this.rowspan-1>=e}},{key:"shift",value:function(e,t){var r=e[0]||e[1],n=t+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",i=e[0]?"col":"row",a=Math.min(t,n),s=Math.max(t,n),l=this[i],u=this[i]+this[o]-1;if(l>=t&&(this[i]+=r),r>0)t<=u&&t>l&&(this[o]+=r);else if(r<0){if(a<=l&&s>=u)return this.removed=!0,!1;if(l>=a&&l<=s){var c=s-l+1,f=Math.abs(r)-c;this[i]-=f+r,this[o]-=c}else if(l<=a&&u>=s)this[o]+=r;else if(l<=a&&u>=a&&u<s){var h=u-a+1;this[o]-=h}}return!0}},{key:"isFarther",value:function(e,t){return!e||("down"===t?e.row+e.rowspan-1<this.row+this.rowspan-1:"up"===t?e.row>this.row:"right"===t?e.col+e.colspan-1<this.col+this.colspan-1:"left"===t?e.col>this.col:null)}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return new CellRange(new CellCoords(this.row,this.col),new CellCoords(this.row,this.col),new CellCoords(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(e){return toSingleLine(_templateObject$5(),e.row,e.col,e.rowspan,e.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(e){return toSingleLine(_templateObject2$1(),e.row,e.col)}},{key:"IS_SINGLE_CELL",value:function(e){return toSingleLine(_templateObject3$1(),e.row,e.col)}},{key:"ZERO_SPAN_WARNING",value:function(e){return toSingleLine(_templateObject4$1(),e.row,e.col)}},{key:"containsNegativeValues",value:function(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}},{key:"isSingleCell",value:function(e){return 1===e.colspan&&1===e.rowspan}},{key:"containsZeroSpan",value:function(e){return 0===e.colspan||0===e.rowspan}},{key:"isOutOfBounds",value:function(e,t,r){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=r||e.col+e.colspan-1>=r}}]),e}();function applySpanProperties(e,t,r,n){t?t.row===r&&t.col===n?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function _templateObject$6(){var e=_taggedTemplateLiteral$6(["The merged cell declared at [",", ","], overlaps \n      with the other declared merged cell. The overlapping merged cell was not added to the table, please \n      fix your setup."],["The merged cell declared at [",", ","], overlaps\\x20\n      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20\n      fix your setup."]);return _templateObject$6=function(){return e},e}function _taggedTemplateLiteral$6(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _toConsumableArray$d(e){return _arrayWithoutHoles$d(e)||_iterableToArray$e(e)||_unsupportedIterableToArray$u(e)||_nonIterableSpread$d()}function _nonIterableSpread$d(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$u(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$u(e,t):void 0}}function _iterableToArray$e(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$d(e){if(Array.isArray(e))return _arrayLikeToArray$u(e)}function _arrayLikeToArray$u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$1O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1H(e,t,r){return t&&_defineProperties$1H(e.prototype,t),r&&_defineProperties$1H(e,r),e}var MergedCellsCollection=function(){function e(t){_classCallCheck$1O(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}return _createClass$1H(e,[{key:"get",value:function(e,t){var r=this.mergedCells,n=!1;return arrayEach(r,(function(r){return!(r.row<=e&&r.row+r.rowspan-1>=e&&r.col<=t&&r.col+r.colspan-1>=t)||(n=r,!1)})),n}},{key:"getByRange",value:function(e){var t=this.mergedCells,r=!1;return arrayEach(t,(function(t){return!(t.row<=e.from.row&&t.row+t.rowspan-1>=e.to.row&&t.col<=e.from.col&&t.col+t.colspan-1>=e.to.col)||(r=t)})),r}},{key:"getWithinRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.mergedCells,n=[],o=e;if(!o.includesRange){var i=new CellCoords(o.from.row,o.from.col),a=new CellCoords(o.to.row,o.to.col);o=new CellRange(i,i,a)}return arrayEach(r,(function(e){var r=new CellCoords(e.row,e.col),i=new CellCoords(e.row+e.rowspan-1,e.col+e.colspan-1),a=new CellRange(r,r,i);t?o.overlaps(a)&&n.push(e):o.includesRange(a)&&n.push(e)})),!!n.length&&n}},{key:"add",value:function(t){var r=this.mergedCells,n=t.row,o=t.col,i=t.rowspan,a=t.colspan,s=new MergedCellCoords(n,o,i,a),l=this.get(n,o),u=this.isOverlapping(s);return l||u?(warn(e.IS_OVERLAPPING_WARNING(s)),!1):(this.hot&&s.normalize(this.hot),r.push(s),s)}},{key:"remove",value:function(e,t){var r=this.mergedCells,n=this.get(e,t),o=n?this.mergedCells.indexOf(n):null;return!(!n||!1===o)&&(r.splice(o,1),n)}},{key:"clear",value:function(){var e=this,t=this.mergedCells,r=[],n=[];arrayEach(t,(function(t){var n=e.hot.getCell(t.row,t.col);n&&r.push([n,e.get(t.row,t.col),t.row,t.col])})),this.mergedCells.length=0,arrayEach(r,(function(t,o){rangeEach(0,t.rowspan-1,(function(r){rangeEach(0,t.colspan-1,(function(o){if(0!==o||0!==r){var i=e.hot.getCell(t.row+r,t.col+o);i&&n.push([i,null,null,null])}}))})),r[o][1]=null})),arrayEach(r,(function(e){applySpanProperties.apply(void 0,_toConsumableArray$d(e))})),arrayEach(n,(function(e){applySpanProperties.apply(void 0,_toConsumableArray$d(e))}))}},{key:"isOverlapping",value:function(e){var t=new CellRange(new CellCoords(0,0),new CellCoords(e.row,e.col),new CellCoords(e.row+e.rowspan-1,e.col+e.colspan-1)),r=!1;return arrayEach(this.mergedCells,(function(e){return!new CellRange(new CellCoords(0,0),new CellCoords(e.row,e.col),new CellCoords(e.row+e.rowspan-1,e.col+e.colspan-1)).overlaps(t)||(r=!0,!1)})),r}},{key:"isFirstRenderableMergedCell",value:function(e,t){var r=this.get(e,t);return r&&this.hot.rowIndexMapper.getFirstNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getFirstNotHiddenIndex(r.col,1)===t}},{key:"getFirstRenderableCoords",value:function(e,t){var r=this.get(e,t);if(!r||this.isFirstRenderableMergedCell(e,t))return new CellCoords(e,t);var n=this.hot.rowIndexMapper.getFirstNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getFirstNotHiddenIndex(r.col,1);return new CellCoords(n,o)}},{key:"shiftCollections",value:function(e,t,r){var n=this,o=[0,0];switch(e){case"right":o[0]+=r;break;case"left":o[0]-=r;break;case"down":o[1]+=r;break;case"up":o[1]-=r}arrayEach(this.mergedCells,(function(e){e.shift(o,t)})),rangeEachReverse(this.mergedCells.length-1,0,(function(e){var t=n.mergedCells[e];t&&t.removed&&n.mergedCells.splice(n.mergedCells.indexOf(t),1)}))}}],[{key:"IS_OVERLAPPING_WARNING",value:function(e){return toSingleLine(_templateObject$6(),e.row,e.col)}}]),e}();function _slicedToArray$k(e,t){return _arrayWithHoles$l(e)||_iterableToArrayLimit$k(e,t)||_unsupportedIterableToArray$v(e,t)||_nonIterableRest$l()}function _nonIterableRest$l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$v(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$v(e,t):void 0}}function _arrayLikeToArray$v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$k(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$l(e){if(Array.isArray(e))return e}function _classCallCheck$1P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1I(e,t,r){return t&&_defineProperties$1I(e.prototype,t),r&&_defineProperties$1I(e,r),e}var AutofillCalculations=function(){function e(t){_classCallCheck$1P(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return _createClass$1I(e,[{key:"correctSelectionAreaSize",value:function(e){if(e[0]===e[2]&&e[1]===e[3]){var t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}},{key:"getDirection",value:function(e,t){return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?"down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?"up":t[1]===e[1]&&t[2]===e[2]?"right":"left"}},{key:"snapDragArea",value:function(e,t,r,n){var o=t.slice(0),i=this.getAutofillSize(e,t,r),a=_slicedToArray$k(e,4),s=a[0],l=a[1],u=a[2],c=a[3],f=["up","down"].indexOf(r)>-1?u-s+1:c-l+1,h=i-Math.floor(i/f)*f,d=this.getFarthestCollection(e,t,r,n);if(d)if("down"===r){var p=d.row+d.rowspan-s-h;o[2]+p>=this.plugin.hot.countRows()?o[2]-=h:o[2]+=h?p:0}else if("right"===r){var y=d.col+d.colspan-l-h;o[3]+y>=this.plugin.hot.countCols()?o[3]-=h:o[3]+=h?y:0}else if("up"===r){var g=u-h-d.row+1;o[0]+g<0?o[0]+=h:o[0]-=h?g:0}else if("left"===r){var m=c-h-d.col+1;o[1]+m<0?o[1]+=h:o[1]-=h?m:0}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:n,fillSize:i,dragArea:o,cycleLength:f}),o}},{key:"updateCurrentFillCache",value:function(e){this.currentFillData||(this.currentFillData={}),extend(this.currentFillData,e)}},{key:"getAutofillSize",value:function(e,t,r){var n=_slicedToArray$k(e,4),o=n[0],i=n[1],a=n[2],s=n[3],l=_slicedToArray$k(t,4),u=l[0],c=l[1],f=l[2],h=l[3];switch(r){case"up":return o-u;case"down":return f-a;case"left":return i-c;case"right":return h-s;default:return null}}},{key:"getDragArea",value:function(e,t,r){var n=_slicedToArray$k(e,4),o=n[0],i=n[1],a=n[2],s=n[3],l=_slicedToArray$k(t,4),u=l[0],c=l[1],f=l[2],h=l[3];switch(r){case"up":return[u,c,o-1,s];case"down":return[a+1,i,f,s];case"left":return[u,c,a,i-1];case"right":return[o,s+1,f,h];default:return null}}},{key:"getFarthestCollection",value:function(e,t,r,n){var o=_slicedToArray$k(e,4),i=o[0],a=o[1],s=o[2],l=o[3],u=["up","down"].indexOf(r)>-1,c=u?s:l,f=u?i:a,h=this.getAutofillSize(e,t,r),d=u?s-i+1:l-a+1,p=h-Math.floor(h/d)*d,y=null,g=null,m=null;switch(r){case"up":y="includesVertically",m=c-p+1;break;case"left":y="includesHorizontally",m=c-p+1;break;case"down":y="includesVertically",m=f+p-1;break;case"right":y="includesHorizontally",m=f+p-1}return arrayEach(n,(function(e){e[y](m)&&e.isFarther(g,r)&&(g=e)})),g}},{key:"recreateAfterDataPopulation",value:function(e){if(this.currentFillData){var t=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,n=this.currentFillData.dragDirection,o=function(e,r){switch(n){case"up":return e.row-r>=t.from.row;case"down":return e.row+e.rowspan-1+r<=t.to.row;case"left":return e.col-r>=t.from.column;case"right":return e.col+e.colspan-1+r<=t.to.column;default:return null}},i=0,a=null,s=1;do{for(var l=0;l<r.length;l+=1){if(o(a=r[l],i=s*this.currentFillData.cycleLength))switch(n){case"up":this.plugin.mergedCellsCollection.add({row:a.row-i,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+i,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-i,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+i,colspan:a.colspan})}l===r.length-1&&(s+=1)}}while(o(a,i));this.currentFillData=null,this.plugin.hot.render()}}},{key:"getRangeFromChanges",value:function(e){var t=this,r={min:null,max:null},n={min:null,max:null};return arrayEach(e,(function(e){var o=e[0],i=t.plugin.hot.propToCol(e[1]);(null===r.min||o<r.min)&&(r.min=o),(null===r.max||o>r.max)&&(r.max=o),(null===n.min||i<n.min)&&(n.min=i),(null===n.max||i>n.max)&&(n.max=i)})),{from:{row:r.min,column:n.min},to:{row:r.max,column:n.max}}}},{key:"dragAreaOverlapsCollections",value:function(e,t,r){var n=_slicedToArray$k(this.getDragArea(e,t,r),4),o=n[0],i=n[1],a=n[2],s=n[3],l=new CellCoords(o,i),u=new CellCoords(a,s),c=new CellRange(l,l,u);return!!this.mergedCellsCollection.getWithinRange(c,!0)}}]),e}();function _classCallCheck$1Q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1J(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1J(e,t,r){return t&&_defineProperties$1J(e.prototype,t),r&&_defineProperties$1J(e,r),e}var SelectionCalculations=function(){function e(t){_classCallCheck$1Q(this,e),this.plugin=t,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return _createClass$1J(e,[{key:"snapDelta",value:function(e,t,r){var n=t.to,o=n.row+e.row,i=n.col+e.col;e.row?this.jumpOverMergedCell(e,r,o):e.col&&this.jumpOverMergedCell(e,r,i)}},{key:"jumpOverMergedCell",value:function(e,t,r){var n=e.row||e.col,o=null,i=null,a=null;e.row?(o=t.includesVertically(r),i=t.row,a=t.getLastRow()):e.col&&(o=t.includesHorizontally(r),i=t.col,a=t.getLastColumn()),0!==n&&(n>0?o&&r!==i&&(n+=a-r+1):o&&r!==a&&(n-=r-i+1),e.row?e.row=n:e.col&&(e.col=n))}},{key:"getUpdatedSelectionRange",value:function(e,t){return new CellRange(e.highlight,e.from,new CellCoords(e.to.row+t.row,e.to.col+t.col))}},{key:"getSelectedMergedCellClassName",value:function(e,t,r,n){var o=Math.min(r[0],r[2]),i=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),s=Math.max(r[1],r[3]);if(void 0!==n&&this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t)){var l=this.plugin.mergedCellsCollection.get(e,t);if(l){var u=l.getLastRow(),c=l.getLastColumn();return o<=l.row&&i<=l.col&&a>=u&&s>=c?"".concat(this.fullySelectedMergedCellClassName,"-").concat(n):this.plugin.selectionCalculations.isMergeCellFullySelected(l,this.plugin.hot.getSelectedRange())?"".concat(this.fullySelectedMergedCellClassName,"-multiple"):void 0}}}},{key:"isMergeCellFullySelected",value:function(e,t){var r=[];if(!t||!e)return!1;for(var n=0;n<e.rowspan;n+=1)for(var o=0;o<e.colspan;o+=1)r.push(new CellCoords(e.row+n,e.col+o));for(var i=0;i<r.length;i+=1){for(var a=[],s=0;s<t.length;s+=1)a[s]=t[s].includes(r[i]);if(!a.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var e=[],t=0;t<=7;t+=1)e.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(t));return e.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),e}}]),e}();function toggleMergeItem(e){return{key:"mergeCells",name:function(){var t=this.getSelectedLast();if(t){var r=e.mergedCellsCollection.get(t[0],t[1]);if(r.row===t[0]&&r.col===t[1]&&r.row+r.rowspan-1===t[2]&&r.col+r.colspan-1===t[3])return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_MERGE_CELLS)},callback:function(){e.toggleMergeOnSelection()},disabled:function(){var e=this.getSelectedLast();return!e||(MergedCellCoords.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner())},hidden:!1}}function _typeof$_(e){return(_typeof$_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _slicedToArray$l(e,t){return _arrayWithHoles$m(e)||_iterableToArrayLimit$l(e,t)||_unsupportedIterableToArray$w(e,t)||_nonIterableRest$m()}function _nonIterableRest$m(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit$l(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$m(e){if(Array.isArray(e))return e}function _toConsumableArray$e(e){return _arrayWithoutHoles$e(e)||_iterableToArray$f(e)||_unsupportedIterableToArray$w(e)||_nonIterableSpread$e()}function _nonIterableSpread$e(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$w(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$w(e,t):void 0}}function _iterableToArray$f(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$e(e){if(Array.isArray(e))return _arrayLikeToArray$w(e)}function _arrayLikeToArray$w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$1R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1K(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1K(e,t,r){return t&&_defineProperties$1K(e.prototype,t),r&&_defineProperties$1K(e,r),e}function _get$t(e,t,r){return(_get$t="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$t(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$t(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$Q(e)););return e}function _inherits$Q(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$R(e,t)}function _setPrototypeOf$R(e,t){return(_setPrototypeOf$R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$Q(e){var t=_isNativeReflectConstruct$R();return function(){var r,n=_getPrototypeOf$Q(e);if(t){var o=_getPrototypeOf$Q(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$Q(this,r)}}function _possibleConstructorReturn$Q(e,t){return!t||"object"!==_typeof$_(t)&&"function"!=typeof t?_assertThisInitialized$Q(e):t}function _assertThisInitialized$Q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$R(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$Q(e){return(_getPrototypeOf$Q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Hooks.getSingleton().register("beforeMergeCells"),Hooks.getSingleton().register("afterMergeCells"),Hooks.getSingleton().register("beforeUnmergeCells"),Hooks.getSingleton().register("afterUnmergeCells");var privatePool$e=new WeakMap,MergeCells=function(e){_inherits$Q(r,e);var t=_createSuper$Q(r);function r(e){var n;return _classCallCheck$1R(this,r),n=t.call(this,e),privatePool$e.set(_assertThisInitialized$Q(n),{lastDesiredCoords:null}),n.mergedCellsCollection=null,n.autofillCalculations=null,n.selectionCalculations=null,n}return _createClass$1K(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().mergeCells}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.mergedCellsCollection=new MergedCellsCollection(this),this.autofillCalculations=new AutofillCalculations(this),this.selectionCalculations=new SelectionCalculations(this),this.addHook("afterInit",(function(){return e.onAfterInit.apply(e,arguments)})),this.addHook("beforeKeyDown",(function(){return e.onBeforeKeyDown.apply(e,arguments)})),this.addHook("modifyTransformStart",(function(){return e.onModifyTransformStart.apply(e,arguments)})),this.addHook("afterModifyTransformStart",(function(){return e.onAfterModifyTransformStart.apply(e,arguments)})),this.addHook("modifyTransformEnd",(function(){return e.onModifyTransformEnd.apply(e,arguments)})),this.addHook("modifyGetCellCoords",(function(){return e.onModifyGetCellCoords.apply(e,arguments)})),this.addHook("beforeSetRangeStart",(function(){return e.onBeforeSetRangeStart.apply(e,arguments)})),this.addHook("beforeSetRangeStartOnly",(function(){return e.onBeforeSetRangeStart.apply(e,arguments)})),this.addHook("beforeSetRangeEnd",(function(){return e.onBeforeSetRangeEnd.apply(e,arguments)})),this.addHook("afterIsMultipleSelection",(function(){return e.onAfterIsMultipleSelection.apply(e,arguments)})),this.addHook("afterRenderer",(function(){return e.onAfterRenderer.apply(e,arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return e.addMergeActionsToContextMenu.apply(e,arguments)})),this.addHook("afterGetCellMeta",(function(){return e.onAfterGetCellMeta.apply(e,arguments)})),this.addHook("afterViewportRowCalculatorOverride",(function(){return e.onAfterViewportRowCalculatorOverride.apply(e,arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return e.onAfterViewportColumnCalculatorOverride.apply(e,arguments)})),this.addHook("modifyAutofillRange",(function(){return e.onModifyAutofillRange.apply(e,arguments)})),this.addHook("afterCreateCol",(function(){return e.onAfterCreateCol.apply(e,arguments)})),this.addHook("afterRemoveCol",(function(){return e.onAfterRemoveCol.apply(e,arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow.apply(e,arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow.apply(e,arguments)})),this.addHook("afterChange",(function(){return e.onAfterChange.apply(e,arguments)})),this.addHook("beforeDrawBorders",(function(){return e.onBeforeDrawAreaBorders.apply(e,arguments)})),this.addHook("afterDrawSelection",(function(){return e.onAfterDrawSelection.apply(e,arguments)})),this.addHook("beforeRemoveCellClassNames",(function(){return e.onBeforeRemoveCellClassNames.apply(e,arguments)})),_get$t(_getPrototypeOf$Q(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.hot.render(),_get$t(_getPrototypeOf$Q(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var e=this.hot.getSettings().mergeCells;this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),_get$t(_getPrototypeOf$Q(r.prototype),"updatePlugin",this).call(this)}},{key:"validateSetting",value:function(e){var t=!0;return!!e&&(MergedCellCoords.containsNegativeValues(e)?(warn(MergedCellCoords.NEGATIVE_VALUES_WARNING(e)),t=!1):MergedCellCoords.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(warn(MergedCellCoords.IS_OUT_OF_BOUNDS_WARNING(e)),t=!1):MergedCellCoords.isSingleCell(e)?(warn(MergedCellCoords.IS_SINGLE_CELL(e)),t=!1):MergedCellCoords.containsZeroSpan(e)&&(warn(MergedCellCoords.ZERO_SPAN_WARNING(e)),t=!1),t)}},{key:"generateFromSettings",value:function(e){var t=this;if(Array.isArray(e)){var r,n=[];arrayEach(e,(function(e){if(t.validateSetting(e)){var r=new CellCoords(e.row,e.col),o=new CellCoords(e.row+e.rowspan-1,e.col+e.colspan-1),i=new CellRange(r,r,o);n.push(t.mergeRange(i,!0,!0))}})),n=n.filter((function(e){return!0!==e}));var o=this.getBulkCollectionData(n);(r=this.hot).populateFromArray.apply(r,_toConsumableArray$e(o))}}},{key:"getBulkCollectionData",value:function(e){var t,r=this.getBulkCollectionDataRange(e),n=(t=this.hot).getData.apply(t,_toConsumableArray$e(r)).splice(0);return arrayEach(e,(function(e){var t=_slicedToArray$l(e,3),o=t[0],i=t[1];arrayEach(t[2],(function(e,t){arrayEach(e,(function(e,a){n[o-r[0]+t][i-r[1]+a]=e}))}))})),[r[0],r[1],n]}},{key:"getBulkCollectionDataRange",value:function(e){var t=[0,0],r=[0,0],n=null,o=null,i=null;return arrayEach(e,(function(e){n=e[0],o=e[1],i=e[2],t[0]=Math.min(n,t[0]),t[1]=Math.min(o,t[1]),r[0]=Math.max(n+i.length-1,r[0]),r[1]=Math.max(o+i[0].length-1,r[1])})),[].concat(t,r)}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!t||this.validateSetting(e)}},{key:"toggleMergeOnSelection",value:function(){var e=this.hot.getSelectedRangeLast();if(e){e.setDirection("NW-SE");var t=e.from,r=e.to;this.toggleMerge(e),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}}},{key:"mergeSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(e){e.setDirection("NW-SE");var t=e.from,r=e.to;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}}},{key:"unmergeSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(e){var t=e.from,r=e.to;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}}},{key:"mergeRange",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=e.getTopLeftCorner(),i=e.getBottomRightCorner(),a={row:o.row,col:o.col,rowspan:i.row-o.row+1,colspan:i.col-o.col+1},s=[],l=null;if(!this.canMergeRange(a,r))return!1;this.hot.runHooks("beforeMergeCells",e,r),rangeEach(0,a.rowspan-1,(function(e){rangeEach(0,a.colspan-1,(function(r){var n=null;s[e]||(s[e]=[]),0===e&&0===r?n=t.hot.getDataAtCell(a.row,a.col):t.hot.setCellMeta(a.row+e,a.col+r,"hidden",!0),s[e][r]=n}))})),this.hot.setCellMeta(a.row,a.col,"spanned",!0);var u=this.mergedCellsCollection.add(a);return!u||(n?l=[a.row,a.col,s]:this.hot.populateFromArray(a.row,a.col,s,void 0,void 0,this.pluginName),this.hot.runHooks("afterMergeCells",e,a,r),l)}},{key:"unmergeRange",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.mergedCellsCollection.getWithinRange(e);n&&(this.hot.runHooks("beforeUnmergeCells",e,r),arrayEach(n,(function(e){t.mergedCellsCollection.remove(e.row,e.col),rangeEach(0,e.rowspan-1,(function(r){rangeEach(0,e.colspan-1,(function(n){t.hot.removeCellMeta(e.row+r,e.col+n,"hidden")}))})),t.hot.removeCellMeta(e.row,e.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",e,r),this.hot.render())}},{key:"toggleMerge",value:function(e){var t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}},{key:"merge",value:function(e,t,r,n){var o=new CellCoords(e,t),i=new CellCoords(r,n);this.mergeRange(new CellRange(o,o,i))}},{key:"unmerge",value:function(e,t,r,n){var o=new CellCoords(e,t),i=new CellCoords(r,n);this.unmergeRange(new CellRange(o,o,i))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings().mergeCells),this.hot.render()}},{key:"onBeforeKeyDown",value:function(e){(e.ctrlKey||e.metaKey)&&!e.altKey&&77===e.keyCode&&(this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render(),stopImmediatePropagation(e))}},{key:"onAfterIsMultipleSelection",value:function(e){if(e)for(var t=this.mergedCellsCollection.mergedCells,r=this.hot.getSelectedRangeLast(),n=0;n<t.length;n+=1)if(r.from.row===t[n].row&&r.from.col===t[n].col&&r.to.row===t[n].row+t[n].rowspan-1&&r.to.col===t[n].col+t[n].colspan-1)return!1;return e}},{key:"onModifyTransformStart",value:function(e){var t,r=privatePool$e.get(this),n=this.hot.getSelectedRangeLast(),o={row:e.row,col:e.col},i=new CellCoords(n.highlight.row,n.highlight.col),a=this.mergedCellsCollection.get(i.row,i.col);if(r.lastDesiredCoords||(r.lastDesiredCoords=new CellCoords(null,null)),a){var s=new CellCoords(a.row,a.col),l=new CellCoords(a.row+a.rowspan-1,a.col+a.colspan-1);new CellRange(s,s,l).includes(r.lastDesiredCoords)||(r.lastDesiredCoords=new CellCoords(null,null)),o.row=r.lastDesiredCoords.row?r.lastDesiredCoords.row-i.row:o.row,o.col=r.lastDesiredCoords.col?r.lastDesiredCoords.col-i.col:o.col,e.row>0?o.row=a.row+a.rowspan-1-i.row+e.row:e.row<0&&(o.row=i.row-a.row+e.row),e.col>0?o.col=a.col+a.colspan-1-i.col+e.col:e.col<0&&(o.col=i.col-a.col+e.col)}t=new CellCoords(n.highlight.row+o.row,n.highlight.col+o.col);var u=this.mergedCellsCollection.get(t.row,t.col);if(u){var c=this.mergedCellsCollection.getFirstRenderableCoords(u.row,u.col);r.lastDesiredCoords=t,o={row:c.row-i.row,col:c.col-i.col}}0!==o.row&&(e.row=o.row),0!==o.col&&(e.col=o.col)}},{key:"onModifyTransformEnd",value:function(e){var t=this,r=this.hot.getSelectedRangeLast(),n=clone(e),o=this.selectionCalculations.getUpdatedSelectionRange(r,e),i=clone(n),a=this.mergedCellsCollection.getWithinRange(o,!0);do{i=clone(n),this.selectionCalculations.getUpdatedSelectionRange(r,n),arrayEach(a,(function(e){t.selectionCalculations.snapDelta(n,r,e)}))}while(n.row!==i.row||n.col!==i.col);e.row=n.row,e.col=n.col}},{key:"onModifyGetCellCoords",value:function(e,t){if(!(e<0||t<0)){var r=this.mergedCellsCollection.get(e,t);if(r){var n=r.row,o=r.col,i=r.colspan;return[n,o,n+r.rowspan-1,o+i-1]}}}},{key:"addMergeActionsToContextMenu",value:function(e){e.items.push({name:"---------"},toggleMergeItem(this))}},{key:"onAfterRenderer",value:function(e,t,r){var n=this.mergedCellsCollection.get(t,r),o=isObject$1(n)?clone(n):void 0;if(isObject$1(o)){var i=this.hot,a=i.rowIndexMapper,s=i.columnIndexMapper,l=o.row,u=o.col,c=o.colspan,f=o.rowspan,h=_slicedToArray$l(this.translateMergedCellToRenderable(l,f,u,c),2),d=h[0],p=h[1],y=d-a.getRenderableFromVisualIndex(t)+1,g=p-s.getRenderableFromVisualIndex(r)+1;o.row=a.getFirstNotHiddenIndex(o.row,1),o.col=s.getFirstNotHiddenIndex(o.col,1),o.rowspan=Math.min(o.rowspan,y),o.colspan=Math.min(o.colspan,g)}applySpanProperties(e,o,t,r)}},{key:"onBeforeSetRangeStart",value:function(e){if(this.mergedCellsCollection.isFirstRenderableMergedCell(e.row,e.col)){var t=this.mergedCellsCollection.get(e.row,e.col),r=[t.row,t.col];e.row=r[0],e.col=r[1]}}},{key:"onBeforeSetRangeEnd",value:function(e){var t=this.hot.getSelectedRangeLast();t.highlight=new CellCoords(t.highlight.row,t.highlight.col),t.to=e;var r=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{r=!1;for(var n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1){var o=this.mergedCellsCollection.mergedCells[n].getRange();t.expandByRange(o)&&(e.row=t.to.row,e.col=t.to.col,r=!0)}}while(r)}},{key:"onAfterGetCellMeta",value:function(e,t,r){var n=this.mergedCellsCollection.get(e,t);n&&(n.row!==e||n.col!==t?r.copyable=!1:(r.rowspan=n.rowspan,r.colspan=n.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(e){var t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}},{key:"modifyViewportRowStart",value:function(e,t){for(var r=this.hot.rowIndexMapper,n=r.getVisualFromRenderableIndex(e.startRow),o=0;o<t;o+=1){var i=this.mergedCellsCollection.get(n,o);if(isObject$1(i)){var a=r.getRenderableFromVisualIndex(r.getFirstNotHiddenIndex(i.row,1));if(a<e.startRow)return e.startRow=a,void this.modifyViewportRowStart(e,t)}}}},{key:"modifyViewportRowEnd",value:function(e,t){for(var r=this.hot.rowIndexMapper,n=r.getVisualFromRenderableIndex(e.endRow),o=0;o<t;o+=1){var i=this.mergedCellsCollection.get(n,o);if(isObject$1(i)){var a=i.row+i.rowspan-1,s=r.getRenderableFromVisualIndex(r.getFirstNotHiddenIndex(a,-1));if(s>e.endRow)return e.endRow=s,void this.modifyViewportRowEnd(e,t)}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(e){var t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}},{key:"modifyViewportColumnStart",value:function(e,t){for(var r=this.hot.columnIndexMapper,n=r.getVisualFromRenderableIndex(e.startColumn),o=0;o<t;o+=1){var i=this.mergedCellsCollection.get(o,n);if(isObject$1(i)){var a=r.getRenderableFromVisualIndex(r.getFirstNotHiddenIndex(i.col,1));if(a<e.startColumn)return e.startColumn=a,void this.modifyViewportColumnStart(e,t)}}}},{key:"modifyViewportColumnEnd",value:function(e,t){for(var r=this.hot.columnIndexMapper,n=r.getVisualFromRenderableIndex(e.endColumn),o=0;o<t;o+=1){var i=this.mergedCellsCollection.get(o,n);if(isObject$1(i)){var a=i.col+i.colspan-1,s=r.getRenderableFromVisualIndex(r.getFirstNotHiddenIndex(a,-1));if(s>e.endColumn)return e.endColumn=s,void this.modifyViewportColumnEnd(e,t)}}}},{key:"translateMergedCellToRenderable",value:function(e,t,r,n){var o,i,a=this.hot,s=a.rowIndexMapper,l=a.columnIndexMapper;return o=0===t?s.getFirstNotHiddenIndex(e,1):s.getFirstNotHiddenIndex(e+t-1,-1),i=0===n?l.getFirstNotHiddenIndex(r,1):l.getFirstNotHiddenIndex(r+n-1,-1),[e>=0?s.getRenderableFromVisualIndex(o):e,r>=0?l.getRenderableFromVisualIndex(i):r]}},{key:"onModifyAutofillRange",value:function(e,t){this.autofillCalculations.correctSelectionAreaSize(t);var r=this.autofillCalculations.getDirection(t,e),n=e;if(this.autofillCalculations.dragAreaOverlapsCollections(t,n,r))return n=t;var o=this.mergedCellsCollection.getWithinRange({from:{row:t[0],col:t[1]},to:{row:t[2],col:t[3]}});return o?n=this.autofillCalculations.snapDragArea(t,n,r,o):n}},{key:"onAfterCreateCol",value:function(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}},{key:"onAfterRemoveCol",value:function(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}},{key:"onAfterCreateRow",value:function(e,t,r){"auto"!==r&&this.mergedCellsCollection.shiftCollections("down",e,t)}},{key:"onAfterRemoveRow",value:function(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}},{key:"onAfterChange",value:function(e,t){"Autofill.fill"===t&&this.autofillCalculations.recreateAfterDataPopulation(e)}},{key:"onBeforeDrawAreaBorders",value:function(e,t){if(t&&"area"===t){var r=this.hot.getSelectedRangeLast();arrayEach(this.mergedCellsCollection.getWithinRange(r),(function(t){r.getBottomRightCorner().row===t.getLastRow()&&r.getBottomRightCorner().col===t.getLastColumn()&&(e[2]=t.row,e[3]=t.col)}))}}},{key:"onAfterModifyTransformStart",value:function(e,t,r){if(this.enabled){var n=this.mergedCellsCollection.get(e.row,e.col);if(n){var o=t>0,i=t<0,a=r<0,s=r>0,l=n.row+n.rowspan-1==this.hot.countRows()-1,u=0===n.row,c=n.col+n.colspan-1==this.hot.countCols()-1,f=0===n.col;(o&&l||i&&u||s&&c||a&&f)&&(e.row=n.row,e.col=n.col)}}}},{key:"onAfterDrawSelection",value:function(e,t,r,n){if(r)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,r,n)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}]),r}(BasePlugin);function _typeof$$(e){return(_typeof$$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$1S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1L(e,t,r){return t&&_defineProperties$1L(e.prototype,t),r&&_defineProperties$1L(e,r),e}function _get$u(e,t,r){return(_get$u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$u(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$u(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$R(e)););return e}function _inherits$R(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$S(e,t)}function _setPrototypeOf$S(e,t){return(_setPrototypeOf$S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$R(e){var t=_isNativeReflectConstruct$S();return function(){var r,n=_getPrototypeOf$R(e);if(t){var o=_getPrototypeOf$R(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$R(this,r)}}function _possibleConstructorReturn$R(e,t){return!t||"object"!==_typeof$$(t)&&"function"!=typeof t?_assertThisInitialized$R(e):t}function _assertThisInitialized$R(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$S(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$R(e){return(_getPrototypeOf$R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}registerPlugin("mergeCells",MergeCells);var MultipleSelectionHandles=function(e){_inherits$R(r,e);var t=_createSuper$R(r);function r(e){var n;return _classCallCheck$1S(this,r),(n=t.call(this,e)).dragged=[],n.eventManager=null,n.lastSetCell=null,n}return _createClass$1L(r,[{key:"isEnabled",value:function(){return isMobileBrowser()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new EventManager(this)),this.registerListeners(),_get$u(_getPrototypeOf$R(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var e=this,t=this,r=this.hot.rootElement;function n(e){if(1===t.dragged.length)return t.dragged.splice(0,t.dragged.length),!0;var r=t.dragged.indexOf(e);if(-1===r)return!1;0===r?t.dragged=t.dragged.slice(0,1):1===r&&(t.dragged=t.dragged.slice(-1))}this.eventManager.addEventListener(r,"touchstart",(function(e){var r;return hasClass(e.target,"topLeftSelectionHandle-HitArea")?(r=t.hot.getSelectedRangeLast(),t.dragged.push("topLeft"),t.touchStartRange={width:r.getWidth(),height:r.getHeight(),direction:r.getDirection()},e.preventDefault(),!1):hasClass(e.target,"bottomRightSelectionHandle-HitArea")?(r=t.hot.getSelectedRangeLast(),t.dragged.push("bottomRight"),t.touchStartRange={width:r.getWidth(),height:r.getHeight(),direction:r.getDirection()},e.preventDefault(),!1):void 0})),this.eventManager.addEventListener(r,"touchend",(function(e){return hasClass(e.target,"topLeftSelectionHandle-HitArea")?(n.call(t,"topLeft"),t.touchStartRange=void 0,e.preventDefault(),!1):hasClass(e.target,"bottomRightSelectionHandle-HitArea")?(n.call(t,"bottomRight"),t.touchStartRange=void 0,e.preventDefault(),!1):void 0})),this.eventManager.addEventListener(r,"touchmove",(function(r){var n,o,i,a,s,l,u=e.hot,c=u.rootWindow,f=u.rootDocument,h=getWindowScrollTop(c),d=getWindowScrollLeft(c);if(0!==t.dragged.length){var p=f.elementFromPoint(r.touches[0].screenX-d,r.touches[0].screenY-h);p&&p!==t.lastSetCell&&("TD"!==p.nodeName&&"TH"!==p.nodeName||(-1===(n=t.hot.getCoords(p)).col&&(n.col=0),i=(o=t.hot.getSelectedRangeLast()).getWidth(),a=o.getHeight(),s=o.getDirection(),1===i&&1===a&&t.hot.selection.setRangeEnd(n),null!==(l=t.getCurrentRangeCoords(o,n,t.touchStartRange.direction,s,t.dragged[0])).start&&t.hot.selection.setRangeStart(l.start),t.hot.selection.setRangeEnd(l.end),t.lastSetCell=p),r.preventDefault())}}))}},{key:"getCurrentRangeCoords",value:function(e,t,r,n,o){var i=e.getTopLeftCorner(),a=e.getBottomRightCorner(),s=e.getBottomLeftCorner(),l=e.getTopRightCorner(),u={start:null,end:null};switch(r){case"NE-SW":switch(n){case"NE-SW":case"NW-SE":u="topLeft"===o?{start:new CellCoords(t.row,e.highlight.col),end:new CellCoords(s.row,t.col)}:{start:new CellCoords(e.highlight.row,t.col),end:new CellCoords(t.row,i.col)};break;case"SE-NW":"bottomRight"===o&&(u={start:new CellCoords(a.row,t.col),end:new CellCoords(t.row,i.col)})}break;case"NW-SE":switch(n){case"NE-SW":"topLeft"===o?u={start:t,end:s}:u.end=t;break;case"NW-SE":"topLeft"===o?u={start:t,end:a}:u.end=t;break;case"SE-NW":"topLeft"===o?u={start:t,end:i}:u.end=t;break;case"SW-NE":"topLeft"===o?u={start:t,end:l}:u.end=t}break;case"SW-NE":switch(n){case"NW-SE":u="bottomRight"===o?{start:new CellCoords(t.row,i.col),end:new CellCoords(s.row,t.col)}:{start:new CellCoords(i.row,t.col),end:new CellCoords(t.row,a.col)};break;case"SW-NE":u="topLeft"===o?{start:new CellCoords(e.highlight.row,t.col),end:new CellCoords(t.row,a.col)}:{start:new CellCoords(t.row,i.col),end:new CellCoords(i.row,t.col)};break;case"SE-NW":"bottomRight"===o?u={start:new CellCoords(t.row,l.col),end:new CellCoords(i.row,t.col)}:"topLeft"===o&&(u={start:s,end:t})}break;case"SE-NW":switch(n){case"NW-SE":case"NE-SW":case"SW-NE":"topLeft"===o&&(u.end=t);break;case"SE-NW":"topLeft"===o?u.end=t:u={start:t,end:i}}}return u}},{key:"isDragged",value:function(){return this.dragged.length>0}}]),r}(BasePlugin);function _toArray$1(e){return _arrayWithHoles$n(e)||_iterableToArray$g(e)||_unsupportedIterableToArray$x(e)||_nonIterableRest$n()}function _nonIterableRest$n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$x(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$x(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$x(e,t):void 0}}function _arrayLikeToArray$x(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArray$g(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithHoles$n(e){if(Array.isArray(e))return e}function rootComparator$1(e,t){return function(r,n){var o=_toArray$1(r).slice(1),i=_toArray$1(n).slice(1);return function r(n){var a=e[n],s=t[n],l=o[n],u=i[n],c=s.multiColumnSorting,f=(c.compareFunctionFactory?c.compareFunctionFactory:getCompareFunctionFactory(s.type))(a,s,c)(l,u);if(f===DO_NOT_SWAP){var h=n+1;if(void 0!==t[h])return r(h)}return f}(0)}}function warnAboutPluginsConflict(){warn("Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously.")}registerPlugin("multipleSelectionHandles",MultipleSelectionHandles);var COLUMN_ORDER_PREFIX="sort";function getClassesToAdd$1(e,t,r){var n=[];return!1===r||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&n.push("".concat(COLUMN_ORDER_PREFIX,"-").concat(e.getIndexOfColumnInSortQueue(t)+1)),n}function getClassedToRemove$1(e){var t=e.className.split(" "),r=new RegExp("^".concat(COLUMN_ORDER_PREFIX,"-[0-9]{1,2}$"));return t.filter((function(e){return r.test(e)}))}function _typeof$10(e){return(_typeof$10="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$1T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1M(e,t,r){return t&&_defineProperties$1M(e.prototype,t),r&&_defineProperties$1M(e,r),e}function _get$v(e,t,r){return(_get$v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$v(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$v(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$S(e)););return e}function _inherits$S(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$T(e,t)}function _setPrototypeOf$T(e,t){return(_setPrototypeOf$T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$S(e){var t=_isNativeReflectConstruct$T();return function(){var r,n=_getPrototypeOf$S(e);if(t){var o=_getPrototypeOf$S(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$S(this,r)}}function _possibleConstructorReturn$S(e,t){return!t||"object"!==_typeof$10(t)&&"function"!=typeof t?_assertThisInitialized$S(e):t}function _assertThisInitialized$S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$T(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$S(e){return(_getPrototypeOf$S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var APPEND_COLUMN_CONFIG_STRATEGY$1="append",PLUGIN_KEY$1="multiColumnSorting",CONFLICTED_PLUGIN_KEY="columnSorting";registerRootComparator(PLUGIN_KEY$1,rootComparator$1);var MultiColumnSorting=function(e){_inherits$S(r,e);var t=_createSuper$S(r);function r(e){var n;return _classCallCheck$1T(this,r),(n=t.call(this,e)).pluginKey=PLUGIN_KEY$1,n}return _createClass$1M(r,[{key:"isEnabled",value:function(){return _get$v(_getPrototypeOf$S(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[CONFLICTED_PLUGIN_KEY]&&warnAboutPluginsConflict(),_get$v(_getPrototypeOf$S(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){_get$v(_getPrototypeOf$S(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(e){_get$v(_getPrototypeOf$S(r.prototype),"sort",this).call(this,e)}},{key:"clearSort",value:function(){_get$v(_getPrototypeOf$S(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return _get$v(_getPrototypeOf$S(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(e){return _get$v(_getPrototypeOf$S(r.prototype),"getSortConfig",this).call(this,e)}},{key:"setSortConfig",value:function(e){_get$v(_getPrototypeOf$S(r.prototype),"setSortConfig",this).call(this,e)}},{key:"getNormalizedSortConfigs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e:[e]}},{key:"updateHeaderClasses",value:function(e){for(var t,n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];(t=_get$v(_getPrototypeOf$S(r.prototype),"updateHeaderClasses",this)).call.apply(t,[this,e].concat(o)),removeClass(e,getClassedToRemove$1(e)),!1!==this.enabled&&addClass(e,getClassesToAdd$1.apply(void 0,o))}},{key:"onUpdateSettings",value:function(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[CONFLICTED_PLUGIN_KEY]&&warnAboutPluginsConflict(),_get$v(_getPrototypeOf$S(r.prototype),"onUpdateSettings",this).call(this,e)}},{key:"onAfterOnCellMouseDown",value:function(e,t){!1!==wasHeaderClickedProperly(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(isPressedCtrlKey()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,APPEND_COLUMN_CONFIG_STRATEGY$1))):this.sort(this.getColumnNextConfig(t.col)))}}]),r}(ColumnSorting);registerPlugin(PLUGIN_KEY$1,MultiColumnSorting);var jsonPatchDuplex=createCommonjsModule((function(e,t){
/*!
     * https://github.com/Starcounter-Jack/JSON-Patch
     * json-patch-duplex.js version: 0.5.7
     * (c) 2013 Joachim Wester
     * MIT license
     */
var r,n=commonjsGlobal&&commonjsGlobal.__extends||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=Error;!function(e){var t=function(e){if(u(e)){for(var t=new Array(e.length),r=0;r<t.length;r++)t[r]=""+r;return t}if(Object.keys)return Object.keys(e);t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};function r(e,n){switch(typeof e){case"undefined":case"boolean":case"string":case"number":return e===n;case"object":if(null===e)return null===n;if(u(e)){if(!u(n)||e.length!==n.length)return!1;for(var o=0,i=e.length;o<i;o++)if(!r(e[o],n[o]))return!1;return!0}var a=t(n).length;if(t(e).length!==a)return!1;for(o=0;o<a;o++)if(!r(e[o],n[o]))return!1;return!0;default:return!1}}var i={add:function(e,t){return e[t]=this.value,!0},remove:function(e,t){return delete e[t],!0},replace:function(e,t){return e[t]=this.value,!0},move:function(e,t,r){var n={op:"_get",path:this.from};return m(r,[n]),m(r,[{op:"remove",path:this.from}]),m(r,[{op:"add",path:this.path,value:n.value}]),!0},copy:function(e,t,r){var n={op:"_get",path:this.from};return m(r,[n]),m(r,[{op:"add",path:this.path,value:n.value}]),!0},test:function(e,t){return r(e[t],this.value)},_get:function(e,t){this.value=e[t]}},a={add:function(e,t){return e.splice(t,0,this.value),!0},remove:function(e,t){return e.splice(t,1),!0},replace:function(e,t){return e[t]=this.value,!0},move:i.move,copy:i.copy,test:i.test,_get:i._get},s={add:function(e){for(var t in s.remove.call(this,e),this.value)this.value.hasOwnProperty(t)&&(e[t]=this.value[t]);return!0},remove:function(e){for(var t in e)e.hasOwnProperty(t)&&i.remove.call(this,e,t);return!0},replace:function(e){return m(e,[{op:"remove",path:this.path}]),m(e,[{op:"add",path:this.path,value:this.value}]),!0},move:i.move,copy:i.copy,test:function(e){return JSON.stringify(e)===JSON.stringify(this.value)},_get:function(e){this.value=e}};function l(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}var u,c=[],f=function(e){this.observers=[],this.obj=e},h=function(e,t){this.callback=e,this.observer=t};function d(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e}function p(e){for(var t,r=0,n=c.length;r<n;r++)if(c[r].obj===e.object){t=c[r];break}y(t.value,e.object,e.patches,""),e.patches.length&&m(t.value,e.patches);var o=e.patches;return o.length>0&&(e.patches=[],e.callback&&e.callback(o)),o}function y(e,r,n,o){for(var i=t(r),a=t(e),s=!1,u=a.length-1;u>=0;u--){var c=e[h=a[u]];if(r.hasOwnProperty(h)){var f=r[h];"object"==typeof c&&null!=c&&"object"==typeof f&&null!=f?y(c,f,n,o+"/"+l(h)):c!=f&&n.push({op:"replace",path:o+"/"+l(h),value:d(f)})}else n.push({op:"remove",path:o+"/"+l(h)}),s=!0}if(s||i.length!=a.length)for(u=0;u<i.length;u++){var h=i[u];e.hasOwnProperty(h)||n.push({op:"add",path:o+"/"+l(h),value:d(r[h])})}}function g(e){for(var t,r=0,n=e.length;r<n;){if(!((t=e.charCodeAt(r))>=48&&t<=57))return!1;r++}return!0}function m(e,t,r){for(var n,o,l=!1,c=0,f=t.length;c<f;){n=t[c],c++;for(var h=(n.path||"").split("/"),d=e,p=1,y=h.length,m=void 0;;){if(o=h[p],r&&void 0===m&&(void 0===d[o]?m=h.slice(0,p).join("/"):p==y-1&&(m=n.path),void 0!==m&&this.validator(n,c-1,e,m)),p++,void 0===o&&p>=y){l=s[n.op].call(n,d,o,e);break}if(u(d)){if("-"===o)o=d.length;else{if(r&&!g(o))throw new v("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",c-1,n.path,n);o=parseInt(o,10)}if(p>=y){if(r&&"add"===n.op&&o>d.length)throw new v("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",c-1,n.path,n);l=a[n.op].call(n,d,o,e);break}}else if(o&&-1!=o.indexOf("~")&&(o=o.replace(/~1/g,"/").replace(/~0/g,"~")),p>=y){l=i[n.op].call(n,d,o,e);break}d=d[o]}}return l}e.unobserve=function(e,t){t.unobserve()},e.observe=function(e,t){var r,n=function(e){for(var t=0,r=c.length;t<r;t++)if(c[t].obj===e)return c[t]}(e);if(n?r=function(e,t){for(var r=0,n=e.observers.length;r<n;r++)if(e.observers[r].callback===t)return e.observers[r].observer}(n,t):(n=new f(e),c.push(n)),r)return r;if(r={},n.value=d(e),t){r.callback=t,r.next=null;var i=this.intervals||[100,1e3,1e4,6e4];if(void 0===i.push)throw new o("jsonpatch.intervals must be an array");var a=0,s=function(){p(r)},l=function(){clearTimeout(r.next),r.next=setTimeout((function(){s(),a=0,r.next=setTimeout(u,i[a++])}),0)},u=function(){s(),a==i.length&&(a=i.length-1),r.next=setTimeout(u,i[a++])};"undefined"!=typeof window&&(window.addEventListener?(window.addEventListener("mousedown",l),window.addEventListener("mouseup",l),window.addEventListener("keydown",l)):(document.documentElement.attachEvent("onmousedown",l),document.documentElement.attachEvent("onmouseup",l),document.documentElement.attachEvent("onkeydown",l))),r.next=setTimeout(u,i[a++])}return r.patches=[],r.object=e,r.unobserve=function(){p(r),clearTimeout(r.next),function(e,t){for(var r=0,n=e.observers.length;r<n;r++)if(e.observers[r].observer===t)return void e.observers.splice(r,1)}(n,r),0===n.observers.length&&c.splice(c.indexOf(n),1),"undefined"!=typeof window&&(window.removeEventListener?(window.removeEventListener("mousedown",l),window.removeEventListener("mouseup",l),window.removeEventListener("keydown",l)):(document.documentElement.detachEvent("onmousedown",l),document.documentElement.detachEvent("onmouseup",l),document.documentElement.detachEvent("onkeydown",l)))},n.observers.push(new h(t,r)),r},e.generate=p,u=Array.isArray?Array.isArray:function(e){return e.push&&"number"==typeof e.length},e.apply=m,e.compare=function(e,t){var r=[];return y(e,t,r,""),r};var v=function(e){function t(t,r,n,o,i){e.call(this,t),this.message=t,this.name=r,this.index=n,this.operation=o,this.tree=i}return n(t,e),t}(o);function _(e){if(void 0===e)return!0;if("array"==typeof e||"object"==typeof e)for(var t in e)if(_(e[t]))return!0;return!1}e.JsonPatchError=v,e.Error=v,e.validator=function(t,r,n,o){if("object"!=typeof t||null===t||u(t))throw new v("Operation is not an object","OPERATION_NOT_AN_OBJECT",r,t,n);if(!i[t.op])throw new v("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",r,t,n);if("string"!=typeof t.path)throw new v("Operation `path` property is not a string","OPERATION_PATH_INVALID",r,t,n);if(("move"===t.op||"copy"===t.op)&&"string"!=typeof t.from)throw new v("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",r,t,n);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&void 0===t.value)throw new v("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",r,t,n);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&_(t.value))throw new v("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",r,t,n);if(n)if("add"==t.op){var a=t.path.split("/").length,s=o.split("/").length;if(a!==s+1&&a!==s)throw new v("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",r,t,n)}else if("replace"===t.op||"remove"===t.op||"_get"===t.op){if(t.path!==o)throw new v("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",r,t,n)}else if("move"===t.op||"copy"===t.op){var l={op:"_get",path:t.from,value:void 0},c=e.validate([l],n);if(c&&"OPERATION_PATH_UNRESOLVABLE"===c.name)throw new v("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",r,t,n)}},e.validate=function(e,t){try{if(!u(e))throw new v("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)t=JSON.parse(JSON.stringify(t)),m.call(this,t,e,!0);else for(var r=0;r<e.length;r++)this.validator(e[r],r)}catch(e){if(e instanceof v)return e;throw e}}}(r||(r={})),t.apply=r.apply,t.observe=r.observe,t.unobserve=r.unobserve,t.generate=r.generate,t.compare=r.compare,t.validate=r.validate,t.validator=r.validator,t.JsonPatchError=r.JsonPatchError,t.Error=r.Error}));function _slicedToArray$m(e,t){return _arrayWithHoles$o(e)||_iterableToArrayLimit$m(e,t)||_unsupportedIterableToArray$y(e,t)||_nonIterableRest$o()}function _nonIterableRest$o(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$y(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$y(e,t):void 0}}function _arrayLikeToArray$y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$m(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$o(e){if(Array.isArray(e))return e}function cleanPatches(e){var t=[],r=arrayFilter(e,(function(e){return!/[/]length/gi.test(e.path)&&!!parsePath(e.path)}));return r=arrayFilter(r=arrayMap(r,(function(e){var t=parsePath(e.path);return e.row=t.row,e.col=t.col,e})),(function(e){if(-1!==["add","remove"].indexOf(e.op)&&!isNaN(e.col)){if(-1!==t.indexOf(e.col))return!1;t.push(e.col)}return!0})),t.length=0,r}function parsePath(e){var t=e.match(/^\/(\d+)\/?(.*)?$/);if(!t)return null;var r=_slicedToArray$m(t,3),n=r[1],o=r[2];return{row:parseInt(n,10),col:/^\d*$/.test(o)?parseInt(o,10):o}}function _classCallCheck$1U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1N(e,t,r){return t&&_defineProperties$1N(e.prototype,t),r&&_defineProperties$1N(e,r),e}var DataObserver=function(){function e(t){_classCallCheck$1U(this,e),this.observedData=null,this.observer=null,this.paused=!1,this.setObservedData(t)}return _createClass$1N(e,[{key:"setObservedData",value:function(e){var t=this;this.observer&&jsonPatchDuplex.unobserve(this.observedData,this.observer),this.observedData=e,this.observer=jsonPatchDuplex.observe(this.observedData,(function(e){return t.onChange(e)}))}},{key:"isPaused",value:function(){return this.paused}},{key:"pause",value:function(){this.paused=!0}},{key:"resume",value:function(){this.paused=!1}},{key:"onChange",value:function(e){this.runLocalHooks("change",cleanPatches(e))}},{key:"destroy",value:function(){jsonPatchDuplex.unobserve(this.observedData,this.observer),this.observedData=null,this.observer=null}}]),e}();function _typeof$11(e){return(_typeof$11="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$1V(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1O(e,t,r){return t&&_defineProperties$1O(e.prototype,t),r&&_defineProperties$1O(e,r),e}function _get$w(e,t,r){return(_get$w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$w(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$w(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$T(e)););return e}function _inherits$T(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$U(e,t)}function _setPrototypeOf$U(e,t){return(_setPrototypeOf$U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$T(e){var t=_isNativeReflectConstruct$U();return function(){var r,n=_getPrototypeOf$T(e);if(t){var o=_getPrototypeOf$T(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$T(this,r)}}function _possibleConstructorReturn$T(e,t){return!t||"object"!==_typeof$11(t)&&"function"!=typeof t?_assertThisInitialized$T(e):t}function _assertThisInitialized$T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$U(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$T(e){return(_getPrototypeOf$T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}mixin(DataObserver,localHooks);var ObserveChanges=function(e){_inherits$T(r,e);var t=_createSuper$T(r);function r(e){var n;return _classCallCheck$1V(this,r),(n=t.call(this,e)).observer=null,n}return _createClass$1O(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().observeChanges}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.observer||(warn("The Observe Changes plugin is deprecated and will be removed in the next major release"),this.observer=new DataObserver(this.hot.getSettings().data),this._exposePublicApi()),this.observer.addLocalHook("change",(function(t){return e.onDataChange(t)})),this.addHook("afterCreateRow",(function(){return e.onAfterTableAlter()})),this.addHook("afterRemoveRow",(function(){return e.onAfterTableAlter()})),this.addHook("afterCreateCol",(function(){return e.onAfterTableAlter()})),this.addHook("afterRemoveCol",(function(){return e.onAfterTableAlter()})),this.addHook("afterChange",(function(t,r){return e.onAfterTableAlter(r)})),this.addHook("afterLoadData",(function(t,r){return e.onAfterLoadData(t,r)})),_get$w(_getPrototypeOf$T(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.observer&&(this.observer.destroy(),this.observer=null,this._deletePublicApi()),_get$w(_getPrototypeOf$T(r.prototype),"disablePlugin",this).call(this)}},{key:"onDataChange",value:function(e){var t=this,r=!1;if(!this.observer.isPaused()){var n="".concat(this.pluginName,".change"),o={add:function(e){var r=[e.row,e.col],o=r[0],i=r[1];isNaN(i)?(t.hot.rowIndexMapper.insertIndexes(o,1),t.hot.runHooks("afterCreateRow",o,1,n)):(t.hot.columnIndexMapper.insertIndexes(i,1),t.hot.runHooks("afterCreateCol",i,1,n))},remove:function(e){var r=[e.row,e.col],o=r[0],i=r[1];isNaN(i)?(t.hot.rowIndexMapper.removeIndexes([o]),t.hot.runHooks("afterRemoveRow",o,1,n)):(t.hot.columnIndexMapper.removeIndexes([i]),t.hot.runHooks("afterRemoveCol",i,1,n))},replace:function(e){t.hot.runHooks("afterChange",[[e.row,e.col,null,e.value]],n)}};arrayEach(e,(function(e){o[e.op]&&o[e.op](e)})),r=!0}this.hot.runHooks("afterChangesObserved"),r&&this.hot.render()}},{key:"onAfterTableAlter",value:function(e){var t=this;"loadData"!==e&&(this.observer.pause(),this.hot.addHookOnce("afterChangesObserved",(function(){return t.observer.resume()})))}},{key:"onAfterLoadData",value:function(e,t){t||this.observer.setObservedData(e)}},{key:"destroy",value:function(){this.observer&&(this.observer.destroy(),this._deletePublicApi()),_get$w(_getPrototypeOf$T(r.prototype),"destroy",this).call(this)}},{key:"_exposePublicApi",value:function(){var e=this,t=this.hot;t.pauseObservingChanges=function(){return e.observer.pause()},t.resumeObservingChanges=function(){return e.observer.resume()},t.isPausedObservingChanges=function(){return e.observer.isPaused()}}},{key:"_deletePublicApi",value:function(){var e=this.hot;delete e.pauseObservingChanges,delete e.resumeObservingChanges,delete e.isPausedObservingChanges}}]),r}(BasePlugin);function _typeof$12(e){return(_typeof$12="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray$f(e){return _arrayWithoutHoles$f(e)||_iterableToArray$h(e)||_unsupportedIterableToArray$z(e)||_nonIterableSpread$f()}function _nonIterableSpread$f(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$z(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$z(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$z(e,t):void 0}}function _iterableToArray$h(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$f(e){if(Array.isArray(e))return _arrayLikeToArray$z(e)}function _arrayLikeToArray$z(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$1W(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1P(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1P(e,t,r){return t&&_defineProperties$1P(e.prototype,t),r&&_defineProperties$1P(e,r),e}function _get$x(e,t,r){return(_get$x="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$x(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$x(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$U(e)););return e}function _inherits$U(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$V(e,t)}function _setPrototypeOf$V(e,t){return(_setPrototypeOf$V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$U(e){var t=_isNativeReflectConstruct$V();return function(){var r,n=_getPrototypeOf$U(e);if(t){var o=_getPrototypeOf$U(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$U(this,r)}}function _possibleConstructorReturn$U(e,t){return!t||"object"!==_typeof$12(t)&&"function"!=typeof t?_assertThisInitialized$U(e):t}function _assertThisInitialized$U(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$V(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$U(e){return(_getPrototypeOf$U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}registerPlugin("observeChanges",ObserveChanges);var DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",DEFAULT_CALLBACK=function(e,t,r,n,o){e.getCellMeta(t,r).isSearchResult=o},DEFAULT_QUERY_METHOD=function(e,t){return!(isUndefined(e)||null===e||!e.toLowerCase||0===e.length)&&(!isUndefined(t)&&null!==t&&-1!==t.toString().toLowerCase().indexOf(e.toLowerCase()))},Search=function(e){_inherits$U(r,e);var t=_createSuper$U(r);function r(e){var n;return _classCallCheck$1W(this,r),(n=t.call(this,e)).callback=DEFAULT_CALLBACK,n.queryMethod=DEFAULT_QUERY_METHOD,n.searchResultClass=DEFAULT_SEARCH_RESULT_CLASS,n}return _createClass$1P(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().search}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().search;this.updatePluginSettings(t),this.addHook("beforeRenderer",(function(){return e.onBeforeRenderer.apply(e,arguments)})),_get$x(_getPrototypeOf$U(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var e=this,t=function(){return e.onBeforeRenderer.apply(e,arguments)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterRender",(function(){e.hot.removeHook("beforeRenderer",t)})),_get$x(_getPrototypeOf$U(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$x(_getPrototypeOf$U(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod(),o=this.hot.countRows(),i=this.hot.countCols(),a=[],s=this.hot;return rangeEach(0,o-1,(function(o){rangeEach(0,i-1,(function(i){var l=t.hot.getDataAtCell(o,i),u=t.hot.getCellMeta(o,i),c=u.search.callback||r,f=(u.search.queryMethod||n)(e,l,u);if(f){var h={row:o,col:i,data:l};a.push(h)}c&&c(s,o,i,l,f)}))})),a}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(e){this.callback=e}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(e){this.queryMethod=e}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(e){this.searchResultClass=e}},{key:"updatePluginSettings",value:function(e){isObject$1(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}},{key:"onBeforeRenderer",value:function(e,t,r,n,o,i){var a,s=i.className||[],l=[];"string"==typeof s?l=s.split(" "):(a=l).push.apply(a,_toConsumableArray$f(s));this.isEnabled()&&i.isSearchResult?l.includes(this.searchResultClass)||l.push("".concat(this.searchResultClass)):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),i.className=l.join(" ")}},{key:"destroy",value:function(){_get$x(_getPrototypeOf$U(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);function _typeof$13(e){return(_typeof$13="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$1X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1Q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1Q(e,t,r){return t&&_defineProperties$1Q(e.prototype,t),r&&_defineProperties$1Q(e,r),e}function _get$y(e,t,r){return(_get$y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$y(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$y(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$V(e)););return e}function _inherits$V(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$W(e,t)}function _setPrototypeOf$W(e,t){return(_setPrototypeOf$W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$V(e){var t=_isNativeReflectConstruct$W();return function(){var r,n=_getPrototypeOf$V(e);if(t){var o=_getPrototypeOf$V(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$V(this,r)}}function _possibleConstructorReturn$V(e,t){return!t||"object"!==_typeof$13(t)&&"function"!=typeof t?_assertThisInitialized$V(e):t}function _assertThisInitialized$V(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$W(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$V(e){return(_getPrototypeOf$V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}registerPlugin("search",Search);var TouchScroll=function(e){_inherits$V(r,e);var t=_createSuper$V(r);function r(e){var n;return _classCallCheck$1X(this,r),(n=t.call(this,e)).scrollbars=[],n.clones=[],n.lockedCollection=!1,n.freezeOverlays=!1,n}return _createClass$1Q(r,[{key:"isEnabled",value:function(){return isTouchSupported()}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterRender",(function(){return e.onAfterRender()})),this.registerEvents(),_get$y(_getPrototypeOf$V(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,_get$y(_getPrototypeOf$V(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){_get$y(_getPrototypeOf$V(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var e=this;this.addHook("beforeTouchScroll",(function(){return e.onBeforeTouchScroll()})),this.addHook("afterMomentumScroll",(function(){return e.onAfterMomentumScroll()}))}},{key:"onAfterRender",value:function(){if(!this.lockedCollection){var e=this.hot.view.wt.wtOverlays,t=e.topOverlay,r=e.bottomOverlay,n=e.leftOverlay,o=e.topLeftCornerOverlay,i=e.bottomLeftCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),r.clone&&this.scrollbars.push(r),this.scrollbars.push(n),o&&this.scrollbars.push(o),i&&i.clone&&this.scrollbars.push(i),this.clones.length=0,t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),o&&this.clones.push(o.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,arrayEach(this.clones,(function(e){addClass(e,"hide-tween")}))}},{key:"onAfterMomentumScroll",value:function(){var e=this;this.freezeOverlays=!1,arrayEach(this.clones,(function(e){removeClass(e,"hide-tween"),addClass(e,"show-tween")})),setTimeout((function(){arrayEach(e.clones,(function(e){removeClass(e,"show-tween")}))}),400),arrayEach(this.scrollbars,(function(e){e.refresh(),e.resetFixedPosition()})),this.hot.view.wt.wtOverlays.syncScrollWithMaster()}}]),r}(BasePlugin);function _typeof$14(e){return(_typeof$14="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$1Y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1R(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1R(e,t,r){return t&&_defineProperties$1R(e.prototype,t),r&&_defineProperties$1R(e,r),e}function _inherits$W(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$X(e,t)}function _setPrototypeOf$X(e,t){return(_setPrototypeOf$X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$W(e){var t=_isNativeReflectConstruct$X();return function(){var r,n=_getPrototypeOf$W(e);if(t){var o=_getPrototypeOf$W(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$W(this,r)}}function _possibleConstructorReturn$W(e,t){return!t||"object"!==_typeof$14(t)&&"function"!=typeof t?_assertThisInitialized$W(e):t}function _assertThisInitialized$W(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$X(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$W(e){return(_getPrototypeOf$W=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _toConsumableArray$g(e){return _arrayWithoutHoles$g(e)||_iterableToArray$i(e)||_unsupportedIterableToArray$A(e)||_nonIterableSpread$g()}function _nonIterableSpread$g(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray$i(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$g(e){if(Array.isArray(e))return _arrayLikeToArray$A(e)}function _slicedToArray$n(e,t){return _arrayWithHoles$p(e)||_iterableToArrayLimit$n(e,t)||_unsupportedIterableToArray$A(e,t)||_nonIterableRest$p()}function _nonIterableRest$p(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$A(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$A(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$A(e,t):void 0}}function _arrayLikeToArray$A(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$n(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$p(e){if(Array.isArray(e))return e}function UndoRedo(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,e.addHook("afterChange",(function(r,n){var o=r&&r.length;if(o&&!["UndoRedo.undo","UndoRedo.redo","MergeCells"].includes(n)&&r.find((function(e){var t=_slicedToArray$n(e,4);return t[2]!==t[3]}))){var i=r.reduce((function(e,t){return e.push(_toConsumableArray$g(t)),e}),[]);arrayEach(i,(function(t){t[1]=e.propToCol(t[1])}));var a=o>1?this.getSelected():[[i[0][0],i[0][1]]];t.done(new UndoRedo.ChangeAction(i,a))}})),e.addHook("afterCreateRow",(function(e,r,n){if("UndoRedo.undo"!==n&&"UndoRedo.undo"!==n&&"auto"!==n){var o=new UndoRedo.CreateRowAction(e,r);t.done(o)}})),e.addHook("beforeRemoveRow",(function(r,n,o,i){if("UndoRedo.undo"!==i&&"UndoRedo.redo"!==i&&"auto"!==i){var a=t.instance.getSourceDataArray(),s=(a.length+r)%a.length,l=e.toPhysicalRow(s),u=deepClone(a.slice(l,l+n));t.done(new UndoRedo.RemoveRowAction(s,u,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop))}})),e.addHook("afterCreateCol",(function(e,r,n){"UndoRedo.undo"!==n&&"UndoRedo.redo"!==n&&"auto"!==n&&t.done(new UndoRedo.CreateColumnAction(e,r))})),e.addHook("beforeRemoveCol",(function(r,n,o,i){if("UndoRedo.undo"!==i&&"UndoRedo.redo"!==i&&"auto"!==i){var a=t.instance.getSourceDataArray(),s=(t.instance.countCols()+r)%t.instance.countCols(),l=[],u=[],c=[];rangeEach(a.length-1,(function(t){var r=[],o=a[t];rangeEach(s,s+(n-1),(function(t){r.push(o[e.toPhysicalColumn(t)])})),l.push(r)})),rangeEach(n-1,(function(t){c.push(e.toPhysicalColumn(s+t))})),Array.isArray(e.getSettings().colHeaders)&&rangeEach(n-1,(function(t){u.push(e.getSettings().colHeaders[e.toPhysicalColumn(s+t)]||null)}));var f=e.columnIndexMapper.getIndexesSequence(),h=e.rowIndexMapper.getIndexesSequence(),d=new UndoRedo.RemoveColumnAction(s,c,l,u,f,h,e.getSettings().fixedColumnsLeft);t.done(d)}})),e.addHook("beforeCellAlignment",(function(e,r,n,o){var i=new UndoRedo.CellAlignmentAction(e,r,n,o);t.done(i)})),e.addHook("beforeFilter",(function(e){t.done(new UndoRedo.FiltersAction(e))})),e.addHook("beforeRowMove",(function(e,r){!1!==e&&t.done(new UndoRedo.RowMoveAction(e,r))})),e.addHook("beforeMergeCells",(function(r,n){n||t.done(new UndoRedo.MergeCellsAction(e,r))})),e.addHook("afterUnmergeCells",(function(r,n){n||t.done(new UndoRedo.UnmergeCellsAction(e,r))}))}registerPlugin("touchScroll",TouchScroll),UndoRedo.prototype.done=function(e){this.ignoreNewActions||(this.doneActions.push(e),this.undoneActions.length=0)},UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.pop(),t=deepClone(e),r=this.instance;if(!1===r.runHooks("beforeUndo",t))return;this.ignoreNewActions=!0;var n=this;e.undo(this.instance,(function(){n.ignoreNewActions=!1,n.undoneActions.push(e)})),r.runHooks("afterUndo",t)}},UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.pop(),t=deepClone(e),r=this.instance;if(!1===r.runHooks("beforeRedo",t))return;this.ignoreNewActions=!0;var n=this;e.redo(this.instance,(function(){n.ignoreNewActions=!1,n.doneActions.push(e)})),r.runHooks("afterRedo",t)}},UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0},UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},UndoRedo.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},UndoRedo.Action=function(){},UndoRedo.Action.prototype.undo=function(){},UndoRedo.Action.prototype.redo=function(){},UndoRedo.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"},inherit(UndoRedo.ChangeAction,UndoRedo.Action),UndoRedo.ChangeAction.prototype.undo=function(e,t){for(var r=deepClone(this.changes),n=e.countEmptyRows(!0),o=e.countEmptyCols(!0),i=0,a=r.length;i<a;i++)r[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(var s=0,l=r.length;s<l;s++){var u=_slicedToArray$n(r[s],2),c=u[0],f=u[1];e.getSettings().minSpareRows&&c+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(c+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&f+1+e.getSettings().minSpareCols===e.countCols()&&o===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(f+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}e.selectCells(this.selected,!1,!1)},UndoRedo.ChangeAction.prototype.redo=function(e,t){for(var r=deepClone(this.changes),n=0,o=r.length;n<o;n++)r[n].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)},UndoRedo.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"},inherit(UndoRedo.CreateRowAction,UndoRedo.Action),UndoRedo.CreateRowAction.prototype.undo=function(e,t){var r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},UndoRedo.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row",this.index,this.amount,"UndoRedo.redo")},UndoRedo.RemoveRowAction=function(e,t,r,n){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n},inherit(UndoRedo.RemoveRowAction,UndoRedo.Action),UndoRedo.RemoveRowAction.prototype.undo=function(e,t){var r=e.getSettings();r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,e.alter("insert_row",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterRender",t),e.populateFromArray(this.index,0,this.data,void 0,void 0,"UndoRedo.undo")},UndoRedo.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},UndoRedo.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"},inherit(UndoRedo.CreateColumnAction,UndoRedo.Action),UndoRedo.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},UndoRedo.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col",this.index,this.amount,"UndoRedo.redo")},UndoRedo.RemoveColumnAction=function(e,t,r,n,o,i,a){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsLeft=a},inherit(UndoRedo.RemoveColumnAction,UndoRedo.Action),UndoRedo.RemoveColumnAction.prototype.undo=function(e,t){var r,n,o=this;e.getSettings().fixedColumnsLeft=this.fixedColumnsLeft;for(var i=this.indexes.slice(0).sort(),a=function(e,t,r){return r[o.indexes.indexOf(i[t])]},s=this.data.length,l=[],u=0;u<s;u++)l.push(arrayMap(this.data[u],a));var c=arrayMap(this.headers,a),f=null!==(r=null===(n=e.getPlugin("formulas"))||void 0===n?void 0:n.enabled)&&void 0!==r&&r,h=[];if(e.alter("insert_col",this.indexes[0],this.indexes.length,"UndoRedo.undo"),arrayEach(e.getSourceDataArray(),(function(e,t){arrayEach(i,(function(r,n){e[r]=l[t][n],h.push([t,r,e[r]])}))})),e.setSourceDataAtCell(h),e.columnIndexMapper.insertIndexes(i[0],i.length),f){var d=[];arrayEach(e.getSourceDataArray(),(function(e,t){arrayEach(i,(function(r,n){e[r]=l[t][n],d.push([t,r,null,e[r]])}))})),e.getPlugin("formulas").onAfterSetDataAtCell(d)}void 0!==this.headers&&arrayEach(c,(function(t,r){e.getSettings().colHeaders[i[r]]=t})),e.batch((function(){e.rowIndexMapper.setIndexesSequence(o.rowPositions),e.columnIndexMapper.setIndexesSequence(o.columnPositions)})),e.addHookOnce("afterRender",t),e.runHooks("afterCreateCol",this.indexes[0],this.indexes.length,"UndoRedo.undo"),f&&e.getPlugin("formulas").recalculateFull(),e.render()},UndoRedo.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},UndoRedo.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n},UndoRedo.CellAlignmentAction.prototype.undo=function(e,t){var r=this;arrayEach(this.range,(function(t){t.forAll((function(t,n){t>=0&&n>=0&&e.setCellMeta(t,n,"className",r.stateBefore[t][n]||" htLeft")}))})),e.addHookOnce("afterRender",t),e.render()},UndoRedo.CellAlignmentAction.prototype.redo=function(e,t){align(this.range,this.type,this.alignment,(function(t,r){return e.getCellMeta(t,r)}),(function(t,r,n,o){return e.setCellMeta(t,r,n,o)})),e.addHookOnce("afterRender",t),e.render()},UndoRedo.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"},inherit(UndoRedo.FiltersAction,UndoRedo.Action),UndoRedo.FiltersAction.prototype.undo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()},UndoRedo.FiltersAction.prototype.redo=function(e,t){var r=e.getPlugin("filters");e.addHookOnce("afterRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var MergeCellsAction=function(e){_inherits$W(r,e);var t=_createSuper$W(r);function r(e,n){var o;_classCallCheck$1Y(this,r),(o=t.call(this)).cellRange=n;var i=o.cellRange.getTopLeftCorner(),a=o.cellRange.getBottomRightCorner();return o.rangeData=e.getData(i.row,i.col,a.row,a.col),o}return _createClass$1R(r,[{key:"undo",value:function(e,t){var r=e.getPlugin("mergeCells");e.addHookOnce("afterRender",t),r.unmergeRange(this.cellRange,!0);var n=this.cellRange.getTopLeftCorner();e.populateFromArray(n.row,n.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(e,t){var r=e.getPlugin("mergeCells");e.addHookOnce("afterRender",t),r.mergeRange(this.cellRange)}}]),r}(UndoRedo.Action);UndoRedo.MergeCellsAction=MergeCellsAction;var UnmergeCellsAction=function(e){_inherits$W(r,e);var t=_createSuper$W(r);function r(e,n){var o;return _classCallCheck$1Y(this,r),(o=t.call(this)).cellRange=n,o}return _createClass$1R(r,[{key:"undo",value:function(e,t){var r=e.getPlugin("mergeCells");e.addHookOnce("afterRender",t),r.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(e,t){var r=e.getPlugin("mergeCells");e.addHookOnce("afterRender",t),r.unmergeRange(this.cellRange,!0),e.render()}}]),r}(UndoRedo.Action);function init$1(){var e=this;void 0===e.getSettings().undo||e.getSettings().undo?e.undoRedo||(e.undoRedo=new UndoRedo(e),exposeUndoRedoMethods(e),e.addHook("beforeKeyDown",onBeforeKeyDown),e.addHook("afterChange",onAfterChange)):e.undoRedo&&(delete e.undoRedo,removeExposedUndoRedoMethods(e),e.removeHook("beforeKeyDown",onBeforeKeyDown),e.removeHook("afterChange",onAfterChange))}function onBeforeKeyDown(e){if(!isImmediatePropagationStopped(e)){var t=this,r=t.getActiveEditor();if(!r||!r.isOpened()){var n=e.altKey,o=e.ctrlKey,i=e.keyCode,a=e.metaKey,s=e.shiftKey;if((o||a)&&!n)89===i||s&&90===i?(t.undoRedo.redo(),stopImmediatePropagation(e)):90===i&&(t.undoRedo.undo(),stopImmediatePropagation(e))}}}function onAfterChange(e,t){if("loadData"===t)return this.undoRedo.clear()}function exposeUndoRedoMethods(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function removeExposedUndoRedoMethods(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}UndoRedo.UnmergeCellsAction=UnmergeCellsAction,UndoRedo.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalIndex=t},inherit(UndoRedo.RowMoveAction,UndoRedo.Action),UndoRedo.RowMoveAction.prototype.undo=function(e,t){var r=this,n=e.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter((function(e){return e>r.finalIndex})),a=o.filter((function(e){return e<=r.finalIndex})),s=i.sort((function(e,t){return t-e})).concat(a.sort((function(e,t){return e-t})));e.addHookOnce("afterRender",t);for(var l=0;l<s.length;l+=1){var u=e.toVisualRow(s[l]);n.moveRow(u,s[l])}e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},UndoRedo.RowMoveAction.prototype.redo=function(e,t){var r=e.getPlugin("manualRowMove");e.addHookOnce("afterRender",t),r.moveRows(this.rows.slice(),this.finalIndex),e.render(),e.deselectCell(),e.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};var hook=Hooks.getSingleton();function _typeof$15(e){return(_typeof$15="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$1Z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1S(e,t,r){return t&&_defineProperties$1S(e.prototype,t),r&&_defineProperties$1S(e,r),e}function _get$z(e,t,r){return(_get$z="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$z(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$z(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$X(e)););return e}function _inherits$X(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$Y(e,t)}function _setPrototypeOf$Y(e,t){return(_setPrototypeOf$Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$X(e){var t=_isNativeReflectConstruct$Y();return function(){var r,n=_getPrototypeOf$X(e);if(t){var o=_getPrototypeOf$X(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$X(this,r)}}function _possibleConstructorReturn$X(e,t){return!t||"object"!==_typeof$15(t)&&"function"!=typeof t?_assertThisInitialized$X(e):t}function _assertThisInitialized$X(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$Y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$X(e){return(_getPrototypeOf$X=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}hook.add("afterInit",init$1),hook.add("afterUpdateSettings",init$1),hook.register("beforeUndo"),hook.register("afterUndo"),hook.register("beforeRedo"),hook.register("afterRedo");var _alterUtilsFactory=alterUtilsFactory("physicallyIndexed"),getListWithInsertedItems$2=_alterUtilsFactory.getListWithInsertedItems,getListWithRemovedItems$2=_alterUtilsFactory.getListWithRemovedItems,LooseBindsMap=function(e){_inherits$X(r,e);var t=_createSuper$X(r);function r(){return _classCallCheck$1Z(this,r),t.call(this,(function(e){return e}))}return _createClass$1S(r,[{key:"insert",value:function(e,t){var n=getIncreasedIndexes(this.indexedValues,e,t);this.indexedValues=getListWithInsertedItems$2(n,e,t,this.initValueOrFn),_get$z(_getPrototypeOf$X(r.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){var t=getListWithRemovedItems$2(this.indexedValues,e);this.indexedValues=getDecreasedIndexes(t,e),_get$z(_getPrototypeOf$X(r.prototype),"remove",this).call(this,e)}}]),r}(IndexMap);function _typeof$16(e){return(_typeof$16="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray$h(e){return _arrayWithoutHoles$h(e)||_iterableToArray$j(e)||_unsupportedIterableToArray$B(e)||_nonIterableSpread$h()}function _nonIterableSpread$h(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$B(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$B(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$B(e,t):void 0}}function _iterableToArray$j(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$h(e){if(Array.isArray(e))return _arrayLikeToArray$B(e)}function _arrayLikeToArray$B(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$1_(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1T(e,t,r){return t&&_defineProperties$1T(e.prototype,t),r&&_defineProperties$1T(e,r),e}function _get$A(e,t,r){return(_get$A="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$A(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$A(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$Y(e)););return e}function _inherits$Y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$Z(e,t)}function _setPrototypeOf$Z(e,t){return(_setPrototypeOf$Z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$Y(e){var t=_isNativeReflectConstruct$Z();return function(){var r,n=_getPrototypeOf$Y(e);if(t){var o=_getPrototypeOf$Y(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$Y(this,r)}}function _possibleConstructorReturn$Y(e,t){return!t||"object"!==_typeof$16(t)&&"function"!=typeof t?_assertThisInitialized$Y(e):t}function _assertThisInitialized$Y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$Z(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$Y(e){return(_getPrototypeOf$Y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _alterUtilsFactory$1=alterUtilsFactory("physicallyIndexed"),getListWithInsertedItems$3=_alterUtilsFactory$1.getListWithInsertedItems,getListWithRemovedItems$3=_alterUtilsFactory$1.getListWithRemovedItems,StrictBindsMap=function(e){_inherits$Y(r,e);var t=_createSuper$Y(r);function r(){return _classCallCheck$1_(this,r),t.call(this,(function(e){return e}))}return _createClass$1T(r,[{key:"insert",value:function(e,t){var n=this;this.indexedValues=getListWithInsertedItems$3(this.indexedValues,e,t,(function(e,t){return n.getNextValue(t)})),_get$A(_getPrototypeOf$Y(r.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=getListWithRemovedItems$3(this.indexedValues,e),_get$A(_getPrototypeOf$Y(r.prototype),"remove",this).call(this,e)}},{key:"getNextValue",value:function(e){return Math.max.apply(Math,_toConsumableArray$h(this.getValues()))+1+e}}]),r}(IndexMap);function _typeof$17(e){return(_typeof$17="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$1$(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1U(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1U(e,t,r){return t&&_defineProperties$1U(e.prototype,t),r&&_defineProperties$1U(e,r),e}function _get$B(e,t,r){return(_get$B="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$B(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$B(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$Z(e)););return e}function _inherits$Z(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$_(e,t)}function _setPrototypeOf$_(e,t){return(_setPrototypeOf$_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$Z(e){var t=_isNativeReflectConstruct$_();return function(){var r,n=_getPrototypeOf$Z(e);if(t){var o=_getPrototypeOf$Z(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$Z(this,r)}}function _possibleConstructorReturn$Z(e,t){return!t||"object"!==_typeof$17(t)&&"function"!=typeof t?_assertThisInitialized$Z(e):t}function _assertThisInitialized$Z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$_(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$Z(e){return(_getPrototypeOf$Z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var DEFAULT_BIND="loose",bindTypeToMapStrategy=new Map([["loose",LooseBindsMap],["strict",StrictBindsMap]]),BindRowsWithHeaders=function(e){_inherits$Z(r,e);var t=_createSuper$Z(r);function r(e){var n;return _classCallCheck$1$(this,r),(n=t.call(this,e)).headerIndexes=null,n}return _createClass$1U(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().bindRowsWithHeaders}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().bindRowsWithHeaders;"string"!=typeof t&&(t=DEFAULT_BIND);var n=bindTypeToMapStrategy.get(t);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",(function(t){return e.onModifyRowHeader(t)})),_get$B(_getPrototypeOf$Z(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),_get$B(_getPrototypeOf$Z(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}},{key:"destroy",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),_get$B(_getPrototypeOf$Z(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);registerPlugin("bindRowsWithHeaders",BindRowsWithHeaders);var thisNumberValue=function(e){if("number"!=typeof e&&"Number"!=classofRaw(e))throw TypeError("Incorrect invocation");return+e},nativeToFixed=1..toFixed,floor$3=Math.floor,pow=function(e,t,r){return 0===t?r:t%2==1?pow(e,t-1,r*e):pow(e*e,t/2,r)},log=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t},FORCED$7=nativeToFixed&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!fails((function(){nativeToFixed.call({})}));function _classCallCheck$20(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1V(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1V(e,t,r){return t&&_defineProperties$1V(e.prototype,t),r&&_defineProperties$1V(e,r),e}_export({target:"Number",proto:!0,forced:FORCED$7},{toFixed:function(e){var t,r,n,o,i=thisNumberValue(this),a=toInteger(e),s=[0,0,0,0,0,0],l="",u="0",c=function(e,t){for(var r=-1,n=t;++r<6;)n+=e*s[r],s[r]=n%1e7,n=floor$3(n/1e7)},f=function(e){for(var t=6,r=0;--t>=0;)r+=s[t],s[t]=floor$3(r/e),r=r%e*1e7},h=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==s[e]){var r=String(s[e]);t=""===t?r:t+stringRepeat.call("0",7-r.length)+r}return t};if(a<0||a>20)throw RangeError("Incorrect fraction digits");if(i!=i)return"NaN";if(i<=-1e21||i>=1e21)return String(i);if(i<0&&(l="-",i=-i),i>1e-21)if(r=(t=log(i*pow(2,69,1))-69)<0?i*pow(2,-t,1):i/pow(2,t,1),r*=4503599627370496,(t=52-t)>0){for(c(0,r),n=a;n>=7;)c(1e7,0),n-=7;for(c(pow(10,n,1),0),n=t-1;n>=23;)f(1<<23),n-=23;f(1<<n),c(1,1),f(2),u=h()}else c(0,r),c(1<<-t,0),u=h()+stringRepeat.call("0",a);return u=a>0?l+((o=u.length)<=a?"0."+stringRepeat.call("0",a-o)+u:u.slice(0,o-a)+"."+u.slice(o-a)):l+u}});var Endpoints=function(){function e(t,r){_classCallCheck$20(this,e),this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return _createClass$1V(e,[{key:"getEndpoint",value:function(e){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}},{key:"getAllEndpoints",value:function(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(e){return this.parseSettings(e.call(this))}},{key:"parseSettings",value:function(e){var t=this,r=[],n=e;if(n||"function"!=typeof this.settings)return n||(n=this.settings),arrayEach(n,(function(e){var n={};t.assignSetting(e,n,"ranges",[[0,t.hot.countRows()-1]]),t.assignSetting(e,n,"reversedRowCoords",!1),t.assignSetting(e,n,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),t.assignSetting(e,n,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),t.assignSetting(e,n,"sourceColumn",e.destinationColumn),t.assignSetting(e,n,"type","sum"),t.assignSetting(e,n,"forceNumeric",!1),t.assignSetting(e,n,"suppressDataTypeErrors",!0),t.assignSetting(e,n,"suppressDataTypeErrors",!0),t.assignSetting(e,n,"customFunction",null),t.assignSetting(e,n,"readOnly",!0),t.assignSetting(e,n,"roundFloat",!1),r.push(n)})),r;this.settingsType="function"}},{key:"assignSetting",value:function(e,t,r,n){if("ranges"!==r||void 0!==e[r]){if("ranges"!==r||0!==e[r].length)if(void 0===e[r]){if(n instanceof Error)throw n;t[r]=n}else"destinationRow"===r&&t.reversedRowCoords?t[r]=this.hot.countRows()-e[r]-1:t[r]=e[r]}else t[r]=n}},{key:"resetSetupBeforeStructureAlteration",value:function(e,t,r){if("function"===this.settingsType){var n=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();arrayEach(o,(function(o){"row"===n&&o.destinationRow>=t&&("insert_row"===e?o.alterRowOffset=r:"remove_row"===e&&(o.alterRowOffset=-1*r)),"col"===n&&o.destinationColumn>=t&&("insert_col"===e?o.alterColumnOffset=r:"remove_col"===e&&(o.alterColumnOffset=-1*r))})),this.resetAllEndpoints(o,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(e,t,r,n,o){var i=this,a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"!==this.settingsType){var s=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=0===e.indexOf("move_row"),f=t;arrayEach(u,(function(e){"row"===s&&e.destinationRow>=f&&(e.alterRowOffset=l*r),"col"===s&&e.destinationColumn>=f&&(e.alterColumnOffset=l*r)})),this.resetAllEndpoints(u,!c),arrayEach(u,c?function(e){i.extendEndpointRanges(e,f,n[0],n.length),i.recreatePhysicalRanges(e),i.clearOffsetInformation(e)}:function(e){i.shiftEndpointCoordinates(e,f)}),a&&this.refreshAllEndpoints()}else{var h=function e(){return i.hot.removeHook("beforeRender",e),i.refreshAllEndpoints()};this.hot.addHookOnce("beforeRender",h)}}},{key:"clearOffsetInformation",value:function(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(e,t,r,n){arrayEach(e.ranges,(function(e){e[1]&&(t>=e[0]&&t<=e[1]?r>e[1]?e[1]+=n:r<e[0]&&(e[0]-=n):r>=e[0]&&r<=e[1]&&(e[1]-=n,t<=e[0]&&(e[0]+=1,e[1]+=1)))}))}},{key:"recreatePhysicalRanges",value:function(e){var t=this,r=e.ranges,n=[],o=[];arrayEach(r,(function(e){var r=[];if(e[1])for(var n=e[0];n<=e[1];n++)r.push(t.hot.toPhysicalRow(n));else r.push(t.hot.toPhysicalRow(e[0]));o.push(r)})),arrayEach(o,(function(e){var t=[];arrayEach(e,(function(r,o){0===o?t.push(r):e[o]!==e[o-1]+1&&(t.push(e[o-1]),n.push(t),(t=[]).push(r)),o===e.length-1&&(t.push(r),n.push(t))}))})),e.ranges=n}},{key:"shiftEndpointCoordinates",value:function(e,t){e.alterRowOffset&&0!==e.alterRowOffset?(e.destinationRow+=e.alterRowOffset||0,arrayEach(e.ranges,(function(r){arrayEach(r,(function(n,o){n>=t&&(r[o]+=e.alterRowOffset||0)}))}))):e.alterColumnOffset&&0!==e.alterColumnOffset&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t.some((function(t){var r=t.alterRowOffset||0,n=t.alterColumnOffset||0;return t.destinationRow+r>=e.hot.countRows()||t.destinationColumn+n>=e.hot.countCols()}));n||(this.cellsToSetCache=[],arrayEach(t,(function(t){e.resetEndpointValue(t,r)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var e=this;this.cellsToSetCache=[],arrayEach(this.getAllEndpoints(),(function(t){e.currentEndpoint=t,e.plugin.calculate(t),e.setEndpointValue(t,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(e){var t=this,r=[];this.cellsToSetCache=[],arrayEach(e,(function(e,n,o){"".concat(e[2]||"")!=="".concat(e[3])&&arrayEach(t.getAllEndpoints(),(function(e,i){t.hot.propToCol(o[n][1])===e.sourceColumn&&-1===r.indexOf(i)&&r.push(i)}))})),arrayEach(r,(function(e){t.refreshEndpoint(t.getEndpoint(e))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.alterRowOffset||0,n=e.alterColumnOffset||0,o=[this.hot.toVisualRow(e.destinationRow),this.hot.toVisualColumn(e.destinationColumn)],i=o[0],a=o[1];if(null!==a&&null!==i){var s=this.hot.getCellMeta(i,a);s.readOnly=!1,s.className=""}this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?r:0)),this.hot.toVisualColumn(e.destinationColumn+(t?n:0)),""])}},{key:"setEndpointValue",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=-1*e.alterRowOffset||0,o=-1*e.alterColumnOffset||0,i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols())this.throwOutOfBoundsWarning();else{var a=this.hot.toVisualRow(e.destinationRow+n);if(null!==a){var s=this.hot.getCellMeta(a,e.destinationColumn+o);"init"!==t&&s.readOnly===e.readOnly||(s.readOnly=e.readOnly,s.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}}},{key:"throwOutOfBoundsWarning",value:function(){warn("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),e}();function _typeof$18(e){return(_typeof$18="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _templateObject$7(){var e=_taggedTemplateLiteral$7(["ColumnSummary plugin: cell at (",", ",") is not in a \n          numeric format. Cannot do the calculation."],["ColumnSummary plugin: cell at (",", ",") is not in a\\x20\n          numeric format. Cannot do the calculation."]);return _templateObject$7=function(){return e},e}function _taggedTemplateLiteral$7(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _classCallCheck$21(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1W(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1W(e,t,r){return t&&_defineProperties$1W(e.prototype,t),r&&_defineProperties$1W(e,r),e}function _get$C(e,t,r){return(_get$C="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$C(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$C(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$_(e)););return e}function _inherits$_(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$$(e,t)}function _setPrototypeOf$$(e,t){return(_setPrototypeOf$$=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$_(e){var t=_isNativeReflectConstruct$$();return function(){var r,n=_getPrototypeOf$_(e);if(t){var o=_getPrototypeOf$_(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$_(this,r)}}function _possibleConstructorReturn$_(e,t){return!t||"object"!==_typeof$18(t)&&"function"!=typeof t?_assertThisInitialized$_(e):t}function _assertThisInitialized$_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$$(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$_(e){return(_getPrototypeOf$_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ColumnSummary=function(e){_inherits$_(r,e);var t=_createSuper$_(r);function r(e){var n;return _classCallCheck$21(this,r),(n=t.call(this,e)).endpoints=null,n}return _createClass$1W(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().columnSummary}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.settings=this.hot.getSettings().columnSummary,this.endpoints=new Endpoints(this,this.settings),this.addHook("afterInit",(function(){return e.onAfterInit.apply(e,arguments)})),this.addHook("afterChange",(function(){return e.onAfterChange.apply(e,arguments)})),this.addHook("beforeCreateRow",(function(t,r,n){return e.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,r,null,n)})),this.addHook("beforeCreateCol",(function(t,r,n){return e.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,r,null,n)})),this.addHook("beforeRemoveRow",(function(){for(var t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(t=e.endpoints).resetSetupBeforeStructureAlteration.apply(t,["remove_row"].concat(n))})),this.addHook("beforeRemoveCol",(function(){for(var t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(t=e.endpoints).resetSetupBeforeStructureAlteration.apply(t,["remove_col"].concat(n))})),this.addHook("afterCreateRow",(function(t,r,n){return e.endpoints.resetSetupAfterStructureAlteration("insert_row",t,r,null,n)})),this.addHook("afterCreateCol",(function(t,r,n){return e.endpoints.resetSetupAfterStructureAlteration("insert_col",t,r,null,n)})),this.addHook("afterRemoveRow",(function(){for(var t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(t=e.endpoints).resetSetupAfterStructureAlteration.apply(t,["remove_row"].concat(n))})),this.addHook("afterRemoveCol",(function(){for(var t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(t=e.endpoints).resetSetupAfterStructureAlteration.apply(t,["remove_col"].concat(n))})),this.addHook("afterRowMove",(function(){return e.onAfterRowMove.apply(e,arguments)})),_get$C(_getPrototypeOf$_(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e)}}},{key:"calculateSum",value:function(e){var t=this,r=0;return objectEach(e.ranges,(function(n){r+=t.getPartialSum(n,e.sourceColumn)})),r}},{key:"getPartialSum",value:function(e,t){var r=0,n=e[1]||e[0],o=null,i=0;do{o=this.getCellValue(n,t)||0;var a=("".concat(o).split(".")[1]||[]).length||1;a>i&&(i=a),r+=o||0,n-=1}while(n>=e[0]);return Math.round(r*Math.pow(10,i))/Math.pow(10,i)}},{key:"calculateMinMax",value:function(e,t){var r=this,n=null;return objectEach(e.ranges,(function(o){var i=r.getPartialMinMax(o,e.sourceColumn,t);if(null===n&&null!==i&&(n=i),null!==i)switch(t){case"min":n=Math.min(n,i);break;case"max":n=Math.max(n,i)}})),null===n?"Not enough data":n}},{key:"getPartialMinMax",value:function(e,t,r){var n,o=null,i=e[1]||e[0];do{if(n=this.getCellValue(i,t)||null,null===o)o=n;else if(null!==n)switch(r){case"min":o=Math.min(o,n);break;case"max":o=Math.max(o,n)}i-=1}while(i>=e[0]);return o}},{key:"countEmpty",value:function(e,t){var r=0,n=e[1]||e[0];do{this.getCellValue(n,t)||(r+=1),n-=1}while(n>=e[0]);return r}},{key:"countEntries",value:function(e){var t=this,r=0;return objectEach(e.ranges,(function(n){var o=void 0===n[1]?1:n[1]-n[0]+1,i=t.countEmpty(n,e.sourceColumn);r+=o,r-=i})),r}},{key:"calculateAverage",value:function(e){return this.calculateSum(e)/this.countEntries(e)}},{key:"getCellValue",value:function(e,t){var r=this.hot.toVisualRow(e),n=this.hot.toVisualColumn(t),o=this.hot.getSourceDataAtCell(e,t),i="";if(null!==r&&null!==n&&(i=this.hot.getCellMeta(r,n).className||""),i.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof o&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(toSingleLine(_templateObject$7(),e,t));return o}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(e,t){e&&"ColumnSummary.reset"!==t&&"ColumnSummary.set"!==t&&"loadData"!==t&&this.endpoints.refreshChangedEndpoints(e)}},{key:"onAfterRowMove",value:function(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}}]),r}(BasePlugin);function _typeof$19(e){return(_typeof$19="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$22(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _get$D(e,t,r){return(_get$D="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$D(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$D(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$$(e)););return e}function _defineProperties$1X(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1X(e,t,r){return t&&_defineProperties$1X(e.prototype,t),r&&_defineProperties$1X(e,r),e}function _inherits$$(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$10(e,t)}function _setPrototypeOf$10(e,t){return(_setPrototypeOf$10=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$$(e){var t=_isNativeReflectConstruct$10();return function(){var r,n=_getPrototypeOf$$(e);if(t){var o=_getPrototypeOf$$(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$$(this,r)}}function _possibleConstructorReturn$$(e,t){return!t||"object"!==_typeof$19(t)&&"function"!=typeof t?_assertThisInitialized$$(e):t}function _assertThisInitialized$$(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$10(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$$(e){return(_getPrototypeOf$$=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}registerPlugin("columnSummary",ColumnSummary),Hooks.getSingleton().register("afterDropdownMenuDefaultOptions"),Hooks.getSingleton().register("beforeDropdownMenuShow"),Hooks.getSingleton().register("afterDropdownMenuShow"),Hooks.getSingleton().register("afterDropdownMenuHide"),Hooks.getSingleton().register("afterDropdownMenuExecute");var BUTTON_CLASS_NAME="changeType",DropdownMenu=function(e){_inherits$$(r,e);var t=_createSuper$$(r);function r(e){var n;return _classCallCheck$22(this,r),(n=t.call(this,e)).eventManager=new EventManager(_assertThisInitialized$$(n)),n.commandExecutor=new CommandExecutor(n.hot),n.itemsFactory=null,n.menu=null,n.hot.addHook("afterGetColHeader",(function(e,t){return n.onAfterGetColHeader(e,t)})),n}return _createClass$1X(r,null,[{key:"DEFAULT_ITEMS",get:function(){return[KEY$3,KEY$4,KEY,KEY$7,KEY,KEY$2,KEY,KEY$5,KEY,KEY$1]}}]),_createClass$1X(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().dropdownMenu}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){this.itemsFactory=new ItemsFactory(this.hot,r.DEFAULT_ITEMS);var t=this.hot.getSettings().dropdownMenu,n={items:this.itemsFactory.getItems(t)};this.registerEvents(),"function"==typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),_get$D(_getPrototypeOf$$(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady((function(){e.hot.runHooks("afterDropdownMenuDefaultOptions",n),e.itemsFactory.setPredefinedItems(n.items);var r=e.itemsFactory.getItems(t);e.menu&&e.menu.destroy(),e.menu=new Menu(e.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||e.hot.rootDocument.body}),e.hot.runHooks("beforeDropdownMenuSetItems",r),e.menu.setMenuItems(r),e.menu.addLocalHook("beforeOpen",(function(){return e.onMenuBeforeOpen()})),e.menu.addLocalHook("afterOpen",(function(){return e.onMenuAfterOpen()})),e.menu.addLocalHook("afterClose",(function(){return e.onMenuAfterClose()})),e.menu.addLocalHook("executeCommand",(function(){for(var t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(t=e.executeCommand).call.apply(t,[e].concat(n))})),arrayEach(r,(function(t){return e.commandExecutor.registerCommand(t.key,t)}))}))}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$D(_getPrototypeOf$$(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),_get$D(_getPrototypeOf$$(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"click",(function(t){return e.onTableClick(t)}))}},{key:"open",value:function(e){this.menu&&(this.menu.open(),e.width&&this.menu.setOffset("left",e.width),this.menu.setPosition(e))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];(t=this.commandExecutor).execute.apply(t,[e].concat(n))}},{key:"setListening",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(e){if(e.stopPropagation(),hasClass(e.target,BUTTON_CLASS_NAME)&&!this.menu.isOpened()){var t=0,r=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var n=this.hot.rootWindow.frameElement.getBoundingClientRect();t=n.top,r=n.left}var o=e.target.getBoundingClientRect();this.open({left:o.left+r,top:o.top+e.target.offsetHeight+3+t,width:o.width,height:o.height})}}},{key:"onAfterGetColHeader",value:function(e,t){var r=t.parentNode;if(r){var n=r.parentNode.childNodes,o=Array.prototype.indexOf.call(n,r);if(!(e<0||o!==n.length-1)){var i=t.querySelector(".".concat(BUTTON_CLASS_NAME));if(!this.enabled||!i)if(this.enabled){var a=this.hot.rootDocument.createElement("button");a.className=BUTTON_CLASS_NAME,a.onclick=function(){return!1},t.firstChild.insertBefore(a,t.firstChild.firstChild)}else i&&i.parentNode.removeChild(i)}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),_get$D(_getPrototypeOf$$(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);function _slicedToArray$o(e,t){return _arrayWithHoles$q(e)||_iterableToArrayLimit$o(e,t)||_unsupportedIterableToArray$C(e,t)||_nonIterableRest$q()}function _nonIterableRest$q(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$C(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$C(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$C(e,t):void 0}}function _arrayLikeToArray$C(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$o(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$q(e){if(Array.isArray(e))return e}function _classCallCheck$23(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1Y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1Y(e,t,r){return t&&_defineProperties$1Y(e.prototype,t),r&&_defineProperties$1Y(e,r),e}DropdownMenu.SEPARATOR={name:KEY},registerPlugin("dropdownMenu",DropdownMenu);var DataProvider=function(){function e(t){_classCallCheck$23(this,e),this.hot=t,this.options={}}return _createClass$1Y(e,[{key:"setOptions",value:function(e){this.options=e}},{key:"getData",value:function(){var e=this,t=this._getDataRange(),r=t.startRow,n=t.startCol,o=t.endRow,i=t.endCol,a=this.options,s=[];return rangeEach(r,o,(function(t){var r=[];!a.exportHiddenRows&&e._isHiddenRow(t)||(rangeEach(n,i,(function(n){!a.exportHiddenColumns&&e._isHiddenColumn(n)||r.push(e.hot.getDataAtCell(t,n))})),s.push(r))})),s}},{key:"getRowHeaders",value:function(){var e=this,t=[];if(this.options.rowHeaders){var r=this._getDataRange(),n=r.startRow,o=r.endRow,i=this.hot.getRowHeader();rangeEach(n,o,(function(r){!e.options.exportHiddenRows&&e._isHiddenRow(r)||t.push(i[r])}))}return t}},{key:"getColumnHeaders",value:function(){var e=this,t=[];if(this.options.columnHeaders){var r=this._getDataRange(),n=r.startCol,o=r.endCol,i=this.hot.getColHeader();rangeEach(n,o,(function(r){!e.options.exportHiddenColumns&&e._isHiddenColumn(r)||t.push(i[r])}))}return t}},{key:"_getDataRange",value:function(){var e=this.hot.countCols()-1,t=this.hot.countRows()-1,r=_slicedToArray$o(this.options.range,4),n=r[0],o=void 0===n?0:n,i=r[1],a=void 0===i?0:i,s=r[2],l=void 0===s?t:s,u=r[3],c=void 0===u?e:u;return{startRow:o=Math.max(o,0),startCol:a=Math.max(a,0),endRow:l=Math.min(l,t),endCol:c=Math.min(c,e)}}},{key:"_isHiddenRow",value:function(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}},{key:"_isHiddenColumn",value:function(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}]),e}();function _classCallCheck$24(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1Z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1Z(e,t,r){return t&&_defineProperties$1Z(e.prototype,t),r&&_defineProperties$1Z(e,r),e}var BaseType=function(){function e(t,r){_classCallCheck$24(this,e),this.dataProvider=t,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return _createClass$1Z(e,null,[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),_createClass$1Z(e,[{key:"_mergeOptions",value:function(t){var r=clone(this.constructor.DEFAULT_OPTIONS),n=new Date;return r=extend(clone(e.DEFAULT_OPTIONS),r),(r=extend(r,t)).filename=substitute(r.filename,{YYYY:n.getFullYear(),MM:"".concat(n.getMonth()+1).padStart(2,"0"),DD:"".concat(n.getDate()).padStart(2,"0")}),r}}]),e}();function _typeof$1a(e){return(_typeof$1a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$25(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1_(e,t,r){return t&&_defineProperties$1_(e.prototype,t),r&&_defineProperties$1_(e,r),e}function _inherits$10(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$11(e,t)}function _setPrototypeOf$11(e,t){return(_setPrototypeOf$11=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$10(e){var t=_isNativeReflectConstruct$11();return function(){var r,n=_getPrototypeOf$10(e);if(t){var o=_getPrototypeOf$10(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$10(this,r)}}function _possibleConstructorReturn$10(e,t){return!t||"object"!==_typeof$1a(t)&&"function"!=typeof t?_assertThisInitialized$10(e):t}function _assertThisInitialized$10(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$11(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$10(e){return(_getPrototypeOf$10=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var CHAR_CARRIAGE_RETURN=String.fromCharCode(13),CHAR_DOUBLE_QUOTES=String.fromCharCode(34),CHAR_LINE_FEED=String.fromCharCode(10),Csv=function(e){_inherits$10(r,e);var t=_createSuper$10(r);function r(){return _classCallCheck$25(this,r),t.apply(this,arguments)}return _createClass$1_(r,[{key:"export",value:function(){var e=this,t=this.options,r=this.dataProvider.getData(),n=this.dataProvider.getColumnHeaders(),o=n.length>0,i=this.dataProvider.getRowHeaders(),a=i.length>0,s=t.bom?String.fromCharCode(65279):"";return o&&(n=arrayMap(n,(function(t){return e._escapeCell(t,!0)})),a&&(s+=t.columnDelimiter),s+=n.join(t.columnDelimiter),s+=t.rowDelimiter),arrayEach(r,(function(r,n){n>0&&(s+=t.rowDelimiter),a&&(s+=e._escapeCell(i[n])+t.columnDelimiter),s+=r.map((function(t){return e._escapeCell(t)})).join(t.columnDelimiter)})),s}},{key:"_escapeCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=stringify(e);return""!==r&&(t||r.indexOf(CHAR_CARRIAGE_RETURN)>=0||r.indexOf(CHAR_DOUBLE_QUOTES)>=0||r.indexOf(CHAR_LINE_FEED)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r='"'.concat(r,'"')),r}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}}]),r}(BaseType);function _defineProperty$g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var TYPE_CSV="csv",EXPORT_TYPES=_defineProperty$g({},TYPE_CSV,Csv);function typeFactory(e,t,r){return"function"==typeof EXPORT_TYPES[e]?new EXPORT_TYPES[e](t,r):null}function _typeof$1b(e){return(_typeof$1b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$26(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1$(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$1$(e,t,r){return t&&_defineProperties$1$(e.prototype,t),r&&_defineProperties$1$(e,r),e}function _inherits$11(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$12(e,t)}function _setPrototypeOf$12(e,t){return(_setPrototypeOf$12=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$11(e){var t=_isNativeReflectConstruct$12();return function(){var r,n=_getPrototypeOf$11(e);if(t){var o=_getPrototypeOf$11(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$11(this,r)}}function _possibleConstructorReturn$11(e,t){return!t||"object"!==_typeof$1b(t)&&"function"!=typeof t?_assertThisInitialized$11(e):t}function _assertThisInitialized$11(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$12(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$11(e){return(_getPrototypeOf$11=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ExportFile=function(e){_inherits$11(r,e);var t=_createSuper$11(r);function r(){return _classCallCheck$26(this,r),t.apply(this,arguments)}return _createClass$1$(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(e,t).export()}},{key:"exportAsBlob",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}},{key:"downloadFile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.hot,n=r.rootDocument,o=r.rootWindow,i=this._createTypeFormatter(e,t),a=this._createBlob(i),s=o.URL||o.webkitURL,l=n.createElement("a"),u="".concat(i.options.filename,".").concat(i.options.fileExtension);if(void 0!==l.download){var c=s.createObjectURL(a);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),n.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),n.body.removeChild(l),setTimeout((function(){s.revokeObjectURL(c)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(a,u)}},{key:"_createTypeFormatter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!EXPORT_TYPES[e])throw new Error('Export format type "'.concat(e,'" is not supported.'));return typeFactory(e,new DataProvider(this.hot),t)}},{key:"_createBlob",value:function(e){var t=null;return"undefined"!=typeof Blob&&(t=new Blob([e.export()],{type:"".concat(e.options.mimeType,";charset=").concat(e.options.encoding)})),t}}]),r}(BasePlugin);registerPlugin("exportFile",ExportFile);var getOwnPropertyDescriptor$3=objectGetOwnPropertyDescriptor.f,nativeStartsWith="".startsWith,min$6=Math.min,CORRECT_IS_REGEXP_LOGIC=correctIsRegexpLogic("startsWith"),MDN_POLYFILL_BUG=!(CORRECT_IS_REGEXP_LOGIC||(descriptor=getOwnPropertyDescriptor$3(String.prototype,"startsWith"),!descriptor||descriptor.writable)),descriptor,_stateSaver;function _defineProperty$h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}_export({target:"String",proto:!0,forced:!MDN_POLYFILL_BUG&&!CORRECT_IS_REGEXP_LOGIC},{startsWith:function(e){var t=String(requireObjectCoercible(this));notARegexp(e);var r=toLength(min$6(arguments.length>1?arguments[1]:void 0,t.length)),n=String(e);return nativeStartsWith?nativeStartsWith.call(t,n,r):t.slice(r,r+n.length)===n}});var MIXIN_NAME$7="stateSaver",STATE_PREFIX="state_",PROP_PREFIX="_states",getState=function(e,t){return e[PROP_PREFIX][STATE_PREFIX+t]},setState=function(e,t,r){e[PROP_PREFIX][STATE_PREFIX+t]=r},stateSaver=(_stateSaver={},_defineProperty$h(_stateSaver,PROP_PREFIX,{}),_defineProperty$h(_stateSaver,"getCachedState",(function(e){return getState(this,e)})),_defineProperty$h(_stateSaver,"setCachedState",(function(e,t){setState(this,e,t)})),_defineProperty$h(_stateSaver,"saveState",(function(e){setState(this,e,this.getState())})),_defineProperty$h(_stateSaver,"restoreState",(function(e){this.setState(getState(this,e))})),_defineProperty$h(_stateSaver,"hasSavedState",(function(e){return void 0!==getState(this,e)})),_defineProperty$h(_stateSaver,"clearState",(function(e){setState(this,e)})),_defineProperty$h(_stateSaver,"clearStates",(function(){this[PROP_PREFIX]={}})),_stateSaver);function _classCallCheck$27(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$20(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$20(e,t,r){return t&&_defineProperties$20(e.prototype,t),r&&_defineProperties$20(e,r),e}defineGetter(stateSaver,"MIXIN_NAME",MIXIN_NAME$7,{writable:!1,enumerable:!1});var BaseComponent=function(){function e(t){_classCallCheck$27(this,e),this.hot=t,this.elements=[],this.hidden=!1}return _createClass$20(e,[{key:"reset",value:function(){arrayEach(this.elements,(function(e){return e.reset()}))}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hidden}},{key:"destroy",value:function(){this.clearLocalHooks(),arrayEach(this.elements,(function(e){return e.destroy()})),this.elements=null,this.hot=null}}]),e}();mixin(BaseComponent,localHooks),mixin(BaseComponent,stateSaver);var conditions={};function getCondition(e,t){if(!conditions[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));var r=conditions[e],n=r.condition,o=r.descriptor,i=t;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(e){return n.apply(e.meta.instance,[].concat([e],[i]))}}function getConditionDescriptor(e){if(!conditions[e])throw Error('Filter condition "'.concat(e,'" does not exist.'));return conditions[e].descriptor}function registerCondition(e,t,r){r.key=e,conditions[e]={condition:t,descriptor:r}}var CONDITION_NAME="none";function condition(){return!0}registerCondition(CONDITION_NAME,condition,{name:FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1});var CONDITION_NAME$1="empty";function condition$1(e){return""===e.value||null===e.value||void 0===e.value}registerCondition(CONDITION_NAME$1,condition$1,{name:FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0});var CONDITION_NAME$2="not_empty";function condition$2(e,t){return!getCondition(CONDITION_NAME$1,t)(e)}function _slicedToArray$p(e,t){return _arrayWithHoles$r(e)||_iterableToArrayLimit$p(e,t)||_unsupportedIterableToArray$D(e,t)||_nonIterableRest$r()}function _nonIterableRest$r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$D(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$D(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$D(e,t):void 0}}function _arrayLikeToArray$D(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$p(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$r(e){if(Array.isArray(e))return e}registerCondition(CONDITION_NAME$2,condition$2,{name:FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0});var CONDITION_NAME$3="eq";function condition$3(e,t){var r=_slicedToArray$p(t,1)[0];return stringify(e.value).toLowerCase()===stringify(r)}registerCondition(CONDITION_NAME$3,condition$3,{name:FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0});var CONDITION_NAME$4="neq";function condition$4(e,t){return!getCondition(CONDITION_NAME$3,t)(e)}function _slicedToArray$q(e,t){return _arrayWithHoles$s(e)||_iterableToArrayLimit$q(e,t)||_unsupportedIterableToArray$E(e,t)||_nonIterableRest$s()}function _nonIterableRest$s(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$E(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$E(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$E(e,t):void 0}}function _arrayLikeToArray$E(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$q(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$s(e){if(Array.isArray(e))return e}registerCondition(CONDITION_NAME$4,condition$4,{name:FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0});var CONDITION_NAME$5="gt";function condition$5(e,t){var r=_slicedToArray$q(t,1)[0];return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value>r}function _slicedToArray$r(e,t){return _arrayWithHoles$t(e)||_iterableToArrayLimit$r(e,t)||_unsupportedIterableToArray$F(e,t)||_nonIterableRest$t()}function _nonIterableRest$t(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$F(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$F(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$F(e,t):void 0}}function _arrayLikeToArray$F(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$r(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$t(e){if(Array.isArray(e))return e}registerCondition(CONDITION_NAME$5,condition$5,{name:FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0});var CONDITION_NAME$6="gte";function condition$6(e,t){var r=_slicedToArray$r(t,1)[0];return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value>=r}function _slicedToArray$s(e,t){return _arrayWithHoles$u(e)||_iterableToArrayLimit$s(e,t)||_unsupportedIterableToArray$G(e,t)||_nonIterableRest$u()}function _nonIterableRest$u(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$G(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$G(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$G(e,t):void 0}}function _arrayLikeToArray$G(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$s(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$u(e){if(Array.isArray(e))return e}registerCondition(CONDITION_NAME$6,condition$6,{name:FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});var CONDITION_NAME$7="lt";function condition$7(e,t){var r=_slicedToArray$s(t,1)[0];return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value<r}function _slicedToArray$t(e,t){return _arrayWithHoles$v(e)||_iterableToArrayLimit$t(e,t)||_unsupportedIterableToArray$H(e,t)||_nonIterableRest$v()}function _nonIterableRest$v(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$H(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$H(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$H(e,t):void 0}}function _arrayLikeToArray$H(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$t(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$v(e){if(Array.isArray(e))return e}registerCondition(CONDITION_NAME$7,condition$7,{name:FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0});var CONDITION_NAME$8="lte";function condition$8(e,t){var r=_slicedToArray$t(t,1)[0];return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value<=r}function _slicedToArray$u(e,t){return _arrayWithHoles$w(e)||_iterableToArrayLimit$u(e,t)||_unsupportedIterableToArray$I(e,t)||_nonIterableRest$w()}function _nonIterableRest$w(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$I(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$I(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$I(e,t):void 0}}function _arrayLikeToArray$I(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$u(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$w(e){if(Array.isArray(e))return e}registerCondition(CONDITION_NAME$8,condition$8,{name:FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});var CONDITION_NAME$9="date_after";function condition$9(e,t){var r=_slicedToArray$u(t,1)[0],n=moment(e.value,e.meta.dateFormat),o=moment(r,e.meta.dateFormat);return!(!n.isValid()||!o.isValid())&&n.diff(o)>=0}function _slicedToArray$v(e,t){return _arrayWithHoles$x(e)||_iterableToArrayLimit$v(e,t)||_unsupportedIterableToArray$J(e,t)||_nonIterableRest$x()}function _nonIterableRest$x(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$J(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$J(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$J(e,t):void 0}}function _arrayLikeToArray$J(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$v(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$x(e){if(Array.isArray(e))return e}registerCondition(CONDITION_NAME$9,condition$9,{name:FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0});var CONDITION_NAME$a="date_before";function condition$a(e,t){var r=_slicedToArray$v(t,1)[0],n=moment(e.value,e.meta.dateFormat),o=moment(r,e.meta.dateFormat);return!(!n.isValid()||!o.isValid())&&n.diff(o)<=0}function _slicedToArray$w(e,t){return _arrayWithHoles$y(e)||_iterableToArrayLimit$w(e,t)||_unsupportedIterableToArray$K(e,t)||_nonIterableRest$y()}function _nonIterableRest$y(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$K(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$K(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$K(e,t):void 0}}function _arrayLikeToArray$K(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$w(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$y(e){if(Array.isArray(e))return e}registerCondition(CONDITION_NAME$a,condition$a,{name:FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0});var CONDITION_NAME$b="between";function condition$b(e,t){var r=_slicedToArray$w(t,2),n=r[0],o=r[1];if("numeric"===e.meta.type){var i=parseFloat(n,10),a=parseFloat(o,10);n=Math.min(i,a),o=Math.max(i,a)}else if("date"===e.meta.type){var s=getCondition(CONDITION_NAME$a,[o]),l=getCondition(CONDITION_NAME$9,[n]);return s(e)&&l(e)}return e.value>=n&&e.value<=o}registerCondition(CONDITION_NAME$b,condition$b,{name:FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0});var CONDITION_NAME$c="not_between";function condition$c(e,t){return!getCondition(CONDITION_NAME$b,t)(e)}function _slicedToArray$x(e,t){return _arrayWithHoles$z(e)||_iterableToArrayLimit$x(e,t)||_unsupportedIterableToArray$L(e,t)||_nonIterableRest$z()}function _nonIterableRest$z(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$L(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$L(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$L(e,t):void 0}}function _arrayLikeToArray$L(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$x(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$z(e){if(Array.isArray(e))return e}registerCondition(CONDITION_NAME$c,condition$c,{name:FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0});var CONDITION_NAME$d="begins_with";function condition$d(e,t){var r=_slicedToArray$x(t,1)[0];return stringify(e.value).toLowerCase().startsWith(stringify(r))}registerCondition(CONDITION_NAME$d,condition$d,{name:FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0});var getOwnPropertyDescriptor$4=objectGetOwnPropertyDescriptor.f,nativeEndsWith="".endsWith,min$7=Math.min,CORRECT_IS_REGEXP_LOGIC$1=correctIsRegexpLogic("endsWith"),MDN_POLYFILL_BUG$1=!CORRECT_IS_REGEXP_LOGIC$1&&!!function(){var e=getOwnPropertyDescriptor$4(String.prototype,"endsWith");return e&&!e.writable}();function _slicedToArray$y(e,t){return _arrayWithHoles$A(e)||_iterableToArrayLimit$y(e,t)||_unsupportedIterableToArray$M(e,t)||_nonIterableRest$A()}function _nonIterableRest$A(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$M(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$M(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$M(e,t):void 0}}function _arrayLikeToArray$M(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$y(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$A(e){if(Array.isArray(e))return e}_export({target:"String",proto:!0,forced:!MDN_POLYFILL_BUG$1&&!CORRECT_IS_REGEXP_LOGIC$1},{endsWith:function(e){var t=String(requireObjectCoercible(this));notARegexp(e);var r=arguments.length>1?arguments[1]:void 0,n=toLength(t.length),o=void 0===r?n:min$7(toLength(r),n),i=String(e);return nativeEndsWith?nativeEndsWith.call(t,i,o):t.slice(o-i.length,o)===i}});var CONDITION_NAME$e="ends_with";function condition$e(e,t){var r=_slicedToArray$y(t,1)[0];return stringify(e.value).toLowerCase().endsWith(stringify(r))}function _slicedToArray$z(e,t){return _arrayWithHoles$B(e)||_iterableToArrayLimit$z(e,t)||_unsupportedIterableToArray$N(e,t)||_nonIterableRest$B()}function _nonIterableRest$B(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$N(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$N(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$N(e,t):void 0}}function _arrayLikeToArray$N(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$z(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$B(e){if(Array.isArray(e))return e}registerCondition(CONDITION_NAME$e,condition$e,{name:FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0});var CONDITION_NAME$f="contains";function condition$f(e,t){var r=_slicedToArray$z(t,1)[0];return stringify(e.value).toLowerCase().indexOf(stringify(r))>=0}registerCondition(CONDITION_NAME$f,condition$f,{name:FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0});var CONDITION_NAME$g="not_contains";function condition$g(e,t){return!getCondition(CONDITION_NAME$f,t)(e)}registerCondition(CONDITION_NAME$g,condition$g,{name:FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0});var CONDITION_NAME$h="date_tomorrow";function condition$h(e){var t=moment(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(moment().subtract(-1,"days").startOf("day"),"d")}registerCondition(CONDITION_NAME$h,condition$h,{name:FILTERS_CONDITIONS_TOMORROW,inputsCount:0});var CONDITION_NAME$i="date_today";function condition$i(e){var t=moment(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(moment().startOf("day"),"d")}registerCondition(CONDITION_NAME$i,condition$i,{name:FILTERS_CONDITIONS_TODAY,inputsCount:0});var CONDITION_NAME$j="date_yesterday";function condition$j(e){var t=moment(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(moment().subtract(1,"days").startOf("day"),"d")}registerCondition(CONDITION_NAME$j,condition$j,{name:FILTERS_CONDITIONS_YESTERDAY,inputsCount:0});var sortCompare=getComparisonFunction();function toVisualValue(e,t){var r=e;return""===r&&(r="(".concat(t,")")),r}var SUPPORT_SET_CONSTRUCTOR=new Set([1]).has(1),SUPPORT_FAST_DEDUPE=SUPPORT_SET_CONSTRUCTOR&&"function"==typeof Array.from;function createArrayAssertion(e){var t=e;return SUPPORT_SET_CONSTRUCTOR&&(t=new Set(t)),function(e){return SUPPORT_SET_CONSTRUCTOR?t.has(e):!!~t.indexOf(e)}}function toEmptyString(e){return null==e?"":e}function unifyColumnValues(e){var t=e;return t=(t=SUPPORT_FAST_DEDUPE?Array.from(new Set(t)):arrayUnique(t)).sort((function(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e===t?0:e>t?1:-1}))}function intersectValues(e,t,r,n){var o,i=[],a=e===t;return a||(o=createArrayAssertion(t)),arrayEach(e,(function(e){var t=!1;(a||o(e))&&(t=!0);var s={checked:t,value:e,visualValue:toVisualValue(e,r)};n&&n(s),i.push(s)})),i}function _slicedToArray$A(e,t){return _arrayWithHoles$C(e)||_iterableToArrayLimit$A(e,t)||_unsupportedIterableToArray$O(e,t)||_nonIterableRest$C()}function _nonIterableRest$C(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$O(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$O(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$O(e,t):void 0}}function _arrayLikeToArray$O(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$A(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$C(e){if(Array.isArray(e))return e}var CONDITION_NAME$k="by_value";function condition$k(e,t){return(0,_slicedToArray$A(t,1)[0])(e.value)}registerCondition(CONDITION_NAME$k,condition$k,{name:"By value",inputsCount:0,inputValuesDecorator:function(e){return[createArrayAssertion(_slicedToArray$A(e,1)[0])]},showOperators:!1});var CONDITION_NAME$l="true";function condition$l(){return!0}registerCondition(CONDITION_NAME$l,condition$l,{name:"True"});var CONDITION_NAME$m="false";function condition$m(){return!1}registerCondition(CONDITION_NAME$m,condition$m,{name:"False"});var operations={};function getOperationFunc(e){if(!operations[e])throw Error('Operation with id "'.concat(e,'" does not exist.'));var t=operations[e].func;return function(e,r){return t(e,r)}}function getOperationName(e){return operations[e].name}function registerOperation(e,t,r){operations[e]={name:t,func:r}}var OPERATION_ID="conjunction",SHORT_NAME_FOR_COMPONENT=FILTERS_LABELS_CONJUNCTION;function operationResult(e,t){return e.every((function(e){return e.func(t)}))}registerOperation(OPERATION_ID,SHORT_NAME_FOR_COMPONENT,operationResult);var OPERATION_ID$1="disjunction",SHORT_NAME_FOR_COMPONENT$1=FILTERS_LABELS_DISJUNCTION;function operationResult$1(e,t){return e.some((function(e){return e.func(t)}))}registerOperation(OPERATION_ID$1,SHORT_NAME_FOR_COMPONENT$1,operationResult$1);var OPERATION_ID$2="disjunctionWithExtraCondition",SHORT_NAME_FOR_COMPONENT$2=FILTERS_LABELS_DISJUNCTION,_TYPES;function operationResult$2(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some((function(e){return e.func(t)}))&&e[e.length-1].func(t)}function _defineProperty$i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}registerOperation(OPERATION_ID$2,SHORT_NAME_FOR_COMPONENT$2,operationResult$2);var TYPE_NUMERIC="numeric",TYPE_TEXT="text",TYPE_DATE="date",TYPES=(_TYPES={},_defineProperty$i(_TYPES,TYPE_NUMERIC,[CONDITION_NAME,KEY,CONDITION_NAME$1,CONDITION_NAME$2,KEY,CONDITION_NAME$3,CONDITION_NAME$4,KEY,CONDITION_NAME$5,CONDITION_NAME$6,CONDITION_NAME$7,CONDITION_NAME$8,CONDITION_NAME$b,CONDITION_NAME$c]),_defineProperty$i(_TYPES,TYPE_TEXT,[CONDITION_NAME,KEY,CONDITION_NAME$1,CONDITION_NAME$2,KEY,CONDITION_NAME$3,CONDITION_NAME$4,KEY,CONDITION_NAME$d,CONDITION_NAME$e,KEY,CONDITION_NAME$f,CONDITION_NAME$g]),_defineProperty$i(_TYPES,TYPE_DATE,[CONDITION_NAME,KEY,CONDITION_NAME$1,CONDITION_NAME$2,KEY,CONDITION_NAME$3,CONDITION_NAME$4,KEY,CONDITION_NAME$a,CONDITION_NAME$9,CONDITION_NAME$b,KEY,CONDITION_NAME$h,CONDITION_NAME$i,CONDITION_NAME$j]),_TYPES);function getOptionsList(e){var t=[],r=e;return TYPES[r]||(r=TYPE_TEXT),arrayEach(TYPES[r],(function(e){var r;r=e===KEY?{name:KEY}:clone(getConditionDescriptor(e)),t.push(r)})),t}function _classCallCheck$28(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$21(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$21(e,t,r){return t&&_defineProperties$21(e.prototype,t),r&&_defineProperties$21(e,r),e}var STATE_BUILT$2="built",STATE_BUILDING="building",EVENTS_TO_REGISTER=["click","input","keydown","keypress","keyup","focus","blur","change"],BaseUI$2=function(){function e(t,r){_classCallCheck$28(this,e),this.hot=t,this.eventManager=new EventManager(this),this.options=extend(e.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=!1}return _createClass$21(e,null,[{key:"DEFAULTS",get:function(){return clone({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),_createClass$21(e,[{key:"setValue",value:function(e){this.options.value=e,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"isBuilt",value:function(){return this.buildState===STATE_BUILT$2}},{key:"translateIfPossible",value:function(e){return"string"==typeof e&&e.startsWith(FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(e):e}},{key:"build",value:function(){var e=this,t=function(t,r){e.eventManager.addEventListener(t,r,(function(t){return e.runLocalHooks(r,t,e)}))};if(this.buildState||(this.buildState=STATE_BUILDING),this.options.className&&addClass(this._element,this.options.className),this.options.children.length)arrayEach(this.options.children,(function(t){return e._element.appendChild(t.element)}));else if(this.options.wrapIt){var r=this.hot.rootDocument.createElement(this.options.tagName);objectEach(this.options,(function(t,n){void 0!==r[n]&&"className"!==n&&"tagName"!==n&&"children"!==n&&(r[n]=e.translateIfPossible(t))})),this._element.appendChild(r),arrayEach(EVENTS_TO_REGISTER,(function(e){return t(r,e)}))}else arrayEach(EVENTS_TO_REGISTER,(function(r){return t(e._element,r)}))}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}},{key:"element",get:function(){return this.buildState===STATE_BUILDING?this._element:this.buildState===STATE_BUILT$2?(this.update(),this._element):(this.buildState=STATE_BUILDING,this.build(),this.buildState=STATE_BUILT$2,this._element)}}]),e}();function _typeof$1c(e){return(_typeof$1c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$29(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _get$E(e,t,r){return(_get$E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$E(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$E(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$12(e)););return e}function _defineProperties$22(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$22(e,t,r){return t&&_defineProperties$22(e.prototype,t),r&&_defineProperties$22(e,r),e}function _inherits$12(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$13(e,t)}function _setPrototypeOf$13(e,t){return(_setPrototypeOf$13=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$12(e){var t=_isNativeReflectConstruct$13();return function(){var r,n=_getPrototypeOf$12(e);if(t){var o=_getPrototypeOf$12(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$12(this,r)}}function _possibleConstructorReturn$12(e,t){return!t||"object"!==_typeof$1c(t)&&"function"!=typeof t?_assertThisInitialized$12(e):t}function _assertThisInitialized$12(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$13(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$12(e){return(_getPrototypeOf$12=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}mixin(BaseUI$2,localHooks);var privatePool$f=new WeakMap,InputUI=function(e){_inherits$12(r,e);var t=_createSuper$12(r);function r(e,n){var o;return _classCallCheck$29(this,r),o=t.call(this,e,extend(r.DEFAULTS,n)),privatePool$f.set(_assertThisInitialized$12(o),{}),o.registerHooks(),o}return _createClass$22(r,null,[{key:"DEFAULTS",get:function(){return clone({placeholder:"",type:"text",tagName:"input"})}}]),_createClass$22(r,[{key:"registerHooks",value:function(){var e=this;this.addLocalHook("click",(function(){return e.onClick()})),this.addLocalHook("keyup",(function(t){return e.onKeyup(t)}))}},{key:"build",value:function(){_get$E(_getPrototypeOf$12(r.prototype),"build",this).call(this);var e=privatePool$f.get(this),t=this.hot.rootDocument.createElement("div");e.input=this._element.firstChild,addClass(this._element,"htUIInput"),addClass(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var e=privatePool$f.get(this).input;e.type=this.options.type,e.placeholder=this.translateIfPossible(this.options.placeholder),e.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&privatePool$f.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(e){this.options.value=e.target.value}}]),r}(BaseUI$2);function _typeof$1d(e){return(_typeof$1d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$2a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _get$F(e,t,r){return(_get$F="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$F(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$F(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$13(e)););return e}function _defineProperties$23(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$23(e,t,r){return t&&_defineProperties$23(e.prototype,t),r&&_defineProperties$23(e,r),e}function _inherits$13(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$14(e,t)}function _setPrototypeOf$14(e,t){return(_setPrototypeOf$14=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$13(e){var t=_isNativeReflectConstruct$14();return function(){var r,n=_getPrototypeOf$13(e);if(t){var o=_getPrototypeOf$13(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$13(this,r)}}function _possibleConstructorReturn$13(e,t){return!t||"object"!==_typeof$1d(t)&&"function"!=typeof t?_assertThisInitialized$13(e):t}function _assertThisInitialized$13(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$14(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$13(e){return(_getPrototypeOf$13=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var privatePool$g=new WeakMap,SelectUI=function(e){_inherits$13(r,e);var t=_createSuper$13(r);function r(e,n){var o;return _classCallCheck$2a(this,r),o=t.call(this,e,extend(r.DEFAULTS,n)),privatePool$g.set(_assertThisInitialized$13(o),{}),o.menu=null,o.items=[],o.registerHooks(),o}return _createClass$23(r,null,[{key:"DEFAULTS",get:function(){return clone({className:"htUISelect",wrapIt:!1})}}]),_createClass$23(r,[{key:"registerHooks",value:function(){var e=this;this.addLocalHook("click",(function(){return e.onClick()}))}},{key:"setItems",value:function(e){this.items=this.translateNames(e),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(e){var t=this;return arrayEach(e,(function(e){e.name=t.translateIfPossible(e.name)})),e}},{key:"build",value:function(){var e=this;_get$F(_getPrototypeOf$13(r.prototype),"build",this).call(this),this.menu=new Menu(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var t=new BaseUI$2(this.hot,{className:"htUISelectCaption"}),n=new BaseUI$2(this.hot,{className:"htUISelectDropdown"}),o=privatePool$g.get(this);o.caption=t,o.captionElement=t.element,o.dropdown=n,arrayEach([t,n],(function(t){return e._element.appendChild(t.element)})),this.menu.addLocalHook("select",(function(t){return e.onMenuSelect(t)})),this.menu.addLocalHook("afterClose",(function(){return e.onMenuClosed()})),this.update()}},{key:"update",value:function(){var e;this.isBuilt()&&(e=this.options.value?this.options.value.name:this.menu.hot.getTranslatedPhrase(FILTERS_CONDITIONS_NONE),privatePool$g.get(this).captionElement.textContent=e,_get$F(_getPrototypeOf$13(r.prototype),"update",this).call(this))}},{key:"openOptions",value:function(){var e=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:e.left-5,top:e.top,width:e.width,height:e.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(e){e.name!==KEY&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var e=privatePool$g.get(this),t=e.caption,n=e.dropdown;t&&t.destroy(),n&&n.destroy(),_get$F(_getPrototypeOf$13(r.prototype),"destroy",this).call(this)}}]),r}(BaseUI$2);function _typeof$1e(e){return(_typeof$1e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray$i(e){return _arrayWithoutHoles$i(e)||_iterableToArray$k(e)||_unsupportedIterableToArray$P(e)||_nonIterableSpread$i()}function _nonIterableSpread$i(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$P(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$P(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$P(e,t):void 0}}function _iterableToArray$k(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$i(e){if(Array.isArray(e))return _arrayLikeToArray$P(e)}function _arrayLikeToArray$P(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$2b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$24(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$24(e,t,r){return t&&_defineProperties$24(e.prototype,t),r&&_defineProperties$24(e,r),e}function _get$G(e,t,r){return(_get$G="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$G(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$G(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$14(e)););return e}function _inherits$14(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$15(e,t)}function _setPrototypeOf$15(e,t){return(_setPrototypeOf$15=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$14(e){var t=_isNativeReflectConstruct$15();return function(){var r,n=_getPrototypeOf$14(e);if(t){var o=_getPrototypeOf$14(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$14(this,r)}}function _possibleConstructorReturn$14(e,t){return!t||"object"!==_typeof$1e(t)&&"function"!=typeof t?_assertThisInitialized$14(e):t}function _assertThisInitialized$14(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$15(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$14(e){return(_getPrototypeOf$14=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ConditionComponent=function(e){_inherits$14(r,e);var t=_createSuper$14(r);function r(e,n){var o;return _classCallCheck$2b(this,r),(o=t.call(this,e)).id=n.id,o.name=n.name,o.addSeparator=n.addSeparator,o.elements.push(new SelectUI(o.hot,{menuContainer:n.menuContainer})),o.elements.push(new InputUI(o.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_VALUE})),o.elements.push(new InputUI(o.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),o.registerHooks(),o}return _createClass$24(r,[{key:"registerHooks",value:function(){var e=this;this.getSelectElement().addLocalHook("select",(function(t){return e.onConditionSelect(t)})),this.getSelectElement().addLocalHook("afterClose",(function(){return e.onSelectUIClosed()})),arrayEach(this.getInputElements(),(function(t){t.addLocalHook("keydown",(function(t){return e.onInputKeyDown(t)}))}))}},{key:"setState",value:function(e){var t=this;if(this.reset(),e){var r=clone(e.command);r.name.startsWith(FILTERS_CONDITIONS_NAMESPACE)&&(r.name=this.hot.getTranslatedPhrase(r.name)),this.getSelectElement().setValue(r),arrayEach(e.args,(function(e,n){if(n>r.inputsCount-1)return!1;var o=t.getInputElement(n);o.setValue(e),o[r.inputsCount>n?"show":"hide"](),n||setTimeout((function(){return o.focus()}),10)}))}}},{key:"getState",value:function(){var e=this.getSelectElement().getValue()||getConditionDescriptor(CONDITION_NAME),t=[];return arrayEach(this.getInputElements(),(function(r,n){e.inputsCount>n&&t.push(r.getValue())})),{command:e,args:t}}},{key:"updateState",value:function(e,t){var r=getConditionDescriptor(e?e.name:CONDITION_NAME);this.setCachedState(t,{command:r,args:e?e.args:[]}),e||arrayEach(this.getInputElements(),(function(e){return e.setValue(null)}))}},{key:"getSelectElement",value:function(){return this.elements.filter((function(e){return e instanceof SelectUI}))[0]}},{key:"getInputElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[e]}},{key:"getInputElements",value:function(){return this.elements.filter((function(e){return e instanceof InputUI}))}},{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,r,n,o,i,a){addClass(r.parentNode,"htFiltersMenuCondition"),e.addSeparator&&addClass(r.parentNode,"border");var s=e.hot.rootDocument.createElement("div");return addClass(s,"htFiltersMenuLabel"),s.textContent=a,r.appendChild(s),r.parentNode.hasAttribute("ghost-table")||arrayEach(e.elements,(function(e){return r.appendChild(e.element)})),r}}}},{key:"reset",value:function(){var e,t=this.hot.getPlugin("filters").getSelectedColumn(),n=t&&t.visualIndex,o=getOptionsList((e=this.hot).getDataType.apply(e,_toConsumableArray$i(this.hot.getSelectedLast()||[0,n])));arrayEach(this.getInputElements(),(function(e){return e.hide()})),this.getSelectElement().setItems(o),_get$G(_getPrototypeOf$14(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(o[0])}},{key:"onConditionSelect",value:function(e){arrayEach(this.getInputElements(),(function(t,r){t[e.inputsCount>r?"show":"hide"](),0===r&&setTimeout((function(){return t.focus()}),10)})),this.runLocalHooks("change",e)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(e){isKey(e.keyCode,"ENTER")?(this.runLocalHooks("accept"),stopImmediatePropagation(e)):isKey(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),stopImmediatePropagation(e))}}]),r}(BaseComponent);function _typeof$1f(e){return(_typeof$1f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$2c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _get$H(e,t,r){return(_get$H="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$H(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$H(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$15(e)););return e}function _defineProperties$25(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$25(e,t,r){return t&&_defineProperties$25(e.prototype,t),r&&_defineProperties$25(e,r),e}function _inherits$15(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$16(e,t)}function _setPrototypeOf$16(e,t){return(_setPrototypeOf$16=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$15(e){var t=_isNativeReflectConstruct$16();return function(){var r,n=_getPrototypeOf$15(e);if(t){var o=_getPrototypeOf$15(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$15(this,r)}}function _possibleConstructorReturn$15(e,t){return!t||"object"!==_typeof$1f(t)&&"function"!=typeof t?_assertThisInitialized$15(e):t}function _assertThisInitialized$15(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$16(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$15(e){return(_getPrototypeOf$15=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var privatePool$h=new WeakMap,RadioInputUI=function(e){_inherits$15(r,e);var t=_createSuper$15(r);function r(e,n){var o;return _classCallCheck$2c(this,r),o=t.call(this,e,extend(r.DEFAULTS,n)),privatePool$h.set(_assertThisInitialized$15(o),{}),o}return _createClass$25(r,null,[{key:"DEFAULTS",get:function(){return clone({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),_createClass$25(r,[{key:"build",value:function(){_get$H(_getPrototypeOf$15(r.prototype),"build",this).call(this);var e=privatePool$h.get(this);e.input=this._element.firstChild;var t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),e.label=t,this._element.appendChild(t),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var e=privatePool$h.get(this);e.input.checked=this.options.checked,e.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.options.checked=e,this.update()}},{key:"focus",value:function(){this.isBuilt()&&privatePool$h.get(this).input.focus()}}]),r}(BaseUI$2);function _typeof$1g(e){return(_typeof$1g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _templateObject$8(){var e=_taggedTemplateLiteral$8(["Radio button with index "," doesn't exist."]);return _templateObject$8=function(){return e},e}function _taggedTemplateLiteral$8(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _classCallCheck$2d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$26(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$26(e,t,r){return t&&_defineProperties$26(e.prototype,t),r&&_defineProperties$26(e,r),e}function _inherits$16(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$17(e,t)}function _setPrototypeOf$17(e,t){return(_setPrototypeOf$17=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$16(e){var t=_isNativeReflectConstruct$17();return function(){var r,n=_getPrototypeOf$16(e);if(t){var o=_getPrototypeOf$16(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$16(this,r)}}function _possibleConstructorReturn$16(e,t){return!t||"object"!==_typeof$1g(t)&&"function"!=typeof t?_assertThisInitialized$16(e):t}function _assertThisInitialized$16(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$17(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$16(e){return(_getPrototypeOf$16=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var SELECTED_AT_START_ELEMENT_INDEX=0,OperatorsComponent=function(e){_inherits$16(r,e);var t=_createSuper$16(r);function r(e,n){var o;return _classCallCheck$2d(this,r),(o=t.call(this,e)).id=n.id,o.name=n.name,o.buildOperatorsElement(),o}return _createClass$26(r,[{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,r){return addClass(r.parentNode,"htFiltersMenuOperators"),r.parentNode.hasAttribute("ghost-table")||arrayEach(e.elements,(function(e){return r.appendChild(e.element)})),r}}}},{key:"buildOperatorsElement",value:function(){var e=this,t=[OPERATION_ID,OPERATION_ID$1];arrayEach(t,(function(r){var n=new RadioInputUI(e.hot,{name:"operator",label:{htmlFor:r,textContent:getOperationName(r)},value:r,checked:r===t[SELECTED_AT_START_ELEMENT_INDEX],id:r});n.addLocalHook("change",(function(t){return e.onRadioInputChange(t)})),e.elements.push(n)}))}},{key:"setChecked",value:function(e){if(this.elements.length<e)throw Error(toSingleLine(_templateObject$8(),e));arrayEach(this.elements,(function(t,r){t.setChecked(r===e)}))}},{key:"getActiveOperationId",value:function(){var e=this.elements.find((function(e){return e instanceof RadioInputUI&&e.isChecked()}));return e?e.getValue():OPERATION_ID}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(e){this.reset(),e&&this.getActiveOperationId()!==e&&arrayEach(this.elements,(function(t){t.setChecked(t.getValue()===e)}))}},{key:"updateState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:OPERATION_ID,t=arguments.length>1?arguments[1]:void 0,r=e;r===OPERATION_ID$2&&(r=OPERATION_ID$1),this.setCachedState(t,r)}},{key:"reset",value:function(){this.setChecked(SELECTED_AT_START_ELEMENT_INDEX)}},{key:"onRadioInputChange",value:function(e){this.setState(e.target.value)}}]),r}(BaseComponent),quot=/"/g,createHtml=function(e,t,r,n){var o=String(requireObjectCoercible(e)),i="<"+t;return""!==r&&(i+=" "+r+'="'+String(n).replace(quot,"&quot;")+'"'),i+">"+o+"</"+t+">"},stringHtmlForced=function(e){return fails((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))};function _typeof$1h(e){return(_typeof$1h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _get$I(e,t,r){return(_get$I="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$I(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$I(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$17(e)););return e}function _defineProperties$27(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$27(e,t,r){return t&&_defineProperties$27(e.prototype,t),r&&_defineProperties$27(e,r),e}function _inherits$17(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$18(e,t)}function _setPrototypeOf$18(e,t){return(_setPrototypeOf$18=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$17(e){var t=_isNativeReflectConstruct$18();return function(){var r,n=_getPrototypeOf$17(e);if(t){var o=_getPrototypeOf$17(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$17(this,r)}}function _possibleConstructorReturn$17(e,t){return!t||"object"!==_typeof$1h(t)&&"function"!=typeof t?_assertThisInitialized$17(e):t}function _assertThisInitialized$17(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$18(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$17(e){return(_getPrototypeOf$17=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}_export({target:"String",proto:!0,forced:stringHtmlForced("link")},{link:function(e){return createHtml(this,"a","href",e)}});var privatePool$i=new WeakMap,LinkUI=function(e){_inherits$17(r,e);var t=_createSuper$17(r);function r(e,n){var o;return _classCallCheck$2e(this,r),o=t.call(this,e,extend(r.DEFAULTS,n)),privatePool$i.set(_assertThisInitialized$17(o),{}),o}return _createClass$27(r,null,[{key:"DEFAULTS",get:function(){return clone({href:"#",tagName:"a"})}}]),_createClass$27(r,[{key:"build",value:function(){_get$I(_getPrototypeOf$17(r.prototype),"build",this).call(this),privatePool$i.get(this).link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(privatePool$i.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}]),r}(BaseUI$2);function _typeof$1i(e){return(_typeof$1i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray$j(e){return _arrayWithoutHoles$j(e)||_iterableToArray$l(e)||_unsupportedIterableToArray$Q(e)||_nonIterableSpread$j()}function _nonIterableSpread$j(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$Q(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$Q(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$Q(e,t):void 0}}function _iterableToArray$l(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$j(e){if(Array.isArray(e))return _arrayLikeToArray$Q(e)}function _arrayLikeToArray$Q(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$2f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _get$J(e,t,r){return(_get$J="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$J(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$J(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$18(e)););return e}function _defineProperties$28(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$28(e,t,r){return t&&_defineProperties$28(e.prototype,t),r&&_defineProperties$28(e,r),e}function _inherits$18(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$19(e,t)}function _setPrototypeOf$19(e,t){return(_setPrototypeOf$19=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$18(e){var t=_isNativeReflectConstruct$19();return function(){var r,n=_getPrototypeOf$18(e);if(t){var o=_getPrototypeOf$18(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$18(this,r)}}function _possibleConstructorReturn$18(e,t){return!t||"object"!==_typeof$1i(t)&&"function"!=typeof t?_assertThisInitialized$18(e):t}function _assertThisInitialized$18(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$19(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$18(e){return(_getPrototypeOf$18=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var privatePool$j=new WeakMap,MultipleSelectUI=function(e){_inherits$18(r,e);var t=_createSuper$18(r);function r(e,n){var o;return _classCallCheck$2f(this,r),o=t.call(this,e,extend(r.DEFAULTS,n)),privatePool$j.set(_assertThisInitialized$18(o),{}),o.searchInput=new InputUI(o.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"}),o.selectAllUI=new LinkUI(o.hot,{textContent:FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"}),o.clearAllUI=new LinkUI(o.hot,{textContent:FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"}),o.items=[],o.itemsBox=null,o.registerHooks(),o}return _createClass$28(r,null,[{key:"DEFAULTS",get:function(){return clone({className:"htUIMultipleSelect",value:[]})}}]),_createClass$28(r,[{key:"registerHooks",value:function(){var e=this;this.searchInput.addLocalHook("keydown",(function(t){return e.onInputKeyDown(t)})),this.searchInput.addLocalHook("input",(function(t){return e.onInput(t)})),this.selectAllUI.addLocalHook("click",(function(t){return e.onSelectAllClick(t)})),this.clearAllUI.addLocalHook("click",(function(t){return e.onClearAllClick(t)}))}},{key:"setItems",value:function(e){this.items=e,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"getItems",value:function(){return _toConsumableArray$j(this.items)}},{key:"getValue",value:function(){return itemsToValue(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var e=this;_get$J(_getPrototypeOf$18(r.prototype),"build",this).call(this);var t=this.hot.rootDocument,n=t.createElement("div"),o=new BaseUI$2(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(o.element),this._element.appendChild(n);var i=function(r){e._element&&(e.itemsBox&&e.itemsBox.destroy(),addClass(r,"htUIMultipleSelectHot"),e.itemsBox=new e.hot.constructor(r,{data:e.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(e,t,r,n,o,i){e.title=i.instance.getDataAtRowProp(t,i.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return e.itemsBox.container.scrollWidth-getScrollbarWidth(t)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},beforeKeyDown:function(t){return e.onItemsBoxBeforeKeyDown(t)}}),e.itemsBox.init())};i(n),setTimeout((function(){return i(n)}),100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(valueToItems(this.items,this.options.value)),_get$J(_getPrototypeOf$18(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,_get$J(_getPrototypeOf$18(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(e){var t,r=e.target.value.toLowerCase();t=""===r?_toConsumableArray$j(this.items):arrayFilter(this.items,(function(e){return"".concat(e.value).toLowerCase().indexOf(r)>=0})),this.itemsBox.loadData(t)}},{key:"onInputKeyDown",value:function(e){this.runLocalHooks("keydown",e,this),partial(isKey,e.keyCode)("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(stopImmediatePropagation(e),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onItemsBoxBeforeKeyDown",value:function(e){var t=partial(isKey,e.keyCode);t("ESCAPE")&&this.runLocalHooks("keydown",e,this),t("ARROW_UP|ARROW_DOWN|ARROW_LEFT|ARROW_RIGHT|TAB|SPACE|ENTER")||(stopImmediatePropagation(e),this.itemsBox.unlisten(),this.itemsBox.deselectCell(),this.searchInput.focus())}},{key:"onSelectAllClick",value:function(e){var t=[];e.preventDefault(),arrayEach(this.itemsBox.getSourceData(),(function(e,r){e.checked=!0,t.push(dataRowToChangesArray(e,r)[0])})),this.itemsBox.setSourceDataAtCell(t)}},{key:"onClearAllClick",value:function(e){var t=[];e.preventDefault(),arrayEach(this.itemsBox.getSourceData(),(function(e,r){e.checked=!1,t.push(dataRowToChangesArray(e,r)[0])})),this.itemsBox.setSourceDataAtCell(t)}}]),r}(BaseUI$2);function valueToItems(e,t){var r=createArrayAssertion(t);return arrayMap(e,(function(e){return e.checked=r(e.value),e}))}function itemsToValue(e){var t=[];return arrayEach(e,(function(e){e.checked&&t.push(e.value)})),t}function _typeof$1j(e){return(_typeof$1j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _slicedToArray$B(e,t){return _arrayWithHoles$D(e)||_iterableToArrayLimit$B(e,t)||_unsupportedIterableToArray$R(e,t)||_nonIterableRest$D()}function _nonIterableRest$D(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$R(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$R(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$R(e,t):void 0}}function _arrayLikeToArray$R(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$B(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$D(e){if(Array.isArray(e))return e}function _classCallCheck$2g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$29(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$29(e,t,r){return t&&_defineProperties$29(e.prototype,t),r&&_defineProperties$29(e,r),e}function _get$K(e,t,r){return(_get$K="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$K(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$K(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$19(e)););return e}function _inherits$19(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$1a(e,t)}function _setPrototypeOf$1a(e,t){return(_setPrototypeOf$1a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$19(e){var t=_isNativeReflectConstruct$1a();return function(){var r,n=_getPrototypeOf$19(e);if(t){var o=_getPrototypeOf$19(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$19(this,r)}}function _possibleConstructorReturn$19(e,t){return!t||"object"!==_typeof$1j(t)&&"function"!=typeof t?_assertThisInitialized$19(e):t}function _assertThisInitialized$19(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$19(e){return(_getPrototypeOf$19=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ValueComponent=function(e){_inherits$19(r,e);var t=_createSuper$19(r);function r(e,n){var o;return _classCallCheck$2g(this,r),(o=t.call(this,e)).id=n.id,o.name=n.name,o.elements.push(new MultipleSelectUI(o.hot)),o.registerHooks(),o}return _createClass$29(r,[{key:"registerHooks",value:function(){var e=this;this.getMultipleSelectElement().addLocalHook("keydown",(function(t){return e.onInputKeyDown(t)}))}},{key:"setState",value:function(e){if(this.reset(),e&&e.command.key===CONDITION_NAME$k){var t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0])}}},{key:"getState",value:function(){var e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?CONDITION_NAME:CONDITION_NAME$k},args:[e.getValue()],itemsSnapshot:t}}},{key:"updateState",value:function(e){var t=this,r=function(e,r,n,o,i){var a=_slicedToArray$B(arrayFilter(r,(function(e){return e.name===CONDITION_NAME$k})),1)[0],s={},l=t.hot.getTranslatedPhrase(FILTERS_VALUES_BLANK_CELLS);if(a){var u=arrayMap(o(e,i),(function(e){return e.value}));u=unifyColumnValues(u),n&&(a.args[0]=n);var c=[],f=intersectValues(u,a.args[0],l,(function(e){e.checked&&c.push(e.value)}));s.args=[c],s.command=getConditionDescriptor(CONDITION_NAME$k),s.itemsSnapshot=f}else s.args=[],s.command=getConditionDescriptor(CONDITION_NAME);t.setCachedState(e,s)};r(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&r(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter((function(e){return e instanceof MultipleSelectUI}))[0]}},{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,r,n,o,i,a){addClass(r.parentNode,"htFiltersMenuValue");var s=e.hot.rootDocument.createElement("div");return addClass(s,"htFiltersMenuLabel"),s.textContent=a,r.appendChild(s),r.parentNode.hasAttribute("ghost-table")||arrayEach(e.elements,(function(e){return r.appendChild(e.element)})),r}}}},{key:"reset",value:function(){var e=this.hot.getTranslatedPhrase(FILTERS_VALUES_BLANK_CELLS),t=unifyColumnValues(this._getColumnVisibleValues()),n=intersectValues(t,t,e);this.getMultipleSelectElement().setItems(n),_get$K(_getPrototypeOf$19(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(t)}},{key:"onInputKeyDown",value:function(e){isKey(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),stopImmediatePropagation(e))}},{key:"_getColumnVisibleValues",value:function(){var e=this.hot.getPlugin("filters").getSelectedColumn(),t=e&&e.visualIndex;return arrayMap(this.hot.getDataAtCol(t),(function(e){return toEmptyString(e)}))}}]),r}(BaseComponent);function _typeof$1k(e){return(_typeof$1k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$2h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2a(e,t,r){return t&&_defineProperties$2a(e.prototype,t),r&&_defineProperties$2a(e,r),e}function _inherits$1a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$1b(e,t)}function _setPrototypeOf$1b(e,t){return(_setPrototypeOf$1b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$1a(e){var t=_isNativeReflectConstruct$1b();return function(){var r,n=_getPrototypeOf$1a(e);if(t){var o=_getPrototypeOf$1a(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$1a(this,r)}}function _possibleConstructorReturn$1a(e,t){return!t||"object"!==_typeof$1k(t)&&"function"!=typeof t?_assertThisInitialized$1a(e):t}function _assertThisInitialized$1a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$1a(e){return(_getPrototypeOf$1a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ActionBarComponent=function(e){_inherits$1a(r,e);var t=_createSuper$1a(r);function r(e,n){var o;return _classCallCheck$2h(this,r),(o=t.call(this,e)).id=n.id,o.name=n.name,o.elements.push(new InputUI(o.hot,{type:"button",value:FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),o.elements.push(new InputUI(o.hot,{type:"button",value:FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),o.registerHooks(),o}return _createClass$2a(r,null,[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),_createClass$2a(r,[{key:"registerHooks",value:function(){var e=this;arrayEach(this.elements,(function(t){t.addLocalHook("click",(function(t,r){return e.onButtonClick(t,r)}))}))}},{key:"getMenuItemDescriptor",value:function(){var e=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,r){return addClass(r.parentNode,"htFiltersMenuActionBar"),r.parentNode.hasAttribute("ghost-table")||arrayEach(e.elements,(function(e){return r.appendChild(e.element)})),r}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(e,t){t.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}]),r}(BaseComponent);function _templateObject2$2(){var e=_taggedTemplateLiteral$9(["Unexpected operation named `","`. Possible ones are \n          `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n          \\`disjunction\\` and \\`conjunction\\`."]);return _templateObject2$2=function(){return e},e}function _templateObject$9(){var e=_taggedTemplateLiteral$9(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."]);return _templateObject$9=function(){return e},e}function _taggedTemplateLiteral$9(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _classCallCheck$2i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2b(e,t,r){return t&&_defineProperties$2b(e.prototype,t),r&&_defineProperties$2b(e,r),e}var ConditionCollection=function(){function e(){_classCallCheck$2i(this,e),this.conditions=this.initConditionsCollection(),this.columnTypes={},this.orderStack=[]}return _createClass$2b(e,[{key:"isEmpty",value:function(){return!this.orderStack.length}},{key:"isMatch",value:function(e,t){var r=this,n=!0;if(void 0===t)objectEach(this.columnTypes,(function(t,o){return n=r.isMatchInConditions(r.conditions[t][o],e,t)}));else{var o=this.columnTypes[t];n=this.isMatchInConditions(this.getConditions(t),e,o)}return n}},{key:"isMatchInConditions",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:OPERATION_ID;return!e.length||getOperationFunc(r)(e,t)}},{key:"addCondition",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:OPERATION_ID,n=arrayMap(t.args,(function(e){return"string"==typeof e?e.toLowerCase():e})),o=t.name||t.command.key;this.runLocalHooks("beforeAdd",e),-1===this.orderStack.indexOf(e)&&this.orderStack.push(e);var i=this.columnTypes[e];if(i){if(i!==r)throw Error(toSingleLine(_templateObject$9(),e,i))}else{if(!this.conditions[r])throw new Error(toSingleLine(_templateObject2$2(),r));this.columnTypes[e]=r}this.getConditions(e).push({name:o,args:n,func:getCondition(o,n)}),this.runLocalHooks("afterAdd",e)}},{key:"getConditions",value:function(e){var t=this.columnTypes[e];return t?(this.conditions[t][e]||(this.conditions[t][e]=[]),this.conditions[t][e]):[]}},{key:"exportAllConditions",value:function(){var e=this,t=[];return arrayEach(this.orderStack,(function(r){var n=arrayMap(e.getConditions(r),(function(e){return{name:e.name,args:e.args}})),o=e.columnTypes[r];t.push({column:r,operation:o,conditions:n})})),t}},{key:"importAllConditions",value:function(e){var t=this;this.clean(),arrayEach(e,(function(e){t.orderStack.push(e.column),arrayEach(e.conditions,(function(r){return t.addCondition(e.column,r)}))}))}},{key:"removeConditions",value:function(e){this.runLocalHooks("beforeRemove",e),this.orderStack.indexOf(e)>=0&&this.orderStack.splice(this.orderStack.indexOf(e),1),this.clearConditions(e),this.runLocalHooks("afterRemove",e)}},{key:"clearConditions",value:function(e){this.runLocalHooks("beforeClear",e),this.getConditions(e).length=0,delete this.columnTypes[e],this.runLocalHooks("afterClear",e)}},{key:"hasConditions",value:function(e,t){if(!this.columnTypes[e])return!1;var r=this.getConditions(e);return t?arrayFilter(r,(function(e){return e.name===t})).length>0:r.length>0}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.columnTypes=Object.create(null),this.orderStack.length=0,this.conditions=this.initConditionsCollection(),this.runLocalHooks("afterClean")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.conditions=null,this.orderStack=null,this.columnTypes=null}},{key:"initConditionsCollection",value:function(){var e=Object.create(null);return objectEach(operations,(function(t,r){e[r]=Object.create(null)})),e}}]),e}();function _classCallCheck$2j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2c(e,t,r){return t&&_defineProperties$2c(e.prototype,t),r&&_defineProperties$2c(e,r),e}mixin(ConditionCollection,localHooks);var DataFilter=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return[]};_classCallCheck$2j(this,e),this.conditionCollection=t,this.columnDataFactory=r}return _createClass$2c(e,[{key:"filter",value:function(){var e=this,t=[];return this.conditionCollection.isEmpty()||arrayEach(this.conditionCollection.orderStack,(function(r,n){var o=e.columnDataFactory(r);n&&(o=e._getIntersectData(o,t)),t=e.filterByColumn(r,o)})),t}},{key:"filterByColumn",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return arrayEach(r,(function(r){void 0!==r&&t.conditionCollection.isMatch(r,e)&&n.push(r)})),n}},{key:"_getIntersectData",value:function(e,t){var r=[];return arrayEach(t,(function(t){var n=t.meta.visualRow;void 0!==e[n]&&(r[n]=e[n])})),r}}]),e}();function _classCallCheck$2k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2d(e,t,r){return t&&_defineProperties$2d(e.prototype,t),r&&_defineProperties$2d(e,r),e}var ConditionUpdateObserver=function(){function e(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return[]};_classCallCheck$2k(this,e),this.conditionCollection=t,this.columnDataFactory=n,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",(function(e){return r._onConditionBeforeModify(e)})),this.conditionCollection.addLocalHook("afterAdd",(function(e){return r.updateStatesAtColumn(e)})),this.conditionCollection.addLocalHook("afterClear",(function(e){return r.updateStatesAtColumn(e)})),this.conditionCollection.addLocalHook("beforeClean",(function(){return r._onConditionBeforeClean()})),this.conditionCollection.addLocalHook("afterClean",(function(){return r._onConditionAfterClean()}))}return _createClass$2d(e,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var e=this;this.grouping=!1,arrayEach(this.changes,(function(t){e.updateStatesAtColumn(t)})),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(e){this.latestEditedColumnPosition=this.conditionCollection.orderStack.indexOf(e)}},{key:"updateStatesAtColumn",value:function(e,t){var r=this;if(this.grouping)-1===this.changes.indexOf(e)&&this.changes.push(e);else{var n=this.conditionCollection.exportAllConditions(),o=this.conditionCollection.orderStack.indexOf(e);-1===o&&(o=this.latestEditedColumnPosition);var i=n.slice(0,o),a=n.slice(o);a.length&&a[0].column===e&&a.shift();var s=curry((function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=new ConditionCollection,i=[].concat(e,n);o.importAllConditions(i);var a=r.columnDataFactory(t),s=createArrayAssertion(arrayMap(o.isEmpty()?a:new DataFilter(o,(function(e){return r.columnDataFactory(e)})).filter(),(function(e){return e.meta.visualRow})));return arrayFilter(a,(function(e){return s(e.meta.visualRow)}))}))(i),l=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:l},dependentConditionStacks:a,filteredRowsFactory:s,conditionArgsChange:t})}}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=[].concat(this.conditionCollection.orderStack)}},{key:"_onConditionAfterClean",value:function(){var e=this;arrayEach(this.latestOrderStack,(function(t){e.updateStatesAtColumn(t)}))}},{key:"destroy",value:function(){var e=this;this.clearLocalHooks(),objectEach(this,(function(t,r){e[r]=null}))}}]),e}();function _typeof$1l(e){return(_typeof$1l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _templateObject$a(){var e=_taggedTemplateLiteral$a(["The filter conditions have been applied properly, but couldn’t be displayed visually. \n        The overall amount of conditions exceed the capability of the dropdown menu. \n        For more details see the documentation."],["The filter conditions have been applied properly, but couldn’t be displayed visually.\\x20\n        The overall amount of conditions exceed the capability of the dropdown menu.\\x20\n        For more details see the documentation."]);return _templateObject$a=function(){return e},e}function _taggedTemplateLiteral$a(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _slicedToArray$C(e,t){return _arrayWithHoles$E(e)||_iterableToArrayLimit$C(e,t)||_unsupportedIterableToArray$S(e,t)||_nonIterableRest$E()}function _nonIterableRest$E(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$S(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$S(e,t):void 0}}function _arrayLikeToArray$S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$C(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$E(e){if(Array.isArray(e))return e}function _classCallCheck$2l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2e(e,t,r){return t&&_defineProperties$2e(e.prototype,t),r&&_defineProperties$2e(e,r),e}function _get$L(e,t,r){return(_get$L="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$L(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$L(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1b(e)););return e}function _inherits$1b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$1c(e,t)}function _setPrototypeOf$1c(e,t){return(_setPrototypeOf$1c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$1b(e){var t=_isNativeReflectConstruct$1c();return function(){var r,n=_getPrototypeOf$1b(e);if(t){var o=_getPrototypeOf$1b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$1b(this,r)}}function _possibleConstructorReturn$1b(e,t){return!t||"object"!==_typeof$1l(t)&&"function"!=typeof t?_assertThisInitialized$1b(e):t}function _assertThisInitialized$1b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$1b(e){return(_getPrototypeOf$1b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}mixin(ConditionUpdateObserver,localHooks);var Filters=function(e){_inherits$1b(r,e);var t=_createSuper$1b(r);function r(e){var n;return _classCallCheck$2l(this,r),(n=t.call(this,e)).eventManager=new EventManager(_assertThisInitialized$1b(n)),n.dropdownMenuPlugin=null,n.conditionCollection=null,n.conditionUpdateObserver=null,n.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),n.lastSelectedColumn=null,n.hiddenRowsCache=new Map,n.filtersRowsMap=null,n.hot.addHook("afterGetColHeader",(function(e,t){return n.onAfterGetColHeader(e,t)})),n}return _createClass$2e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().filters}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new TrimmingMap),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var t=this.hot.getSettings().dropdownMenu,n=t&&t.uiContainer||this.hot.rootDocument.body,o=function(t){return t.addLocalHook("accept",(function(){return e.onActionBarSubmit("accept")})),t.addLocalHook("cancel",(function(){return e.onActionBarSubmit("cancel")})),t.addLocalHook("change",(function(r){return e.onComponentChange(t,r)})),t};if(!this.components.get("filter_by_condition")){var i=new ConditionComponent(this.hot,{id:"filter_by_condition",name:function(){return"".concat(e.hot.getTranslatedPhrase(FILTERS_DIVS_FILTER_BY_CONDITION),":")},addSeparator:!1,menuContainer:n});i.addLocalHook("afterClose",(function(){return e.onSelectUIClosed()})),this.components.set("filter_by_condition",o(i))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new OperatorsComponent(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var a=new ConditionComponent(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});a.addLocalHook("afterClose",(function(){return e.onSelectUIClosed()})),this.components.set("filter_by_condition2",o(a))}this.components.get("filter_by_value")||this.components.set("filter_by_value",o(new ValueComponent(this.hot,{id:"filter_by_value",name:function(){return"".concat(e.hot.getTranslatedPhrase(FILTERS_DIVS_FILTER_BY_VALUE),":")}}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",o(new ActionBarComponent(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new ConditionCollection),this.conditionUpdateObserver||(this.conditionUpdateObserver=new ConditionUpdateObserver(this.conditionCollection,(function(t){return e.getDataMapAtColumn(t)})),this.conditionUpdateObserver.addLocalHook("update",(function(t){return e.updateComponents(t)}))),this.components.forEach((function(e){e.show()})),this.registerEvents(),this.addHook("beforeDropdownMenuSetItems",(function(t){return e.onBeforeDropdownMenuSetItems(t)})),this.addHook("afterDropdownMenuDefaultOptions",(function(t){return e.onAfterDropdownMenuDefaultOptions(t)})),this.addHook("afterDropdownMenuShow",(function(){return e.onAfterDropdownMenuShow()})),this.addHook("afterDropdownMenuHide",(function(){return e.onAfterDropdownMenuHide()})),this.addHook("afterChange",(function(t){return e.onAfterChange(t)})),this.hot.getSettings().dropdownMenu&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),_get$L(_getPrototypeOf$1b(r.prototype),"enablePlugin",this).call(this)}}},{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"click",(function(t){return e.onTableClick(t)}))}},{key:"disablePlugin",value:function(){this.enabled&&(this.dropdownMenuPlugin.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((function(e){e.hide()})),this.conditionCollection.clean(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),_get$L(_getPrototypeOf$1b(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:OPERATION_ID,o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:t},args:r},n)}},{key:"removeConditions",value:function(e){var t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}},{key:"clearConditions",value:function(e){if(void 0===e)this.conditionCollection.clean();else{var t=this.hot.toPhysicalColumn(e);this.conditionCollection.clearConditions(t)}}},{key:"filter",value:function(){var e=this,t=this._createDataFilter(),r=!this.conditionCollection.isEmpty(),n=[],o=this.conditionCollection.exportAllConditions();if(!1!==this.hot.runHooks("beforeFilter",o))if(r){var i=[];this.hot.batch((function(){e.filtersRowsMap.clear();var r=createArrayAssertion(n=arrayMap(t.filter(),(function(e){return e.meta.visualRow})));rangeEach(e.hot.countSourceRows()-1,(function(e){r(e)||i.push(e)})),arrayEach(i,(function(t){e.filtersRowsMap.setValueAtIndex(t,!0)}))})),n.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.wt.wtOverlays.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){return this.lastSelectedColumn}},{key:"clearColumnSelection",value:function(){var e,t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.getTopLeftCorner();void 0!==t&&this.hot.selectCell(t.row,t.col)}},{key:"getDataMapAtColumn",value:function(e){var t=this,r=this.hot.toVisualColumn(e),n=[];return arrayEach(this.hot.getSourceDataAtCol(r),(function(e,o){var i=t.hot.getCellMeta(o,r),a=i.row,s=i.col,l=i.visualCol,u=i.visualRow,c=i.type,f=i.instance,h=i.dateFormat;n.push({meta:{row:a,col:s,visualCol:l,visualRow:u,type:c,instance:f,dateFormat:h},value:toEmptyString(e)})})),n}},{key:"onAfterChange",value:function(e){var t=this;e&&arrayEach(e,(function(e){var r=_slicedToArray$C(e,2)[1],n=t.hot.propToCol(r);t.conditionCollection.hasConditions(n)&&t.updateValueComponentCondition(n)}))}},{key:"updateValueComponentCondition",value:function(e){var t=unifyColumnValues(this.hot.getDataAtCol(e));this.conditionUpdateObserver.updateStatesAtColumn(e,t)}},{key:"restoreComponents",value:function(e){var t=this.getSelectedColumn(),r=t&&t.physicalIndex;e.forEach((function(e){!1===e.isHidden()&&e.restoreState(r)}))}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents([this.components.get("filter_by_condition"),this.components.get("filter_operators"),this.components.get("filter_by_condition2"),this.components.get("filter_by_value")])}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(e){var t=arrayMap(e,(function(e){return e.key}));this.components.forEach((function(e){e[-1===t.indexOf(e.getMenuItemDescriptor().key)?"hide":"show"]()})),this.initHiddenRowsCache()}},{key:"onAfterDropdownMenuDefaultOptions",value:function(e){e.items.push({name:KEY}),this.components.forEach((function(t){e.items.push(t.getMenuItemDescriptor())}))}},{key:"getOperationBasedOnArguments",value:function(e,t,r,n){var o=e;return o===OPERATION_ID$1&&t.command.key!==CONDITION_NAME&&r.command.key!==CONDITION_NAME&&n.command.key!==CONDITION_NAME?o=OPERATION_ID$2:n.command.key!==CONDITION_NAME&&(t.command.key!==CONDITION_NAME&&r.command.key!==CONDITION_NAME||(o=OPERATION_ID)),o}},{key:"onActionBarSubmit",value:function(e){if("accept"===e){var t=this.getSelectedColumn(),r=t&&t.physicalIndex,n=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),i=this.components.get("filter_by_value").getState(),a=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),n,o,i);this.conditionUpdateObserver.groupChanges(),this.conditionCollection.clearConditions(r),n.command.key===CONDITION_NAME&&o.command.key===CONDITION_NAME&&i.command.key===CONDITION_NAME?this.conditionCollection.removeConditions(r):(n.command.key!==CONDITION_NAME&&(this.conditionCollection.addCondition(r,n,a),o.command.key!==CONDITION_NAME&&this.conditionCollection.addCondition(r,o,a)),i.command.key!==CONDITION_NAME&&this.conditionCollection.addCondition(r,i,a)),this.conditionUpdateObserver.flush(),this.components.get("filter_operators").saveState(r),this.components.get("filter_by_value").saveState(r),this.saveHiddenRowsCache(r),this.filtersRowsMap.clear(),this.filter()}this.dropdownMenuPlugin.close()}},{key:"onComponentChange",value:function(e,t){if(e===this.components.get("filter_by_condition")){var r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents.apply(this,r):this.hideComponents.apply(this,r)}e.constructor!==ConditionComponent||t.inputsCount||this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin.setListening()}},{key:"onAfterGetColHeader",value:function(e,t){var r=this.hot.toPhysicalColumn(e);this.enabled&&this.conditionCollection.hasConditions(r)?addClass(t,"htFiltersActive"):removeClass(t,"htFiltersActive")}},{key:"onTableClick",value:function(e){var t=closest(e.target,"TH");if(t){var r=this.hot.getCoords(t).col,n=this.hot.toPhysicalColumn(r);this.lastSelectedColumn={visualIndex:r,physicalIndex:n}}}},{key:"_createDataFilter",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new DataFilter(t,(function(t){return e.getDataMapAtColumn(t)}))}},{key:"updateComponents",value:function(e){if(this.dropdownMenuPlugin.enabled){var t=e.editedConditionStack.conditions,r=e.editedConditionStack.column,n=t.filter((function(e){return e.name===CONDITION_NAME$k})),o=t.filter((function(e){return e.name!==CONDITION_NAME$k})),i=this.conditionCollection.columnTypes[r];2===n.length||3===o.length?warn(toSingleLine(_templateObject$a())):(o.length>0&&this.showComponentForParticularColumn(this.components.get("filter_operators"),r),this.components.get("filter_by_condition").updateState(o[0],r),this.components.get("filter_by_condition2").updateState(o[1],r),this.components.get("filter_by_value").updateState(e),this.components.get("filter_operators").updateState(i,r))}}},{key:"showComponentForParticularColumn",value:function(e,t){if(this.hiddenRowsCache.has(t)){var r=this.getIndexesOfComponents(e);this.removeIndexesFromHiddenRowsCache(t,r)}else this.hiddenRowsCache.set(t,[])}},{key:"removeIndexesFromHiddenRowsCache",value:function(e,t){var r=this.hiddenRowsCache.get(e);arrayEach(t,(function(e){r.includes(e)&&r.splice(r.indexOf(e),1)}))}},{key:"getIndexesOfComponents",value:function(){for(var e=this.dropdownMenuPlugin.menu,t=[],r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return arrayEach(n,(function(r){arrayEach(e.menuItems,(function(e,n){e.key===r.getMenuItemDescriptor().key&&t.push(n)}))})),t}},{key:"changeComponentsVisibility",value:function(){for(var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.dropdownMenuPlugin.menu,r=t.hotMenu,n=r.getPlugin("hiddenRows"),o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var s=this.getIndexesOfComponents.apply(this,i);e?n.showRows(s):n.hideRows(s),r.render()}},{key:"initHiddenRowsCache",value:function(){var e=this;this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",(function(){var t=e.lastSelectedColumn.physicalIndex;e.hiddenRowsCache.has(t)||e.hiddenRowsCache.set(t,e.getIndexesOfComponents(e.components.get("filter_operators"),e.components.get("filter_by_condition2"))),e.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:{rows:e.hiddenRowsCache.get(t)}})}))}},{key:"saveHiddenRowsCache",value:function(e){this.hiddenRowsCache.set(e,this.dropdownMenuPlugin.menu.hotMenu.getPlugin("hiddenRows").getHiddenRows())}},{key:"hideComponents",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.changeComponentsVisibility.apply(this,[!1].concat(t))}},{key:"showComponents",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.changeComponentsVisibility.apply(this,[!0].concat(t))}},{key:"destroy",value:function(){this.enabled&&(this.components.forEach((function(e){e.destroy()})),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hiddenRowsCache.clear()),_get$L(_getPrototypeOf$1b(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);function isFormulaExpression(e){return"string"==typeof e&&e.length>=2&&"="===e.charAt(0)}function isFormulaExpressionEscaped(e){return"string"==typeof e&&"'"===e.charAt(0)&&"="===e.charAt(1)}function unescapeFormulaExpression(e){return isFormulaExpressionEscaped(e)?e.substr(1):e}function toUpperCaseFormula(e){var t=/(\\"|"(?:\\"|[^"])*"|(\+))|(\\'|'(?:\\'|[^'])*'|(\+))/g,r=e.match(t)||[],n=-1;return e.toUpperCase().replace(t,(function(){return r[n+=1]}))}function cellCoordFactory(e,t){return function(r){return{row:"row"===e?t:r.row,column:"column"===e?t:r.column}}}registerPlugin("filters",Filters);var formulaParser=createCommonjsModule((function(e,t){var r;"undefined"!=typeof self&&self,r=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=15)}([function(e,t){t.nil=new Error("#NULL!"),t.div0=new Error("#DIV/0!"),t.value=new Error("#VALUE!"),t.ref=new Error("#REF!"),t.name=new Error("#NAME?"),t.num=new Error("#NUM!"),t.na=new Error("#N/A"),t.error=new Error("#ERROR!"),t.data=new Error("#GETTING_DATA")},function(e,t,r){var n=r(0);t.flattenShallow=function(e){return e&&e.reduce?e.reduce((function(e,t){var r=Array.isArray(e),n=Array.isArray(t);return r&&n?e.concat(t):r?(e.push(t),e):n?[e].concat(t):[e,t]})):e},t.isFlat=function(e){if(!e)return!1;for(var t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0},t.flatten=function(){for(var e=t.argsToArray.apply(null,arguments);!t.isFlat(e);)e=t.flattenShallow(e);return e},t.argsToArray=function(e){var r=[];return t.arrayEach(e,(function(e){r.push(e)})),r},t.numbers=function(){var e=this.flatten.apply(null,arguments);return e.filter((function(e){return"number"==typeof e}))},t.cleanFloat=function(e){var t=1e14;return Math.round(e*t)/t},t.parseBool=function(e){if("boolean"==typeof e)return e;if(e instanceof Error)return e;if("number"==typeof e)return 0!==e;if("string"==typeof e){var t=e.toUpperCase();if("TRUE"===t)return!0;if("FALSE"===t)return!1}return e instanceof Date&&!isNaN(e)||n.value},t.parseNumber=function(e){return void 0===e||""===e||isNaN(e)?n.value:parseFloat(e)},t.parseNumberArray=function(e){var r,o;if(!e||0===(r=e.length))return n.value;for(;r--;){if((o=t.parseNumber(e[r]))===n.value)return o;e[r]=o}return e},t.parseMatrix=function(e){var r;if(!e||0===e.length)return n.value;for(var o=0;o<e.length;o++)if(r=t.parseNumberArray(e[o]),e[o]=r,r instanceof Error)return r;return e};var o=new Date(Date.UTC(1900,0,1));t.parseDate=function(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);var t=parseInt(e,10);return t<0?n.num:t<=60?new Date(o.getTime()+864e5*(t-1)):new Date(o.getTime()+864e5*(t-2))}return"string"!=typeof e||(e=new Date(e),isNaN(e))?n.value:e},t.parseDateArray=function(e){for(var t,r=e.length;r--;){if((t=this.parseDate(e[r]))===n.value)return t;e[r]=t}return e},t.anyIsError=function(){for(var e=arguments.length;e--;)if(arguments[e]instanceof Error)return!0;return!1},t.arrayValuesToNumbers=function(e){for(var t,r=e.length;r--;)if("number"!=typeof(t=e[r]))if(!0!==t)if(!1!==t){if("string"==typeof t){var n=this.parseNumber(t);n instanceof Error?e[r]=0:e[r]=n}}else e[r]=0;else e[r]=1;return e},t.rest=function(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(t):e},t.initial=function(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(0,e.length-t):e},t.arrayEach=function(e,t){for(var r=-1,n=e.length;++r<n&&!1!==t(e[r],r,e););return e},t.transpose=function(e){return e?e[0].map((function(t,r){return e.map((function(e){return e[r]}))})):n.value}},function(e,t,r){var n;t.__esModule=!0,t.default=function(e){var t=void 0;return e=(e+"").replace(/#|!|\?/g,""),h[e]&&(t=h[e]),t||null},t.isValidStrict=function(e){var t=!1;for(var r in h)if(Object.prototype.hasOwnProperty.call(h,r)&&h[r]===e){t=!0;break}return t};var o=t.ERROR="ERROR",i=t.ERROR_DIV_ZERO="DIV/0",a=t.ERROR_NAME="NAME",s=t.ERROR_NOT_AVAILABLE="N/A",l=t.ERROR_NULL="NULL",u=t.ERROR_NUM="NUM",c=t.ERROR_REF="REF",f=t.ERROR_VALUE="VALUE",h=((n={})[o]="#ERROR!",n[i]="#DIV/0!",n[a]="#NAME?",n[s]="#N/A",n[l]="#NULL!",n[u]="#NUM!",n[c]="#REF!",n[f]="#VALUE!",n)},function(e,t,r){function n(e){var t=void 0;return"number"==typeof e?t=e:"string"==typeof e&&(t=e.indexOf(".")>-1?parseFloat(e):parseInt(e,10)),t}t.__esModule=!0,t.toNumber=n,t.invertNumber=function(e){return-1*n(e)}},function(e,t,r){var n=r(1),o=r(0),i=r(5),a=r(8),s=r(7);t.ABS=function(e){return(e=n.parseNumber(e))instanceof Error?e:Math.abs(e)},t.ACOS=function(e){if((e=n.parseNumber(e))instanceof Error)return e;var t=Math.acos(e);return isNaN(t)&&(t=o.num),t},t.ACOSH=function(e){if((e=n.parseNumber(e))instanceof Error)return e;var t=Math.log(e+Math.sqrt(e*e-1));return isNaN(t)&&(t=o.num),t},t.ACOT=function(e){return(e=n.parseNumber(e))instanceof Error?e:Math.atan(1/e)},t.ACOTH=function(e){if((e=n.parseNumber(e))instanceof Error)return e;var t=.5*Math.log((e+1)/(e-1));return isNaN(t)&&(t=o.num),t},t.AGGREGATE=function(e,r,a,s){if(e=n.parseNumber(e),r=n.parseNumber(e),n.anyIsError(e,r))return o.value;switch(e){case 1:return i.AVERAGE(a);case 2:return i.COUNT(a);case 3:return i.COUNTA(a);case 4:return i.MAX(a);case 5:return i.MIN(a);case 6:return t.PRODUCT(a);case 7:return i.STDEV.S(a);case 8:return i.STDEV.P(a);case 9:return t.SUM(a);case 10:return i.VAR.S(a);case 11:return i.VAR.P(a);case 12:return i.MEDIAN(a);case 13:return i.MODE.SNGL(a);case 14:return i.LARGE(a,s);case 15:return i.SMALL(a,s);case 16:return i.PERCENTILE.INC(a,s);case 17:return i.QUARTILE.INC(a,s);case 18:return i.PERCENTILE.EXC(a,s);case 19:return i.QUARTILE.EXC(a,s)}},t.ARABIC=function(e){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return o.value;var t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(function(e){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]})),t},t.ASIN=function(e){if((e=n.parseNumber(e))instanceof Error)return e;var t=Math.asin(e);return isNaN(t)&&(t=o.num),t},t.ASINH=function(e){return(e=n.parseNumber(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},t.ATAN=function(e){return(e=n.parseNumber(e))instanceof Error?e:Math.atan(e)},t.ATAN2=function(e,t){return e=n.parseNumber(e),t=n.parseNumber(t),n.anyIsError(e,t)?o.value:Math.atan2(e,t)},t.ATANH=function(e){if((e=n.parseNumber(e))instanceof Error)return e;var t=Math.log((1+e)/(1-e))/2;return isNaN(t)&&(t=o.num),t},t.BASE=function(e,t,r){if(r=r||0,e=n.parseNumber(e),t=n.parseNumber(t),r=n.parseNumber(r),n.anyIsError(e,t,r))return o.value;r=void 0===r?0:r;var i=e.toString(t);return new Array(Math.max(r+1-i.length,0)).join("0")+i},t.CEILING=function(e,r,i){if(r=void 0===r?1:Math.abs(r),i=i||0,e=n.parseNumber(e),r=n.parseNumber(r),i=n.parseNumber(i),n.anyIsError(e,r,i))return o.value;if(0===r)return 0;var a=-Math.floor(Math.log(r)/Math.log(10));return e>=0?t.ROUND(Math.ceil(e/r)*r,a):0===i?-t.ROUND(Math.floor(Math.abs(e)/r)*r,a):-t.ROUND(Math.ceil(Math.abs(e)/r)*r,a)},t.CEILING.MATH=t.CEILING,t.CEILING.PRECISE=t.CEILING,t.COMBIN=function(e,r){return e=n.parseNumber(e),r=n.parseNumber(r),n.anyIsError(e,r)?o.value:t.FACT(e)/(t.FACT(r)*t.FACT(e-r))},t.COMBINA=function(e,r){return e=n.parseNumber(e),r=n.parseNumber(r),n.anyIsError(e,r)?o.value:0===e&&0===r?1:t.COMBIN(e+r-1,e-1)},t.COS=function(e){return(e=n.parseNumber(e))instanceof Error?e:Math.cos(e)},t.COSH=function(e){return(e=n.parseNumber(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},t.COT=function(e){return(e=n.parseNumber(e))instanceof Error?e:1/Math.tan(e)},t.COTH=function(e){if((e=n.parseNumber(e))instanceof Error)return e;var t=Math.exp(2*e);return(t+1)/(t-1)},t.CSC=function(e){return(e=n.parseNumber(e))instanceof Error?e:1/Math.sin(e)},t.CSCH=function(e){return(e=n.parseNumber(e))instanceof Error?e:2/(Math.exp(e)-Math.exp(-e))},t.DECIMAL=function(e,t){return arguments.length<1?o.value:parseInt(e,t)},t.DEGREES=function(e){return(e=n.parseNumber(e))instanceof Error?e:180*e/Math.PI},t.EVEN=function(e){return(e=n.parseNumber(e))instanceof Error?e:t.CEILING(e,-2,-1)},t.EXP=function(e){return arguments.length<1?o.na:"number"!=typeof e||arguments.length>1?o.error:e=Math.exp(e)};var l=[];t.FACT=function(e){if((e=n.parseNumber(e))instanceof Error)return e;var r=Math.floor(e);return 0===r||1===r?1:(l[r]>0||(l[r]=t.FACT(r-1)*r),l[r])},t.FACTDOUBLE=function(e){if((e=n.parseNumber(e))instanceof Error)return e;var r=Math.floor(e);return r<=0?1:r*t.FACTDOUBLE(r-2)},t.FLOOR=function(e,r){if(e=n.parseNumber(e),r=n.parseNumber(r),n.anyIsError(e,r))return o.value;if(0===r)return 0;if(!(e>0&&r>0||e<0&&r<0))return o.num;r=Math.abs(r);var i=-Math.floor(Math.log(r)/Math.log(10));return e>=0?t.ROUND(Math.floor(e/r)*r,i):-t.ROUND(Math.ceil(Math.abs(e)/r),i)},t.FLOOR.MATH=function(e,r,i){if(r=void 0===r?1:r,i=void 0===i?0:i,e=n.parseNumber(e),r=n.parseNumber(r),i=n.parseNumber(i),n.anyIsError(e,r,i))return o.value;if(0===r)return 0;r=r?Math.abs(r):1;var a=-Math.floor(Math.log(r)/Math.log(10));return e>=0?t.ROUND(Math.floor(e/r)*r,a):0===i||void 0===i?-t.ROUND(Math.ceil(Math.abs(e)/r)*r,a):-t.ROUND(Math.floor(Math.abs(e)/r)*r,a)},t.FLOOR.PRECISE=t.FLOOR.MATH,t.GCD=function(){var e=n.parseNumberArray(n.flatten(arguments));if(e instanceof Error)return e;for(var t=e.length,r=e[0],o=r<0?-r:r,i=1;i<t;i++){for(var a=e[i],s=a<0?-a:a;o&&s;)o>s?o%=s:s%=o;o+=s}return o},t.INT=function(e){return(e=n.parseNumber(e))instanceof Error?e:Math.floor(e)},t.ISO={CEILING:t.CEILING},t.LCM=function(){var e=n.parseNumberArray(n.flatten(arguments));if(e instanceof Error)return e;for(var t,r,o,i,a=1;void 0!==(o=e.pop());)for(;o>1;){if(o%2){for(t=3,r=Math.floor(Math.sqrt(o));t<=r&&o%t;t+=2);i=t<=r?t:o}else i=2;for(o/=i,a*=i,t=e.length;t;e[--t]%i==0&&1==(e[t]/=i)&&e.splice(t,1));}return a},t.LN=function(e){return(e=n.parseNumber(e))instanceof Error?e:Math.log(e)},t.LN10=function(){return Math.log(10)},t.LN2=function(){return Math.log(2)},t.LOG10E=function(){return Math.LOG10E},t.LOG2E=function(){return Math.LOG2E},t.LOG=function(e,t){return e=n.parseNumber(e),t=n.parseNumber(t),n.anyIsError(e,t)?o.value:(t=void 0===t?10:t,Math.log(e)/Math.log(t))},t.LOG10=function(e){return(e=n.parseNumber(e))instanceof Error?e:Math.log(e)/Math.log(10)},t.MOD=function(e,t){if(e=n.parseNumber(e),t=n.parseNumber(t),n.anyIsError(e,t))return o.value;if(0===t)return o.div0;var r=Math.abs(e%t);return t>0?r:-r},t.MROUND=function(e,t){return e=n.parseNumber(e),t=n.parseNumber(t),n.anyIsError(e,t)?o.value:e*t<0?o.num:Math.round(e/t)*t},t.MULTINOMIAL=function(){var e=n.parseNumberArray(n.flatten(arguments));if(e instanceof Error)return e;for(var r=0,o=1,i=0;i<e.length;i++)r+=e[i],o*=t.FACT(e[i]);return t.FACT(r)/o},t.ODD=function(e){if((e=n.parseNumber(e))instanceof Error)return e;var t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>0?t:-t},t.PI=function(){return Math.PI},t.E=function(){return Math.E},t.POWER=function(e,t){if(e=n.parseNumber(e),t=n.parseNumber(t),n.anyIsError(e,t))return o.value;var r=Math.pow(e,t);return isNaN(r)?o.num:r},t.PRODUCT=function(){var e=n.parseNumberArray(n.flatten(arguments));if(e instanceof Error)return e;for(var t=1,r=0;r<e.length;r++)t*=e[r];return t},t.QUOTIENT=function(e,t){return e=n.parseNumber(e),t=n.parseNumber(t),n.anyIsError(e,t)?o.value:parseInt(e/t,10)},t.RADIANS=function(e){return(e=n.parseNumber(e))instanceof Error?e:e*Math.PI/180},t.RAND=function(){return Math.random()},t.RANDBETWEEN=function(e,t){return e=n.parseNumber(e),t=n.parseNumber(t),n.anyIsError(e,t)?o.value:e+Math.ceil((t-e+1)*Math.random())-1},t.ROMAN=function(e){if((e=n.parseNumber(e))instanceof Error)return e;for(var t=String(e).split(""),r=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],o="",i=3;i--;)o=(r[+t.pop()+10*i]||"")+o;return new Array(+t.join("")+1).join("M")+o},t.ROUND=function(e,t){return e=n.parseNumber(e),t=n.parseNumber(t),n.anyIsError(e,t)?o.value:Math.round(e*Math.pow(10,t))/Math.pow(10,t)},t.ROUNDDOWN=function(e,t){return e=n.parseNumber(e),t=n.parseNumber(t),n.anyIsError(e,t)?o.value:(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t.ROUNDUP=function(e,t){return e=n.parseNumber(e),t=n.parseNumber(t),n.anyIsError(e,t)?o.value:(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t.SEC=function(e){return(e=n.parseNumber(e))instanceof Error?e:1/Math.cos(e)},t.SECH=function(e){return(e=n.parseNumber(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},t.SERIESSUM=function(e,t,r,i){if(e=n.parseNumber(e),t=n.parseNumber(t),r=n.parseNumber(r),i=n.parseNumberArray(i),n.anyIsError(e,t,r,i))return o.value;for(var a=i[0]*Math.pow(e,t),s=1;s<i.length;s++)a+=i[s]*Math.pow(e,t+s*r);return a},t.SIGN=function(e){return(e=n.parseNumber(e))instanceof Error?e:e<0?-1:0===e?0:1},t.SIN=function(e){return(e=n.parseNumber(e))instanceof Error?e:Math.sin(e)},t.SINH=function(e){return(e=n.parseNumber(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},t.SQRT=function(e){return(e=n.parseNumber(e))instanceof Error?e:e<0?o.num:Math.sqrt(e)},t.SQRTPI=function(e){return(e=n.parseNumber(e))instanceof Error?e:Math.sqrt(e*Math.PI)},t.SQRT1_2=function(){return 1/Math.sqrt(2)},t.SQRT2=function(){return Math.sqrt(2)},t.SUBTOTAL=function(e,r){if((e=n.parseNumber(e))instanceof Error)return e;switch(e){case 1:return i.AVERAGE(r);case 2:return i.COUNT(r);case 3:return i.COUNTA(r);case 4:return i.MAX(r);case 5:return i.MIN(r);case 6:return t.PRODUCT(r);case 7:return i.STDEV.S(r);case 8:return i.STDEV.P(r);case 9:return t.SUM(r);case 10:return i.VAR.S(r);case 11:return i.VAR.P(r);case 101:return i.AVERAGE(r);case 102:return i.COUNT(r);case 103:return i.COUNTA(r);case 104:return i.MAX(r);case 105:return i.MIN(r);case 106:return t.PRODUCT(r);case 107:return i.STDEV.S(r);case 108:return i.STDEV.P(r);case 109:return t.SUM(r);case 110:return i.VAR.S(r);case 111:return i.VAR.P(r)}},t.ADD=function(e,t){return 2!==arguments.length?o.na:(e=n.parseNumber(e),t=n.parseNumber(t),n.anyIsError(e,t)?o.value:e+t)},t.MINUS=function(e,t){return 2!==arguments.length?o.na:(e=n.parseNumber(e),t=n.parseNumber(t),n.anyIsError(e,t)?o.value:e-t)},t.DIVIDE=function(e,t){return 2!==arguments.length?o.na:(e=n.parseNumber(e),t=n.parseNumber(t),n.anyIsError(e,t)?o.value:0===t?o.div0:e/t)},t.MULTIPLY=function(e,t){return 2!==arguments.length?o.na:(e=n.parseNumber(e),t=n.parseNumber(t),n.anyIsError(e,t)?o.value:e*t)},t.GTE=function(e,t){return 2!==arguments.length?o.na:(e=n.parseNumber(e),t=n.parseNumber(t),n.anyIsError(e,t)?o.error:e>=t)},t.LT=function(e,t){return 2!==arguments.length?o.na:(e=n.parseNumber(e),t=n.parseNumber(t),n.anyIsError(e,t)?o.error:e<t)},t.LTE=function(e,t){return 2!==arguments.length?o.na:(e=n.parseNumber(e),t=n.parseNumber(t),n.anyIsError(e,t)?o.error:e<=t)},t.EQ=function(e,t){return 2!==arguments.length?o.na:e===t},t.NE=function(e,t){return 2!==arguments.length?o.na:e!==t},t.POW=function(e,r){return 2!==arguments.length?o.na:(e=n.parseNumber(e),r=n.parseNumber(r),n.anyIsError(e,r)?o.error:t.POWER(e,r))},t.SUM=function(){var e=0;return n.arrayEach(n.argsToArray(arguments),(function(r){if("number"==typeof r)e+=r;else if("string"==typeof r){var n=parseFloat(r);!isNaN(n)&&(e+=n)}else Array.isArray(r)&&(e+=t.SUM.apply(null,r))})),e},t.SUMIF=function(e,t){if((e=n.parseNumberArray(n.flatten(e)))instanceof Error)return e;for(var r=0,o=void 0===t||"*"===t,i=o?null:s.parse(t+""),a=0;a<e.length;a++){var l=e[a];if(o)r+=l;else{var u=[s.createToken(l,s.TOKEN_TYPE_LITERAL)].concat(i);r+=s.compute(u)?l:0}}return r},t.SUMIFS=function(){var e=n.argsToArray(arguments),t=n.parseNumberArray(n.flatten(e.shift()));if(t instanceof Error)return t;for(var r=e,o=t.length,i=r.length,a=0,l=0;l<o;l++){for(var u=t[l],c=!1,f=0;f<i;f++){var h=r[f],d=void 0===h||"*"===h,p=!1;if(d)p=!0;else{var y=s.parse(h+""),g=[s.createToken(u,s.TOKEN_TYPE_LITERAL)].concat(y);p=s.compute(g)}if(!p){c=!1;break}c=!0}c&&(a+=u)}return a},t.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return o.value;for(var e,t,r,i,a=arguments.length+1,s=0,l=0;l<arguments[0].length;l++)if(arguments[0][l]instanceof Array)for(var u=0;u<arguments[0][l].length;u++){for(e=1,t=1;t<a;t++){if((i=n.parseNumber(arguments[t-1][l][u]))instanceof Error)return i;e*=i}s+=e}else{for(e=1,t=1;t<a;t++){if((r=n.parseNumber(arguments[t-1][l]))instanceof Error)return r;e*=r}s+=e}return s},t.SUMSQ=function(){var e=n.parseNumberArray(n.flatten(arguments));if(e instanceof Error)return e;for(var t=0,r=e.length,o=0;o<r;o++)t+=a.ISNUMBER(e[o])?e[o]*e[o]:0;return t},t.SUMX2MY2=function(e,t){if(e=n.parseNumberArray(n.flatten(e)),t=n.parseNumberArray(n.flatten(t)),n.anyIsError(e,t))return o.value;for(var r=0,i=0;i<e.length;i++)r+=e[i]*e[i]-t[i]*t[i];return r},t.SUMX2PY2=function(e,t){if(e=n.parseNumberArray(n.flatten(e)),t=n.parseNumberArray(n.flatten(t)),n.anyIsError(e,t))return o.value;var r=0;e=n.parseNumberArray(n.flatten(e)),t=n.parseNumberArray(n.flatten(t));for(var i=0;i<e.length;i++)r+=e[i]*e[i]+t[i]*t[i];return r},t.SUMXMY2=function(e,t){if(e=n.parseNumberArray(n.flatten(e)),t=n.parseNumberArray(n.flatten(t)),n.anyIsError(e,t))return o.value;var r=0;e=n.flatten(e),t=n.flatten(t);for(var i=0;i<e.length;i++)r+=Math.pow(e[i]-t[i],2);return r},t.TAN=function(e){return(e=n.parseNumber(e))instanceof Error?e:Math.tan(e)},t.TANH=function(e){if((e=n.parseNumber(e))instanceof Error)return e;var t=Math.exp(2*e);return(t-1)/(t+1)},t.TRUNC=function(e,t){return t=void 0===t?0:t,e=n.parseNumber(e),t=n.parseNumber(t),n.anyIsError(e,t)?o.value:(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)}},function(e,t,r){var n=r(4),o=r(6),i=r(10),a=r(1),s=r(7),l=r(0),u=r(11);t.AVEDEV=function(){var e=a.parseNumberArray(a.flatten(arguments));return e instanceof Error?e:i.sum(i(e).subtract(i.mean(e)).abs()[0])/e.length},t.AVERAGE=function(){for(var e,t=a.numbers(a.flatten(arguments)),r=t.length,n=0,o=0,i=0;i<r;i++)n+=t[i],o+=1;return e=n/o,isNaN(e)&&(e=l.num),e},t.AVERAGEA=function(){for(var e,t=a.flatten(arguments),r=t.length,n=0,o=0,i=0;i<r;i++){var s=t[i];"number"==typeof s&&(n+=s),!0===s&&n++,null!==s&&o++}return e=n/o,isNaN(e)&&(e=l.num),e},t.AVERAGEIF=function(e,t,r){if(arguments.length<=1)return l.na;if(r=r||e,e=a.flatten(e),(r=a.parseNumberArray(a.flatten(r)))instanceof Error)return r;for(var n=0,o=0,i=void 0===t||"*"===t,u=i?null:s.parse(t+""),c=0;c<e.length;c++){var f=e[c];if(i)o+=r[c],n++;else{var h=[s.createToken(f,s.TOKEN_TYPE_LITERAL)].concat(u);s.compute(h)&&(o+=r[c],n++)}}return o/n},t.AVERAGEIFS=function(){for(var e=a.argsToArray(arguments),t=(e.length-1)/2,r=a.flatten(e[0]),n=0,o=0,i=0;i<r.length;i++){for(var l=!1,u=0;u<t;u++){var c=e[2*u+1][i],f=e[2*u+2],h=void 0===f||"*"===f,d=!1;if(h)d=!0;else{var p=s.parse(f+""),y=[s.createToken(c,s.TOKEN_TYPE_LITERAL)].concat(p);d=s.compute(y)}if(!d){l=!1;break}l=!0}l&&(o+=r[i],n++)}var g=o/n;return isNaN(g)?0:g},t.BETA={},t.BETA.DIST=function(e,t,r,n,o,s){return arguments.length<4?l.value:(o=void 0===o?0:o,s=void 0===s?1:s,e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),o=a.parseNumber(o),s=a.parseNumber(s),a.anyIsError(e,t,r,o,s)?l.value:(e=(e-o)/(s-o),n?i.beta.cdf(e,t,r):i.beta.pdf(e,t,r)))},t.BETA.INV=function(e,t,r,n,o){return n=void 0===n?0:n,o=void 0===o?1:o,e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),n=a.parseNumber(n),o=a.parseNumber(o),a.anyIsError(e,t,r,n,o)?l.value:i.beta.inv(e,t,r)*(o-n)+n},t.BINOM={},t.BINOM.DIST=function(e,t,r,n){return e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),n=a.parseNumber(n),a.anyIsError(e,t,r,n)?l.value:n?i.binomial.cdf(e,t,r):i.binomial.pdf(e,t,r)},t.BINOM.DIST.RANGE=function(e,t,r,o){if(o=void 0===o?r:o,e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),o=a.parseNumber(o),a.anyIsError(e,t,r,o))return l.value;for(var i=0,s=r;s<=o;s++)i+=n.COMBIN(e,s)*Math.pow(t,s)*Math.pow(1-t,e-s);return i},t.BINOM.INV=function(e,t,r){if(e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),a.anyIsError(e,t,r))return l.value;for(var n=0;n<=e;){if(i.binomial.cdf(n,e,t)>=r)return n;n++}},t.CHISQ={},t.CHISQ.DIST=function(e,t,r){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?l.value:r?i.chisquare.cdf(e,t):i.chisquare.pdf(e,t)},t.CHISQ.DIST.RT=function(e,t){return!e|!t?l.na:e<1||t>Math.pow(10,10)?l.num:"number"!=typeof e||"number"!=typeof t?l.value:1-i.chisquare.cdf(e,t)},t.CHISQ.INV=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?l.value:i.chisquare.inv(e,t)},t.CHISQ.INV.RT=function(e,t){return!e|!t?l.na:e<0||e>1||t<1||t>Math.pow(10,10)?l.num:"number"!=typeof e||"number"!=typeof t?l.value:i.chisquare.inv(1-e,t)},t.CHISQ.TEST=function(e,t){if(2!==arguments.length)return l.na;if(!(e instanceof Array&&t instanceof Array))return l.value;if(e.length!==t.length)return l.value;if(e[0]&&t[0]&&e[0].length!==t[0].length)return l.value;var r,n,o,i=e.length;for(n=0;n<i;n++)e[n]instanceof Array||(r=e[n],e[n]=[],e[n].push(r)),t[n]instanceof Array||(r=t[n],t[n]=[],t[n].push(r));var a=e[0].length,s=1===a?i-1:(i-1)*(a-1),u=0,c=Math.PI;for(n=0;n<i;n++)for(o=0;o<a;o++)u+=Math.pow(e[n][o]-t[n][o],2)/t[n][o];function f(e,t){var r=Math.exp(-.5*e);t%2==1&&(r*=Math.sqrt(2*e/c));for(var n=t;n>=2;)r=r*e/n,n-=2;for(var o=r,i=t;o>1e-10*r;)r+=o=o*e/(i+=2);return 1-r}return Math.round(1e6*f(u,s))/1e6},t.COLUMN=function(e,t){return 2!==arguments.length?l.na:t<0?l.num:e instanceof Array&&"number"==typeof t?0!==e.length?i.col(e,t):void 0:l.value},t.COLUMNS=function(e){return 1!==arguments.length?l.na:e instanceof Array?0===e.length?0:i.cols(e):l.value},t.CONFIDENCE={},t.CONFIDENCE.NORM=function(e,t,r){return e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?l.value:i.normalci(1,e,t,r)[1]-1},t.CONFIDENCE.T=function(e,t,r){return e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?l.value:i.tci(1,e,t,r)[1]-1},t.CORREL=function(e,t){return e=a.parseNumberArray(a.flatten(e)),t=a.parseNumberArray(a.flatten(t)),a.anyIsError(e,t)?l.value:i.corrcoeff(e,t)},t.COUNT=function(){return a.numbers(a.flatten(arguments)).length},t.COUNTA=function(){var e=a.flatten(arguments);return e.length-t.COUNTBLANK(e)},t.COUNTIN=function(e,t){var r=0;e=a.flatten(e);for(var n=0;n<e.length;n++)e[n]===t&&r++;return r},t.COUNTBLANK=function(){for(var e,t=a.flatten(arguments),r=0,n=0;n<t.length;n++)null!==(e=t[n])&&""!==e||r++;return r},t.COUNTIF=function(e,t){if(e=a.flatten(e),void 0===t||"*"===t)return e.length;for(var r=0,n=s.parse(t+""),o=0;o<e.length;o++){var i=e[o],l=[s.createToken(i,s.TOKEN_TYPE_LITERAL)].concat(n);s.compute(l)&&r++}return r},t.COUNTIFS=function(){for(var e=a.argsToArray(arguments),t=new Array(a.flatten(e[0]).length),r=0;r<t.length;r++)t[r]=!0;for(r=0;r<e.length;r+=2){var n=a.flatten(e[r]),o=e[r+1],i=void 0===o||"*"===o;if(!i)for(var l=s.parse(o+""),u=0;u<n.length;u++){var c=n[u],f=[s.createToken(c,s.TOKEN_TYPE_LITERAL)].concat(l);t[u]=t[u]&&s.compute(f)}}var h=0;for(r=0;r<t.length;r++)t[r]&&h++;return h},t.COUNTUNIQUE=function(){return u.UNIQUE.apply(null,a.flatten(arguments)).length},t.COVARIANCE={},t.COVARIANCE.P=function(e,t){if(e=a.parseNumberArray(a.flatten(e)),t=a.parseNumberArray(a.flatten(t)),a.anyIsError(e,t))return l.value;for(var r=i.mean(e),n=i.mean(t),o=0,s=e.length,u=0;u<s;u++)o+=(e[u]-r)*(t[u]-n);return o/s},t.COVARIANCE.S=function(e,t){return e=a.parseNumberArray(a.flatten(e)),t=a.parseNumberArray(a.flatten(t)),a.anyIsError(e,t)?l.value:i.covariance(e,t)},t.DEVSQ=function(){var e=a.parseNumberArray(a.flatten(arguments));if(e instanceof Error)return e;for(var t=i.mean(e),r=0,n=0;n<e.length;n++)r+=Math.pow(e[n]-t,2);return r},t.EXPON={},t.EXPON.DIST=function(e,t,r){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?l.value:r?i.exponential.cdf(e,t):i.exponential.pdf(e,t)},t.F={},t.F.DIST=function(e,t,r,n){return e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?l.value:n?i.centralF.cdf(e,t,r):i.centralF.pdf(e,t,r)},t.F.DIST.RT=function(e,t,r){return 3!==arguments.length?l.na:e<0||t<1||r<1?l.num:"number"!=typeof e||"number"!=typeof t||"number"!=typeof r?l.value:1-i.centralF.cdf(e,t,r)},t.F.INV=function(e,t,r){return e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?l.value:e<=0||e>1?l.num:i.centralF.inv(e,t,r)},t.F.INV.RT=function(e,t,r){return 3!==arguments.length?l.na:e<0||e>1||t<1||t>Math.pow(10,10)||r<1||r>Math.pow(10,10)?l.num:"number"!=typeof e||"number"!=typeof t||"number"!=typeof r?l.value:i.centralF.inv(1-e,t,r)},t.F.TEST=function(e,t){if(!e||!t)return l.na;if(!(e instanceof Array&&t instanceof Array))return l.na;if(e.length<2||t.length<2)return l.div0;var r=function(e,t){for(var r=0,n=0;n<e.length;n++)r+=Math.pow(e[n]-t,2);return r},o=n.SUM(e)/e.length,i=n.SUM(t)/t.length;return r(e,o)/(e.length-1)/(r(t,i)/(t.length-1))},t.FISHER=function(e){return(e=a.parseNumber(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},t.FISHERINV=function(e){if((e=a.parseNumber(e))instanceof Error)return e;var t=Math.exp(2*e);return(t-1)/(t+1)},t.FORECAST=function(e,t,r){if(e=a.parseNumber(e),t=a.parseNumberArray(a.flatten(t)),r=a.parseNumberArray(a.flatten(r)),a.anyIsError(e,t,r))return l.value;for(var n=i.mean(r),o=i.mean(t),s=r.length,u=0,c=0,f=0;f<s;f++)u+=(r[f]-n)*(t[f]-o),c+=Math.pow(r[f]-n,2);var h=u/c;return o-h*n+h*e},t.FREQUENCY=function(e,t){if(e=a.parseNumberArray(a.flatten(e)),t=a.parseNumberArray(a.flatten(t)),a.anyIsError(e,t))return l.value;for(var r=e.length,n=t.length,o=[],i=0;i<=n;i++){o[i]=0;for(var s=0;s<r;s++)0===i?e[s]<=t[0]&&(o[0]+=1):i<n?e[s]>t[i-1]&&e[s]<=t[i]&&(o[i]+=1):i===n&&e[s]>t[n-1]&&(o[n]+=1)}return o},t.GAMMA=function(e){return(e=a.parseNumber(e))instanceof Error?e:0===e||parseInt(e,10)===e&&e<0?l.num:i.gammafn(e)},t.GAMMA.DIST=function(e,t,r,n){return 4!==arguments.length?l.na:e<0||t<=0||r<=0||"number"!=typeof e||"number"!=typeof t||"number"!=typeof r?l.value:n?i.gamma.cdf(e,t,r,!0):i.gamma.pdf(e,t,r,!1)},t.GAMMA.INV=function(e,t,r){return 3!==arguments.length?l.na:e<0||e>1||t<=0||r<=0?l.num:"number"!=typeof e||"number"!=typeof t||"number"!=typeof r?l.value:i.gamma.inv(e,t,r)},t.GAMMALN=function(e){return(e=a.parseNumber(e))instanceof Error?e:i.gammaln(e)},t.GAMMALN.PRECISE=function(e){return 1!==arguments.length?l.na:e<=0?l.num:"number"!=typeof e?l.value:i.gammaln(e)},t.GAUSS=function(e){return(e=a.parseNumber(e))instanceof Error?e:i.normal.cdf(e,0,1)-.5},t.GEOMEAN=function(){var e=a.parseNumberArray(a.flatten(arguments));return e instanceof Error?e:i.geomean(e)},t.GROWTH=function(e,t,r,n){if((e=a.parseNumberArray(e))instanceof Error)return e;var o;if(void 0===t)for(t=[],o=1;o<=e.length;o++)t.push(o);if(void 0===r)for(r=[],o=1;o<=e.length;o++)r.push(o);if(t=a.parseNumberArray(t),r=a.parseNumberArray(r),a.anyIsError(t,r))return l.value;void 0===n&&(n=!0);var i,s,u=e.length,c=0,f=0,h=0,d=0;for(o=0;o<u;o++){var p=t[o],y=Math.log(e[o]);c+=p,f+=y,h+=p*y,d+=p*p}c/=u,f/=u,h/=u,d/=u,n?s=f-(i=(h-c*f)/(d-c*c))*c:(i=h/d,s=0);var g=[];for(o=0;o<r.length;o++)g.push(Math.exp(s+i*r[o]));return g},t.HARMEAN=function(){var e=a.parseNumberArray(a.flatten(arguments));if(e instanceof Error)return e;for(var t=e.length,r=0,n=0;n<t;n++)r+=1/e[n];return t/r},t.HYPGEOM={},t.HYPGEOM.DIST=function(e,t,r,o,i){if(e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),o=a.parseNumber(o),a.anyIsError(e,t,r,o))return l.value;function s(e,t,r,o){return n.COMBIN(r,e)*n.COMBIN(o-r,t-e)/n.COMBIN(o,t)}return i?function(e,t,r,n){for(var o=0,i=0;i<=e;i++)o+=s(i,t,r,n);return o}(e,t,r,o):s(e,t,r,o)},t.INTERCEPT=function(e,r){return e=a.parseNumberArray(e),r=a.parseNumberArray(r),a.anyIsError(e,r)?l.value:e.length!==r.length?l.na:t.FORECAST(0,e,r)},t.KURT=function(){var e=a.parseNumberArray(a.flatten(arguments));if(e instanceof Error)return e;for(var t=i.mean(e),r=e.length,n=0,o=0;o<r;o++)n+=Math.pow(e[o]-t,4);return r*(r+1)/((r-1)*(r-2)*(r-3))*(n/=Math.pow(i.stdev(e,!0),4))-3*(r-1)*(r-1)/((r-2)*(r-3))},t.LARGE=function(e,t){return e=a.parseNumberArray(a.flatten(e)),t=a.parseNumber(t),a.anyIsError(e,t)?e:e.sort((function(e,t){return t-e}))[t-1]},t.LINEST=function(e,t){if(e=a.parseNumberArray(a.flatten(e)),t=a.parseNumberArray(a.flatten(t)),a.anyIsError(e,t))return l.value;for(var r=i.mean(e),n=i.mean(t),o=t.length,s=0,u=0,c=0;c<o;c++)s+=(t[c]-n)*(e[c]-r),u+=Math.pow(t[c]-n,2);var f=s/u;return[f,r-f*n]},t.LOGEST=function(e,r){if(e=a.parseNumberArray(a.flatten(e)),r=a.parseNumberArray(a.flatten(r)),a.anyIsError(e,r))return l.value;for(var n=0;n<e.length;n++)e[n]=Math.log(e[n]);var o=t.LINEST(e,r);return o[0]=Math.round(1e6*Math.exp(o[0]))/1e6,o[1]=Math.round(1e6*Math.exp(o[1]))/1e6,o},t.LOGNORM={},t.LOGNORM.DIST=function(e,t,r,n){return e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?l.value:n?i.lognormal.cdf(e,t,r):i.lognormal.pdf(e,t,r)},t.LOGNORM.INV=function(e,t,r){return e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?l.value:i.lognormal.inv(e,t,r)},t.MAX=function(){var e=a.numbers(a.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},t.MAXA=function(){var e=a.arrayValuesToNumbers(a.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},t.MEDIAN=function(){var e=a.arrayValuesToNumbers(a.flatten(arguments)),t=i.median(e);return isNaN(t)&&(t=l.num),t},t.MIN=function(){var e=a.numbers(a.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)},t.MINA=function(){var e=a.arrayValuesToNumbers(a.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)},t.MODE={},t.MODE.MULT=function(){var e=a.parseNumberArray(a.flatten(arguments));if(e instanceof Error)return e;for(var t,r=e.length,n={},o=[],i=0,s=0;s<r;s++)n[t=e[s]]=n[t]?n[t]+1:1,n[t]>i&&(i=n[t],o=[]),n[t]===i&&(o[o.length]=t);return o},t.MODE.SNGL=function(){var e=a.parseNumberArray(a.flatten(arguments));return e instanceof Error?e:t.MODE.MULT(e).sort((function(e,t){return e-t}))[0]},t.NEGBINOM={},t.NEGBINOM.DIST=function(e,t,r,n){return e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?l.value:n?i.negbin.cdf(e,t,r):i.negbin.pdf(e,t,r)},t.NORM={},t.NORM.DIST=function(e,t,r,n){return e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?l.value:r<=0?l.num:n?i.normal.cdf(e,t,r):i.normal.pdf(e,t,r)},t.NORM.INV=function(e,t,r){return e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?l.value:i.normal.inv(e,t,r)},t.NORM.S={},t.NORM.S.DIST=function(e,t){return(e=a.parseNumber(e))instanceof Error?l.value:t?i.normal.cdf(e,0,1):i.normal.pdf(e,0,1)},t.NORM.S.INV=function(e){return(e=a.parseNumber(e))instanceof Error?l.value:i.normal.inv(e,0,1)},t.PEARSON=function(e,t){if(t=a.parseNumberArray(a.flatten(t)),e=a.parseNumberArray(a.flatten(e)),a.anyIsError(t,e))return l.value;for(var r=i.mean(e),n=i.mean(t),o=e.length,s=0,u=0,c=0,f=0;f<o;f++)s+=(e[f]-r)*(t[f]-n),u+=Math.pow(e[f]-r,2),c+=Math.pow(t[f]-n,2);return s/Math.sqrt(u*c)},t.PERCENTILE={},t.PERCENTILE.EXC=function(e,t){if(e=a.parseNumberArray(a.flatten(e)),t=a.parseNumber(t),a.anyIsError(e,t))return l.value;var r=(e=e.sort((function(e,t){return e-t}))).length;if(t<1/(r+1)||t>1-1/(r+1))return l.num;var n=t*(r+1)-1,o=Math.floor(n);return a.cleanFloat(n===o?e[n]:e[o]+(n-o)*(e[o+1]-e[o]))},t.PERCENTILE.INC=function(e,t){if(e=a.parseNumberArray(a.flatten(e)),t=a.parseNumber(t),a.anyIsError(e,t))return l.value;var r=t*((e=e.sort((function(e,t){return e-t}))).length-1),n=Math.floor(r);return a.cleanFloat(r===n?e[r]:e[n]+(r-n)*(e[n+1]-e[n]))},t.PERCENTRANK={},t.PERCENTRANK.EXC=function(e,t,r){if(r=void 0===r?3:r,e=a.parseNumberArray(a.flatten(e)),t=a.parseNumber(t),r=a.parseNumber(r),a.anyIsError(e,t,r))return l.value;e=e.sort((function(e,t){return e-t}));for(var n=u.UNIQUE.apply(null,e),o=e.length,i=n.length,s=Math.pow(10,r),c=0,f=!1,h=0;!f&&h<i;)t===n[h]?(c=(e.indexOf(n[h])+1)/(o+1),f=!0):t>=n[h]&&(t<n[h+1]||h===i-1)&&(c=(e.indexOf(n[h])+1+(t-n[h])/(n[h+1]-n[h]))/(o+1),f=!0),h++;return Math.floor(c*s)/s},t.PERCENTRANK.INC=function(e,t,r){if(r=void 0===r?3:r,e=a.parseNumberArray(a.flatten(e)),t=a.parseNumber(t),r=a.parseNumber(r),a.anyIsError(e,t,r))return l.value;e=e.sort((function(e,t){return e-t}));for(var n=u.UNIQUE.apply(null,e),o=e.length,i=n.length,s=Math.pow(10,r),c=0,f=!1,h=0;!f&&h<i;)t===n[h]?(c=e.indexOf(n[h])/(o-1),f=!0):t>=n[h]&&(t<n[h+1]||h===i-1)&&(c=(e.indexOf(n[h])+(t-n[h])/(n[h+1]-n[h]))/(o-1),f=!0),h++;return Math.floor(c*s)/s},t.PERMUT=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?l.value:n.FACT(e)/n.FACT(e-t)},t.PERMUTATIONA=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?l.value:Math.pow(e,t)},t.PHI=function(e){return(e=a.parseNumber(e))instanceof Error?l.value:Math.exp(-.5*e*e)/2.5066282746310002},t.POISSON={},t.POISSON.DIST=function(e,t,r){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?l.value:r?i.poisson.cdf(e,t):i.poisson.pdf(e,t)},t.PROB=function(e,t,r,n){if(void 0===r)return 0;if(n=void 0===n?r:n,e=a.parseNumberArray(a.flatten(e)),t=a.parseNumberArray(a.flatten(t)),r=a.parseNumber(r),n=a.parseNumber(n),a.anyIsError(e,t,r,n))return l.value;if(r===n)return e.indexOf(r)>=0?t[e.indexOf(r)]:0;for(var o=e.sort((function(e,t){return e-t})),i=o.length,s=0,u=0;u<i;u++)o[u]>=r&&o[u]<=n&&(s+=t[e.indexOf(o[u])]);return s},t.QUARTILE={},t.QUARTILE.EXC=function(e,r){if(e=a.parseNumberArray(a.flatten(e)),r=a.parseNumber(r),a.anyIsError(e,r))return l.value;switch(r){case 1:return t.PERCENTILE.EXC(e,.25);case 2:return t.PERCENTILE.EXC(e,.5);case 3:return t.PERCENTILE.EXC(e,.75);default:return l.num}},t.QUARTILE.INC=function(e,r){if(e=a.parseNumberArray(a.flatten(e)),r=a.parseNumber(r),a.anyIsError(e,r))return l.value;switch(r){case 1:return t.PERCENTILE.INC(e,.25);case 2:return t.PERCENTILE.INC(e,.5);case 3:return t.PERCENTILE.INC(e,.75);default:return l.num}},t.RANK={},t.RANK.AVG=function(e,t,r){if(e=a.parseNumber(e),t=a.parseNumberArray(a.flatten(t)),a.anyIsError(e,t))return l.value;for(var n=(r=r||!1)?function(e,t){return e-t}:function(e,t){return t-e},o=(t=(t=a.flatten(t)).sort(n)).length,i=0,s=0;s<o;s++)t[s]===e&&i++;return i>1?(2*t.indexOf(e)+i+1)/2:t.indexOf(e)+1},t.RANK.EQ=function(e,t,r){if(e=a.parseNumber(e),t=a.parseNumberArray(a.flatten(t)),a.anyIsError(e,t))return l.value;var n=(r=r||!1)?function(e,t){return e-t}:function(e,t){return t-e};return(t=t.sort(n)).indexOf(e)+1},t.ROW=function(e,t){return 2!==arguments.length?l.na:t<0?l.num:e instanceof Array&&"number"==typeof t?0!==e.length?i.row(e,t):void 0:l.value},t.ROWS=function(e){return 1!==arguments.length?l.na:e instanceof Array?0===e.length?0:i.rows(e):l.value},t.RSQ=function(e,r){return e=a.parseNumberArray(a.flatten(e)),r=a.parseNumberArray(a.flatten(r)),a.anyIsError(e,r)?l.value:Math.pow(t.PEARSON(e,r),2)},t.SKEW=function(){var e=a.parseNumberArray(a.flatten(arguments));if(e instanceof Error)return e;for(var t=i.mean(e),r=e.length,n=0,o=0;o<r;o++)n+=Math.pow(e[o]-t,3);return r*n/((r-1)*(r-2)*Math.pow(i.stdev(e,!0),3))},t.SKEW.P=function(){var e=a.parseNumberArray(a.flatten(arguments));if(e instanceof Error)return e;for(var t=i.mean(e),r=e.length,n=0,o=0,s=0;s<r;s++)o+=Math.pow(e[s]-t,3),n+=Math.pow(e[s]-t,2);return n/=r,(o/=r)/Math.pow(n,1.5)},t.SLOPE=function(e,t){if(e=a.parseNumberArray(a.flatten(e)),t=a.parseNumberArray(a.flatten(t)),a.anyIsError(e,t))return l.value;for(var r=i.mean(t),n=i.mean(e),o=t.length,s=0,u=0,c=0;c<o;c++)s+=(t[c]-r)*(e[c]-n),u+=Math.pow(t[c]-r,2);return s/u},t.SMALL=function(e,t){return e=a.parseNumberArray(a.flatten(e)),t=a.parseNumber(t),a.anyIsError(e,t)?e:e.sort((function(e,t){return e-t}))[t-1]},t.STANDARDIZE=function(e,t,r){return e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?l.value:(e-t)/r},t.STDEV={},t.STDEV.P=function(){var e=t.VAR.P.apply(this,arguments),r=Math.sqrt(e);return isNaN(r)&&(r=l.num),r},t.STDEV.S=function(){var e=t.VAR.S.apply(this,arguments),r=Math.sqrt(e);return r},t.STDEVA=function(){var e=t.VARA.apply(this,arguments),r=Math.sqrt(e);return r},t.STDEVPA=function(){var e=t.VARPA.apply(this,arguments),r=Math.sqrt(e);return isNaN(r)&&(r=l.num),r},t.STEYX=function(e,t){if(e=a.parseNumberArray(a.flatten(e)),t=a.parseNumberArray(a.flatten(t)),a.anyIsError(e,t))return l.value;for(var r=i.mean(t),n=i.mean(e),o=t.length,s=0,u=0,c=0,f=0;f<o;f++)s+=Math.pow(e[f]-n,2),u+=(t[f]-r)*(e[f]-n),c+=Math.pow(t[f]-r,2);return Math.sqrt((s-u*u/c)/(o-2))},t.TRANSPOSE=function(e){return e?i.transpose(e):l.na},t.T=o.T,t.T.DIST=function(e,t,r){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?l.value:r?i.studentt.cdf(e,t):i.studentt.pdf(e,t)},t.T.DIST["2T"]=function(e,t){return 2!==arguments.length?l.na:e<0||t<1?l.num:"number"!=typeof e||"number"!=typeof t?l.value:2*(1-i.studentt.cdf(e,t))},t.T.DIST.RT=function(e,t){return 2!==arguments.length?l.na:e<0||t<1?l.num:"number"!=typeof e||"number"!=typeof t?l.value:1-i.studentt.cdf(e,t)},t.T.INV=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?l.value:i.studentt.inv(e,t)},t.T.INV["2T"]=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),e<=0||e>1||t<1?l.num:a.anyIsError(e,t)?l.value:Math.abs(i.studentt.inv(e/2,t))},t.T.TEST=function(e,r){if(e=a.parseNumberArray(a.flatten(e)),r=a.parseNumberArray(a.flatten(r)),a.anyIsError(e,r))return l.value;var n,o=i.mean(e),s=i.mean(r),u=0,c=0;for(n=0;n<e.length;n++)u+=Math.pow(e[n]-o,2);for(n=0;n<r.length;n++)c+=Math.pow(r[n]-s,2);u/=e.length-1,c/=r.length-1;var f=Math.abs(o-s)/Math.sqrt(u/e.length+c/r.length);return t.T.DIST["2T"](f,e.length+r.length-2)},t.TREND=function(e,r,n){if(e=a.parseNumberArray(a.flatten(e)),r=a.parseNumberArray(a.flatten(r)),n=a.parseNumberArray(a.flatten(n)),a.anyIsError(e,r,n))return l.value;var o=t.LINEST(e,r),i=o[0],s=o[1],u=[];return n.forEach((function(e){u.push(i*e+s)})),u},t.TRIMMEAN=function(e,t){if(e=a.parseNumberArray(a.flatten(e)),t=a.parseNumber(t),a.anyIsError(e,t))return l.value;var r=n.FLOOR(e.length*t,2)/2;return i.mean(a.initial(a.rest(e.sort((function(e,t){return e-t})),r),r))},t.VAR={},t.VAR.P=function(){for(var e,r=a.numbers(a.flatten(arguments)),n=r.length,o=0,i=t.AVERAGE(r),s=0;s<n;s++)o+=Math.pow(r[s]-i,2);return e=o/n,isNaN(e)&&(e=l.num),e},t.VAR.S=function(){for(var e=a.numbers(a.flatten(arguments)),r=e.length,n=0,o=t.AVERAGE(e),i=0;i<r;i++)n+=Math.pow(e[i]-o,2);return n/(r-1)},t.VARA=function(){for(var e=a.flatten(arguments),r=e.length,n=0,o=0,i=t.AVERAGEA(e),s=0;s<r;s++){var l=e[s];n+="number"==typeof l?Math.pow(l-i,2):!0===l?Math.pow(1-i,2):Math.pow(0-i,2),null!==l&&o++}return n/(o-1)},t.VARPA=function(){for(var e,r=a.flatten(arguments),n=r.length,o=0,i=0,s=t.AVERAGEA(r),u=0;u<n;u++){var c=r[u];o+="number"==typeof c?Math.pow(c-s,2):!0===c?Math.pow(1-s,2):Math.pow(0-s,2),null!==c&&i++}return e=o/i,isNaN(e)&&(e=l.num),e},t.WEIBULL={},t.WEIBULL.DIST=function(e,t,r,n){return e=a.parseNumber(e),t=a.parseNumber(t),r=a.parseNumber(r),a.anyIsError(e,t,r)?l.value:n?1-Math.exp(-Math.pow(e/r,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/r,t))*t/Math.pow(r,t)},t.Z={},t.Z.TEST=function(e,r,n){if(e=a.parseNumberArray(a.flatten(e)),r=a.parseNumber(r),a.anyIsError(e,r))return l.value;n=n||t.STDEV.S(e);var o=e.length;return 1-t.NORM.S.DIST((t.AVERAGE(e)-r)/(n/Math.sqrt(o)),!0)}},function(e,t,r){var n=r(1),o=r(0);t.ASC=function(){throw new Error("ASC is not implemented")},t.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},t.CHAR=function(e){return(e=n.parseNumber(e))instanceof Error?e:String.fromCharCode(e)},t.CLEAN=function(e){return(e=e||"").replace(/[\0-\x1F]/g,"")},t.CODE=function(e){var t=(e=e||"").charCodeAt(0);return isNaN(t)&&(t=o.na),t},t.CONCATENATE=function(){for(var e=n.flatten(arguments),t=0;(t=e.indexOf(!0))>-1;)e[t]="TRUE";for(var r=0;(r=e.indexOf(!1))>-1;)e[r]="FALSE";return e.join("")},t.DBCS=function(){throw new Error("DBCS is not implemented")},t.DOLLAR=function(){throw new Error("DOLLAR is not implemented")},t.EXACT=function(e,t){return 2!==arguments.length?o.na:e===t},t.FIND=function(e,t,r){return arguments.length<2?o.na:(r=void 0===r?0:r,t?t.indexOf(e,r-1)+1:null)},t.FIXED=function(){throw new Error("FIXED is not implemented")},t.HTML2TEXT=function(e){var t="";return e&&(e instanceof Array?e.forEach((function(e){""!==t&&(t+="\n"),t+=e.replace(/<(?:.|\n)*?>/gm,"")})):t=e.replace(/<(?:.|\n)*?>/gm,"")),t},t.LEFT=function(e,t){return t=void 0===t?1:t,(t=n.parseNumber(t))instanceof Error||"string"!=typeof e?o.value:e?e.substring(0,t):null},t.LEN=function(e){return 0===arguments.length?o.error:"string"==typeof e?e?e.length:0:e.length?e.length:o.value},t.LOWER=function(e){return"string"!=typeof e?o.value:e?e.toLowerCase():e},t.MID=function(e,t,r){if(t=n.parseNumber(t),r=n.parseNumber(r),n.anyIsError(t,r)||"string"!=typeof e)return r;var o=t-1,i=o+r;return e.substring(o,i)},t.NUMBERVALUE=function(e,t,r){return t=void 0===t?".":t,r=void 0===r?",":r,Number(e.replace(t,".").replace(r,""))},t.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},t.PROPER=function(e){return void 0===e||0===e.length?o.value:(!0===e&&(e="TRUE"),!1===e&&(e="FALSE"),isNaN(e)&&"number"==typeof e?o.value:("number"==typeof e&&(e=""+e),e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))))},t.REGEXEXTRACT=function(e,t){if(arguments.length<2)return o.na;var r=e.match(new RegExp(t));return r?r[r.length>1?r.length-1:0]:null},t.REGEXMATCH=function(e,t,r){if(arguments.length<2)return o.na;var n=e.match(new RegExp(t));return r?n:!!n},t.REGEXREPLACE=function(e,t,r){return arguments.length<3?o.na:e.replace(new RegExp(t),r)},t.REPLACE=function(e,t,r,i){return t=n.parseNumber(t),r=n.parseNumber(r),n.anyIsError(t,r)||"string"!=typeof e||"string"!=typeof i?o.value:e.substr(0,t-1)+i+e.substr(t-1+r)},t.REPT=function(e,t){return(t=n.parseNumber(t))instanceof Error?t:new Array(t+1).join(e)},t.RIGHT=function(e,t){return t=void 0===t?1:t,(t=n.parseNumber(t))instanceof Error?t:e?e.substring(e.length-t):o.na},t.SEARCH=function(e,t,r){var n;return"string"!=typeof e||"string"!=typeof t?o.value:(r=void 0===r?0:r,0===(n=t.toLowerCase().indexOf(e.toLowerCase(),r-1)+1)?o.value:n)},t.SPLIT=function(e,t){return e.split(t)},t.SUBSTITUTE=function(e,t,r,n){if(arguments.length<2)return o.na;if(!(e&&t&&r))return e;if(void 0===n)return e.replace(new RegExp(t,"g"),r);for(var i=0,a=0;e.indexOf(t,i)>0;)if(i=e.indexOf(t,i+1),++a===n)return e.substring(0,i)+r+e.substring(i+t.length)},t.T=function(e){return"string"==typeof e?e:""},t.TEXT=function(){throw new Error("TEXT is not implemented")},t.TRIM=function(e){return"string"!=typeof e?o.value:e.replace(/ +/g," ").trim()},t.UNICHAR=t.CHAR,t.UNICODE=t.CODE,t.UPPER=function(e){return"string"!=typeof e?o.value:e.toUpperCase()},t.VALUE=function(){throw new Error("VALUE is not implemented")}},function(e,t){var r=[">",">=","<","<=","=","<>"],n="operator",o="literal",i=[n,o];function a(e,t){if(-1===i.indexOf(t))throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function s(e){for(var t,i="",s=[],l=0;l<e.length;l++){var u=e[l];0===l&&r.indexOf(u)>=0?s.push(a(u,n)):i+=u}return i.length>0&&s.push(a(("string"!=typeof(t=i)||/^\d+(\.\d+)?$/.test(t)&&(t=-1===t.indexOf(".")?parseInt(t,10):parseFloat(t)),t),o)),s.length>0&&s[0].type!==n&&s.unshift(a("=",n)),s}t.TOKEN_TYPE_OPERATOR=n,t.TOKEN_TYPE_LITERAL=o,t.parse=function(e){return s(function(e){for(var t=e.length,r=[],n=0,o="",i="";n<t;){var a=e.charAt(n);switch(a){case">":case"<":case"=":i+=a,o.length>0&&(r.push(o),o="");break;default:i.length>0&&(r.push(i),i=""),o+=a}n++}return o.length>0&&r.push(o),i.length>0&&r.push(i),r}(e))},t.createToken=a,t.compute=function(e){for(var t,r=[],i=0;i<e.length;i++){var a=e[i];switch(a.type){case n:t=a.value;break;case o:r.push(a.value)}}return function(e,t){var r=!1;switch(t){case">":r=e[0]>e[1];break;case">=":r=e[0]>=e[1];break;case"<":r=e[0]<e[1];break;case"<=":r=e[0]<=e[1];break;case"=":r=e[0]==e[1];break;case"<>":r=e[0]!=e[1]}return r}(r,t)}},function(e,t,r){var n=r(0);t.CELL=function(){throw new Error("CELL is not implemented")},t.ERROR={},t.ERROR.TYPE=function(e){switch(e){case n.nil:return 1;case n.div0:return 2;case n.value:return 3;case n.ref:return 4;case n.name:return 5;case n.num:return 6;case n.na:return 7;case n.data:return 8}return n.na},t.INFO=function(){throw new Error("INFO is not implemented")},t.ISBLANK=function(e){return null===e},t.ISBINARY=function(e){return/^[01]{1,10}$/.test(e)},t.ISERR=function(e){return[n.value,n.ref,n.div0,n.num,n.name,n.nil].indexOf(e)>=0||"number"==typeof e&&(isNaN(e)||!isFinite(e))},t.ISERROR=function(e){return t.ISERR(e)||e===n.na},t.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},t.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},t.ISLOGICAL=function(e){return!0===e||!1===e},t.ISNA=function(e){return e===n.na},t.ISNONTEXT=function(e){return"string"!=typeof e},t.ISNUMBER=function(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)},t.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},t.ISREF=function(){throw new Error("ISREF is not implemented")},t.ISTEXT=function(e){return"string"==typeof e},t.N=function(e){return this.ISNUMBER(e)?e:e instanceof Date?e.getTime():!0===e?1:!1===e?0:this.ISERROR(e)?e:0},t.NA=function(){return n.na},t.SHEET=function(){throw new Error("SHEET is not implemented")},t.SHEETS=function(){throw new Error("SHEETS is not implemented")},t.TYPE=function(e){return this.ISNUMBER(e)?1:this.ISTEXT(e)?2:this.ISLOGICAL(e)?4:this.ISERROR(e)?16:Array.isArray(e)?64:void 0}},function(e,t,r){var n=r(0),o=r(1),i=new Date(Date.UTC(1900,0,1)),a=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],s=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],l=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function u(e){return 1===new Date(e,1,29).getMonth()}function c(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function f(e){var t=e>-22038912e5?2:1;return Math.ceil((e-i)/864e5)+t}t.DATE=function(e,t,r){return e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r)?n.value:e<0||t<0||r<0?n.num:new Date(e,t-1,r)},t.DATEVALUE=function(e){var t,r=2;return"string"!=typeof e?n.value:(t=Date.parse(e),isNaN(t)?n.value:(t<=-22038912e5&&(r=1),Math.ceil((t-i)/864e5)+r))},t.DAY=function(e){var t=o.parseDate(e);return t instanceof Error?t:t.getDate()},t.DAYS=function(e,t){return e=o.parseDate(e),t=o.parseDate(t),e instanceof Error?e:t instanceof Error?t:f(e)-f(t)},t.DAYS360=function(e,t,r){if(r=o.parseBool(r),e=o.parseDate(e),t=o.parseDate(t),e instanceof Error)return e;if(t instanceof Error)return t;if(r instanceof Error)return r;var n,i,a=e.getMonth(),s=t.getMonth();if(r)n=31===e.getDate()?30:e.getDate(),i=31===t.getDate()?30:t.getDate();else{var l=new Date(e.getFullYear(),a+1,0).getDate(),u=new Date(t.getFullYear(),s+1,0).getDate();n=e.getDate()===l?30:e.getDate(),t.getDate()===u?n<30?(s++,i=1):i=30:i=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(s-a)+(i-n)},t.EDATE=function(e,t){return(e=o.parseDate(e))instanceof Error?e:isNaN(t)?n.value:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),f(e))},t.EOMONTH=function(e,t){return(e=o.parseDate(e))instanceof Error?e:isNaN(t)?n.value:(t=parseInt(t,10),f(new Date(e.getFullYear(),e.getMonth()+t+1,0)))},t.HOUR=function(e){return(e=o.parseDate(e))instanceof Error?e:e.getHours()},t.INTERVAL=function(e){if("number"!=typeof e&&"string"!=typeof e)return n.value;e=parseInt(e,10);var t=Math.floor(e/94608e4);e%=94608e4;var r=Math.floor(e/2592e3);e%=2592e3;var o=Math.floor(e/86400);e%=86400;var i=Math.floor(e/3600);e%=3600;var a=Math.floor(e/60),s=e%=60;return"P"+(t=t>0?t+"Y":"")+(r=r>0?r+"M":"")+(o=o>0?o+"D":"")+"T"+(i=i>0?i+"H":"")+(a=a>0?a+"M":"")+(s=s>0?s+"S":"")},t.ISOWEEKNUM=function(e){if((e=o.parseDate(e))instanceof Error)return e;e.setHours(0,0,0),e.setDate(e.getDate()+4-(e.getDay()||7));var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)},t.MINUTE=function(e){return(e=o.parseDate(e))instanceof Error?e:e.getMinutes()},t.MONTH=function(e){return(e=o.parseDate(e))instanceof Error?e:e.getMonth()+1},t.NETWORKDAYS=function(e,t,r){return this.NETWORKDAYS.INTL(e,t,1,r)},t.NETWORKDAYS.INTL=function(e,t,r,i){if((e=o.parseDate(e))instanceof Error)return e;if((t=o.parseDate(t))instanceof Error)return t;if(!((r=void 0===r?l[1]:l[r])instanceof Array))return n.value;void 0===i?i=[]:i instanceof Array||(i=[i]);for(var a=0;a<i.length;a++){var s=o.parseDate(i[a]);if(s instanceof Error)return s;i[a]=s}var u=(t-e)/864e5+1,c=u,f=e;for(a=0;a<u;a++){var h=(new Date).getTimezoneOffset()>0?f.getUTCDay():f.getDay(),d=!1;h!==r[0]&&h!==r[1]||(d=!0);for(var p=0;p<i.length;p++){var y=i[p];if(y.getDate()===f.getDate()&&y.getMonth()===f.getMonth()&&y.getFullYear()===f.getFullYear()){d=!0;break}}d&&c--,f.setDate(f.getDate()+1)}return c},t.NOW=function(){return new Date},t.SECOND=function(e){return(e=o.parseDate(e))instanceof Error?e:e.getSeconds()},t.TIME=function(e,t,r){return e=o.parseNumber(e),t=o.parseNumber(t),r=o.parseNumber(r),o.anyIsError(e,t,r)?n.value:e<0||t<0||r<0?n.num:(3600*e+60*t+r)/86400},t.TIMEVALUE=function(e){return(e=o.parseDate(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},t.TODAY=function(){return new Date},t.WEEKDAY=function(e,t){if((e=o.parseDate(e))instanceof Error)return e;void 0===t&&(t=1);var r=e.getDay();return s[t][r]},t.WEEKNUM=function(e,t){if((e=o.parseDate(e))instanceof Error)return e;if(void 0===t&&(t=1),21===t)return this.ISOWEEKNUM(e);var r=a[t],n=new Date(e.getFullYear(),0,1),i=n.getDay()<r?1:0;return n-=24*Math.abs(n.getDay()-r)*60*60*1e3,Math.floor((e-n)/864e5/7+1)+i},t.WORKDAY=function(e,t,r){return this.WORKDAY.INTL(e,t,1,r)},t.WORKDAY.INTL=function(e,t,r,i){if((e=o.parseDate(e))instanceof Error)return e;if((t=o.parseNumber(t))instanceof Error)return t;if(t<0)return n.num;if(!((r=void 0===r?l[1]:l[r])instanceof Array))return n.value;void 0===i?i=[]:i instanceof Array||(i=[i]);for(var a=0;a<i.length;a++){var s=o.parseDate(i[a]);if(s instanceof Error)return s;i[a]=s}for(var u=0;u<t;){e.setDate(e.getDate()+1);var c=e.getDay();if(c!==r[0]&&c!==r[1]){for(var f=0;f<i.length;f++){var h=i[f];if(h.getDate()===e.getDate()&&h.getMonth()===e.getMonth()&&h.getFullYear()===e.getFullYear()){u--;break}}u++}}return e},t.YEAR=function(e){return(e=o.parseDate(e))instanceof Error?e:e.getFullYear()},t.YEARFRAC=function(e,t,r){if((e=o.parseDate(e))instanceof Error)return e;if((t=o.parseDate(t))instanceof Error)return t;r=r||0;var n=e.getDate(),i=e.getMonth()+1,a=e.getFullYear(),s=t.getDate(),l=t.getMonth()+1,f=t.getFullYear();switch(r){case 0:return 31===n&&31===s?(n=30,s=30):31===n?n=30:30===n&&31===s&&(s=30),(s+30*l+360*f-(n+30*i+360*a))/360;case 1:var h=365;if(a===f||a+1===f&&(i>l||i===l&&n>=s))return(a===f&&u(a)||function(e,t){var r=e.getFullYear(),n=new Date(r,2,1);if(u(r)&&e<n&&t>=n)return!0;var o=t.getFullYear(),i=new Date(o,2,1);return u(o)&&t>=i&&e<i}(e,t)||1===l&&29===s)&&(h=366),c(e,t)/h;var d=f-a+1,p=(new Date(f+1,0,1)-new Date(a,0,1))/1e3/60/60/24/d;return c(e,t)/p;case 2:return c(e,t)/360;case 3:return c(e,t)/365;case 4:return(s+30*l+360*f-(n+30*i+360*a))/360}}},function(e,t,r){var n;e.exports=(function(e,t){var r=e.utils.isFunction;function n(e,t){return e-t}function o(e,r,n){return t.max(r,t.min(e,n))}e.sum=function(e){for(var t=0,r=e.length;--r>=0;)t+=e[r];return t},e.sumsqrd=function(e){for(var t=0,r=e.length;--r>=0;)t+=e[r]*e[r];return t},e.sumsqerr=function(t){for(var r,n=e.mean(t),o=0,i=t.length;--i>=0;)o+=(r=t[i]-n)*r;return o},e.sumrow=function(e){for(var t=0,r=e.length;--r>=0;)t+=e[r];return t},e.product=function(e){for(var t=1,r=e.length;--r>=0;)t*=e[r];return t},e.min=function(e){for(var t=e[0],r=0;++r<e.length;)e[r]<t&&(t=e[r]);return t},e.max=function(e){for(var t=e[0],r=0;++r<e.length;)e[r]>t&&(t=e[r]);return t},e.unique=function(e){for(var t={},r=[],n=0;n<e.length;n++)t[e[n]]||(t[e[n]]=!0,r.push(e[n]));return r},e.mean=function(t){return e.sum(t)/t.length},e.meansqerr=function(t){return e.sumsqerr(t)/t.length},e.geomean=function(r){return t.pow(e.product(r),1/r.length)},e.median=function(e){var t=e.length,r=e.slice().sort(n);return 1&t?r[t/2|0]:(r[t/2-1]+r[t/2])/2},e.cumsum=function(t){return e.cumreduce(t,(function(e,t){return e+t}))},e.cumprod=function(t){return e.cumreduce(t,(function(e,t){return e*t}))},e.diff=function(e){var t,r=[],n=e.length;for(t=1;t<n;t++)r.push(e[t]-e[t-1]);return r},e.rank=function(e){for(var t,r=e.length,o=e.slice().sort(n),i=new Array(r),a=0;a<r;a++){var s=o.indexOf(e[a]),l=o.lastIndexOf(e[a]);t=s===l?s:(s+l)/2,i[a]=t+1}return i},e.mode=function(e){var t,r=e.length,o=e.slice().sort(n),i=1,a=0,s=0,l=[];for(t=0;t<r;t++)o[t]===o[t+1]?i++:(i>a?(l=[o[t]],a=i,s=0):i===a&&(l.push(o[t]),s++),i=1);return 0===s?l[0]:l},e.range=function(t){return e.max(t)-e.min(t)},e.variance=function(t,r){return e.sumsqerr(t)/(t.length-(r?1:0))},e.pooledvariance=function(t){return t.reduce((function(t,r){return t+e.sumsqerr(r)}),0)/(t.reduce((function(e,t){return e+t.length}),0)-t.length)},e.deviation=function(t){for(var r=e.mean(t),n=t.length,o=new Array(n),i=0;i<n;i++)o[i]=t[i]-r;return o},e.stdev=function(r,n){return t.sqrt(e.variance(r,n))},e.pooledstdev=function(r){return t.sqrt(e.pooledvariance(r))},e.meandev=function(r){for(var n=e.mean(r),o=[],i=r.length-1;i>=0;i--)o.push(t.abs(r[i]-n));return e.mean(o)},e.meddev=function(r){for(var n=e.median(r),o=[],i=r.length-1;i>=0;i--)o.push(t.abs(r[i]-n));return e.median(o)},e.coeffvar=function(t){return e.stdev(t)/e.mean(t)},e.quartiles=function(e){var r=e.length,o=e.slice().sort(n);return[o[t.round(r/4)-1],o[t.round(r/2)-1],o[t.round(3*r/4)-1]]},e.quantiles=function(e,r,i,a){var s,l,u,c,f,h=e.slice().sort(n),d=[r.length],p=e.length;for(void 0===i&&(i=3/8),void 0===a&&(a=3/8),s=0;s<r.length;s++)u=p*(l=r[s])+(i+l*(1-i-a)),c=t.floor(o(u,1,p-1)),f=o(u-c,0,1),d[s]=(1-f)*h[c-1]+f*h[c];return d},e.percentile=function(e,t,r){var o=e.slice().sort(n),i=t*(o.length+(r?1:-1))+(r?0:1),a=parseInt(i),s=i-a;return a+1<o.length?o[a-1]+s*(o[a]-o[a-1]):o[a-1]},e.percentileOfScore=function(e,t,r){var n,o,i=0,a=e.length,s=!1;for("strict"===r&&(s=!0),o=0;o<a;o++)n=e[o],(s&&n<t||!s&&n<=t)&&i++;return i/a},e.histogram=function(r,n){n=n||4;var o,i=e.min(r),a=(e.max(r)-i)/n,s=r.length,l=[];for(o=0;o<n;o++)l[o]=0;for(o=0;o<s;o++)l[t.min(t.floor((r[o]-i)/a),n-1)]+=1;return l},e.covariance=function(t,r){var n,o=e.mean(t),i=e.mean(r),a=t.length,s=new Array(a);for(n=0;n<a;n++)s[n]=(t[n]-o)*(r[n]-i);return e.sum(s)/(a-1)},e.corrcoeff=function(t,r){return e.covariance(t,r)/e.stdev(t,1)/e.stdev(r,1)},e.spearmancoeff=function(t,r){return t=e.rank(t),r=e.rank(r),e.corrcoeff(t,r)},e.stanMoment=function(r,n){for(var o=e.mean(r),i=e.stdev(r),a=r.length,s=0,l=0;l<a;l++)s+=t.pow((r[l]-o)/i,n);return s/r.length},e.skewness=function(t){return e.stanMoment(t,3)},e.kurtosis=function(t){return e.stanMoment(t,4)-3};var i=e.prototype;!function(t){for(var n=0;n<t.length;n++)!function(t){i[t]=function(n,o){var a=[],s=0,l=this;if(r(n)&&(o=n,n=!1),o)return setTimeout((function(){o.call(l,i[t].call(l,n))})),this;if(this.length>1){for(l=!0===n?this:this.transpose();s<l.length;s++)a[s]=e[t](l[s]);return a}return e[t](this[0],n)}}(t[n])}("cumsum cumprod".split(" ")),function(t){for(var n=0;n<t.length;n++)!function(t){i[t]=function(n,o){var a=[],s=0,l=this;if(r(n)&&(o=n,n=!1),o)return setTimeout((function(){o.call(l,i[t].call(l,n))})),this;if(this.length>1){for("sumrow"!==t&&(l=!0===n?this:this.transpose());s<l.length;s++)a[s]=e[t](l[s]);return!0===n?e[t](e.utils.toVector(a)):a}return e[t](this[0],n)}}(t[n])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(t){for(var n=0;n<t.length;n++)!function(t){i[t]=function(){var n,o=[],a=0,s=this,l=Array.prototype.slice.call(arguments);if(r(l[l.length-1])){n=l[l.length-1];var u=l.slice(0,l.length-1);return setTimeout((function(){n.call(s,i[t].apply(s,u))})),this}n=void 0;var c=function(r){return e[t].apply(s,[r].concat(l))};if(this.length>1){for(s=s.transpose();a<s.length;a++)o[a]=c(s[a]);return o}return c(this[0])}}(t[n])}("quantiles percentileOfScore".split(" "))}(n=function(e,t){var r=Array.prototype.concat,n=Array.prototype.slice,o=Object.prototype.toString;function i(t,r){var n=t>r?t:r;return e.pow(10,17-~~(e.log(n>0?n:-n)*e.LOG10E))}var a=Array.isArray||function(e){return"[object Array]"===o.call(e)};function s(e){return"[object Function]"===o.call(e)}function l(e){return"number"==typeof e&&e-e==0}function u(e){return r.apply([],e)}function c(){return new c._init(arguments)}function f(){return 0}function h(){return 1}function d(e,t){return e===t?1:0}c.fn=c.prototype,c._init=function(e){if(a(e[0]))if(a(e[0][0])){s(e[1])&&(e[0]=c.map(e[0],e[1]));for(var t=0;t<e[0].length;t++)this[t]=e[0][t];this.length=e[0].length}else this[0]=s(e[1])?c.map(e[0],e[1]):e[0],this.length=1;else if(l(e[0]))this[0]=c.seq.apply(null,e),this.length=1;else{if(e[0]instanceof c)return c(e[0].toArray());this[0]=[],this.length=1}return this},c._init.prototype=c.prototype,c._init.constructor=c,c.utils={calcRdx:i,isArray:a,isFunction:s,isNumber:l,toVector:u},c._random_fn=e.random,c.setRandom=function(e){if("function"!=typeof e)throw new TypeError("fn is not a function");c._random_fn=e},c.extend=function(e){var t,r;if(1===arguments.length){for(r in e)c[r]=e[r];return this}for(t=1;t<arguments.length;t++)for(r in arguments[t])e[r]=arguments[t][r];return e},c.rows=function(e){return e.length||1},c.cols=function(e){return e[0].length||1},c.dimensions=function(e){return{rows:c.rows(e),cols:c.cols(e)}},c.row=function(e,t){return a(t)?t.map((function(t){return c.row(e,t)})):e[t]},c.rowa=function(e,t){return c.row(e,t)},c.col=function(e,t){if(a(t)){var r=c.arange(e.length).map((function(){return new Array(t.length)}));return t.forEach((function(t,n){c.arange(e.length).forEach((function(o){r[o][n]=e[o][t]}))})),r}for(var n=new Array(e.length),o=0;o<e.length;o++)n[o]=[e[o][t]];return n},c.cola=function(e,t){return c.col(e,t).map((function(e){return e[0]}))},c.diag=function(e){for(var t=c.rows(e),r=new Array(t),n=0;n<t;n++)r[n]=[e[n][n]];return r},c.antidiag=function(e){for(var t=c.rows(e)-1,r=new Array(t),n=0;t>=0;t--,n++)r[n]=[e[n][t]];return r},c.transpose=function(e){var t,r,n,o,i,s=[];for(a(e[0])||(e=[e]),r=e.length,n=e[0].length,i=0;i<n;i++){for(t=new Array(r),o=0;o<r;o++)t[o]=e[o][i];s.push(t)}return 1===s.length?s[0]:s},c.map=function(e,t,r){var n,o,i,s,l;for(a(e[0])||(e=[e]),o=e.length,i=e[0].length,s=r?e:new Array(o),n=0;n<o;n++)for(s[n]||(s[n]=new Array(i)),l=0;l<i;l++)s[n][l]=t(e[n][l],n,l);return 1===s.length?s[0]:s},c.cumreduce=function(e,t,r){var n,o,i,s,l;for(a(e[0])||(e=[e]),o=e.length,i=e[0].length,s=r?e:new Array(o),n=0;n<o;n++)for(s[n]||(s[n]=new Array(i)),i>0&&(s[n][0]=e[n][0]),l=1;l<i;l++)s[n][l]=t(s[n][l-1],e[n][l]);return 1===s.length?s[0]:s},c.alter=function(e,t){return c.map(e,t,!0)},c.create=function(e,t,r){var n,o,i=new Array(e);for(s(t)&&(r=t,t=e),n=0;n<e;n++)for(i[n]=new Array(t),o=0;o<t;o++)i[n][o]=r(n,o);return i},c.zeros=function(e,t){return l(t)||(t=e),c.create(e,t,f)},c.ones=function(e,t){return l(t)||(t=e),c.create(e,t,h)},c.rand=function(e,t){return l(t)||(t=e),c.create(e,t,c._random_fn)},c.identity=function(e,t){return l(t)||(t=e),c.create(e,t,d)},c.symmetric=function(e){var t,r,n=e.length;if(e.length!==e[0].length)return!1;for(t=0;t<n;t++)for(r=0;r<n;r++)if(e[r][t]!==e[t][r])return!1;return!0},c.clear=function(e){return c.alter(e,f)},c.seq=function(e,t,r,n){s(n)||(n=!1);var o,a=[],l=i(e,t),u=(t*l-e*l)/((r-1)*l),c=e;for(o=0;c<=t&&o<r;c=(e*l+u*l*++o)/l)a.push(n?n(c,o):c);return a},c.arange=function(e,r,n){var o,i=[];if(n=n||1,r===t&&(r=e,e=0),e===r||0===n)return[];if(e<r&&n<0)return[];if(e>r&&n>0)return[];if(n>0)for(o=e;o<r;o+=n)i.push(o);else for(o=e;o>r;o+=n)i.push(o);return i},c.slice=function(){function e(e,r,n,o){var i,a=[],s=e.length;if(r===t&&n===t&&o===t)return c.copy(e);if(o=o||1,(r=(r=r||0)>=0?r:s+r)===(n=(n=n||e.length)>=0?n:s+n)||0===o)return[];if(r<n&&o<0)return[];if(r>n&&o>0)return[];if(o>0)for(i=r;i<n;i+=o)a.push(e[i]);else for(i=r;i>n;i+=o)a.push(e[i]);return a}function r(t,r){var n,o;return l((r=r||{}).row)?l(r.col)?t[r.row][r.col]:e(c.rowa(t,r.row),(n=r.col||{}).start,n.end,n.step):l(r.col)?e(c.cola(t,r.col),(o=r.row||{}).start,o.end,o.step):(o=r.row||{},n=r.col||{},e(t,o.start,o.end,o.step).map((function(t){return e(t,n.start,n.end,n.step)})))}return r}(),c.sliceAssign=function(r,n,o){var i,a;if(l(n.row)){if(l(n.col))return r[n.row][n.col]=o;n.col=n.col||{},n.col.start=n.col.start||0,n.col.end=n.col.end||r[0].length,n.col.step=n.col.step||1,i=c.arange(n.col.start,e.min(r.length,n.col.end),n.col.step);var s=n.row;return i.forEach((function(e,t){r[s][e]=o[t]})),r}if(l(n.col)){n.row=n.row||{},n.row.start=n.row.start||0,n.row.end=n.row.end||r.length,n.row.step=n.row.step||1,a=c.arange(n.row.start,e.min(r[0].length,n.row.end),n.row.step);var u=n.col;return a.forEach((function(e,t){r[e][u]=o[t]})),r}return o[0].length===t&&(o=[o]),n.row.start=n.row.start||0,n.row.end=n.row.end||r.length,n.row.step=n.row.step||1,n.col.start=n.col.start||0,n.col.end=n.col.end||r[0].length,n.col.step=n.col.step||1,a=c.arange(n.row.start,e.min(r.length,n.row.end),n.row.step),i=c.arange(n.col.start,e.min(r[0].length,n.col.end),n.col.step),a.forEach((function(e,t){i.forEach((function(n,i){r[e][n]=o[t][i]}))})),r},c.diagonal=function(e){var t=c.zeros(e.length,e.length);return e.forEach((function(e,r){t[r][r]=e})),t},c.copy=function(e){return e.map((function(e){return l(e)?e:e.map((function(e){return e}))}))};var p=c.prototype;return p.length=0,p.push=Array.prototype.push,p.sort=Array.prototype.sort,p.splice=Array.prototype.splice,p.slice=Array.prototype.slice,p.toArray=function(){return this.length>1?n.call(this):n.call(this)[0]},p.map=function(e,t){return c(c.map(this,e,t))},p.cumreduce=function(e,t){return c(c.cumreduce(this,e,t))},p.alter=function(e){return c.alter(this,e),this},function(e){for(var t=0;t<e.length;t++)!function(e){p[e]=function(t){var r,n=this;return t?(setTimeout((function(){t.call(n,p[e].call(n))})),this):(r=c[e](this),a(r)?c(r):r)}}(e[t])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(e){for(var t=0;t<e.length;t++)!function(e){p[e]=function(t,r){var n=this;return r?(setTimeout((function(){r.call(n,p[e].call(n,t))})),this):c(c[e](this,t))}}(e[t])}("row col".split(" ")),function(e){for(var t=0;t<e.length;t++)!function(e){p[e]=function(){return c(c[e].apply(null,arguments))}}(e[t])}("create zeros ones rand identity".split(" ")),c}(Math),Math),function(e,t){e.gammaln=function(e){var r,n,o,i=0,a=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],s=1.000000000190015;for(o=(n=r=e)+5.5,o-=(r+.5)*t.log(o);i<6;i++)s+=a[i]/++n;return t.log(2.5066282746310007*s/r)-o},e.loggam=function(e){var r,n,o,i,a,s,l,u=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(r=e,l=0,1==e||2==e)return 0;for(e<=7&&(r=e+(l=t.floor(7-e))),n=1/(r*r),o=2*t.PI,a=u[9],s=8;s>=0;s--)a*=n,a+=u[s];if(i=a/r+.5*t.log(o)+(r-.5)*t.log(r)-r,e<=7)for(s=1;s<=l;s++)i-=t.log(r-1),r-=1;return i},e.gammafn=function(e){var r,n,o,i,a=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],s=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],l=!1,u=0,c=0,f=0,h=e;if(h<=0){if(!(i=h%1+36e-17))return 1/0;l=(1&h?-1:1)*t.PI/t.sin(t.PI*i),h=1-h}for(o=h,n=h<1?h++:(h-=u=(0|h)-1)-1,r=0;r<8;++r)f=(f+a[r])*n,c=c*n+s[r];if(i=f/c+1,o<h)i/=o;else if(o>h)for(r=0;r<u;++r)i*=h,h++;return l&&(i=l/i),i},e.gammap=function(t,r){return e.lowRegGamma(t,r)*e.gammafn(t)},e.lowRegGamma=function(r,n){var o,i=e.gammaln(r),a=r,s=1/r,l=s,u=n+1-r,c=1/1e-30,f=1/u,h=f,d=1,p=-~(8.5*t.log(r>=1?r:1/r)+.4*r+17);if(n<0||r<=0)return NaN;if(n<r+1){for(;d<=p;d++)s+=l*=n/++a;return s*t.exp(-n+r*t.log(n)-i)}for(;d<=p;d++)h*=(f=1/(f=(o=-d*(d-r))*f+(u+=2)))*(c=u+o/c);return 1-h*t.exp(-n+r*t.log(n)-i)},e.factorialln=function(t){return t<0?NaN:e.gammaln(t+1)},e.factorial=function(t){return t<0?NaN:e.gammafn(t+1)},e.combination=function(r,n){return r>170||n>170?t.exp(e.combinationln(r,n)):e.factorial(r)/e.factorial(n)/e.factorial(r-n)},e.combinationln=function(t,r){return e.factorialln(t)-e.factorialln(r)-e.factorialln(t-r)},e.permutation=function(t,r){return e.factorial(t)/e.factorial(t-r)},e.betafn=function(r,n){if(!(r<=0||n<=0))return r+n>170?t.exp(e.betaln(r,n)):e.gammafn(r)*e.gammafn(n)/e.gammafn(r+n)},e.betaln=function(t,r){return e.gammaln(t)+e.gammaln(r)-e.gammaln(t+r)},e.betacf=function(e,r,n){var o,i,a,s,l=1e-30,u=1,c=r+n,f=r+1,h=r-1,d=1,p=1-c*e/f;for(t.abs(p)<l&&(p=l),s=p=1/p;u<=100&&(p=1+(i=u*(n-u)*e/((h+(o=2*u))*(r+o)))*p,t.abs(p)<l&&(p=l),d=1+i/d,t.abs(d)<l&&(d=l),s*=(p=1/p)*d,p=1+(i=-(r+u)*(c+u)*e/((r+o)*(f+o)))*p,t.abs(p)<l&&(p=l),d=1+i/d,t.abs(d)<l&&(d=l),s*=a=(p=1/p)*d,!(t.abs(a-1)<3e-7));u++);return s},e.gammapinv=function(r,n){var o,i,a,s,l,u,c=0,f=n-1,h=1e-8,d=e.gammaln(n);if(r>=1)return t.max(100,n+100*t.sqrt(n));if(r<=0)return 0;for(n>1?(l=t.log(f),u=t.exp(f*(l-1)-d),s=r<.5?r:1-r,o=(2.30753+.27061*(i=t.sqrt(-2*t.log(s))))/(1+i*(.99229+.04481*i))-i,r<.5&&(o=-o),o=t.max(.001,n*t.pow(1-1/(9*n)-o/(3*t.sqrt(n)),3))):o=r<(i=1-n*(.253+.12*n))?t.pow(r/i,1/n):1-t.log(1-(r-i)/(1-i));c<12;c++){if(o<=0)return 0;if((o-=i=(a=(e.lowRegGamma(n,o)-r)/(i=n>1?u*t.exp(-(o-f)+f*(t.log(o)-l)):t.exp(-o+f*t.log(o)-d)))/(1-.5*t.min(1,a*((n-1)/o-1))))<=0&&(o=.5*(o+i)),t.abs(i)<h*o)break}return o},e.erf=function(e){var r,n,o,i,a=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],s=a.length-1,l=!1,u=0,c=0;for(e<0&&(e=-e,l=!0),n=4*(r=2/(2+e))-2;s>0;s--)o=u,u=n*u-c+a[s],c=o;return i=r*t.exp(-e*e+.5*(a[0]+n*u)-c),l?i-1:1-i},e.erfc=function(t){return 1-e.erf(t)},e.erfcinv=function(r){var n,o,i,a,s=0;if(r>=2)return-100;if(r<=0)return 100;for(a=r<1?r:2-r,n=-.70711*((2.30753+.27061*(i=t.sqrt(-2*t.log(a/2))))/(1+i*(.99229+.04481*i))-i);s<2;s++)n+=(o=e.erfc(n)-a)/(1.1283791670955126*t.exp(-n*n)-n*o);return r<1?n:-n},e.ibetainv=function(r,n,o){var i,a,s,l,u,c,f,h,d,p,y=1e-8,g=n-1,m=o-1,v=0;if(r<=0)return 0;if(r>=1)return 1;for(n>=1&&o>=1?(s=r<.5?r:1-r,c=(2.30753+.27061*(l=t.sqrt(-2*t.log(s))))/(1+l*(.99229+.04481*l))-l,r<.5&&(c=-c),f=(c*c-3)/6,h=2/(1/(2*n-1)+1/(2*o-1)),d=c*t.sqrt(f+h)/h-(1/(2*o-1)-1/(2*n-1))*(f+5/6-2/(3*h)),c=n/(n+o*t.exp(2*d))):(i=t.log(n/(n+o)),a=t.log(o/(n+o)),c=r<(l=t.exp(n*i)/n)/(d=l+(u=t.exp(o*a)/o))?t.pow(n*d*r,1/n):1-t.pow(o*d*(1-r),1/o)),p=-e.gammaln(n)-e.gammaln(o)+e.gammaln(n+o);v<10;v++){if(0===c||1===c)return c;if((c-=l=(u=(e.ibeta(c,n,o)-r)/(l=t.exp(g*t.log(c)+m*t.log(1-c)+p)))/(1-.5*t.min(1,u*(g/c-m/(1-c)))))<=0&&(c=.5*(c+l)),c>=1&&(c=.5*(c+l+1)),t.abs(l)<y*c&&v>0)break}return c},e.ibeta=function(r,n,o){var i=0===r||1===r?0:t.exp(e.gammaln(n+o)-e.gammaln(n)-e.gammaln(o)+n*t.log(r)+o*t.log(1-r));return!(r<0||r>1)&&(r<(n+1)/(n+o+2)?i*e.betacf(r,n,o)/n:1-i*e.betacf(1-r,o,n)/o)},e.randn=function(r,n){var o,i,a,s,l;if(n||(n=r),r)return e.create(r,n,(function(){return e.randn()}));do{o=e._random_fn(),i=1.7156*(e._random_fn()-.5),l=(a=o-.449871)*a+(s=t.abs(i)+.386595)*(.196*s-.25472*a)}while(l>.27597&&(l>.27846||i*i>-4*t.log(o)*o*o));return i/o},e.randg=function(r,n,o){var i,a,s,l,u,c,f=r;if(o||(o=n),r||(r=1),n)return(c=e.zeros(n,o)).alter((function(){return e.randg(r)})),c;r<1&&(r+=1),i=r-1/3,a=1/t.sqrt(9*i);do{do{l=1+a*(u=e.randn())}while(l<=0);l*=l*l,s=e._random_fn()}while(s>1-.331*t.pow(u,4)&&t.log(s)>.5*u*u+i*(1-l+t.log(l)));if(r==f)return i*l;do{s=e._random_fn()}while(0===s);return t.pow(s,1/f)*i*l},function(t){for(var r=0;r<t.length;r++)!function(t){e.fn[t]=function(){return e(e.map(this,(function(r){return e[t](r)})))}}(t[r])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var r=0;r<t.length;r++)!function(t){e.fn[t]=function(){return e(e[t].apply(null,arguments))}}(t[r])}("randn".split(" "))}(n,Math),function(e,t){function r(e,r,n,o){for(var i,a=0,s=1,l=1,u=1,c=0,f=0;t.abs((l-f)/l)>o;)f=l,s=u+(i=-(r+c)*(r+n+c)*e/(r+2*c)/(r+2*c+1))*s,l=(a=l+i*a)+(i=(c+=1)*(n-c)*e/(r+2*c-1)/(r+2*c))*l,a/=u=s+i*u,s/=u,l/=u,u=1;return l/r}function n(e){return e/t.abs(e)}function o(r,n,o){var i=12,a=6,s=-30,l=-50,u=60,c=8,f=3,h=2,d=3,p=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],y=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],g=.5*r;if(g>=c)return 1;var m,v=2*e.normal.cdf(g,0,1,1,0)-1;v=v>=t.exp(l/o)?t.pow(v,o):0;for(var _=g,b=(c-g)/(m=r>f?h:d),C=_+b,w=0,E=o-1,S=1;S<=m;S++){for(var O=0,T=.5*(C+_),R=.5*(C-_),$=1;$<=i;$++){var I,A=T+R*(a<$?p[(I=i-$+1)-1]:-p[(I=$)-1]),P=A*A;if(P>u)break;var k=2*e.normal.cdf(A,0,1,1,0)*.5-2*e.normal.cdf(A,r,1,1,0)*.5;k>=t.exp(s/E)&&(O+=k=y[I-1]*t.exp(-.5*P)*t.pow(k,E))}w+=O*=2*R*o/t.sqrt(2*t.PI),_=C,C+=b}return(v+=w)<=t.exp(s/n)?0:(v=t.pow(v,n))>=1?1:v}function i(e,r,n){var o=.322232421088,i=.099348462606,a=-1,s=.588581570495,l=-.342242088547,u=.531103462366,c=-.204231210125,f=.10353775285,h=-453642210148e-16,d=.0038560700634,p=.8832,y=.2368,g=1.214,m=1.208,v=1.4142,_=120,b=.5-.5*e,C=t.sqrt(t.log(1/(b*b))),w=C+((((C*h+c)*C+l)*C+a)*C+o)/((((C*d+f)*C+u)*C+s)*C+i);n<_&&(w+=(w*w*w+w)/n/4);var E=p-y*w;return n<_&&(E+=-g/n+m*w/n),w*(E*t.log(r-1)+v)}!function(t){for(var r=0;r<t.length;r++)!function(t){e[t]=function(e,t,r){return this instanceof arguments.callee?(this._a=e,this._b=t,this._c=r,this):new arguments.callee(e,t,r)},e.fn[t]=function(r,n,o){var i=e[t](r,n,o);return i.data=this,i},e[t].prototype.sample=function(r){var n=this._a,o=this._b,i=this._c;return r?e.alter(r,(function(){return e[t].sample(n,o,i)})):e[t].sample(n,o,i)},function(r){for(var n=0;n<r.length;n++)!function(r){e[t].prototype[r]=function(n){var o=this._a,i=this._b,a=this._c;return n||0===n||(n=this.data),"number"!=typeof n?e.fn.map.call(n,(function(n){return e[t][r](n,o,i,a)})):e[t][r](n,o,i,a)}}(r[n])}("pdf cdf inv".split(" ")),function(r){for(var n=0;n<r.length;n++)!function(r){e[t].prototype[r]=function(){return e[t][r](this._a,this._b,this._c)}}(r[n])}("mean median mode variance".split(" "))}(t[r])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),e.extend(e.beta,{pdf:function(r,n,o){return r>1||r<0?0:1==n&&1==o?1:n<512&&o<512?t.pow(r,n-1)*t.pow(1-r,o-1)/e.betafn(n,o):t.exp((n-1)*t.log(r)+(o-1)*t.log(1-r)-e.betaln(n,o))},cdf:function(t,r,n){return t>1||t<0?1*(t>1):e.ibeta(t,r,n)},inv:function(t,r,n){return e.ibetainv(t,r,n)},mean:function(e,t){return e/(e+t)},median:function(t,r){return e.ibetainv(.5,t,r)},mode:function(e,t){return(e-1)/(e+t-2)},sample:function(t,r){var n=e.randg(t);return n/(n+e.randg(r))},variance:function(e,r){return e*r/(t.pow(e+r,2)*(e+r+1))}}),e.extend(e.centralF,{pdf:function(r,n,o){var i;return r<0?0:n<=2?0===r&&n<2?1/0:0===r&&2===n?1:1/e.betafn(n/2,o/2)*t.pow(n/o,n/2)*t.pow(r,n/2-1)*t.pow(1+n/o*r,-(n+o)/2):(i=n*r/(o+r*n),n*(o/(o+r*n))/2*e.binomial.pdf((n-2)/2,(n+o-2)/2,i))},cdf:function(t,r,n){return t<0?0:e.ibeta(r*t/(r*t+n),r/2,n/2)},inv:function(t,r,n){return n/(r*(1/e.ibetainv(t,r/2,n/2)-1))},mean:function(e,t){return t>2?t/(t-2):void 0},mode:function(e,t){return e>2?t*(e-2)/(e*(t+2)):void 0},sample:function(t,r){return 2*e.randg(t/2)/t/(2*e.randg(r/2)/r)},variance:function(e,t){if(!(t<=4))return 2*t*t*(e+t-2)/(e*(t-2)*(t-2)*(t-4))}}),e.extend(e.cauchy,{pdf:function(e,r,n){return n<0?0:n/(t.pow(e-r,2)+t.pow(n,2))/t.PI},cdf:function(e,r,n){return t.atan((e-r)/n)/t.PI+.5},inv:function(e,r,n){return r+n*t.tan(t.PI*(e-.5))},median:function(e){return e},mode:function(e){return e},sample:function(r,n){return e.randn()*t.sqrt(1/(2*e.randg(.5)))*n+r}}),e.extend(e.chisquare,{pdf:function(r,n){return r<0?0:0===r&&2===n?.5:t.exp((n/2-1)*t.log(r)-r/2-n/2*t.log(2)-e.gammaln(n/2))},cdf:function(t,r){return t<0?0:e.lowRegGamma(r/2,t/2)},inv:function(t,r){return 2*e.gammapinv(t,.5*r)},mean:function(e){return e},median:function(e){return e*t.pow(1-2/(9*e),3)},mode:function(e){return e-2>0?e-2:0},sample:function(t){return 2*e.randg(t/2)},variance:function(e){return 2*e}}),e.extend(e.exponential,{pdf:function(e,r){return e<0?0:r*t.exp(-r*e)},cdf:function(e,r){return e<0?0:1-t.exp(-r*e)},inv:function(e,r){return-t.log(1-e)/r},mean:function(e){return 1/e},median:function(e){return 1/e*t.log(2)},mode:function(){return 0},sample:function(r){return-1/r*t.log(e._random_fn())},variance:function(e){return t.pow(e,-2)}}),e.extend(e.gamma,{pdf:function(r,n,o){return r<0?0:0===r&&1===n?1/o:t.exp((n-1)*t.log(r)-r/o-e.gammaln(n)-n*t.log(o))},cdf:function(t,r,n){return t<0?0:e.lowRegGamma(r,t/n)},inv:function(t,r,n){return e.gammapinv(t,r)*n},mean:function(e,t){return e*t},mode:function(e,t){if(e>1)return(e-1)*t},sample:function(t,r){return e.randg(t)*r},variance:function(e,t){return e*t*t}}),e.extend(e.invgamma,{pdf:function(r,n,o){return r<=0?0:t.exp(-(n+1)*t.log(r)-o/r-e.gammaln(n)+n*t.log(o))},cdf:function(t,r,n){return t<=0?0:1-e.lowRegGamma(r,n/t)},inv:function(t,r,n){return n/e.gammapinv(1-t,r)},mean:function(e,t){return e>1?t/(e-1):void 0},mode:function(e,t){return t/(e+1)},sample:function(t,r){return r/e.randg(t)},variance:function(e,t){if(!(e<=2))return t*t/((e-1)*(e-1)*(e-2))}}),e.extend(e.kumaraswamy,{pdf:function(e,r,n){return 0===e&&1===r?n:1===e&&1===n?r:t.exp(t.log(r)+t.log(n)+(r-1)*t.log(e)+(n-1)*t.log(1-t.pow(e,r)))},cdf:function(e,r,n){return e<0?0:e>1?1:1-t.pow(1-t.pow(e,r),n)},inv:function(e,r,n){return t.pow(1-t.pow(1-e,1/n),1/r)},mean:function(t,r){return r*e.gammafn(1+1/t)*e.gammafn(r)/e.gammafn(1+1/t+r)},median:function(e,r){return t.pow(1-t.pow(2,-1/r),1/e)},mode:function(e,r){if(e>=1&&r>=1&&1!==e&&1!==r)return t.pow((e-1)/(e*r-1),1/e)},variance:function(){throw new Error("variance not yet implemented")}}),e.extend(e.lognormal,{pdf:function(e,r,n){return e<=0?0:t.exp(-t.log(e)-.5*t.log(2*t.PI)-t.log(n)-t.pow(t.log(e)-r,2)/(2*n*n))},cdf:function(r,n,o){return r<0?0:.5+.5*e.erf((t.log(r)-n)/t.sqrt(2*o*o))},inv:function(r,n,o){return t.exp(-1.4142135623730951*o*e.erfcinv(2*r)+n)},mean:function(e,r){return t.exp(e+r*r/2)},median:function(e){return t.exp(e)},mode:function(e,r){return t.exp(e-r*r)},sample:function(r,n){return t.exp(e.randn()*n+r)},variance:function(e,r){return(t.exp(r*r)-1)*t.exp(2*e+r*r)}}),e.extend(e.noncentralt,{pdf:function(r,n,o){var i=1e-14;return t.abs(o)<i?e.studentt.pdf(r,n):t.abs(r)<i?t.exp(e.gammaln((n+1)/2)-o*o/2-.5*t.log(t.PI*n)-e.gammaln(n/2)):n/r*(e.noncentralt.cdf(r*t.sqrt(1+2/n),n+2,o)-e.noncentralt.cdf(r,n,o))},cdf:function(r,n,o){var i=1e-14,a=200;if(t.abs(o)<i)return e.studentt.cdf(r,n);var s=!1;r<0&&(s=!0,o=-o);for(var l=e.normal.cdf(-o,0,1),u=i+1,c=u,f=r*r/(r*r+n),h=0,d=t.exp(-o*o/2),p=t.exp(-o*o/2-.5*t.log(2)-e.gammaln(1.5))*o;h<a||c>i||u>i;)c=u,h>0&&(d*=o*o/(2*h),p*=o*o/(2*(h+.5))),l+=.5*(u=d*e.beta.cdf(f,h+.5,n/2)+p*e.beta.cdf(f,h+1,n/2)),h++;return s?1-l:l}}),e.extend(e.normal,{pdf:function(e,r,n){return t.exp(-.5*t.log(2*t.PI)-t.log(n)-t.pow(e-r,2)/(2*n*n))},cdf:function(r,n,o){return.5*(1+e.erf((r-n)/t.sqrt(2*o*o)))},inv:function(t,r,n){return-1.4142135623730951*n*e.erfcinv(2*t)+r},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},sample:function(t,r){return e.randn()*r+t},variance:function(e,t){return t*t}}),e.extend(e.pareto,{pdf:function(e,r,n){return e<r?0:n*t.pow(r,n)/t.pow(e,n+1)},cdf:function(e,r,n){return e<r?0:1-t.pow(r/e,n)},inv:function(e,r,n){return r/t.pow(1-e,1/n)},mean:function(e,r){if(!(r<=1))return r*t.pow(e,r)/(r-1)},median:function(e,r){return e*(r*t.SQRT2)},mode:function(e){return e},variance:function(e,r){if(!(r<=2))return e*e*r/(t.pow(r-1,2)*(r-2))}}),e.extend(e.studentt,{pdf:function(r,n){return n=n>1e100?1e100:n,1/(t.sqrt(n)*e.betafn(.5,n/2))*t.pow(1+r*r/n,-(n+1)/2)},cdf:function(r,n){var o=n/2;return e.ibeta((r+t.sqrt(r*r+n))/(2*t.sqrt(r*r+n)),o,o)},inv:function(r,n){var o=e.ibetainv(2*t.min(r,1-r),.5*n,.5);return o=t.sqrt(n*(1-o)/o),r>.5?o:-o},mean:function(e){return e>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(r){return e.randn()*t.sqrt(r/(2*e.randg(r/2)))},variance:function(e){return e>2?e/(e-2):e>1?1/0:void 0}}),e.extend(e.weibull,{pdf:function(e,r,n){return e<0||r<0||n<0?0:n/r*t.pow(e/r,n-1)*t.exp(-t.pow(e/r,n))},cdf:function(e,r,n){return e<0?0:1-t.exp(-t.pow(e/r,n))},inv:function(e,r,n){return r*t.pow(-t.log(1-e),1/n)},mean:function(t,r){return t*e.gammafn(1+1/r)},median:function(e,r){return e*t.pow(t.log(2),1/r)},mode:function(e,r){return r<=1?0:e*t.pow((r-1)/r,1/r)},sample:function(r,n){return r*t.pow(-t.log(e._random_fn()),1/n)},variance:function(r,n){return r*r*e.gammafn(1+2/n)-t.pow(e.weibull.mean(r,n),2)}}),e.extend(e.uniform,{pdf:function(e,t,r){return e<t||e>r?0:1/(r-t)},cdf:function(e,t,r){return e<t?0:e<r?(e-t)/(r-t):1},inv:function(e,t,r){return t+e*(r-t)},mean:function(e,t){return.5*(e+t)},median:function(t,r){return e.mean(t,r)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(t,r){return t/2+r/2+(r/2-t/2)*(2*e._random_fn()-1)},variance:function(e,r){return t.pow(r-e,2)/12}}),e.extend(e.binomial,{pdf:function(r,n,o){return 0===o||1===o?n*o===r?1:0:e.combination(n,r)*t.pow(o,r)*t.pow(1-o,n-r)},cdf:function(n,o,i){var a,s=1e-10;if(n<0)return 0;if(n>=o)return 1;if(i<0||i>1||o<=0)return NaN;var l=i,u=(n=t.floor(n))+1,c=o-n,f=u+c,h=t.exp(e.gammaln(f)-e.gammaln(c)-e.gammaln(u)+u*t.log(l)+c*t.log(1-l));return a=l<(u+1)/(f+2)?h*r(l,u,c,s):1-h*r(1-l,c,u,s),t.round(1/s*(1-a))/(1/s)}}),e.extend(e.negbin,{pdf:function(r,n,o){return r===r>>>0&&(r<0?0:e.combination(r+n-1,n-1)*t.pow(1-o,r)*t.pow(o,n))},cdf:function(t,r,n){var o=0,i=0;if(t<0)return 0;for(;i<=t;i++)o+=e.negbin.pdf(i,r,n);return o}}),e.extend(e.hypgeom,{pdf:function(r,n,o,i){if(r!=r|0)return!1;if(r<0||r<o-(n-i))return 0;if(r>i||r>o)return 0;if(2*o>n)return 2*i>n?e.hypgeom.pdf(n-o-i+r,n,n-o,n-i):e.hypgeom.pdf(i-r,n,n-o,i);if(2*i>n)return e.hypgeom.pdf(o-r,n,o,n-i);if(o<i)return e.hypgeom.pdf(r,n,i,o);for(var a=1,s=0,l=0;l<r;l++){for(;a>1&&s<i;)a*=1-o/(n-s),s++;a*=(i-l)*(o-l)/((l+1)*(n-o-i+l+1))}for(;s<i;s++)a*=1-o/(n-s);return t.min(1,t.max(0,a))},cdf:function(r,n,o,i){if(r<0||r<o-(n-i))return 0;if(r>=i||r>=o)return 1;if(2*o>n)return 2*i>n?e.hypgeom.cdf(n-o-i+r,n,n-o,n-i):1-e.hypgeom.cdf(i-r-1,n,n-o,i);if(2*i>n)return 1-e.hypgeom.cdf(o-r-1,n,o,n-i);if(o<i)return e.hypgeom.cdf(r,n,i,o);for(var a=1,s=1,l=0,u=0;u<r;u++){for(;a>1&&l<i;){var c=1-o/(n-l);s*=c,a*=c,l++}a+=s*=(i-u)*(o-u)/((u+1)*(n-o-i+u+1))}for(;l<i;l++)a*=1-o/(n-l);return t.min(1,t.max(0,a))}}),e.extend(e.poisson,{pdf:function(r,n){return n<0||r%1!=0||r<0?0:t.pow(n,r)*t.exp(-n)/e.factorial(r)},cdf:function(t,r){var n=[],o=0;if(t<0)return 0;for(;o<=t;o++)n.push(e.poisson.pdf(o,r));return e.sum(n)},mean:function(e){return e},variance:function(e){return e},sampleSmall:function(r){var n=1,o=0,i=t.exp(-r);do{o++,n*=e._random_fn()}while(n>i);return o-1},sampleLarge:function(r){var n,o,i,a,s,l,u,c,f,h,d=r;for(a=t.sqrt(d),s=t.log(d),l=.02483*(u=.931+2.53*a)-.059,c=1.1239+1.1328/(u-3.4),f=.9277-3.6224/(u-2);;){if(o=t.random()-.5,i=t.random(),h=.5-t.abs(o),n=t.floor((2*l/h+u)*o+d+.43),h>=.07&&i<=f)return n;if(!(n<0||h<.013&&i>h)&&t.log(i)+t.log(c)-t.log(l/(h*h)+u)<=n*s-d-e.loggam(n+1))return n}},sample:function(e){return e<10?this.sampleSmall(e):this.sampleLarge(e)}}),e.extend(e.triangular,{pdf:function(e,t,r,n){return r<=t||n<t||n>r?NaN:e<t||e>r?0:e<n?2*(e-t)/((r-t)*(n-t)):e===n?2/(r-t):2*(r-e)/((r-t)*(r-n))},cdf:function(e,r,n,o){return n<=r||o<r||o>n?NaN:e<=r?0:e>=n?1:e<=o?t.pow(e-r,2)/((n-r)*(o-r)):1-t.pow(n-e,2)/((n-r)*(n-o))},inv:function(e,r,n,o){return n<=r||o<r||o>n?NaN:e<=(o-r)/(n-r)?r+(n-r)*t.sqrt(e*((o-r)/(n-r))):r+(n-r)*(1-t.sqrt((1-e)*(1-(o-r)/(n-r))))},mean:function(e,t,r){return(e+t+r)/3},median:function(e,r,n){return n<=(e+r)/2?r-t.sqrt((r-e)*(r-n))/t.sqrt(2):n>(e+r)/2?e+t.sqrt((r-e)*(n-e))/t.sqrt(2):void 0},mode:function(e,t,r){return r},sample:function(r,n,o){var i=e._random_fn();return i<(o-r)/(n-r)?r+t.sqrt(i*(n-r)*(o-r)):n-t.sqrt((1-i)*(n-r)*(n-o))},variance:function(e,t,r){return(e*e+t*t+r*r-e*t-e*r-t*r)/18}}),e.extend(e.arcsine,{pdf:function(e,r,n){return n<=r?NaN:e<=r||e>=n?0:2/t.PI*t.pow(t.pow(n-r,2)-t.pow(2*e-r-n,2),-.5)},cdf:function(e,r,n){return e<r?0:e<n?2/t.PI*t.asin(t.sqrt((e-r)/(n-r))):1},inv:function(e,r,n){return r+(.5-.5*t.cos(t.PI*e))*(n-r)},mean:function(e,t){return t<=e?NaN:(e+t)/2},median:function(e,t){return t<=e?NaN:(e+t)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(r,n){return(r+n)/2+(n-r)/2*t.sin(2*t.PI*e.uniform.sample(0,1))},variance:function(e,r){return r<=e?NaN:t.pow(r-e,2)/8}}),e.extend(e.laplace,{pdf:function(e,r,n){return n<=0?0:t.exp(-t.abs(e-r)/n)/(2*n)},cdf:function(e,r,n){return n<=0?0:e<r?.5*t.exp((e-r)/n):1-.5*t.exp(-(e-r)/n)},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},variance:function(e,t){return 2*t*t},sample:function(r,o){var i=e._random_fn()-.5;return r-o*n(i)*t.log(1-2*t.abs(i))}}),e.extend(e.tukey,{cdf:function(r,n,i){var a=1,s=n,l=16,u=8,c=-30,f=1e-14,h=100,d=800,p=5e3,y=25e3,g=1,m=.5,v=.25,_=.125,b=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],C=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(r<=0)return 0;if(i<2||a<1||s<2)return NaN;if(!Number.isFinite(r))return 1;if(i>y)return o(r,a,s);var w,E=.5*i,S=E*t.log(i)-i*t.log(2)-e.gammaln(E),O=E-1,T=.25*i;w=i<=h?g:i<=d?m:i<=p?v:_,S+=t.log(w);for(var R=0,$=1;$<=50;$++){for(var I=0,A=(2*$-1)*w,P=1;P<=l;P++){var k,N;u<P?(k=P-u-1,N=S+O*t.log(A+b[k]*w)-(b[k]*w+A)*T):(k=P-1,N=S+O*t.log(A-b[k]*w)+(b[k]*w-A)*T),N>=c&&(I+=o(u<P?r*t.sqrt(.5*(b[k]*w+A)):r*t.sqrt(.5*(-b[k]*w+A)),a,s)*C[k]*t.exp(N))}if($*w>=1&&I<=f)break;R+=I}if(I>f)throw new Error("tukey.cdf failed to converge");return R>1&&(R=1),R},inv:function(r,n,o){var a=1e-4,s=50;if(o<2||n<2)return NaN;if(r<0||r>1)return NaN;if(0===r)return 0;if(1===r)return 1/0;var l,u=i(r,n,o),c=e.tukey.cdf(u,n,o)-r;l=c>0?t.max(0,u-1):u+1;for(var f,h=e.tukey.cdf(l,n,o)-r,d=1;d<s;d++)if(f=l-h*(l-u)/(h-c),c=h,u=l,f<0&&(f=0,h=-r),h=e.tukey.cdf(f,n,o)-r,l=f,t.abs(l-u)<a)return f;throw new Error("tukey.inv failed to converge")}})}(n,Math),function(e,t){var r=Array.prototype.push,n=e.utils.isArray;function o(t){return n(t)||t instanceof e}e.extend({add:function(t,r){return o(r)?(o(r[0])||(r=[r]),e.map(t,(function(e,t,n){return e+r[t][n]}))):e.map(t,(function(e){return e+r}))},subtract:function(t,r){return o(r)?(o(r[0])||(r=[r]),e.map(t,(function(e,t,n){return e-r[t][n]||0}))):e.map(t,(function(e){return e-r}))},divide:function(t,r){return o(r)?(o(r[0])||(r=[r]),e.multiply(t,e.inv(r))):e.map(t,(function(e){return e/r}))},multiply:function(t,r){var n,i,a,s,l,u,c,f;if(void 0===t.length&&void 0===r.length)return t*r;if(l=t.length,u=t[0].length,c=e.zeros(l,a=o(r)?r[0].length:u),f=0,o(r)){for(;f<a;f++)for(n=0;n<l;n++){for(s=0,i=0;i<u;i++)s+=t[n][i]*r[i][f];c[n][f]=s}return 1===l&&1===f?c[0][0]:c}return e.map(t,(function(e){return e*r}))},outer:function(t,r){return e.multiply(t.map((function(e){return[e]})),[r])},dot:function(t,r){o(t[0])||(t=[t]),o(r[0])||(r=[r]);for(var n,i,a=1===t[0].length&&1!==t.length?e.transpose(t):t,s=1===r[0].length&&1!==r.length?e.transpose(r):r,l=[],u=0,c=a.length,f=a[0].length;u<c;u++){for(l[u]=[],n=0,i=0;i<f;i++)n+=a[u][i]*s[u][i];l[u]=n}return 1===l.length?l[0]:l},pow:function(r,n){return e.map(r,(function(e){return t.pow(e,n)}))},exp:function(r){return e.map(r,(function(e){return t.exp(e)}))},log:function(r){return e.map(r,(function(e){return t.log(e)}))},abs:function(r){return e.map(r,(function(e){return t.abs(e)}))},norm:function(e,r){var n=0,i=0;for(isNaN(r)&&(r=2),o(e[0])&&(e=e[0]);i<e.length;i++)n+=t.pow(t.abs(e[i]),r);return t.pow(n,1/r)},angle:function(r,n){return t.acos(e.dot(r,n)/(e.norm(r)*e.norm(n)))},aug:function(e,t){var n,o=[];for(n=0;n<e.length;n++)o.push(e[n].slice());for(n=0;n<o.length;n++)r.apply(o[n],t[n]);return o},inv:function(t){for(var r,n=t.length,o=t[0].length,i=e.identity(n,o),a=e.gauss_jordan(t,i),s=[],l=0;l<n;l++)for(s[l]=[],r=o;r<a[0].length;r++)s[l][r-o]=a[l][r];return s},det:function(e){var t,r=e.length,n=2*r,o=new Array(n),i=r-1,a=n-1,s=i-r+1,l=a,u=0,c=0;if(2===r)return e[0][0]*e[1][1]-e[0][1]*e[1][0];for(;u<n;u++)o[u]=1;for(u=0;u<r;u++){for(t=0;t<r;t++)o[s<0?s+r:s]*=e[u][t],o[l<r?l+r:l]*=e[u][t],s++,l--;s=--i-r+1,l=--a}for(u=0;u<r;u++)c+=o[u];for(;u<n;u++)c-=o[u];return c},gauss_elimination:function(r,n){var o,i,a,s,l=0,u=0,c=r.length,f=r[0].length,h=1,d=0,p=[];for(o=(r=e.aug(r,n))[0].length,l=0;l<c;l++){for(i=r[l][l],u=l,s=l+1;s<f;s++)i<t.abs(r[s][l])&&(i=r[s][l],u=s);if(u!=l)for(s=0;s<o;s++)a=r[l][s],r[l][s]=r[u][s],r[u][s]=a;for(u=l+1;u<c;u++)for(h=r[u][l]/r[l][l],s=l;s<o;s++)r[u][s]=r[u][s]-h*r[l][s]}for(l=c-1;l>=0;l--){for(d=0,u=l+1;u<=c-1;u++)d+=p[u]*r[l][u];p[l]=(r[l][o-1]-d)/r[l][l]}return p},gauss_jordan:function(r,n){var o,i,a,s=e.aug(r,n),l=s.length,u=s[0].length,c=0;for(i=0;i<l;i++){var f=i;for(a=i+1;a<l;a++)t.abs(s[a][i])>t.abs(s[f][i])&&(f=a);var h=s[i];for(s[i]=s[f],s[f]=h,a=i+1;a<l;a++)for(c=s[a][i]/s[i][i],o=i;o<u;o++)s[a][o]-=s[i][o]*c}for(i=l-1;i>=0;i--){for(c=s[i][i],a=0;a<i;a++)for(o=u-1;o>i-1;o--)s[a][o]-=s[i][o]*s[a][i]/c;for(s[i][i]/=c,o=l;o<u;o++)s[i][o]/=c}return s},triaUpSolve:function(t,r){var n,o=t[0].length,i=e.zeros(1,o)[0],a=!1;return null!=r[0].length&&(r=r.map((function(e){return e[0]})),a=!0),e.arange(o-1,-1,-1).forEach((function(a){n=e.arange(a+1,o).map((function(e){return i[e]*t[a][e]})),i[a]=(r[a]-e.sum(n))/t[a][a]})),a?i.map((function(e){return[e]})):i},triaLowSolve:function(t,r){var n,o=t[0].length,i=e.zeros(1,o)[0],a=!1;return null!=r[0].length&&(r=r.map((function(e){return e[0]})),a=!0),e.arange(o).forEach((function(o){n=e.arange(o).map((function(e){return t[o][e]*i[e]})),i[o]=(r[o]-e.sum(n))/t[o][o]})),a?i.map((function(e){return[e]})):i},lu:function(t){var r,n=t.length,o=e.identity(n),i=e.zeros(t.length,t[0].length);return e.arange(n).forEach((function(e){i[0][e]=t[0][e]})),e.arange(1,n).forEach((function(a){e.arange(a).forEach((function(n){r=e.arange(n).map((function(e){return o[a][e]*i[e][n]})),o[a][n]=(t[a][n]-e.sum(r))/i[n][n]})),e.arange(a,n).forEach((function(n){r=e.arange(a).map((function(e){return o[a][e]*i[e][n]})),i[a][n]=t[r.length][n]-e.sum(r)}))})),[o,i]},cholesky:function(r){var n,o=r.length,i=e.zeros(r.length,r[0].length);return e.arange(o).forEach((function(a){n=e.arange(a).map((function(e){return t.pow(i[a][e],2)})),i[a][a]=t.sqrt(r[a][a]-e.sum(n)),e.arange(a+1,o).forEach((function(t){n=e.arange(a).map((function(e){return i[a][e]*i[t][e]})),i[t][a]=(r[a][t]-e.sum(n))/i[a][a]}))})),i},gauss_jacobi:function(r,n,o,i){for(var a,s,l,u,c=0,f=0,h=r.length,d=[],p=[],y=[];c<h;c++)for(d[c]=[],p[c]=[],y[c]=[],f=0;f<h;f++)c>f?(d[c][f]=r[c][f],p[c][f]=y[c][f]=0):c<f?(p[c][f]=r[c][f],d[c][f]=y[c][f]=0):(y[c][f]=r[c][f],d[c][f]=p[c][f]=0);for(l=e.multiply(e.multiply(e.inv(y),e.add(d,p)),-1),s=e.multiply(e.inv(y),n),a=o,u=e.add(e.multiply(l,o),s),c=2;t.abs(e.norm(e.subtract(u,a)))>i;)a=u,u=e.add(e.multiply(l,a),s),c++;return u},gauss_seidel:function(r,n,o,i){for(var a,s,l,u,c,f=0,h=r.length,d=[],p=[],y=[];f<h;f++)for(d[f]=[],p[f]=[],y[f]=[],a=0;a<h;a++)f>a?(d[f][a]=r[f][a],p[f][a]=y[f][a]=0):f<a?(p[f][a]=r[f][a],d[f][a]=y[f][a]=0):(y[f][a]=r[f][a],d[f][a]=p[f][a]=0);for(u=e.multiply(e.multiply(e.inv(e.add(y,d)),p),-1),l=e.multiply(e.inv(e.add(y,d)),n),s=o,c=e.add(e.multiply(u,o),l),f=2;t.abs(e.norm(e.subtract(c,s)))>i;)s=c,c=e.add(e.multiply(u,s),l),f+=1;return c},SOR:function(r,n,o,i,a){for(var s,l,u,c,f,h=0,d=r.length,p=[],y=[],g=[];h<d;h++)for(p[h]=[],y[h]=[],g[h]=[],s=0;s<d;s++)h>s?(p[h][s]=r[h][s],y[h][s]=g[h][s]=0):h<s?(y[h][s]=r[h][s],p[h][s]=g[h][s]=0):(g[h][s]=r[h][s],p[h][s]=y[h][s]=0);for(c=e.multiply(e.inv(e.add(g,e.multiply(p,a))),e.subtract(e.multiply(g,1-a),e.multiply(y,a))),u=e.multiply(e.multiply(e.inv(e.add(g,e.multiply(p,a))),n),a),l=o,f=e.add(e.multiply(c,o),u),h=2;t.abs(e.norm(e.subtract(f,l)))>i;)l=f,f=e.add(e.multiply(c,l),u),h++;return f},householder:function(r){for(var n,o,i,a,s=r.length,l=r[0].length,u=0,c=[],f=[];u<s-1;u++){for(n=0,a=u+1;a<l;a++)n+=r[a][u]*r[a][u];for(n=(r[u+1][u]>0?-1:1)*t.sqrt(n),o=t.sqrt((n*n-r[u+1][u]*n)/2),(c=e.zeros(s,1))[u+1][0]=(r[u+1][u]-n)/(2*o),i=u+2;i<s;i++)c[i][0]=r[i][u]/(2*o);f=e.subtract(e.identity(s,l),e.multiply(e.multiply(c,e.transpose(c)),2)),r=e.multiply(f,e.multiply(r,f))}return r},QR:function(){var r=e.sum,n=e.arange;function o(o){var i,a,s,l=o.length,u=o[0].length,c=e.zeros(u,u);for(o=e.copy(o),a=0;a<u;a++){for(c[a][a]=t.sqrt(r(n(l).map((function(e){return o[e][a]*o[e][a]})))),i=0;i<l;i++)o[i][a]=o[i][a]/c[a][a];for(s=a+1;s<u;s++)for(c[a][s]=r(n(l).map((function(e){return o[e][a]*o[e][s]}))),i=0;i<l;i++)o[i][s]=o[i][s]-o[i][a]*c[a][s]}return[o,c]}return o}(),lstsq:function(){function t(t){var r=(t=e.copy(t)).length,n=e.identity(r);return e.arange(r-1,-1,-1).forEach((function(r){e.sliceAssign(n,{row:r},e.divide(e.slice(n,{row:r}),t[r][r])),e.sliceAssign(t,{row:r},e.divide(e.slice(t,{row:r}),t[r][r])),e.arange(r).forEach((function(o){var i=e.multiply(t[o][r],-1),a=e.slice(t,{row:o}),s=e.multiply(e.slice(t,{row:r}),i);e.sliceAssign(t,{row:o},e.add(a,s));var l=e.slice(n,{row:o}),u=e.multiply(e.slice(n,{row:r}),i);e.sliceAssign(n,{row:o},e.add(l,u))}))})),n}function r(r,n){var o=!1;void 0===n[0].length&&(n=n.map((function(e){return[e]})),o=!0);var i=e.QR(r),a=i[0],s=i[1],l=r[0].length,u=e.slice(a,{col:{end:l}}),c=t(e.slice(s,{row:{end:l}})),f=e.transpose(u);void 0===f[0].length&&(f=[f]);var h=e.multiply(e.multiply(c,f),n);return void 0===h.length&&(h=[[h]]),o?h.map((function(e){return e[0]})):h}return r}(),jacobi:function(r){for(var n,o,i,a,s,l,u,c=1,f=r.length,h=e.identity(f,f),d=[];1===c;){for(s=r[0][1],i=0,a=1,n=0;n<f;n++)for(o=0;o<f;o++)n!=o&&s<t.abs(r[n][o])&&(s=t.abs(r[n][o]),i=n,a=o);for(l=r[i][i]===r[a][a]?r[i][a]>0?t.PI/4:-t.PI/4:t.atan(2*r[i][a]/(r[i][i]-r[a][a]))/2,(u=e.identity(f,f))[i][i]=t.cos(l),u[i][a]=-t.sin(l),u[a][i]=t.sin(l),u[a][a]=t.cos(l),h=e.multiply(h,u),r=e.multiply(e.multiply(e.inv(u),r),u),c=0,n=1;n<f;n++)for(o=1;o<f;o++)n!=o&&t.abs(r[n][o])>.001&&(c=1)}for(n=0;n<f;n++)d.push(r[n][n]);return[h,d]},rungekutta:function(e,t,r,n,o,i){var a,s,l;if(2===i)for(;n<=r;)o+=((a=t*e(n,o))+(s=t*e(n+t,o+a)))/2,n+=t;if(4===i)for(;n<=r;)o+=((a=t*e(n,o))+2*(s=t*e(n+t/2,o+a/2))+2*(l=t*e(n+t/2,o+s/2))+t*e(n+t,o+l))/6,n+=t;return o},romberg:function(e,r,n,o){for(var i,a,s,l,u,c=0,f=(n-r)/2,h=[],d=[],p=[];c<o/2;){for(u=e(r),s=r,l=0;s<=n;s+=f,l++)h[l]=s;for(i=h.length,s=1;s<i-1;s++)u+=(s%2!=0?4:2)*e(h[s]);u=f/3*(u+e(n)),p[c]=u,f/=2,c++}for(a=p.length,i=1;1!==a;){for(s=0;s<a-1;s++)d[s]=(t.pow(4,i)*p[s+1]-p[s])/(t.pow(4,i)-1);a=d.length,p=d,d=[],i++}return p},richardson:function(e,r,n,o){function i(e,t){for(var r,n=0,o=e.length;n<o;n++)e[n]===t&&(r=n);return r}for(var a,s,l,u,c,f=t.abs(n-e[i(e,n)+1]),h=0,d=[],p=[];o>=f;)a=i(e,n+o),s=i(e,n),d[h]=(r[a]-2*r[s]+r[2*s-a])/(o*o),o/=2,h++;for(u=d.length,l=1;1!=u;){for(c=0;c<u-1;c++)p[c]=(t.pow(4,l)*d[c+1]-d[c])/(t.pow(4,l)-1);u=p.length,d=p,p=[],l++}return d},simpson:function(e,t,r,n){for(var o,i=(r-t)/n,a=e(t),s=[],l=t,u=0,c=1;l<=r;l+=i,u++)s[u]=l;for(o=s.length;c<o-1;c++)a+=(c%2!=0?4:2)*e(s[c]);return i/3*(a+e(r))},hermite:function(e,t,r,n){for(var o,i=e.length,a=0,s=0,l=[],u=[],c=[],f=[];s<i;s++){for(l[s]=1,o=0;o<i;o++)s!=o&&(l[s]*=(n-e[o])/(e[s]-e[o]));for(u[s]=0,o=0;o<i;o++)s!=o&&(u[s]+=1/(e[s]-e[o]));c[s]=(1-2*(n-e[s])*u[s])*(l[s]*l[s]),f[s]=(n-e[s])*(l[s]*l[s]),a+=c[s]*t[s]+f[s]*r[s]}return a},lagrange:function(e,t,r){for(var n,o,i=0,a=0,s=e.length;a<s;a++){for(o=t[a],n=0;n<s;n++)a!=n&&(o*=(r-e[n])/(e[a]-e[n]));i+=o}return i},cubic_spline:function(t,r,n){for(var o,i=t.length,a=0,s=[],l=[],u=[],c=[],f=[],h=[],d=[];a<i-1;a++)f[a]=t[a+1]-t[a];for(u[0]=0,a=1;a<i-1;a++)u[a]=3/f[a]*(r[a+1]-r[a])-3/f[a-1]*(r[a]-r[a-1]);for(a=1;a<i-1;a++)s[a]=[],l[a]=[],s[a][a-1]=f[a-1],s[a][a]=2*(f[a-1]+f[a]),s[a][a+1]=f[a],l[a][0]=u[a];for(c=e.multiply(e.inv(s),l),o=0;o<i-1;o++)h[o]=(r[o+1]-r[o])/f[o]-f[o]*(c[o+1][0]+2*c[o][0])/3,d[o]=(c[o+1][0]-c[o][0])/(3*f[o]);for(o=0;o<i&&!(t[o]>n);o++);return r[o-=1]+(n-t[o])*h[o]+e.sq(n-t[o])*c[o]+(n-t[o])*e.sq(n-t[o])*d[o]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(t){var r,n,o=t.length,i=t[0].length,a=0,s=[],l=[],u=[],c=[],f=[],h=[],d=[],p=[],y=[],g=[];for(a=0;a<o;a++)s[a]=e.sum(t[a])/i;for(a=0;a<i;a++)for(d[a]=[],r=0;r<o;r++)d[a][r]=t[r][a]-s[r];for(d=e.transpose(d),a=0;a<o;a++)for(p[a]=[],r=0;r<o;r++)p[a][r]=e.dot([d[a]],[d[r]])/(i-1);for(y=(u=e.jacobi(p))[0],l=u[1],g=e.transpose(y),a=0;a<l.length;a++)for(r=a;r<l.length;r++)l[a]<l[r]&&(n=l[a],l[a]=l[r],l[r]=n,c=g[a],g[a]=g[r],g[r]=c);for(h=e.transpose(d),a=0;a<o;a++)for(f[a]=[],r=0;r<h.length;r++)f[a][r]=e.dot([g[a]],[h[r]]);return[t,l,g,f]}}),function(t){for(var r=0;r<t.length;r++)!function(t){e.fn[t]=function(r,n){var o=this;return n?(setTimeout((function(){n.call(o,e.fn[t].call(o,r))}),15),this):"number"==typeof e[t](this,r)?e[t](this,r):e(e[t](this,r))}}(t[r])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(n,Math),function(e,t){var r=[].slice,n=e.utils.isNumber,o=e.utils.isArray;function i(e,r,n,o){if(e>1||n>1||e<=0||n<=0)throw new Error("Proportions should be greater than 0 and less than 1");var i=(e*r+n*o)/(r+o);return(e-n)/t.sqrt(i*(1-i)*(1/r+1/o))}e.extend({zscore:function(){var t=r.call(arguments);return n(t[1])?(t[0]-t[1])/t[2]:(t[0]-e.mean(t[1]))/e.stdev(t[1],t[2])},ztest:function(){var n,i=r.call(arguments);return o(i[1])?(n=e.zscore(i[0],i[1],i[3]),1===i[2]?e.normal.cdf(-t.abs(n),0,1):2*e.normal.cdf(-t.abs(n),0,1)):i.length>2?(n=e.zscore(i[0],i[1],i[2]),1===i[3]?e.normal.cdf(-t.abs(n),0,1):2*e.normal.cdf(-t.abs(n),0,1)):(n=i[0],1===i[1]?e.normal.cdf(-t.abs(n),0,1):2*e.normal.cdf(-t.abs(n),0,1))}}),e.extend(e.fn,{zscore:function(e,t){return(e-this.mean())/this.stdev(t)},ztest:function(r,n,o){var i=t.abs(this.zscore(r,o));return 1===n?e.normal.cdf(-i,0,1):2*e.normal.cdf(-i,0,1)}}),e.extend({tscore:function(){var n=r.call(arguments);return 4===n.length?(n[0]-n[1])/(n[2]/t.sqrt(n[3])):(n[0]-e.mean(n[1]))/(e.stdev(n[1],!0)/t.sqrt(n[1].length))},ttest:function(){var o,i=r.call(arguments);return 5===i.length?(o=t.abs(e.tscore(i[0],i[1],i[2],i[3])),1===i[4]?e.studentt.cdf(-o,i[3]-1):2*e.studentt.cdf(-o,i[3]-1)):n(i[1])?(o=t.abs(i[0]),1==i[2]?e.studentt.cdf(-o,i[1]-1):2*e.studentt.cdf(-o,i[1]-1)):(o=t.abs(e.tscore(i[0],i[1])),1==i[2]?e.studentt.cdf(-o,i[1].length-1):2*e.studentt.cdf(-o,i[1].length-1))}}),e.extend(e.fn,{tscore:function(e){return(e-this.mean())/(this.stdev(!0)/t.sqrt(this.cols()))},ttest:function(r,n){return 1===n?1-e.studentt.cdf(t.abs(this.tscore(r)),this.cols()-1):2*e.studentt.cdf(-t.abs(this.tscore(r)),this.cols()-1)}}),e.extend({anovafscore:function(){var n,o,i,a,s,l,u,c,f=r.call(arguments);if(1===f.length){for(s=new Array(f[0].length),u=0;u<f[0].length;u++)s[u]=f[0][u];f=s}for(o=new Array,u=0;u<f.length;u++)o=o.concat(f[u]);for(i=e.mean(o),n=0,u=0;u<f.length;u++)n+=f[u].length*t.pow(e.mean(f[u])-i,2);for(n/=f.length-1,l=0,u=0;u<f.length;u++)for(a=e.mean(f[u]),c=0;c<f[u].length;c++)l+=t.pow(f[u][c]-a,2);return n/(l/=o.length-f.length)},anovaftest:function(){var t,o,i,a,s=r.call(arguments);if(n(s[0]))return 1-e.centralF.cdf(s[0],s[1],s[2]);var l=e.anovafscore(s);for(t=s.length-1,i=0,a=0;a<s.length;a++)i+=s[a].length;return o=i-t-1,1-e.centralF.cdf(l,t,o)},ftest:function(t,r,n){return 1-e.centralF.cdf(t,r,n)}}),e.extend(e.fn,{anovafscore:function(){return e.anovafscore(this.toArray())},anovaftes:function(){var t,r=0;for(t=0;t<this.length;t++)r+=this[t].length;return e.ftest(this.anovafscore(),this.length-1,r-this.length)}}),e.extend({qscore:function(){var o,i,a,s,l,u=r.call(arguments);return n(u[0])?(o=u[0],i=u[1],a=u[2],s=u[3],l=u[4]):(o=e.mean(u[0]),i=e.mean(u[1]),a=u[0].length,s=u[1].length,l=u[2]),t.abs(o-i)/(l*t.sqrt((1/a+1/s)/2))},qtest:function(){var t,n=r.call(arguments);3===n.length?(t=n[0],n=n.slice(1)):7===n.length?(t=e.qscore(n[0],n[1],n[2],n[3],n[4]),n=n.slice(5)):(t=e.qscore(n[0],n[1],n[2]),n=n.slice(3));var o=n[0],i=n[1];return 1-e.tukey.cdf(t,i,o-i)},tukeyhsd:function(t){for(var r=e.pooledstdev(t),n=t.map((function(t){return e.mean(t)})),o=t.reduce((function(e,t){return e+t.length}),0),i=[],a=0;a<t.length;++a)for(var s=a+1;s<t.length;++s){var l=e.qtest(n[a],n[s],t[a].length,t[s].length,r,o,t.length);i.push([[a,s],l])}return i}}),e.extend({normalci:function(){var n,o=r.call(arguments),i=new Array(2);return n=4===o.length?t.abs(e.normal.inv(o[1]/2,0,1)*o[2]/t.sqrt(o[3])):t.abs(e.normal.inv(o[1]/2,0,1)*e.stdev(o[2])/t.sqrt(o[2].length)),i[0]=o[0]-n,i[1]=o[0]+n,i},tci:function(){var n,o=r.call(arguments),i=new Array(2);return n=4===o.length?t.abs(e.studentt.inv(o[1]/2,o[3]-1)*o[2]/t.sqrt(o[3])):t.abs(e.studentt.inv(o[1]/2,o[2].length-1)*e.stdev(o[2],!0)/t.sqrt(o[2].length)),i[0]=o[0]-n,i[1]=o[0]+n,i},significant:function(e,t){return e<t}}),e.extend(e.fn,{normalci:function(t,r){return e.normalci(t,r,this.toArray())},tci:function(t,r){return e.tci(t,r,this.toArray())}}),e.extend(e.fn,{oneSidedDifferenceOfProportions:function(t,r,n,o){var a=i(t,r,n,o);return e.ztest(a,1)},twoSidedDifferenceOfProportions:function(t,r,n,o){var a=i(t,r,n,o);return e.ztest(a,2)}})}(n,Math),n.models=function(){function e(e){var r=e[0].length;return n.arange(r).map((function(o){var i=n.arange(r).filter((function(e){return e!==o}));return t(n.col(e,o).map((function(e){return e[0]})),n.col(e,i))}))}function t(e,t){var r=e.length,o=t[0].length-1,i=r-o-1,a=n.lstsq(t,e),s=n.multiply(t,a.map((function(e){return[e]}))).map((function(e){return e[0]})),l=n.subtract(e,s),u=n.mean(e),c=n.sum(s.map((function(e){return Math.pow(e-u,2)}))),f=n.sum(e.map((function(e,t){return Math.pow(e-s[t],2)}))),h=c+f;return{exog:t,endog:e,nobs:r,df_model:o,df_resid:i,coef:a,predict:s,resid:l,ybar:u,SST:h,SSE:c,SSR:f,R2:c/h}}function r(t){var r=e(t.exog),o=Math.sqrt(t.SSR/t.df_resid),i=r.map((function(e){var t=e.SST,r=e.R2;return o/Math.sqrt(t*(1-r))})),a=t.coef.map((function(e,t){return(e-0)/i[t]})),s=a.map((function(e){var r=n.studentt.cdf(e,t.df_resid);return 2*(r>.5?1-r:r)})),l=n.studentt.inv(.975,t.df_resid),u=t.coef.map((function(e,t){var r=l*i[t];return[e-r,e+r]}));return{se:i,t:a,p:s,sigmaHat:o,interval95:u}}function o(e){var t=e.R2/e.df_model/((1-e.R2)/e.df_resid);return{F_statistic:t,pvalue:1-function(e,t,r){return n.beta.cdf(e/(r/t+e),t/2,r/2)}(t,e.df_model,e.df_resid)}}function i(e,n){var i=t(e,n),a=r(i),s=o(i),l=1-(1-i.R2)*((i.nobs-1)/i.df_resid);return i.t=a,i.f=s,i.adjust_R2=l,i}return{ols:i}}(),n.extend({buildxmatrix:function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;t++){var r=[1];e[t]=r.concat(arguments[t])}return n(e)},builddxmatrix:function(){for(var e=new Array(arguments[0].length),t=0;t<arguments[0].length;t++){var r=[1];e[t]=r.concat(arguments[0][t])}return n(e)},buildjxmatrix:function(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e[r];return n.builddxmatrix(t)},buildymatrix:function(e){return n(e).transpose()},buildjymatrix:function(e){return e.transpose()},matrixmult:function(e,t){var r,o,i,a,s;if(e.cols()==t.rows()){if(t.rows()>1){for(a=[],r=0;r<e.rows();r++)for(a[r]=[],o=0;o<t.cols();o++){for(s=0,i=0;i<e.cols();i++)s+=e.toArray()[r][i]*t.toArray()[i][o];a[r][o]=s}return n(a)}for(a=[],r=0;r<e.rows();r++)for(a[r]=[],o=0;o<t.cols();o++){for(s=0,i=0;i<e.cols();i++)s+=e.toArray()[r][i]*t.toArray()[o];a[r][o]=s}return n(a)}},regress:function(e,t){var r=n.xtranspxinv(e),o=e.transpose(),i=n.matrixmult(n(r),o);return n.matrixmult(i,t)},regresst:function(e,t,r){var o=n.regress(e,t),i={anova:{}},a=n.jMatYBar(e,o);i.yBar=a;var s=t.mean();i.anova.residuals=n.residuals(t,a),i.anova.ssr=n.ssr(a,s),i.anova.msr=i.anova.ssr/(e[0].length-1),i.anova.sse=n.sse(t,a),i.anova.mse=i.anova.sse/(t.length-(e[0].length-1)-1),i.anova.sst=n.sst(t,s),i.anova.mst=i.anova.sst/(t.length-1),i.anova.r2=1-i.anova.sse/i.anova.sst,i.anova.r2<0&&(i.anova.r2=0),i.anova.fratio=i.anova.msr/i.anova.mse,i.anova.pvalue=n.anovaftest(i.anova.fratio,e[0].length-1,t.length-(e[0].length-1)-1),i.anova.rmse=Math.sqrt(i.anova.mse),i.anova.r2adj=1-i.anova.mse/i.anova.mst,i.anova.r2adj<0&&(i.anova.r2adj=0),i.stats=new Array(e[0].length);for(var l,u,c,f=n.xtranspxinv(e),h=0;h<o.length;h++)l=Math.sqrt(i.anova.mse*Math.abs(f[h][h])),u=Math.abs(o[h]/l),c=n.ttest(u,t.length-e[0].length-1,r),i.stats[h]=[o[h],l,u,c];return i.regress=o,i},xtranspx:function(e){return n.matrixmult(e.transpose(),e)},xtranspxinv:function(e){var t=n.matrixmult(e.transpose(),e);return n.inv(t)},jMatYBar:function(e,t){var r=n.matrixmult(e,t);return new n(r)},residuals:function(e,t){return n.matrixsubtract(e,t)},ssr:function(e,t){for(var r=0,n=0;n<e.length;n++)r+=Math.pow(e[n]-t,2);return r},sse:function(e,t){for(var r=0,n=0;n<e.length;n++)r+=Math.pow(e[n]-t[n],2);return r},sst:function(e,t){for(var r=0,n=0;n<e.length;n++)r+=Math.pow(e[n]-t,2);return r},matrixsubtract:function(e,t){for(var r=new Array(e.length),o=0;o<e.length;o++){r[o]=new Array(e[o].length);for(var i=0;i<e[o].length;i++)r[o][i]=e[o][i]-t[o][i]}return n(r)}}),n.jStat=n,n)},function(e,t,r){var n=r(1),o=r(0);t.UNIQUE=function(){for(var e=[],t=0;t<arguments.length;++t){for(var r=!1,n=arguments[t],o=0;o<e.length&&!(r=e[o]===n);++o);r||e.push(n)}return e},t.FLATTEN=n.flatten,t.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},t.REFERENCE=function(e,t){if(!arguments.length)return o.error;try{for(var r=t.split("."),n=e,i=0;i<r.length;++i){var a=r[i];if("]"===a[a.length-1]){var s=a.indexOf("["),l=a.substring(s+1,a.length-1);n=n[a.substring(0,s)][l]}else n=n[a]}return n}catch(e){}},t.JOIN=function(e,t){return e.join(t)},t.NUMBERS=function(){var e=n.flatten(arguments);return e.filter((function(e){return"number"==typeof e}))}},function(e,t,r){var n=r(0),o=r(10),i=r(6),a=r(1),s=r(26);function l(e){return/^[01]{1,10}$/.test(e)}t.BESSELI=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?n.value:s.besseli(e,t)},t.BESSELJ=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?n.value:s.besselj(e,t)},t.BESSELK=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?n.value:s.besselk(e,t)},t.BESSELY=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?n.value:s.bessely(e,t)},t.BIN2DEC=function(e){if(!l(e))return n.num;var t=parseInt(e,2),r=e.toString();return 10===r.length&&"1"===r.substring(0,1)?parseInt(r.substring(1),2)-512:t},t.BIN2HEX=function(e,t){if(!l(e))return n.num;var r=e.toString();if(10===r.length&&"1"===r.substring(0,1))return(0xfffffffe00+parseInt(r.substring(1),2)).toString(16);var o=parseInt(e,2).toString(16);return void 0===t?o:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=o.length?i.REPT("0",t-o.length)+o:n.num},t.BIN2OCT=function(e,t){if(!l(e))return n.num;var r=e.toString();if(10===r.length&&"1"===r.substring(0,1))return(1073741312+parseInt(r.substring(1),2)).toString(8);var o=parseInt(e,2).toString(8);return void 0===t?o:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=o.length?i.REPT("0",t-o.length)+o:n.num},t.BITAND=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?n.value:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?n.num:e&t},t.BITLSHIFT=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?n.value:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?n.num:t>=0?e<<t:e>>-t},t.BITOR=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?n.value:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?n.num:e|t},t.BITRSHIFT=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?n.value:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?n.num:t>=0?e>>t:e<<-t},t.BITXOR=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?n.value:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?n.num:e^t},t.COMPLEX=function(e,t,r){if(e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t))return e;if("i"!==(r=void 0===r?"i":r)&&"j"!==r)return n.value;if(0===e&&0===t)return 0;if(0===e)return 1===t?r:t.toString()+r;if(0===t)return e.toString();var o=t>0?"+":"";return e.toString()+o+(1===t?r:t.toString()+r)},t.CONVERT=function(e,t,r){if((e=a.parseNumber(e))instanceof Error)return e;for(var o,i=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],s={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},l={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},u=null,c=null,f=t,h=r,d=1,p=1,y=0;y<i.length;y++)o=null===i[y][2]?[]:i[y][2],(i[y][1]===f||o.indexOf(f)>=0)&&(u=i[y]),(i[y][1]===h||o.indexOf(h)>=0)&&(c=i[y]);if(null===u){var g=s[t.substring(0,2)],m=l[t.substring(0,1)];"da"===t.substring(0,2)&&(m=["dekao",10,"da"]),g?(d=g[2],f=t.substring(2)):m&&(d=m[1],f=t.substring(m[2].length));for(var v=0;v<i.length;v++)o=null===i[v][2]?[]:i[v][2],(i[v][1]===f||o.indexOf(f)>=0)&&(u=i[v])}if(null===c){var _=s[r.substring(0,2)],b=l[r.substring(0,1)];"da"===r.substring(0,2)&&(b=["dekao",10,"da"]),_?(p=_[2],h=r.substring(2)):b&&(p=b[1],h=r.substring(b[2].length));for(var C=0;C<i.length;C++)o=null===i[C][2]?[]:i[C][2],(i[C][1]===h||o.indexOf(h)>=0)&&(c=i[C])}return null===u||null===c||u[3]!==c[3]?n.na:e*u[6]*d/(c[6]*p)},t.DEC2BIN=function(e,t){if((e=a.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return n.num;if(e<0)return"1"+i.REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2);var r=parseInt(e,10).toString(2);return void 0===t?r:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=r.length?i.REPT("0",t-r.length)+r:n.num},t.DEC2HEX=function(e,t){if((e=a.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return n.num;if(e<0)return(1099511627776+e).toString(16);var r=parseInt(e,10).toString(16);return void 0===t?r:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=r.length?i.REPT("0",t-r.length)+r:n.num},t.DEC2OCT=function(e,t){if((e=a.parseNumber(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return n.num;if(e<0)return(1073741824+e).toString(8);var r=parseInt(e,10).toString(8);return void 0===t?r:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=r.length?i.REPT("0",t-r.length)+r:n.num},t.DELTA=function(e,t){return t=void 0===t?0:t,e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?n.value:e===t?1:0},t.ERF=function(e,t){return t=void 0===t?0:t,e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?n.value:o.erf(e)},t.ERF.PRECISE=function(){throw new Error("ERF.PRECISE is not implemented")},t.ERFC=function(e){return isNaN(e)?n.value:o.erfc(e)},t.ERFC.PRECISE=function(){throw new Error("ERFC.PRECISE is not implemented")},t.GESTEP=function(e,t){return t=t||0,e=a.parseNumber(e),a.anyIsError(t,e)?e:e>=t?1:0},t.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return n.num;var r=10===e.length&&"f"===e.substring(0,1).toLowerCase(),o=r?parseInt(e,16)-1099511627776:parseInt(e,16);if(o<-512||o>511)return n.num;if(r)return"1"+i.REPT("0",9-(512+o).toString(2).length)+(512+o).toString(2);var a=o.toString(2);return void 0===t?a:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=a.length?i.REPT("0",t-a.length)+a:n.num},t.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return n.num;var t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},t.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return n.num;var r=parseInt(e,16);if(r>536870911&&r<0xffe0000000)return n.num;if(r>=0xffe0000000)return(r-0xffc0000000).toString(8);var o=r.toString(8);return void 0===t?o:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=o.length?i.REPT("0",t-o.length)+o:n.num},t.IMABS=function(e){var r=t.IMREAL(e),o=t.IMAGINARY(e);return a.anyIsError(r,o)?n.value:Math.sqrt(Math.pow(r,2)+Math.pow(o,2))},t.IMAGINARY=function(e){if(void 0===e||!0===e||!1===e)return n.value;if(0===e||"0"===e)return 0;if(["i","j"].indexOf(e)>=0)return 1;var t=(e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),r=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===r&&(r=e.indexOf("-",1));var o=e.substring(e.length-1,e.length),i="i"===o||"j"===o;return t>=0||r>=0?i?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?n.num:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,r))||isNaN(e.substring(r+1,e.length-1))?n.num:-Number(e.substring(r+1,e.length-1)):n.num:i?isNaN(e.substring(0,e.length-1))?n.num:e.substring(0,e.length-1):isNaN(e)?n.num:0},t.IMARGUMENT=function(e){var r=t.IMREAL(e),o=t.IMAGINARY(e);return a.anyIsError(r,o)?n.value:0===r&&0===o?n.div0:0===r&&o>0?Math.PI/2:0===r&&o<0?-Math.PI/2:0===o&&r>0?0:0===o&&r<0?-Math.PI:r>0?Math.atan(o/r):r<0&&o>=0?Math.atan(o/r)+Math.PI:Math.atan(o/r)-Math.PI},t.IMCONJUGATE=function(e){var r=t.IMREAL(e),o=t.IMAGINARY(e);if(a.anyIsError(r,o))return n.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",0!==o?t.COMPLEX(r,-o,i):e},t.IMCOS=function(e){var r=t.IMREAL(e),o=t.IMAGINARY(e);if(a.anyIsError(r,o))return n.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.cos(r)*(Math.exp(o)+Math.exp(-o))/2,-Math.sin(r)*(Math.exp(o)-Math.exp(-o))/2,i)},t.IMCOSH=function(e){var r=t.IMREAL(e),o=t.IMAGINARY(e);if(a.anyIsError(r,o))return n.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.cos(o)*(Math.exp(r)+Math.exp(-r))/2,Math.sin(o)*(Math.exp(r)-Math.exp(-r))/2,i)},t.IMCOT=function(e){var r=t.IMREAL(e),o=t.IMAGINARY(e);return a.anyIsError(r,o)?n.value:t.IMDIV(t.IMCOS(e),t.IMSIN(e))},t.IMDIV=function(e,r){var o=t.IMREAL(e),i=t.IMAGINARY(e),s=t.IMREAL(r),l=t.IMAGINARY(r);if(a.anyIsError(o,i,s,l))return n.value;var u=e.substring(e.length-1),c=r.substring(r.length-1),f="i";if(("j"===u||"j"===c)&&(f="j"),0===s&&0===l)return n.num;var h=s*s+l*l;return t.COMPLEX((o*s+i*l)/h,(i*s-o*l)/h,f)},t.IMEXP=function(e){var r=t.IMREAL(e),o=t.IMAGINARY(e);if(a.anyIsError(r,o))return n.value;var i=e.substring(e.length-1);i="i"===i||"j"===i?i:"i";var s=Math.exp(r);return t.COMPLEX(s*Math.cos(o),s*Math.sin(o),i)},t.IMLN=function(e){var r=t.IMREAL(e),o=t.IMAGINARY(e);if(a.anyIsError(r,o))return n.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.log(Math.sqrt(r*r+o*o)),Math.atan(o/r),i)},t.IMLOG10=function(e){var r=t.IMREAL(e),o=t.IMAGINARY(e);if(a.anyIsError(r,o))return n.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.log(Math.sqrt(r*r+o*o))/Math.log(10),Math.atan(o/r)/Math.log(10),i)},t.IMLOG2=function(e){var r=t.IMREAL(e),o=t.IMAGINARY(e);if(a.anyIsError(r,o))return n.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.log(Math.sqrt(r*r+o*o))/Math.log(2),Math.atan(o/r)/Math.log(2),i)},t.IMPOWER=function(e,r){r=a.parseNumber(r);var o=t.IMREAL(e),i=t.IMAGINARY(e);if(a.anyIsError(r,o,i))return n.value;var s=e.substring(e.length-1);s="i"===s||"j"===s?s:"i";var l=Math.pow(t.IMABS(e),r),u=t.IMARGUMENT(e);return t.COMPLEX(l*Math.cos(r*u),l*Math.sin(r*u),s)},t.IMPRODUCT=function(){var e=arguments[0];if(!arguments.length)return n.value;for(var r=1;r<arguments.length;r++){var o=t.IMREAL(e),i=t.IMAGINARY(e),s=t.IMREAL(arguments[r]),l=t.IMAGINARY(arguments[r]);if(a.anyIsError(o,i,s,l))return n.value;e=t.COMPLEX(o*s-i*l,o*l+i*s)}return e},t.IMREAL=function(e){if(void 0===e||!0===e||!1===e)return n.value;if(0===e||"0"===e)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;var t=e.indexOf("+"),r=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===r&&(r=e.indexOf("-",1));var o=e.substring(e.length-1,e.length),i="i"===o||"j"===o;return t>=0||r>=0?i?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?n.num:Number(e.substring(0,t)):isNaN(e.substring(0,r))||isNaN(e.substring(r+1,e.length-1))?n.num:Number(e.substring(0,r)):n.num:i?isNaN(e.substring(0,e.length-1))?n.num:0:isNaN(e)?n.num:e},t.IMSEC=function(e){if(!0===e||!1===e)return n.value;var r=t.IMREAL(e),o=t.IMAGINARY(e);return a.anyIsError(r,o)?n.value:t.IMDIV("1",t.IMCOS(e))},t.IMSECH=function(e){var r=t.IMREAL(e),o=t.IMAGINARY(e);return a.anyIsError(r,o)?n.value:t.IMDIV("1",t.IMCOSH(e))},t.IMSIN=function(e){var r=t.IMREAL(e),o=t.IMAGINARY(e);if(a.anyIsError(r,o))return n.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.sin(r)*(Math.exp(o)+Math.exp(-o))/2,Math.cos(r)*(Math.exp(o)-Math.exp(-o))/2,i)},t.IMSINH=function(e){var r=t.IMREAL(e),o=t.IMAGINARY(e);if(a.anyIsError(r,o))return n.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.cos(o)*(Math.exp(r)-Math.exp(-r))/2,Math.sin(o)*(Math.exp(r)+Math.exp(-r))/2,i)},t.IMSQRT=function(e){var r=t.IMREAL(e),o=t.IMAGINARY(e);if(a.anyIsError(r,o))return n.value;var i=e.substring(e.length-1);i="i"===i||"j"===i?i:"i";var s=Math.sqrt(t.IMABS(e)),l=t.IMARGUMENT(e);return t.COMPLEX(s*Math.cos(l/2),s*Math.sin(l/2),i)},t.IMCSC=function(e){if(!0===e||!1===e)return n.value;var r=t.IMREAL(e),o=t.IMAGINARY(e);return a.anyIsError(r,o)?n.num:t.IMDIV("1",t.IMSIN(e))},t.IMCSCH=function(e){if(!0===e||!1===e)return n.value;var r=t.IMREAL(e),o=t.IMAGINARY(e);return a.anyIsError(r,o)?n.num:t.IMDIV("1",t.IMSINH(e))},t.IMSUB=function(e,t){var r=this.IMREAL(e),o=this.IMAGINARY(e),i=this.IMREAL(t),s=this.IMAGINARY(t);if(a.anyIsError(r,o,i,s))return n.value;var l=e.substring(e.length-1),u=t.substring(t.length-1),c="i";return("j"===l||"j"===u)&&(c="j"),this.COMPLEX(r-i,o-s,c)},t.IMSUM=function(){if(!arguments.length)return n.value;for(var e=a.flatten(arguments),t=e[0],r=1;r<e.length;r++){var o=this.IMREAL(t),i=this.IMAGINARY(t),s=this.IMREAL(e[r]),l=this.IMAGINARY(e[r]);if(a.anyIsError(o,i,s,l))return n.value;t=this.COMPLEX(o+s,i+l)}return t},t.IMTAN=function(e){if(!0===e||!1===e)return n.value;var r=t.IMREAL(e),o=t.IMAGINARY(e);return a.anyIsError(r,o)?n.value:this.IMDIV(this.IMSIN(e),this.IMCOS(e))},t.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return n.num;var r=10===e.length&&"7"===e.substring(0,1),o=r?parseInt(e,8)-1073741824:parseInt(e,8);if(o<-512||o>511)return n.num;if(r)return"1"+i.REPT("0",9-(512+o).toString(2).length)+(512+o).toString(2);var a=o.toString(2);return void 0===t?a:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=a.length?i.REPT("0",t-a.length)+a:n.num},t.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return n.num;var t=parseInt(e,8);return t>=536870912?t-1073741824:t},t.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return n.num;var r=parseInt(e,8);if(r>=536870912)return"ff"+(r+3221225472).toString(16);var o=r.toString(16);return void 0===t?o:isNaN(t)?n.value:t<0?n.num:(t=Math.floor(t))>=o.length?i.REPT("0",t-o.length)+o:n.num}},function(e,t,r){t.__esModule=!0,t.default=["ABS","ACCRINT","ACOS","ACOSH","ACOT","ACOTH","ADD","AGGREGATE","AND","ARABIC","ARGS2ARRAY","ASIN","ASINH","ATAN","ATAN2","ATANH","AVEDEV","AVERAGE","AVERAGEA","AVERAGEIF","AVERAGEIFS","BASE","BESSELI","BESSELJ","BESSELK","BESSELY","BETA.DIST","BETA.INV","BETADIST","BETAINV","BIN2DEC","BIN2HEX","BIN2OCT","BINOM.DIST","BINOM.DIST.RANGE","BINOM.INV","BINOMDIST","BITAND","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","CEILING","CEILINGMATH","CEILINGPRECISE","CHAR","CHISQ.DIST","CHISQ.DIST.RT","CHISQ.INV","CHISQ.INV.RT","CHOOSE","CHOOSE","CLEAN","CODE","COLUMN","COLUMNS","COMBIN","COMBINA","COMPLEX","CONCATENATE","CONFIDENCE","CONFIDENCE.NORM","CONFIDENCE.T","CONVERT","CORREL","COS","COSH","COT","COTH","COUNT","COUNTA","COUNTBLANK","COUNTIF","COUNTIFS","COUNTIN","COUNTUNIQUE","COVARIANCE.P","COVARIANCE.S","CSC","CSCH","CUMIPMT","CUMPRINC","DATE","DATEVALUE","DAY","DAYS","DAYS360","DB","DDB","DEC2BIN","DEC2HEX","DEC2OCT","DECIMAL","DEGREES","DELTA","DEVSQ","DIVIDE","DOLLARDE","DOLLARFR","E","EDATE","EFFECT","EOMONTH","EQ","ERF","ERFC","EVEN","EXACT","EXP","EXPON.DIST","EXPONDIST","F.DIST","F.DIST.RT","F.INV","F.INV.RT","FACT","FACTDOUBLE","FALSE","FDIST","FDISTRT","FIND","FINV","FINVRT","FISHER","FISHERINV","FLATTEN","FLOOR","FORECAST","FREQUENCY","FV","FVSCHEDULE","GAMMA","GAMMA.DIST","GAMMA.INV","GAMMADIST","GAMMAINV","GAMMALN","GAMMALN.PRECISE","GAUSS","GCD","GEOMEAN","GESTEP","GROWTH","GTE","HARMEAN","HEX2BIN","HEX2DEC","HEX2OCT","HOUR","HTML2TEXT","HYPGEOM.DIST","HYPGEOMDIST","IF","IMABS","IMAGINARY","IMARGUMENT","IMCONJUGATE","IMCOS","IMCOSH","IMCOT","IMCSC","IMCSCH","IMDIV","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMREAL","IMSEC","IMSECH","IMSIN","IMSINH","IMSQRT","IMSUB","IMSUM","IMTAN","INT","INTERCEPT","INTERVAL","IPMT","IRR","ISBINARY","ISBLANK","ISEVEN","ISLOGICAL","ISNONTEXT","ISNUMBER","ISODD","ISODD","ISOWEEKNUM","ISPMT","ISTEXT","JOIN","KURT","LARGE","LCM","LEFT","LEN","LINEST","LN","LOG","LOG10","LOGEST","LOGNORM.DIST","LOGNORM.INV","LOGNORMDIST","LOGNORMINV","LOWER","LT","LTE","MATCH","MAX","MAXA","MEDIAN","MID","MIN","MINA","MINUS","MINUTE","MIRR","MOD","MODE.MULT","MODE.SNGL","MODEMULT","MODESNGL","MONTH","MROUND","MULTINOMIAL","MULTIPLY","NE","NEGBINOM.DIST","NEGBINOMDIST","NETWORKDAYS","NOMINAL","NORM.DIST","NORM.INV","NORM.S.DIST","NORM.S.INV","NORMDIST","NORMINV","NORMSDIST","NORMSINV","NOT","NOW","NPER","NPV","NUMBERS","OCT2BIN","OCT2DEC","OCT2HEX","ODD","OR","PDURATION","PEARSON","PERCENTILEEXC","PERCENTILEINC","PERCENTRANKEXC","PERCENTRANKINC","PERMUT","PERMUTATIONA","PHI","PI","PMT","POISSON.DIST","POISSONDIST","POW","POWER","PPMT","PROB","PRODUCT","PROPER","PV","QUARTILE.EXC","QUARTILE.INC","QUARTILEEXC","QUARTILEINC","QUOTIENT","RADIANS","RAND","RANDBETWEEN","RANK.AVG","RANK.EQ","RANKAVG","RANKEQ","RATE","REFERENCE","REGEXEXTRACT","REGEXMATCH","REGEXREPLACE","REPLACE","REPT","RIGHT","ROMAN","ROUND","ROUNDDOWN","ROUNDUP","ROW","ROWS","RRI","RSQ","SEARCH","SEC","SECH","SECOND","SERIESSUM","SIGN","SIN","SINH","SKEW","SKEW.P","SKEWP","SLN","SLOPE","SMALL","SPLIT","SPLIT","SQRT","SQRTPI","STANDARDIZE","STDEV.P","STDEV.S","STDEVA","STDEVP","STDEVPA","STDEVS","STEYX","SUBSTITUTE","SUBTOTAL","SUM","SUMIF","SUMIFS","SUMPRODUCT","SUMSQ","SUMX2MY2","SUMX2PY2","SUMXMY2","SWITCH","SYD","T","T.DIST","T.DIST.2T","T.DIST.RT","T.INV","T.INV.2T","TAN","TANH","TBILLEQ","TBILLPRICE","TBILLYIELD","TDIST","TDIST2T","TDISTRT","TIME","TIMEVALUE","TINV","TINV2T","TODAY","TRANSPOSE","TREND","TRIM","TRIMMEAN","TRUE","TRUNC","UNICHAR","UNICODE","UNIQUE","UPPER","VAR.P","VAR.S","VARA","VARP","VARPA","VARS","WEEKDAY","WEEKNUM","WEIBULL.DIST","WEIBULLDIST","WORKDAY","XIRR","XNPV","XOR","YEAR","YEARFRAC"]},function(e,t,r){function n(e){var t=parseInt(e,10);return t=isNaN(t)?-1:Math.max(t-1,-1)}function o(e){var t="";return e>=0&&(t=""+(e+1)),t}t.__esModule=!0,t.rowLabelToIndex=n,t.rowIndexToLabel=o,t.columnLabelToIndex=s,t.columnIndexToLabel=l,t.extractLabel=function(e){if("string"!=typeof e||!u.test(e))return[];var t=e.toUpperCase().match(u),r=t[1],o=t[2],i=t[3],a=t[4];return[{index:n(a),label:a,isAbsolute:"$"===i},{index:s(o),label:o,isAbsolute:"$"===r}]},t.toLabel=function(e,t){var r=(e.isAbsolute?"$":"")+o(e.index);return(t.isAbsolute?"$":"")+l(t.index)+r};var i="ABCDEFGHIJKLMNOPQRSTUVWXYZ",a=i.length;function s(e){var t=0;if("string"==typeof e)for(var r=0,n=(e=e.toUpperCase()).length-1;r<e.length;r+=1,n-=1)t+=Math.pow(a,n)*(i.indexOf(e[r])+1);return--t}function l(e){for(var t="";e>=0;)t=String.fromCharCode(e%a+97)+t,e=Math.floor(e/a)-1;return t.toUpperCase()}var u=/^([$])?([A-Za-z]+)([$])?([0-9]+)$/},function(e,t,r){t.__esModule=!0,t.rowLabelToIndex=t.rowIndexToLabel=t.columnLabelToIndex=t.columnIndexToLabel=t.toLabel=t.extractLabel=t.error=t.Parser=t.ERROR_VALUE=t.ERROR_REF=t.ERROR_NUM=t.ERROR_NULL=t.ERROR_NOT_AVAILABLE=t.ERROR_NAME=t.ERROR_DIV_ZERO=t.ERROR=t.SUPPORTED_FORMULAS=void 0;var n=l(r(16)),o=l(r(13)),i=r(2),a=l(i),s=r(14);function l(e){return e&&e.__esModule?e:{default:e}}t.SUPPORTED_FORMULAS=o.default,t.ERROR=i.ERROR,t.ERROR_DIV_ZERO=i.ERROR_DIV_ZERO,t.ERROR_NAME=i.ERROR_NAME,t.ERROR_NOT_AVAILABLE=i.ERROR_NOT_AVAILABLE,t.ERROR_NULL=i.ERROR_NULL,t.ERROR_NUM=i.ERROR_NUM,t.ERROR_REF=i.ERROR_REF,t.ERROR_VALUE=i.ERROR_VALUE,t.Parser=n.default,t.error=a.default,t.extractLabel=s.extractLabel,t.toLabel=s.toLabel,t.columnIndexToLabel=s.columnIndexToLabel,t.columnLabelToIndex=s.columnLabelToIndex,t.rowIndexToLabel=s.rowIndexToLabel,t.rowLabelToIndex=s.rowLabelToIndex},function(e,t,r){t.__esModule=!0;var n=f(r(17)),o=f(r(18)),i=r(39),a=r(40),s=r(3),l=r(2),u=f(l),c=r(14);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this));return r.parser=new i.Parser,r.parser.yy={toNumber:s.toNumber,trimEdges:a.trimEdges,invertNumber:s.invertNumber,throwError:function(e){return r._throwError(e)},callVariable:function(e){return r._callVariable(e)},evaluateByOperator:o.default,callFunction:function(e,t){return r._callFunction(e,t)},cellValue:function(e){return r._callCellValue(e)},rangeValue:function(e,t){return r._callRangeValue(e,t)}},r.variables=Object.create(null),r.functions=Object.create(null),r.setVariable("TRUE",!0).setVariable("FALSE",!1).setVariable("NULL",null),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.parse=function(e){var t=null,r=null;try{t=""===e?"":this.parser.parse(e)}catch(e){var n=(0,u.default)(e.message);r=n||(0,u.default)(l.ERROR)}return t instanceof Error&&(r=(0,u.default)(t.message)||(0,u.default)(l.ERROR),t=null),{error:r,result:t}},t.prototype.setVariable=function(e,t){return this.variables[e]=t,this},t.prototype.getVariable=function(e){return this.variables[e]},t.prototype._callVariable=function(e){var t=this.getVariable(e);if(this.emit("callVariable",e,(function(e){void 0!==e&&(t=e)})),void 0===t)throw Error(l.ERROR_NAME);return t},t.prototype.setFunction=function(e,t){return this.functions[e]=t,this},t.prototype.getFunction=function(e){return this.functions[e]},t.prototype._callFunction=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=this.getFunction(e),n=void 0;return r&&(n=r(t)),this.emit("callFunction",e,t,(function(e){void 0!==e&&(n=e)})),void 0===n?(0,o.default)(e,t):n},t.prototype._callCellValue=function(e){e=e.toUpperCase();var t=(0,c.extractLabel)(e),r=t[0],n=t[1],o=void 0;return this.emit("callCellValue",{label:e,row:r,column:n},(function(e){o=e})),o},t.prototype._callRangeValue=function(e,t){e=e.toUpperCase(),t=t.toUpperCase();var r=(0,c.extractLabel)(e),n=r[0],o=r[1],i=(0,c.extractLabel)(t),a=i[0],s=i[1],l={},u={};n.index<=a.index?(l.row=n,u.row=a):(l.row=a,u.row=n),o.index<=s.index?(l.column=o,u.column=s):(l.column=s,u.column=o),l.label=(0,c.toLabel)(l.row,l.column),u.label=(0,c.toLabel)(u.row,u.column);var f=[];return this.emit("callRangeValue",l,u,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];f=e})),f},t.prototype._throwError=function(e){if((0,l.isValidStrict)(e))throw Error(e);throw Error(l.ERROR)},t}(n.default);t.default=h},function(e,t){function r(){}r.prototype={on:function(e,t,r){var n=this.e||(this.e={});return(n[e]||(n[e]=[])).push({fn:t,ctx:r}),this},once:function(e,t,r){var n=this;function o(){n.off(e,o),t.apply(r,arguments)}return o._=t,this.on(e,o,r)},emit:function(e){for(var t=[].slice.call(arguments,1),r=((this.e||(this.e={}))[e]||[]).slice(),n=0,o=r.length;n<o;n++)r[n].fn.apply(r[n].ctx,t);return this},off:function(e,t){var r=this.e||(this.e={}),n=r[e],o=[];if(n&&t)for(var i=0,a=n.length;i<a;i++)n[i].fn!==t&&n[i].fn._!==t&&o.push(n[i]);return o.length?r[e]=o:delete r[e],this}},e.exports=r,e.exports.TinyEmitter=r},function(e,t,r){t.__esModule=!0,t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(e=e.toUpperCase(),!v[e])throw Error(g.ERROR_NAME);return v[e].apply(v,t)},t.registerOperation=_;var n=m(r(19)),o=m(r(20)),i=m(r(21)),a=m(r(22)),s=m(r(23)),l=m(r(31)),u=m(r(32)),c=m(r(33)),f=m(r(34)),h=m(r(35)),d=m(r(36)),p=m(r(37)),y=m(r(38)),g=r(2);function m(e){return e&&e.__esModule?e:{default:e}}var v=Object.create(null);function _(e,t){Array.isArray(e)||(e=[e.toUpperCase()]),e.forEach((function(e){t.isFactory?v[e]=t(e):v[e]=t}))}_(n.default.SYMBOL,n.default),_(o.default.SYMBOL,o.default),_(i.default.SYMBOL,i.default),_(a.default.SYMBOL,a.default),_(y.default.SYMBOL,y.default),_(s.default.SYMBOL,s.default),_(l.default.SYMBOL,l.default),_(u.default.SYMBOL,u.default),_(c.default.SYMBOL,c.default),_(f.default.SYMBOL,f.default),_(d.default.SYMBOL,d.default),_(p.default.SYMBOL,p.default),_(h.default.SYMBOL,h.default)},function(e,t,r){t.__esModule=!0,t.SYMBOL=void 0,t.default=a;var n=r(3),o=r(2),i=t.SYMBOL="+";function a(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];var a=r.reduce((function(e,t){return e+(0,n.toNumber)(t)}),(0,n.toNumber)(e));if(isNaN(a))throw Error(o.ERROR_VALUE);return a}a.SYMBOL=i},function(e,t,r){t.__esModule=!0,t.default=o;var n=t.SYMBOL="&";function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce((function(e,t){return e+t.toString()}),"")}o.SYMBOL=n},function(e,t,r){t.__esModule=!0,t.SYMBOL=void 0,t.default=a;var n=r(3),o=r(2),i=t.SYMBOL="/";function a(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];var a=r.reduce((function(e,t){return e/(0,n.toNumber)(t)}),(0,n.toNumber)(e));if(a===1/0)throw Error(o.ERROR_DIV_ZERO);if(isNaN(a))throw Error(o.ERROR_VALUE);return a}a.SYMBOL=i},function(e,t,r){t.__esModule=!0,t.default=o;var n=t.SYMBOL="=";function o(e,t){return e===t}o.SYMBOL=n},function(e,t,r){t.__esModule=!0,t.SYMBOL=void 0,t.default=u;var n,o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(24)),i=r(13),a=(n=i)&&n.__esModule?n:{default:n},s=r(2),l=t.SYMBOL=a.default;function u(e){return function(){var t=(e=e.toUpperCase()).split("."),r=!1,n=void 0;if(1===t.length)o[t[0]]&&(r=!0,n=o[t[0]].apply(o,arguments));else{for(var i=t.length,a=0,l=o;a<i;)if(l=l[t[a]],a++,!l){l=null;break}l&&(r=!0,n=l.apply(void 0,arguments))}if(!r)throw Error(s.ERROR_NAME);return n}}u.isFactory=!0,u.SYMBOL=l},function(e,t,r){var n=[r(25),r(27),r(12),r(28),r(4),r(6),r(9),r(29),r(8),r(30),r(5),r(11)];for(var o in n){var i=n[o];for(var a in i)t[a]=t[a]||i[a]}},function(e,t,r){var n=r(4),o=r(5),i=r(12),a=r(9);function s(e,t){if(t)for(var r in t)e[r]=t[r];return e}t.BETADIST=o.BETA.DIST,t.BETAINV=o.BETA.INV,t.BINOMDIST=o.BINOM.DIST,t.CEILING=t.ISOCEILING=s(n.CEILING.MATH,n.CEILING),t.CEILINGMATH=n.CEILING.MATH,t.CEILINGPRECISE=n.CEILING.PRECISE,t.CHIDIST=o.CHISQ.DIST,t.CHIDISTRT=o.CHISQ.DIST.RT,t.CHIINV=o.CHISQ.INV,t.CHIINVRT=o.CHISQ.INV.RT,t.CHITEST=o.CHISQ.TEST,t.CONFIDENCE=s(o.CONFIDENCE.NORM,o.CONFIDENCE),t.COVAR=o.COVARIANCE.P,t.COVARIANCEP=o.COVARIANCE.P,t.COVARIANCES=o.COVARIANCE.S,t.CRITBINOM=o.BINOM.INV,t.EXPONDIST=o.EXPON.DIST,t.ERFCPRECISE=i.ERFC.PRECISE,t.ERFPRECISE=i.ERF.PRECISE,t.FDIST=o.F.DIST,t.FDISTRT=o.F.DIST.RT,t.FINVRT=o.F.INV.RT,t.FINV=o.F.INV,t.FLOOR=s(n.FLOOR.MATH,n.FLOOR),t.FLOORMATH=n.FLOOR.MATH,t.FLOORPRECISE=n.FLOOR.PRECISE,t.FTEST=o.F.TEST,t.GAMMADIST=o.GAMMA.DIST,t.GAMMAINV=o.GAMMA.INV,t.GAMMALNPRECISE=o.GAMMALN.PRECISE,t.HYPGEOMDIST=o.HYPGEOM.DIST,t.LOGINV=o.LOGNORM.INV,t.LOGNORMINV=o.LOGNORM.INV,t.LOGNORMDIST=o.LOGNORM.DIST,t.MODE=s(o.MODE.SNGL,o.MODE),t.MODEMULT=o.MODE.MULT,t.MODESNGL=o.MODE.SNGL,t.NEGBINOMDIST=o.NEGBINOM.DIST,t.NETWORKDAYSINTL=a.NETWORKDAYS.INTL,t.NORMDIST=o.NORM.DIST,t.NORMINV=o.NORM.INV,t.NORMSDIST=o.NORM.S.DIST,t.NORMSINV=o.NORM.S.INV,t.PERCENTILE=s(o.PERCENTILE.EXC,o.PERCENTILE),t.PERCENTILEEXC=o.PERCENTILE.EXC,t.PERCENTILEINC=o.PERCENTILE.INC,t.PERCENTRANK=s(o.PERCENTRANK.INC,o.PERCENTRANK),t.PERCENTRANKEXC=o.PERCENTRANK.EXC,t.PERCENTRANKINC=o.PERCENTRANK.INC,t.POISSON=s(o.POISSON.DIST,o.POISSON),t.POISSONDIST=o.POISSON.DIST,t.QUARTILE=s(o.QUARTILE.INC,o.QUARTILE),t.QUARTILEEXC=o.QUARTILE.EXC,t.QUARTILEINC=o.QUARTILE.INC,t.RANK=s(o.RANK.EQ,o.RANK),t.RANKAVG=o.RANK.AVG,t.RANKEQ=o.RANK.EQ,t.SKEWP=o.SKEW.P,t.STDEV=s(o.STDEV.S,o.STDEV),t.STDEVP=o.STDEV.P,t.STDEVS=o.STDEV.S,t.TDIST=o.T.DIST,t.TDISTRT=o.T.DIST.RT,t.TINV=o.T.INV,t.TTEST=o.T.TEST,t.VAR=s(o.VAR.S,o.VAR),t.VARP=o.VAR.P,t.VARS=o.VAR.S,t.WEIBULL=s(o.WEIBULL.DIST,o.WEIBULL),t.WEIBULLDIST=o.WEIBULL.DIST,t.WORKDAYINTL=a.WORKDAY.INTL,t.ZTEST=o.Z.TEST},function(e,t,r){var n;n=function(e){e.version="1.0.2";var t=Math;function r(e,t){for(var r=0,n=0;r<e.length;++r)n=t*n+e[r];return n}function n(e,t,r,n,o){if(0===t)return r;if(1===t)return n;for(var i=2/e,a=n,s=1;s<t;++s)a=n*s*i+o*r,r=n,n=a;return a}function o(e,t,r,o,i){return function(r,a){if(o){if(0===r)return 1==o?-1/0:1/0;if(r<0)return NaN}return 0===a?e(r):1===a?t(r):a<0?NaN:n(r,a|=0,e(r),t(r),i)}}var i,a,s,l,u,c,f,h,d,p,y,g,m,v=function(){var e=.636619772,o=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),i=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),a=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),s=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function l(n){var l=0,u=0,c=0,f=n*n;if(n<8)l=(u=r(o,f))/(c=r(i,f));else{var h=n-.785398164;u=r(a,f=64/f),c=r(s,f),l=t.sqrt(e/n)*(t.cos(h)*u-t.sin(h)*c*8/n)}return l}var u=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),c=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),f=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),h=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function d(n){var o=0,i=0,a=0,s=n*n,l=t.abs(n)-2.356194491;return Math.abs(n)<8?o=(i=n*r(u,s))/(a=r(c,s)):(i=r(f,s=64/s),a=r(h,s),o=t.sqrt(e/t.abs(n))*(t.cos(l)*i-t.sin(l)*a*8/t.abs(n)),n<0&&(o=-o)),o}return function e(r,o){if(o=Math.round(o),!isFinite(r))return isNaN(r)?r:0;if(o<0)return(o%2?-1:1)*e(r,-o);if(r<0)return(o%2?-1:1)*e(-r,o);if(0===o)return l(r);if(1===o)return d(r);if(0===r)return 0;var i=0;if(r>o)i=n(r,o,l(r),d(r),-1);else{for(var a=!1,s=0,u=0,c=1,f=0,h=2/r,p=2*t.floor((o+t.floor(t.sqrt(40*o)))/2);p>0;p--)f=p*h*c-s,s=c,c=f,t.abs(c)>1e10&&(c*=1e-10,s*=1e-10,i*=1e-10,u*=1e-10),a&&(u+=c),a=!a,p==o&&(i=s);i/=u=2*u-c}return i}}(),_=(i=.636619772,a=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),s=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),u=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),c=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),f=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),h=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),d=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),o((function(e){var n=0,o=0,c=0,f=e*e,h=e-.785398164;return e<8?n=(o=r(a,f))/(c=r(s,f))+i*v(e,0)*t.log(e):(o=r(l,f=64/f),c=r(u,f),n=t.sqrt(i/e)*(t.sin(h)*o+t.cos(h)*c*8/e)),n}),(function(e){var n=0,o=0,a=0,s=e*e,l=e-2.356194491;return e<8?n=(o=e*r(c,s))/(a=r(f,s))+i*(v(e,1)*t.log(e)-1/e):(o=r(h,s=64/s),a=r(d,s),n=t.sqrt(i/e)*(t.sin(l)*o+t.cos(l)*a*8/e)),n}),0,1,-1)),b=(p=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),y=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),g=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),m=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function e(n,o){if(0===(o=Math.round(o)))return function(e){return e<=3.75?r(p,e*e/14.0625):t.exp(t.abs(e))/t.sqrt(t.abs(e))*r(y,3.75/t.abs(e))}(n);if(1===o)return function(e){return e<3.75?e*r(g,e*e/14.0625):(e<0?-1:1)*t.exp(t.abs(e))/t.sqrt(t.abs(e))*r(m,3.75/t.abs(e))}(n);if(o<0)return NaN;if(0===t.abs(n))return 0;if(n==1/0)return 1/0;var i,a=0,s=2/t.abs(n),l=0,u=1,c=0;for(i=2*t.round((o+t.round(t.sqrt(40*o)))/2);i>0;i--)c=i*s*u+l,l=u,u=c,t.abs(u)>1e10&&(u*=1e-10,l*=1e-10,a*=1e-10),i==o&&(a=l);return a*=e(n,0)/u,n<0&&o%2?-a:a}),C=function(){var e=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),n=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),i=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),a=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return o((function(o){return o<=2?-t.log(o/2)*b(o,0)+r(e,o*o/4):t.exp(-o)/t.sqrt(o)*r(n,2/o)}),(function(e){return e<=2?t.log(e/2)*b(e,1)+1/e*r(i,e*e/4):t.exp(-e)/t.sqrt(e)*r(a,2/e)}),0,2,1)}();e.besselj=v,e.bessely=_,e.besseli=b,e.besselk=C},"undefined"==typeof DO_NOT_EXPORT_BESSEL?n(t):n({})},function(e,t,r){var n=r(0),o=r(5),i=r(4),a=r(1),s=r(7);function l(e){var t=[];return a.arrayEach(e,(function(e){e&&t.push(e)})),t}function u(e,t){for(var r={},n=1;n<e[0].length;++n)r[n]=!0;var o=t[0].length;for(n=1;n<t.length;++n)t[n].length>o&&(o=t[n].length);for(var i=1;i<e.length;++i)for(var a=1;a<e[i].length;++a){for(var l=!1,u=!1,c=0;c<t.length;++c){var f=t[c];if(!(f.length<o)){var h=f[0];if(e[i][0]===h){u=!0;for(var d=1;d<f.length;++d)if(!l)if(void 0===f[d]||"*"===f[d])l=!0;else{var p=s.parse(f[d]+""),y=[s.createToken(e[i][a],s.TOKEN_TYPE_LITERAL)].concat(p);l=s.compute(y)}}}}u&&(r[a]=r[a]&&l)}for(var g=[],m=0;m<e[0].length;++m)r[m]&&g.push(m-1);return g}t.FINDFIELD=function(e,t){var r=null;return a.arrayEach(e,(function(e,n){if(e[0]===t)return r=n,!1})),null==r?n.value:r},t.DAVERAGE=function(e,r,o){if(isNaN(r)&&"string"!=typeof r)return n.value;var i=u(e,o),s=[];if("string"==typeof r){var l=t.FINDFIELD(e,r);s=a.rest(e[l])}else s=a.rest(e[r]);var c=0;return a.arrayEach(i,(function(e){c+=s[e]})),0===i.length?n.div0:c/i.length},t.DCOUNT=function(e,r,i){if(isNaN(r)&&"string"!=typeof r)return n.value;var s=u(e,i),l=[];if("string"==typeof r){var c=t.FINDFIELD(e,r);l=a.rest(e[c])}else l=a.rest(e[r]);var f=[];return a.arrayEach(s,(function(e){f.push(l[e])})),o.COUNT(f)},t.DCOUNTA=function(e,r,i){if(isNaN(r)&&"string"!=typeof r)return n.value;var s=u(e,i),l=[];if("string"==typeof r){var c=t.FINDFIELD(e,r);l=a.rest(e[c])}else l=a.rest(e[r]);var f=[];return a.arrayEach(s,(function(e){f.push(l[e])})),o.COUNTA(f)},t.DGET=function(e,r,o){if(isNaN(r)&&"string"!=typeof r)return n.value;var i=u(e,o),s=[];if("string"==typeof r){var l=t.FINDFIELD(e,r);s=a.rest(e[l])}else s=a.rest(e[r]);return 0===i.length?n.value:i.length>1?n.num:s[i[0]]},t.DMAX=function(e,r,o){if(isNaN(r)&&"string"!=typeof r)return n.value;var i=u(e,o),s=[];if("string"==typeof r){var l=t.FINDFIELD(e,r);s=a.rest(e[l])}else s=a.rest(e[r]);var c=s[i[0]];return a.arrayEach(i,(function(e){c<s[e]&&(c=s[e])})),c},t.DMIN=function(e,r,o){if(isNaN(r)&&"string"!=typeof r)return n.value;var i=u(e,o),s=[];if("string"==typeof r){var l=t.FINDFIELD(e,r);s=a.rest(e[l])}else s=a.rest(e[r]);var c=s[i[0]];return a.arrayEach(i,(function(e){c>s[e]&&(c=s[e])})),c},t.DPRODUCT=function(e,r,o){if(isNaN(r)&&"string"!=typeof r)return n.value;var i=u(e,o),s=[];if("string"==typeof r){var c=t.FINDFIELD(e,r);s=a.rest(e[c])}else s=a.rest(e[r]);var f=[];a.arrayEach(i,(function(e){f.push(s[e])})),f=l(f);var h=1;return a.arrayEach(f,(function(e){h*=e})),h},t.DSTDEV=function(e,r,i){if(isNaN(r)&&"string"!=typeof r)return n.value;var s=u(e,i),c=[];if("string"==typeof r){var f=t.FINDFIELD(e,r);c=a.rest(e[f])}else c=a.rest(e[r]);var h=[];return a.arrayEach(s,(function(e){h.push(c[e])})),h=l(h),o.STDEV.S(h)},t.DSTDEVP=function(e,r,i){if(isNaN(r)&&"string"!=typeof r)return n.value;var s=u(e,i),c=[];if("string"==typeof r){var f=t.FINDFIELD(e,r);c=a.rest(e[f])}else c=a.rest(e[r]);var h=[];return a.arrayEach(s,(function(e){h.push(c[e])})),h=l(h),o.STDEV.P(h)},t.DSUM=function(e,r,o){if(isNaN(r)&&"string"!=typeof r)return n.value;var s=u(e,o),l=[];if("string"==typeof r){var c=t.FINDFIELD(e,r);l=a.rest(e[c])}else l=a.rest(e[r]);var f=[];return a.arrayEach(s,(function(e){f.push(l[e])})),i.SUM(f)},t.DVAR=function(e,r,i){if(isNaN(r)&&"string"!=typeof r)return n.value;var s=u(e,i),l=[];if("string"==typeof r){var c=t.FINDFIELD(e,r);l=a.rest(e[c])}else l=a.rest(e[r]);var f=[];return a.arrayEach(s,(function(e){f.push(l[e])})),o.VAR.S(f)},t.DVARP=function(e,r,i){if(isNaN(r)&&"string"!=typeof r)return n.value;var s=u(e,i),l=[];if("string"==typeof r){var c=t.FINDFIELD(e,r);l=a.rest(e[c])}else l=a.rest(e[r]);var f=[];return a.arrayEach(s,(function(e){f.push(l[e])})),o.VAR.P(f)}},function(e,t,r){var n=r(0),o=r(1),i=r(8);t.AND=function(){for(var e=o.flatten(arguments),t=!0,r=0;r<e.length;r++)e[r]||(t=!1);return t},t.CHOOSE=function(){if(arguments.length<2)return n.na;var e=arguments[0];return e<1||e>254||arguments.length<e+1?n.value:arguments[e]},t.FALSE=function(){return!1},t.IF=function(e,t,r){return e?t:r},t.IFERROR=function(e,t){return i.ISERROR(e)?t:e},t.IFNA=function(e,t){return e===n.na?t:e},t.NOT=function(e){return!e},t.OR=function(){for(var e=o.flatten(arguments),t=!1,r=0;r<e.length;r++)e[r]&&(t=!0);return t},t.TRUE=function(){return!0},t.XOR=function(){for(var e=o.flatten(arguments),t=0,r=0;r<e.length;r++)e[r]&&t++;return!!(1&Math.floor(Math.abs(t)))},t.SWITCH=function(){var e;if(arguments.length>0){var t=arguments[0],r=arguments.length-1,o=Math.floor(r/2),i=!1,a=r%2!=0,s=r%2==0?null:arguments[arguments.length-1];if(o)for(var l=0;l<o;l++)if(t===arguments[2*l+1]){e=arguments[2*l+2],i=!0;break}i||(e=a?s:n.na)}else e=n.value;return e}},function(e,t,r){var n=r(0),o=r(9),i=r(1);function a(e){return e&&e.getTime&&!isNaN(e.getTime())}function s(e){return e instanceof Date?e:new Date(e)}t.ACCRINT=function(e,t,r,i,l,u,c){return e=s(e),t=s(t),r=s(r),a(e)&&a(t)&&a(r)?i<=0||l<=0||-1===[1,2,4].indexOf(u)||-1===[0,1,2,3,4].indexOf(c)||r<=e?n.num:(c=c||0,(l=l||0)*i*o.YEARFRAC(e,r,c)):n.value},t.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},t.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},t.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},t.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},t.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},t.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},t.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},t.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},t.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},t.CUMIPMT=function(e,r,o,a,s,l){if(e=i.parseNumber(e),r=i.parseNumber(r),o=i.parseNumber(o),i.anyIsError(e,r,o))return n.value;if(e<=0||r<=0||o<=0)return n.num;if(a<1||s<1||a>s)return n.num;if(0!==l&&1!==l)return n.num;var u=t.PMT(e,r,o,0,l),c=0;1===a&&0===l&&(c=-o,a++);for(var f=a;f<=s;f++)c+=1===l?t.FV(e,f-2,u,o,1)-u:t.FV(e,f-1,u,o,0);return c*=e},t.CUMPRINC=function(e,r,o,a,s,l){if(e=i.parseNumber(e),r=i.parseNumber(r),o=i.parseNumber(o),i.anyIsError(e,r,o))return n.value;if(e<=0||r<=0||o<=0)return n.num;if(a<1||s<1||a>s)return n.num;if(0!==l&&1!==l)return n.num;var u=t.PMT(e,r,o,0,l),c=0;1===a&&(c=0===l?u+o*e:u,a++);for(var f=a;f<=s;f++)c+=l>0?u-(t.FV(e,f-2,u,o,1)-u)*e:u-t.FV(e,f-1,u,o,0)*e;return c},t.DB=function(e,t,r,o,a){if(a=void 0===a?12:a,e=i.parseNumber(e),t=i.parseNumber(t),r=i.parseNumber(r),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(e,t,r,o,a))return n.value;if(e<0||t<0||r<0||o<0)return n.num;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(a))return n.num;if(o>r)return n.num;if(t>=e)return 0;for(var s=(1-Math.pow(t/e,1/r)).toFixed(3),l=e*s*a/12,u=l,c=0,f=o===r?r-1:o,h=2;h<=f;h++)u+=c=(e-u)*s;return 1===o?l:o===r?(e-u)*s:c},t.DDB=function(e,t,r,o,a){if(a=void 0===a?2:a,e=i.parseNumber(e),t=i.parseNumber(t),r=i.parseNumber(r),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(e,t,r,o,a))return n.value;if(e<0||t<0||r<0||o<0||a<=0)return n.num;if(o>r)return n.num;if(t>=e)return 0;for(var s=0,l=0,u=1;u<=o;u++)s+=l=Math.min(a/r*(e-s),e-t-s);return l},t.DISC=function(){throw new Error("DISC is not implemented")},t.DOLLARDE=function(e,t){if(e=i.parseNumber(e),t=i.parseNumber(t),i.anyIsError(e,t))return n.value;if(t<0)return n.num;if(t>=0&&t<1)return n.div0;t=parseInt(t,10);var r=parseInt(e,10);r+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;var o=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return r=Math.round(r*o)/o},t.DOLLARFR=function(e,t){if(e=i.parseNumber(e),t=i.parseNumber(t),i.anyIsError(e,t))return n.value;if(t<0)return n.num;if(t>=0&&t<1)return n.div0;t=parseInt(t,10);var r=parseInt(e,10);return r+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t},t.DURATION=function(){throw new Error("DURATION is not implemented")},t.EFFECT=function(e,t){return e=i.parseNumber(e),t=i.parseNumber(t),i.anyIsError(e,t)?n.value:e<=0||t<1?n.num:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},t.FV=function(e,t,r,o,a){if(o=o||0,a=a||0,e=i.parseNumber(e),t=i.parseNumber(t),r=i.parseNumber(r),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(e,t,r,o,a))return n.value;var s;if(0===e)s=o+r*t;else{var l=Math.pow(1+e,t);s=1===a?o*l+r*(1+e)*(l-1)/e:o*l+r*(l-1)/e}return-s},t.FVSCHEDULE=function(e,t){if(e=i.parseNumber(e),t=i.parseNumberArray(i.flatten(t)),i.anyIsError(e,t))return n.value;for(var r=t.length,o=e,a=0;a<r;a++)o*=1+t[a];return o},t.INTRATE=function(){throw new Error("INTRATE is not implemented")},t.IPMT=function(e,r,o,a,s,l){if(s=s||0,l=l||0,e=i.parseNumber(e),r=i.parseNumber(r),o=i.parseNumber(o),a=i.parseNumber(a),s=i.parseNumber(s),l=i.parseNumber(l),i.anyIsError(e,r,o,a,s,l))return n.value;var u=t.PMT(e,o,a,s,l);return(1===r?1===l?0:-a:1===l?t.FV(e,r-2,u,a,1)-u:t.FV(e,r-1,u,a,0))*e},t.IRR=function(e,t){if(t=t||0,e=i.parseNumberArray(i.flatten(e)),t=i.parseNumber(t),i.anyIsError(e,t))return n.value;for(var r=function(e,t,r){for(var n=r+1,o=e[0],i=1;i<e.length;i++)o+=e[i]/Math.pow(n,(t[i]-t[0])/365);return o},o=function(e,t,r){for(var n=r+1,o=0,i=1;i<e.length;i++){var a=(t[i]-t[0])/365;o-=a*e[i]/Math.pow(n,a+1)}return o},a=[],s=!1,l=!1,u=0;u<e.length;u++)a[u]=0===u?0:a[u-1]+365,e[u]>0&&(s=!0),e[u]<0&&(l=!0);if(!s||!l)return n.num;var c,f,h,d=t=void 0===t?.1:t,p=!0;do{c=d-(h=r(e,a,d))/o(e,a,d),f=Math.abs(c-d),d=c,p=f>1e-10&&Math.abs(h)>1e-10}while(p);return d},t.ISPMT=function(e,t,r,o){return e=i.parseNumber(e),t=i.parseNumber(t),r=i.parseNumber(r),o=i.parseNumber(o),i.anyIsError(e,t,r,o)?n.value:o*e*(t/r-1)},t.MDURATION=function(){throw new Error("MDURATION is not implemented")},t.MIRR=function(e,r,o){if(e=i.parseNumberArray(i.flatten(e)),r=i.parseNumber(r),o=i.parseNumber(o),i.anyIsError(e,r,o))return n.value;for(var a=e.length,s=[],l=[],u=0;u<a;u++)e[u]<0?s.push(e[u]):l.push(e[u]);var c=-t.NPV(o,l)*Math.pow(1+o,a-1),f=t.NPV(r,s)*(1+r);return Math.pow(c/f,1/(a-1))-1},t.NOMINAL=function(e,t){return e=i.parseNumber(e),t=i.parseNumber(t),i.anyIsError(e,t)?n.value:e<=0||t<1?n.num:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},t.NPER=function(e,t,r,o,a){if(a=void 0===a?0:a,o=void 0===o?0:o,e=i.parseNumber(e),t=i.parseNumber(t),r=i.parseNumber(r),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(e,t,r,o,a))return n.value;var s=t*(1+e*a)-o*e,l=r*e+t*(1+e*a);return Math.log(s/l)/Math.log(1+e)},t.NPV=function(){var e=i.parseNumberArray(i.flatten(arguments));if(e instanceof Error)return e;for(var t=e[0],r=0,n=1;n<e.length;n++)r+=e[n]/Math.pow(1+t,n);return r},t.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},t.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},t.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},t.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},t.PDURATION=function(e,t,r){return e=i.parseNumber(e),t=i.parseNumber(t),r=i.parseNumber(r),i.anyIsError(e,t,r)?n.value:e<=0?n.num:(Math.log(r)-Math.log(t))/Math.log(1+e)},t.PMT=function(e,t,r,o,a){if(o=o||0,a=a||0,e=i.parseNumber(e),t=i.parseNumber(t),r=i.parseNumber(r),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(e,t,r,o,a))return n.value;var s;if(0===e)s=(r+o)/t;else{var l=Math.pow(1+e,t);s=1===a?(o*e/(l-1)+r*e/(1-1/l))/(1+e):o*e/(l-1)+r*e/(1-1/l)}return-s},t.PPMT=function(e,r,o,a,s,l){return s=s||0,l=l||0,e=i.parseNumber(e),o=i.parseNumber(o),a=i.parseNumber(a),s=i.parseNumber(s),l=i.parseNumber(l),i.anyIsError(e,o,a,s,l)?n.value:t.PMT(e,o,a,s,l)-t.IPMT(e,r,o,a,s,l)},t.PRICE=function(){throw new Error("PRICE is not implemented")},t.PRICEDISC=function(){throw new Error("PRICEDISC is not implemented")},t.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},t.PV=function(e,t,r,o,a){return o=o||0,a=a||0,e=i.parseNumber(e),t=i.parseNumber(t),r=i.parseNumber(r),o=i.parseNumber(o),a=i.parseNumber(a),i.anyIsError(e,t,r,o,a)?n.value:0===e?-r*t-o:((1-Math.pow(1+e,t))/e*r*(1+e*a)-o)/Math.pow(1+e,t)},t.RATE=function(e,t,r,o,a,s){if(s=void 0===s?.01:s,o=void 0===o?0:o,a=void 0===a?0:a,e=i.parseNumber(e),t=i.parseNumber(t),r=i.parseNumber(r),o=i.parseNumber(o),a=i.parseNumber(a),s=i.parseNumber(s),i.anyIsError(e,t,r,o,a,s))return n.value;var l,u,c,f=1e-10,h=0,d=0,p=0,y=s;for(Math.abs(y)<f||(d=Math.exp(e*Math.log(1+y))),l=r+t*e+o,u=r*d+t*(1/y+a)*(d-1)+o,p=c=0,h=y;Math.abs(l-u)>f&&p<50;)y=(u*c-l*h)/(u-l),c=h,h=y,l=u,u=Math.abs(y)<f?r*(1+e*y)+t*(1+y*a)*e+o:r*(d=Math.exp(e*Math.log(1+y)))+t*(1/y+a)*(d-1)+o,++p;return y},t.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},t.RRI=function(e,t,r){return e=i.parseNumber(e),t=i.parseNumber(t),r=i.parseNumber(r),i.anyIsError(e,t,r)?n.value:0===e||0===t?n.num:Math.pow(r/t,1/e)-1},t.SLN=function(e,t,r){return e=i.parseNumber(e),t=i.parseNumber(t),r=i.parseNumber(r),i.anyIsError(e,t,r)?n.value:0===r?n.num:(e-t)/r},t.SYD=function(e,t,r,o){return e=i.parseNumber(e),t=i.parseNumber(t),r=i.parseNumber(r),o=i.parseNumber(o),i.anyIsError(e,t,r,o)?n.value:0===r||o<1||o>r?n.num:(e-t)*(r-(o=parseInt(o,10))+1)*2/(r*(r+1))},t.TBILLEQ=function(e,t,r){return e=i.parseDate(e),t=i.parseDate(t),r=i.parseNumber(r),i.anyIsError(e,t,r)?n.value:r<=0||e>t||t-e>31536e6?n.num:365*r/(360-r*o.DAYS360(e,t,!1))},t.TBILLPRICE=function(e,t,r){return e=i.parseDate(e),t=i.parseDate(t),r=i.parseNumber(r),i.anyIsError(e,t,r)?n.value:r<=0||e>t||t-e>31536e6?n.num:100*(1-r*o.DAYS360(e,t,!1)/360)},t.TBILLYIELD=function(e,t,r){return e=i.parseDate(e),t=i.parseDate(t),r=i.parseNumber(r),i.anyIsError(e,t,r)?n.value:r<=0||e>t||t-e>31536e6?n.num:360*(100-r)/(r*o.DAYS360(e,t,!1))},t.VDB=function(){throw new Error("VDB is not implemented")},t.XNPV=function(e,t,r){if(e=i.parseNumber(e),t=i.parseNumberArray(i.flatten(t)),r=i.parseDateArray(i.flatten(r)),i.anyIsError(e,t,r))return n.value;for(var a=0,s=0;s<t.length;s++)a+=t[s]/Math.pow(1+e,o.DAYS(r[s],r[0])/365);return a},t.YIELD=function(){throw new Error("YIELD is not implemented")},t.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},t.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")}},function(e,t,r){var n=r(0),o=r(1);t.MATCH=function(e,t,r){if(!e&&!t)return n.na;if(2===arguments.length&&(r=1),!(t instanceof Array))return n.na;if(-1!==r&&0!==r&&1!==r)return n.na;for(var o,i,a=0;a<t.length;a++)if(1===r){if(t[a]===e)return a+1;t[a]<e&&(i?t[a]>i&&(o=a+1,i=t[a]):(o=a+1,i=t[a]))}else if(0===r){if("string"==typeof e){if(e=e.replace(/\?/g,"."),t[a].toLowerCase().match(e.toLowerCase()))return a+1}else if(t[a]===e)return a+1}else if(-1===r){if(t[a]===e)return a+1;t[a]>e&&(i?t[a]<i&&(o=a+1,i=t[a]):(o=a+1,i=t[a]))}return o||n.na},t.VLOOKUP=function(e,t,r,o){if(!e||!t||!r)return n.na;o=o||!1;for(var i=0;i<t.length;i++){var a=t[i];if(!o&&a[0]===e||a[0]===e||o&&"string"==typeof a[0]&&-1!==a[0].toLowerCase().indexOf(e.toLowerCase()))return r<a.length+1?a[r-1]:n.ref}return n.na},t.HLOOKUP=function(e,t,r,i){if(!e||!t||!r)return n.na;i=i||!1;for(var a=o.transpose(t),s=0;s<a.length;s++){var l=a[s];if(!i&&l[0]===e||l[0]===e||i&&"string"==typeof l[0]&&-1!==l[0].toLowerCase().indexOf(e.toLowerCase()))return r<l.length+1?l[r-1]:n.ref}return n.na}},function(e,t,r){t.__esModule=!0,t.default=o;var n=t.SYMBOL=">";function o(e,t){return e>t}o.SYMBOL=n},function(e,t,r){t.__esModule=!0,t.default=o;var n=t.SYMBOL=">=";function o(e,t){return e>=t}o.SYMBOL=n},function(e,t,r){t.__esModule=!0,t.default=o;var n=t.SYMBOL="<";function o(e,t){return e<t}o.SYMBOL=n},function(e,t,r){t.__esModule=!0,t.default=o;var n=t.SYMBOL="<=";function o(e,t){return e<=t}o.SYMBOL=n},function(e,t,r){t.__esModule=!0,t.SYMBOL=void 0,t.default=a;var n=r(3),o=r(2),i=t.SYMBOL="-";function a(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];var a=r.reduce((function(e,t){return e-(0,n.toNumber)(t)}),(0,n.toNumber)(e));if(isNaN(a))throw Error(o.ERROR_VALUE);return a}a.SYMBOL=i},function(e,t,r){t.__esModule=!0,t.SYMBOL=void 0,t.default=a;var n=r(3),o=r(2),i=t.SYMBOL="*";function a(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];var a=r.reduce((function(e,t){return e*(0,n.toNumber)(t)}),(0,n.toNumber)(e));if(isNaN(a))throw Error(o.ERROR_VALUE);return a}a.SYMBOL=i},function(e,t,r){t.__esModule=!0,t.default=o;var n=t.SYMBOL="<>";function o(e,t){return e!==t}o.SYMBOL=n},function(e,t,r){t.__esModule=!0,t.SYMBOL=void 0,t.default=a;var n=r(3),o=r(2),i=t.SYMBOL="^";function a(e,t){var r=Math.pow((0,n.toNumber)(e),(0,n.toNumber)(t));if(isNaN(r))throw Error(o.ERROR_VALUE);return r}a.SYMBOL=i},function(e,t,r){var n=function(){var e=function(e,t,r,n){for(r=r||{},n=e.length;n--;r[e[n]]=t);return r},t=[1,5],r=[1,8],n=[1,6],o=[1,7],i=[1,9],a=[1,14],s=[1,15],l=[1,16],u=[1,12],c=[1,13],f=[1,17],h=[1,19],d=[1,20],p=[1,21],y=[1,22],g=[1,23],m=[1,24],v=[1,25],_=[1,26],b=[1,27],C=[1,28],w=[5,9,10,11,13,14,15,16,17,18,19,20,29,30],E=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,32],S=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,34],O=[5,10,11,13,14,15,16,17,29,30],T=[5,10,13,14,15,16,29,30],R=[5,10,11,13,14,15,16,17,18,19,29,30],$=[13,29,30],I={trace:function(){},yy:{},symbols_:{error:2,expressions:3,expression:4,EOF:5,variableSequence:6,number:7,STRING:8,"&":9,"=":10,"+":11,"(":12,")":13,"<":14,">":15,NOT:16,"-":17,"*":18,"/":19,"^":20,FUNCTION:21,expseq:22,cell:23,ABSOLUTE_CELL:24,RELATIVE_CELL:25,MIXED_CELL:26,":":27,ARRAY:28,";":29,",":30,VARIABLE:31,DECIMAL:32,NUMBER:33,"%":34,ERROR:35,$accept:0,$end:1},terminals_:{5:"EOF",8:"STRING",9:"&",10:"=",11:"+",12:"(",13:")",14:"<",15:">",16:"NOT",17:"-",18:"*",19:"/",20:"^",21:"FUNCTION",24:"ABSOLUTE_CELL",25:"RELATIVE_CELL",26:"MIXED_CELL",27:":",28:"ARRAY",29:";",30:",",31:"VARIABLE",32:"DECIMAL",33:"NUMBER",34:"%",35:"ERROR"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,3],[4,3],[4,3],[4,3],[4,4],[4,4],[4,4],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,3],[4,4],[4,1],[4,1],[4,2],[23,1],[23,1],[23,1],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[22,1],[22,1],[22,3],[22,3],[6,1],[6,3],[7,1],[7,3],[7,2],[2,1]],performAction:function(e,t,r,n,o,i,a){var s=i.length-1;switch(o){case 1:return i[s-1];case 2:this.$=n.callVariable(i[s][0]);break;case 3:this.$=n.toNumber(i[s]);break;case 4:this.$=n.trimEdges(i[s]);break;case 5:this.$=n.evaluateByOperator("&",[i[s-2],i[s]]);break;case 6:this.$=n.evaluateByOperator("=",[i[s-2],i[s]]);break;case 7:this.$=n.evaluateByOperator("+",[i[s-2],i[s]]);break;case 8:this.$=i[s-1];break;case 9:this.$=n.evaluateByOperator("<=",[i[s-3],i[s]]);break;case 10:this.$=n.evaluateByOperator(">=",[i[s-3],i[s]]);break;case 11:this.$=n.evaluateByOperator("<>",[i[s-3],i[s]]);break;case 12:this.$=n.evaluateByOperator("NOT",[i[s-2],i[s]]);break;case 13:this.$=n.evaluateByOperator(">",[i[s-2],i[s]]);break;case 14:this.$=n.evaluateByOperator("<",[i[s-2],i[s]]);break;case 15:this.$=n.evaluateByOperator("-",[i[s-2],i[s]]);break;case 16:this.$=n.evaluateByOperator("*",[i[s-2],i[s]]);break;case 17:this.$=n.evaluateByOperator("/",[i[s-2],i[s]]);break;case 18:this.$=n.evaluateByOperator("^",[i[s-2],i[s]]);break;case 19:var l=n.invertNumber(i[s]);this.$=l,isNaN(this.$)&&(this.$=0);break;case 20:l=n.toNumber(i[s]),this.$=l,isNaN(this.$)&&(this.$=0);break;case 21:this.$=n.callFunction(i[s-2]);break;case 22:this.$=n.callFunction(i[s-3],i[s-1]);break;case 26:case 27:case 28:this.$=n.cellValue(i[s]);break;case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:this.$=n.rangeValue(i[s-2],i[s]);break;case 38:case 42:this.$=[i[s]];break;case 39:this.$=n.trimEdges(e).split(",");break;case 40:case 41:i[s-2].push(i[s]),this.$=i[s-2];break;case 43:this.$=Array.isArray(i[s-2])?i[s-2]:[i[s-2]],this.$.push(i[s]);break;case 44:this.$=i[s];break;case 45:this.$=1*(i[s-2]+"."+i[s]);break;case 46:this.$=.01*i[s-1];break;case 47:this.$=n.throwError(i[s])}},table:[{2:11,3:1,4:2,6:3,7:4,8:t,11:r,12:n,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{1:[3]},{5:[1,18],9:h,10:d,11:p,14:y,15:g,16:m,17:v,18:_,19:b,20:C},e(w,[2,2],{32:[1,29]}),e(w,[2,3],{34:[1,30]}),e(w,[2,4]),{2:11,4:31,6:3,7:4,8:t,11:r,12:n,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:32,6:3,7:4,8:t,11:r,12:n,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:33,6:3,7:4,8:t,11:r,12:n,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{12:[1,34]},e(w,[2,23]),e(w,[2,24],{2:35,35:f}),e(E,[2,42]),e(S,[2,44],{32:[1,36]}),e(w,[2,26],{27:[1,37]}),e(w,[2,27],{27:[1,38]}),e(w,[2,28],{27:[1,39]}),e([5,9,10,11,13,14,15,16,17,18,19,20,29,30,35],[2,47]),{1:[2,1]},{2:11,4:40,6:3,7:4,8:t,11:r,12:n,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:41,6:3,7:4,8:t,11:r,12:n,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:42,6:3,7:4,8:t,11:r,12:n,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:45,6:3,7:4,8:t,10:[1,43],11:r,12:n,15:[1,44],17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:47,6:3,7:4,8:t,10:[1,46],11:r,12:n,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:48,6:3,7:4,8:t,11:r,12:n,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:49,6:3,7:4,8:t,11:r,12:n,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:50,6:3,7:4,8:t,11:r,12:n,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:51,6:3,7:4,8:t,11:r,12:n,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:52,6:3,7:4,8:t,11:r,12:n,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{31:[1,53]},e(S,[2,46]),{9:h,10:d,11:p,13:[1,54],14:y,15:g,16:m,17:v,18:_,19:b,20:C},e(O,[2,19],{9:h,18:_,19:b,20:C}),e(O,[2,20],{9:h,18:_,19:b,20:C}),{2:11,4:57,6:3,7:4,8:t,11:r,12:n,13:[1,55],17:o,21:i,22:56,23:10,24:a,25:s,26:l,28:[1,58],31:u,33:c,35:f},e(w,[2,25]),{33:[1,59]},{24:[1,60],25:[1,61],26:[1,62]},{24:[1,63],25:[1,64],26:[1,65]},{24:[1,66],25:[1,67],26:[1,68]},e(w,[2,5]),e([5,10,13,29,30],[2,6],{9:h,11:p,14:y,15:g,16:m,17:v,18:_,19:b,20:C}),e(O,[2,7],{9:h,18:_,19:b,20:C}),{2:11,4:69,6:3,7:4,8:t,11:r,12:n,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:70,6:3,7:4,8:t,11:r,12:n,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},e(T,[2,14],{9:h,11:p,17:v,18:_,19:b,20:C}),{2:11,4:71,6:3,7:4,8:t,11:r,12:n,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},e(T,[2,13],{9:h,11:p,17:v,18:_,19:b,20:C}),e([5,10,13,16,29,30],[2,12],{9:h,11:p,14:y,15:g,17:v,18:_,19:b,20:C}),e(O,[2,15],{9:h,18:_,19:b,20:C}),e(R,[2,16],{9:h,20:C}),e(R,[2,17],{9:h,20:C}),e([5,10,11,13,14,15,16,17,18,19,20,29,30],[2,18],{9:h}),e(E,[2,43]),e(w,[2,8]),e(w,[2,21]),{13:[1,72],29:[1,73],30:[1,74]},e($,[2,38],{9:h,10:d,11:p,14:y,15:g,16:m,17:v,18:_,19:b,20:C}),e($,[2,39]),e(S,[2,45]),e(w,[2,29]),e(w,[2,30]),e(w,[2,31]),e(w,[2,32]),e(w,[2,33]),e(w,[2,34]),e(w,[2,35]),e(w,[2,36]),e(w,[2,37]),e(T,[2,9],{9:h,11:p,17:v,18:_,19:b,20:C}),e(T,[2,11],{9:h,11:p,17:v,18:_,19:b,20:C}),e(T,[2,10],{9:h,11:p,17:v,18:_,19:b,20:C}),e(w,[2,22]),{2:11,4:75,6:3,7:4,8:t,11:r,12:n,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},{2:11,4:76,6:3,7:4,8:t,11:r,12:n,17:o,21:i,23:10,24:a,25:s,26:l,31:u,33:c,35:f},e($,[2,40],{9:h,10:d,11:p,14:y,15:g,16:m,17:v,18:_,19:b,20:C}),e($,[2,41],{9:h,10:d,11:p,14:y,15:g,16:m,17:v,18:_,19:b,20:C})],defaultActions:{18:[2,1]},parseError:function(e,t){if(!t.recoverable){var r=new Error(e);throw r.hash=t,r}this.trace(e)},parse:function(e){var t=this,r=[0],n=[null],o=[],i=this.table,a="",s=0,l=0,u=0,c=2,f=1,h=o.slice.call(arguments,1),d=Object.create(this.lexer),p={yy:{}};for(var y in this.yy)Object.prototype.hasOwnProperty.call(this.yy,y)&&(p.yy[y]=this.yy[y]);d.setInput(e,p.yy),p.yy.lexer=d,p.yy.parser=this,void 0===d.yylloc&&(d.yylloc={});var g=d.yylloc;o.push(g);var m=d.options&&d.options.ranges;function v(e){r.length=r.length-2*e,n.length=n.length-e,o.length=o.length-e}"function"==typeof p.yy.parseError?this.parseError=p.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var _,b,C,w,E,S,O,T,R,$=function(){var e;return"number"!=typeof(e=d.lex()||f)&&(e=t.symbols_[e]||e),e},I={};;){if(C=r[r.length-1],this.defaultActions[C]?w=this.defaultActions[C]:(null==_&&(_=$()),w=i[C]&&i[C][_]),void 0===w||!w.length||!w[0]){var A,P="";function k(e){for(var t=r.length-1,n=0;;){if(c.toString()in i[e])return n;if(0===e||t<2)return!1;e=r[t-=2],++n}}if(u)b!==f&&(A=k(C));else{for(S in A=k(C),R=[],i[C])this.terminals_[S]&&S>c&&R.push("'"+this.terminals_[S]+"'");P=d.showPosition?"Parse error on line "+(s+1)+":\n"+d.showPosition()+"\nExpecting "+R.join(", ")+", got '"+(this.terminals_[_]||_)+"'":"Parse error on line "+(s+1)+": Unexpected "+(_==f?"end of input":"'"+(this.terminals_[_]||_)+"'"),this.parseError(P,{text:d.match,token:this.terminals_[_]||_,line:d.yylineno,loc:g,expected:R,recoverable:!1!==A})}if(3==u){if(_===f||b===f)throw new Error(P||"Parsing halted while starting to recover from another error.");l=d.yyleng,a=d.yytext,s=d.yylineno,g=d.yylloc,_=$()}if(!1===A)throw new Error(P||"Parsing halted. No suitable error recovery rule available.");v(A),b=_==c?null:_,_=c,C=r[r.length-1],w=i[C]&&i[C][c],u=3}if(w[0]instanceof Array&&w.length>1)throw new Error("Parse Error: multiple actions possible at state: "+C+", token: "+_);switch(w[0]){case 1:r.push(_),n.push(d.yytext),o.push(d.yylloc),r.push(w[1]),_=null,b?(_=b,b=null):(l=d.yyleng,a=d.yytext,s=d.yylineno,g=d.yylloc,u>0&&u--);break;case 2:if(O=this.productions_[w[1]][1],I.$=n[n.length-O],I._$={first_line:o[o.length-(O||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(O||1)].first_column,last_column:o[o.length-1].last_column},m&&(I._$.range=[o[o.length-(O||1)].range[0],o[o.length-1].range[1]]),void 0!==(E=this.performAction.apply(I,[a,l,s,p.yy,w[1],n,o].concat(h))))return E;O&&(r=r.slice(0,-1*O*2),n=n.slice(0,-1*O),o=o.slice(0,-1*O)),r.push(this.productions_[w[1]][0]),n.push(I.$),o.push(I._$),T=i[r[r.length-2]][r[r.length-1]],r.push(T);break;case 3:return!0}}return!0}},A={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e,t){return this.yy=t||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,r=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t),this.offset-=t;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),r.length-1&&(this.yylineno-=r.length-1);var o=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===n.length?this.yylloc.first_column:0)+n[n.length-r.length].length-r[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[o[0],o[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var r,n,o;if(this.options.backtrack_lexer&&(o={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(o.yylloc.range=this.yylloc.range.slice(0))),(n=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=n.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],r=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),r)return r;if(this._backtrack){for(var i in o)this[i]=o[i];return!1}return!1},next:function(){if(this.done)return this.EOF;var e,t,r,n;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var o=this._currentRules(),i=0;i<o.length;i++)if((r=this._input.match(this.rules[o[i]]))&&(!t||r[0].length>t[0].length)){if(t=r,n=i,this.options.backtrack_lexer){if(!1!==(e=this.test_match(r,o[i])))return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?!1!==(e=this.test_match(t,o[n]))&&e:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return(e=this.conditionStack.length-1-Math.abs(e||0))>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,r,n){switch(r){case 0:break;case 1:case 2:return 8;case 3:return 21;case 4:return 35;case 5:return 24;case 6:case 7:return 26;case 8:return 25;case 9:return 21;case 10:case 11:return 31;case 12:return 33;case 13:return 28;case 14:return 9;case 15:return" ";case 16:return 32;case 17:return 27;case 18:return 29;case 19:return 30;case 20:return 18;case 21:return 19;case 22:return 17;case 23:return 11;case 24:return 20;case 25:return 12;case 26:return 13;case 27:return 15;case 28:return 14;case 29:return 16;case 30:return'"';case 31:return"'";case 32:return"!";case 33:return 10;case 34:return 34;case 35:return"#";case 36:return 5}},rules:[/^(?:\s+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9\.]+(?=[(]))/,/^(?:#[A-Z0-9\/]+(!|\?)?)/,/^(?:\$[A-Za-z]+\$[0-9]+)/,/^(?:\$[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+\$[0-9]+)/,/^(?:[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z\.]+(?=[(]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\[(.*)?\])/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],inclusive:!0}}};function P(){this.yy={}}return I.lexer=A,P.prototype=I,I.Parser=P,new P}();t.parser=n,t.Parser=n.Parser,t.parse=function(){return n.parse.apply(n,arguments)}},function(e,t,r){t.__esModule=!0,t.trimEdges=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e=e.substring(t,e.length-t)}}])},e.exports=r()}));function _classCallCheck$2m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2f(e,t,r){return t&&_defineProperties$2f(e.prototype,t),r&&_defineProperties$2f(e,r),e}var BaseCell=function(){function e(t,r){_classCallCheck$2m(this,e);var n=isObject$1(t),o=isObject$1(r);this._row=n?t.index:t,this.rowAbsolute=!n||t.isAbsolute,this._column=o?r.index:r,this.columnAbsolute=!o||r.isAbsolute,this.rowOffset=0,this.columnOffset=0,Object.defineProperty(this,"row",{get:function(){return this.rowOffset+this._row},set:function(e){this._row=e},enumerable:!0,configurable:!0}),Object.defineProperty(this,"column",{get:function(){return this.columnOffset+this._column},set:function(e){this._column=e},enumerable:!0,configurable:!0})}return _createClass$2f(e,[{key:"translateTo",value:function(e,t){this.row=this.row+e,this.column=this.column+t}},{key:"isEqual",value:function(e){return e.row===this.row&&e.column===this.column}},{key:"toString",value:function(){return formulaParser.toLabel({index:this.row,isAbsolute:this.rowAbsolute},{index:this.column,isAbsolute:this.columnAbsolute})}}]),e}();function _typeof$1m(e){return(_typeof$1m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$2n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2g(e,t,r){return t&&_defineProperties$2g(e.prototype,t),r&&_defineProperties$2g(e,r),e}function _inherits$1c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$1d(e,t)}function _setPrototypeOf$1d(e,t){return(_setPrototypeOf$1d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$1c(e){var t=_isNativeReflectConstruct$1d();return function(){var r,n=_getPrototypeOf$1c(e);if(t){var o=_getPrototypeOf$1c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$1c(this,r)}}function _possibleConstructorReturn$1c(e,t){return!t||"object"!==_typeof$1m(t)&&"function"!=typeof t?_assertThisInitialized$1c(e):t}function _assertThisInitialized$1c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$1c(e){return(_getPrototypeOf$1c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var STATE_OUT_OFF_DATE=1,STATE_COMPUTING=2,STATE_UP_TO_DATE=3,states=[STATE_OUT_OFF_DATE,STATE_COMPUTING,STATE_UP_TO_DATE],CellValue=function(e){_inherits$1c(r,e);var t=_createSuper$1c(r);function r(e,n){var o;return _classCallCheck$2n(this,r),(o=t.call(this,e,n)).precedents=[],o.value=null,o.error=null,o.state=r.STATE_UP_TO_DATE,o}return _createClass$2g(r,null,[{key:"STATE_OUT_OFF_DATE",get:function(){return 1}},{key:"STATE_COMPUTING",get:function(){return 2}},{key:"STATE_UP_TO_DATE",get:function(){return 3}}]),_createClass$2g(r,[{key:"setValue",value:function(e){this.value=e}},{key:"getValue",value:function(){return this.value}},{key:"setError",value:function(e){this.error=e}},{key:"getError",value:function(){return this.error}},{key:"hasError",value:function(){return null!==this.error}},{key:"setState",value:function(e){if(-1===states.indexOf(e))throw Error("Unrecognized state: ".concat(e));this.state=e}},{key:"isState",value:function(e){return this.state===e}},{key:"addPrecedent",value:function(e){if(this.isEqual(e))throw Error(formulaParser.ERROR_REF);this.hasPrecedent(e)||this.precedents.push(e)}},{key:"removePrecedent",value:function(e){if(this.isEqual(e))throw Error(formulaParser.ERROR_REF);this.precedents=arrayFilter(this.precedents,(function(t){return!t.isEqual(e)}))}},{key:"clearPrecedents",value:function(){this.precedents.length=0}},{key:"getPrecedents",value:function(){return this.precedents}},{key:"hasPrecedents",value:function(){return this.precedents.length>0}},{key:"hasPrecedent",value:function(e){return arrayFilter(this.precedents,(function(t){return t.isEqual(e)})).length>0}}]),r}(BaseCell);function _typeof$1n(e){return(_typeof$1n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$2o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2h(e,t,r){return t&&_defineProperties$2h(e.prototype,t),r&&_defineProperties$2h(e,r),e}function _inherits$1d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$1e(e,t)}function _setPrototypeOf$1e(e,t){return(_setPrototypeOf$1e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$1d(e){var t=_isNativeReflectConstruct$1e();return function(){var r,n=_getPrototypeOf$1d(e);if(t){var o=_getPrototypeOf$1d(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$1d(this,r)}}function _possibleConstructorReturn$1d(e,t){return!t||"object"!==_typeof$1n(t)&&"function"!=typeof t?_assertThisInitialized$1d(e):t}function _assertThisInitialized$1d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1e(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$1d(e){return(_getPrototypeOf$1d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var CellReference=function(e){_inherits$1d(r,e);var t=_createSuper$1d(r);function r(){return _classCallCheck$2o(this,r),t.apply(this,arguments)}return _createClass$2h(r,[{key:"toString",value:function(){return formulaParser.toLabel({index:this.row,isAbsolute:!1},{index:this.column,isAbsolute:!1})}}]),r}(BaseCell);function _classCallCheck$2p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2i(e,t,r){return t&&_defineProperties$2i(e.prototype,t),r&&_defineProperties$2i(e,r),e}var Matrix=function(){function e(t){_classCallCheck$2p(this,e),this.hot=t,this.data=[],this.cellReferences=[]}return _createClass$2i(e,[{key:"getCellAt",value:function(e,t){var r=null;return arrayEach(this.data,(function(n){if(n.row===e&&n.column===t)return r=n,!1})),r}},{key:"getOutOfDateCells",value:function(){return arrayFilter(this.data,(function(e){return e.isState(CellValue.STATE_OUT_OFF_DATE)}))}},{key:"add",value:function(e){arrayFilter(this.data,(function(t){return t.isEqual(e)})).length||this.data.push(e)}},{key:"remove",value:function(e){var t=Array.isArray(e);this.data=arrayFilter(this.data,(function(r){return!function(e,r){var n=!1;return t?arrayEach(r,(function(t){if(e.isEqual(t))return n=!0,!1})):n=e.isEqual(r),n}(r,e)}))}},{key:"getDependencies",value:function(e){var t=this,r=function(e){return arrayReduce(t.data,(function(t,r){return r.hasPrecedent(e)&&-1===t.indexOf(r)&&t.push(r),t}),[])};return function e(n){var o=r(n);return o.length&&arrayEach(o,(function(r){r.hasPrecedents()&&(o=o.concat(e({row:t.hot.toVisualRow(r.row),column:t.hot.toVisualColumn(r.column)})))})),o}(e)}},{key:"registerCellRef",value:function(e){arrayFilter(this.cellReferences,(function(t){return t.isEqual(e)})).length||this.cellReferences.push(e)}},{key:"removeCellRefsAtRange",value:function(e,t){var r=e.row,n=e.column,o=t.row,i=t.column,a=[];return this.cellReferences=arrayFilter(this.cellReferences,(function(e){return!function(e){return void 0===r||e.row>=r&&e.row<=o}(e)||!function(e){return void 0===n||e.column>=n&&e.column<=i}(e)||(a.push(e),!1)})),a}},{key:"reset",value:function(){this.data.length=0,this.cellReferences.length=0}}]),e}();function _slicedToArray$D(e,t){return _arrayWithHoles$F(e)||_iterableToArrayLimit$D(e,t)||_unsupportedIterableToArray$T(e,t)||_nonIterableRest$F()}function _nonIterableRest$F(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$T(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$T(e,t):void 0}}function _arrayLikeToArray$T(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$D(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$F(e){if(Array.isArray(e))return e}function _classCallCheck$2q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2j(e,t,r){return t&&_defineProperties$2j(e.prototype,t),r&&_defineProperties$2j(e,r),e}var BARE_CELL_STRICT_REGEX=/^\$?[A-Z]+\$?\d+$/,BARE_CELL_REGEX=/\$?[A-Z]+\$?\d+/,CELL_REGEX=/(?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ])/g,RANGE_REGEX=/\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+/g,CELL_AND_RANGE_REGEX=/((?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ]))|(\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+)/g,ExpressionModifier=function(){function e(t){_classCallCheck$2q(this,e),this.expression="",this.cells=[],this.customModifier=null,"string"==typeof t&&this.setExpression(t)}return _createClass$2j(e,[{key:"setExpression",value:function(e){return this.cells.length=0,this.expression=toUpperCaseFormula(e),this._extractCells(),this._extractCellsRange(),this}},{key:"useCustomModifier",value:function(e){this.customModifier=e}},{key:"translate",value:function(e){var t=this,r=e.row,n=e.column,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return arrayEach(this.cells,(function(e){null!=r&&t._translateCell(e,"row",r,o.row),null!=n&&t._translateCell(e,"column",n,o.column)})),this}},{key:"toString",value:function(){var e=this,t=this.expression.replace(CELL_AND_RANGE_REGEX,(function(t,r,n){var o=-1===t.indexOf(":"),i=t,a=t,s=null;o&&(a=BARE_CELL_STRICT_REGEX.test(r)?r:n);var l=e._searchCell(a);return l&&(s=l.refError?formulaParser.error(formulaParser.ERROR_REF):l.toLabel(),i=o?t.replace(a,s):s),i}));return t.startsWith("=")||(t="=".concat(t)),t}},{key:"_translateCell",value:function(e,t,r,n){var o=e.start,i=e.end,a=o[t].index,s=i[t].index,l=r,u=r,c=!1;if(this.customModifier){var f=_slicedToArray$D(this.customModifier(e,t,r,n),3);l=f[0],u=f[1],c=f[2]}else o[t].isAbsolute&&(l=0),i[t].isAbsolute&&(u=0);l&&!c&&(a+l<0&&(c=!0),o[t].index=Math.max(a+l,0)),u&&!c&&(s+u<0&&(c=!0),i[t].index=Math.max(s+u,0)),c&&(e.refError=!0)}},{key:"_extractCells",value:function(){var e=this,t=this.expression.match(CELL_REGEX);t&&arrayEach(t,(function(t){var r=t.match(BARE_CELL_REGEX);if(r){var n=_slicedToArray$D(formulaParser.extractLabel(r[0]),2),o=n[0],i=n[1];e.cells.push(e._createCell({row:o,column:i},{row:o,column:i},r[0]))}}))}},{key:"_extractCellsRange",value:function(){var e=this,t=this.expression.match(RANGE_REGEX);t&&arrayEach(t,(function(t){var r=_slicedToArray$D(t.split(":"),2),n=r[0],o=r[1],i=_slicedToArray$D(formulaParser.extractLabel(n),2),a=i[0],s=i[1],l=_slicedToArray$D(formulaParser.extractLabel(o),2),u={row:a,column:s},c={row:l[0],column:l[1]};e.cells.push(e._createCell(u,c,t))}))}},{key:"_searchCell",value:function(e){return _slicedToArray$D(arrayFilter(this.cells,(function(t){return t.origLabel===e})),1)[0]||null}},{key:"_createCell",value:function(e,t,r){return{start:e,end:t,origLabel:r,type:-1===r.indexOf(":")?"cell":"range",refError:!1,toLabel:function(){var e=formulaParser.toLabel(this.start.row,this.start.column);return"range"===this.type&&(e+=":".concat(formulaParser.toLabel(this.end.row,this.end.column))),e}}}}]),e}();mixin(ExpressionModifier,localHooks);var OPERATION_NAME="column_sorting",visualRows;function prepare(){var e=this.matrix,t=this.hot;visualRows=new WeakMap,arrayEach(e.data,(function(e){visualRows.set(e,t.toVisualRow(e.row))}))}function operate(){var e=this.matrix,t=this.dataProvider,r=this.hot;e.cellReferences.length=0,arrayEach(e.data,(function(e){e.setState(CellValue.STATE_OUT_OFF_DATE),e.clearPrecedents();var n=e.row,o=e.column,i=t.getSourceDataAtCell(n,o);if(isFormulaExpression(i)){var a=visualRows.get(e),s=new ExpressionModifier(i);s.translate({row:r.toVisualRow(n)-a}),t.updateSourceData(n,o,s.toString())}})),visualRows=null}var columnSorting=Object.freeze({__proto__:null,OPERATION_NAME:OPERATION_NAME,prepare:prepare,operate:operate}),OPERATION_NAME$1="insert_column";function operate$1(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.matrix,o=this.dataProvider,i=[0,t];arrayEach(n.cellReferences,(function(t){t.column>=e&&t.translateTo.apply(t,i)})),arrayEach(n.data,(function(n){var a=n.row,s=n.column;if(n.column>=e&&(n.translateTo.apply(n,i),n.setState(CellValue.STATE_OUT_OFF_DATE)),r){var l=n.row,u=n.column,c=o.getSourceDataAtCell(l,u);if(isFormulaExpression(c)){var f=cellCoordFactory("column",e),h=new ExpressionModifier(c);h.useCustomModifier(customTranslateModifier),h.translate({column:t},f({row:a,column:s})),o.updateSourceData(l,u,h.toString())}}}))}function customTranslateModifier(e,t,r,n){var o=e.start,i=e.end,a=r,s=r;return n>o[t].index&&(a=0),n>i[t].index&&(s=0),[a,s,!1]}var insertColumn=Object.freeze({__proto__:null,OPERATION_NAME:OPERATION_NAME$1,operate:operate$1}),OPERATION_NAME$2="insert_row";function operate$2(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.matrix,o=this.dataProvider,i=[t,0];arrayEach(n.cellReferences,(function(t){t.row>=e&&t.translateTo.apply(t,i)})),arrayEach(n.data,(function(n){var a=n.row,s=n.column;if(n.row>=e&&(n.translateTo.apply(n,i),n.setState(CellValue.STATE_OUT_OFF_DATE)),r){var l=n.row,u=n.column,c=o.getSourceDataAtCell(l,u);if(isFormulaExpression(c)){var f=cellCoordFactory("row",e),h=new ExpressionModifier(c);h.useCustomModifier(customTranslateModifier$1),h.translate({row:t},f({row:a,column:s})),o.updateSourceData(l,u,h.toString())}}}))}function customTranslateModifier$1(e,t,r,n){var o=e.start,i=e.end,a=r,s=r;return n>o[t].index&&(a=0),n>i[t].index&&(s=0),[a,s,!1]}var insertRow=Object.freeze({__proto__:null,OPERATION_NAME:OPERATION_NAME$2,operate:operate$2}),OPERATION_NAME$3="remove_column";function operate$3(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=-t,o=this.matrix,i=this.dataProvider,a=this.sheet,s=[0,n],l=Math.abs(n)-1,u=o.removeCellRefsAtRange({column:e},{column:e+l}),c=[];arrayEach(o.data,(function(t){arrayEach(u,(function(e){t.hasPrecedent(e)&&(t.removePrecedent(e),t.setState(CellValue.STATE_OUT_OFF_DATE),arrayEach(a.getCellDependencies(t.row,t.column),(function(e){e.setState(CellValue.STATE_OUT_OFF_DATE)})))})),t.column>=e&&t.column<=e+l&&c.push(t)})),o.remove(c),arrayEach(o.cellReferences,(function(t){t.column>=e&&t.translateTo.apply(t,s)})),arrayEach(o.data,(function(t){var o=t.row,a=t.column;if(t.column>=e&&(t.translateTo.apply(t,s),t.setState(CellValue.STATE_OUT_OFF_DATE)),r){var l=t.row,u=t.column,c=i.getSourceDataAtCell(l,u);if(isFormulaExpression(c)){var f=cellCoordFactory("column",e),h=new ExpressionModifier(c);h.useCustomModifier(customTranslateModifier$2),h.translate({column:n},f({row:o,column:a})),i.updateSourceData(l,u,h.toString())}}}))}function customTranslateModifier$2(e,t,r,n){var o=e.start,i=e.end,a=e.type,s=o[t].index,l=i[t].index,u=Math.abs(r)-1,c=r,f=r,h=!1;return s>=n&&l<=n+u&&(h=!0),h||"cell"!==a||n>=s&&(c=0,f=0),h||"range"!==a||(n>=s&&(c=0),n>l?f=0:l<=n+u&&(f-=Math.min(l-(n+u),0))),s+c<0&&(c-=s+c),[c,f,h]}var removeColumn=Object.freeze({__proto__:null,OPERATION_NAME:OPERATION_NAME$3,operate:operate$3}),OPERATION_NAME$4="remove_row";function operate$4(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=-t,o=this.matrix,i=this.dataProvider,a=this.sheet,s=[n,0],l=Math.abs(n)-1,u=o.removeCellRefsAtRange({row:e},{row:e+l}),c=[];arrayEach(o.data,(function(t){arrayEach(u,(function(e){t.hasPrecedent(e)&&(t.removePrecedent(e),t.setState(CellValue.STATE_OUT_OFF_DATE),arrayEach(a.getCellDependencies(t.row,t.column),(function(e){e.setState(CellValue.STATE_OUT_OFF_DATE)})))})),t.row>=e&&t.row<=e+l&&c.push(t)})),o.remove(c),arrayEach(o.cellReferences,(function(t){t.row>=e&&t.translateTo.apply(t,s)})),arrayEach(o.data,(function(t){var o=t.row,a=t.column;if(t.row>=e&&(t.translateTo.apply(t,s),t.setState(CellValue.STATE_OUT_OFF_DATE)),r){var l=t.row,u=t.column,c=i.getSourceDataAtCell(l,u);if(isFormulaExpression(c)){var f=cellCoordFactory("row",e),h=new ExpressionModifier(c);h.useCustomModifier(customTranslateModifier$3),h.translate({row:n},f({row:o,column:a})),i.updateSourceData(l,u,h.toString())}}}))}function customTranslateModifier$3(e,t,r,n){var o=e.start,i=e.end,a=e.type,s=o[t].index,l=i[t].index,u=Math.abs(r)-1,c=r,f=r,h=!1;return s>=n&&l<=n+u&&(h=!0),h||"cell"!==a||n>=s&&(c=0,f=0),h||"range"!==a||(n>=s&&(c=0),n>l?f=0:l<=n+u&&(f-=Math.min(l-(n+u),0))),s+c<0&&(c-=s+c),[c,f,h]}var removeRow=Object.freeze({__proto__:null,OPERATION_NAME:OPERATION_NAME$4,operate:operate$4});function _classCallCheck$2r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2k(e,t,r){return t&&_defineProperties$2k(e.prototype,t),r&&_defineProperties$2k(e,r),e}var operations$1=new Map;registerOperation$1(OPERATION_NAME,columnSorting),registerOperation$1(OPERATION_NAME$1,insertColumn),registerOperation$1(OPERATION_NAME$2,insertRow),registerOperation$1(OPERATION_NAME$3,removeColumn),registerOperation$1(OPERATION_NAME$4,removeRow);var AlterManager=function(){function e(t){_classCallCheck$2r(this,e),this.sheet=t,this.hot=t.hot,this.dataProvider=t.dataProvider,this.matrix=t.matrix}return _createClass$2k(e,[{key:"prepareAlter",value:function(e){if(!operations$1.has(e))throw Error('Alter operation "'.concat(e,'" not exist.'));for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];operations$1.get(e).prepare.apply(this,r)}},{key:"triggerAlter",value:function(e){if(!operations$1.has(e))throw Error('Alter operation "'.concat(e,'" not exist.'));for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];operations$1.get(e).operate.apply(this,r),this.runLocalHooks.apply(this,["afterAlter"].concat(r))}},{key:"destroy",value:function(){this.sheet=null,this.hot=null,this.dataProvider=null,this.matrix=null}}]),e}();mixin(AlterManager,localHooks);var empty$2=function(){};function registerOperation$1(e,t){operations$1.has(e)||operations$1.set(e,{prepare:t.prepare||empty$2,operate:t.operate||empty$2})}function _classCallCheck$2s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2l(e,t,r){return t&&_defineProperties$2l(e.prototype,t),r&&_defineProperties$2l(e,r),e}var STATE_UP_TO_DATE$1=1,STATE_NEED_REBUILD=2,STATE_NEED_FULL_REBUILD=3,Sheet=function(){function e(t,r){var n=this;_classCallCheck$2s(this,e),this.hot=t,this.dataProvider=r,this.parser=new formulaParser.Parser,this.matrix=new Matrix(this.hot),this.alterManager=new AlterManager(this),this._processingCell=null,this._state=STATE_NEED_FULL_REBUILD,this.parser.on("callCellValue",(function(){return n._onCallCellValue.apply(n,arguments)})),this.parser.on("callRangeValue",(function(){return n._onCallRangeValue.apply(n,arguments)})),this.alterManager.addLocalHook("afterAlter",(function(){return n._onAfterAlter.apply(n,arguments)}))}return _createClass$2l(e,[{key:"recalculate",value:function(){switch(this._state){case STATE_NEED_FULL_REBUILD:this.recalculateFull();break;case STATE_NEED_REBUILD:this.recalculateOptimized()}}},{key:"recalculateOptimized",value:function(){var e=this,t=this.matrix.getOutOfDateCells();arrayEach(t,(function(t){var r=e.dataProvider.getSourceDataAtCell(t.row,t.column);isFormulaExpression(r)&&e.parseExpression(t,r.substr(1))})),this._state=STATE_UP_TO_DATE$1,this.runLocalHooks("afterRecalculate",t,"optimized")}},{key:"recalculateFull",value:function(){var e=this,t=this.dataProvider.getSourceDataByRange();this.matrix.reset(),arrayEach(t,(function(t,r){arrayEach(t,(function(t,n){isFormulaExpression(t)&&e.parseExpression(new CellValue(r,n),t.substr(1))}))})),this._state=STATE_UP_TO_DATE$1,this.runLocalHooks("afterRecalculate",t,"full")}},{key:"setVariable",value:function(e,t){this.parser.setVariable(e,t)}},{key:"getVariable",value:function(e){return this.parser.getVariable(e)}},{key:"applyChanges",value:function(e,t,r){this.matrix.remove({row:e,column:t}),isFormulaExpression(r)&&this.parseExpression(new CellValue(e,t),r.substr(1)),arrayEach(this.getCellDependencies(this.hot.toVisualRow(e),this.hot.toVisualColumn(t)),(function(e){e.setState(CellValue.STATE_OUT_OFF_DATE)})),this._state=STATE_NEED_REBUILD}},{key:"parseExpression",value:function(e,t){e.setState(CellValue.STATE_COMPUTING),this._processingCell=e;var r=this.parser.parse(toUpperCaseFormula(t)),n=r.error,o=r.result;isFormulaExpression(o)?this.parseExpression(e,o.substr(1)):(e.setValue(o),e.setError(n),e.setState(CellValue.STATE_UP_TO_DATE)),this.matrix.add(e),this._processingCell=null}},{key:"getCellAt",value:function(e,t){return this.matrix.getCellAt(e,t)}},{key:"getCellDependencies",value:function(e,t){return this.matrix.getDependencies({row:e,column:t})}},{key:"_onCallCellValue",value:function(e,t){var r=e.row,n=e.column,o=new CellReference(r,n);if(!this.dataProvider.isInDataRange(o.row,o.column))throw Error(formulaParser.ERROR_REF);this.matrix.registerCellRef(o),this._processingCell.addPrecedent(o);var i=this.dataProvider.getRawDataAtCell(r.index,n.index);if(formulaParser.error(i)){var a=this.matrix.getCellAt(r.index,n.index);if(a&&a.hasError())throw Error(i)}if(isFormulaExpression(i)){var s=this.parser.parse(i.substr(1)),l=s.error,u=s.result;if(l)throw Error(l);t(u)}else t(i)}},{key:"_onCallRangeValue",value:function(e,t,r){var n=this,o=e.row,i=e.column,a=t.row,s=t.column,l=this.dataProvider.getRawDataByRange(o.index,i.index,a.index,s.index);r(arrayMap(l,(function(e,t){return function(e,t){return arrayMap(e,(function(e,r){var a=o.index+t,s=i.index+r,l=new CellReference(a,s);if(!n.dataProvider.isInDataRange(l.row,l.column))throw Error(formulaParser.ERROR_REF);n.matrix.registerCellRef(l),n._processingCell.addPrecedent(l);var u=e;if(formulaParser.error(u)){var c=n.matrix.getCellAt(l.row,l.column);if(c&&c.hasError())throw Error(u)}if(isFormulaExpression(u)){var f=n.parser.parse(u.substr(1)),h=f.error,d=f.result;if(h)throw Error(h);u=d}return u}))}(e,t)})))}},{key:"_onAfterAlter",value:function(){this.recalculateOptimized()}},{key:"destroy",value:function(){this.hot=null,this.dataProvider.destroy(),this.dataProvider=null,this.alterManager.destroy(),this.alterManager=null,this.parser=null,this.matrix.reset(),this.matrix=null}}]),e}();function _classCallCheck$2t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2m(e,t,r){return t&&_defineProperties$2m(e.prototype,t),r&&_defineProperties$2m(e,r),e}mixin(Sheet,localHooks);var DataProvider$1=function(){function e(t){_classCallCheck$2t(this,e),this.hot=t,this.changes={}}return _createClass$2m(e,[{key:"collectChanges",value:function(e,t,r){this.changes[this._coordId(e,t)]=r}},{key:"clearChanges",value:function(){this.changes={}}},{key:"isInDataRange",value:function(e,t){return e>=0&&e<this.hot.countRows()&&t>=0&&t<this.hot.countCols()}},{key:"getDataAtCell",value:function(e,t){var r=this._coordId(this.hot.toPhysicalRow(e),this.hot.toPhysicalColumn(t));return hasOwnProperty$1(this.changes,r)?this.changes[r]:this.hot.getDataAtCell(e,t)}},{key:"getDataByRange",value:function(e,t,r,n){var o=this,i=this.hot.getData(e,t,r,n);return arrayEach(i,(function(r,n){arrayEach(r,(function(r,a){var s=o._coordId(o.hot.toPhysicalRow(n+e),o.hot.toPhysicalColumn(a+t));hasOwnProperty$1(o.changes,s)&&(i[n][a]=o.changes[s])}))})),i}},{key:"getSourceDataAtCell",value:function(e,t){var r=this._coordId(e,t);return hasOwnProperty$1(this.changes,r)?this.changes[r]:this.hot.getSourceDataAtCell(e,t)}},{key:"getSourceDataByRange",value:function(e,t,r,n){return this.hot.getSourceDataArray(e,t,r,n)}},{key:"getRawDataAtCell",value:function(e,t){return this.getSourceDataAtCell(this.hot.toPhysicalRow(e),this.hot.toPhysicalColumn(t))}},{key:"getRawDataByRange",value:function(e,t,r,n){var o=this,i=[];return rangeEach(e,r,(function(e){var r=[];rangeEach(t,n,(function(t){var n=[o.hot.toPhysicalRow(e),o.hot.toPhysicalColumn(t)],i=n[0],a=n[1],s=o._coordId(i,a);hasOwnProperty$1(o.changes,s)?r.push(o.changes[s]):r.push(o.getSourceDataAtCell(i,a))})),i.push(r)})),i}},{key:"updateSourceData",value:function(e,t,r){this.hot.setSourceDataAtCell(e,this.hot.colToProp(t),r)}},{key:"_coordId",value:function(e,t){return"".concat(e,":").concat(t)}},{key:"destroy",value:function(){this.hot=null,this.changes=null}}]),e}();function _classCallCheck$2u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2n(e,t,r){return t&&_defineProperties$2n(e.prototype,t),r&&_defineProperties$2n(e,r),e}var Stack=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_classCallCheck$2u(this,e),this.items=t}return _createClass$2n(e,[{key:"push",value:function(){var e;(e=this.items).push.apply(e,arguments)}},{key:"pop",value:function(){return this.items.pop()}},{key:"peek",value:function(){return this.isEmpty()?void 0:this.items[this.items.length-1]}},{key:"isEmpty",value:function(){return!this.size()}},{key:"size",value:function(){return this.items.length}}]),e}();function _classCallCheck$2v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2o(e,t,r){return t&&_defineProperties$2o(e.prototype,t),r&&_defineProperties$2o(e,r),e}var UndoRedoSnapshot=function(){function e(t){_classCallCheck$2v(this,e),this.sheet=t,this.stack=new Stack}return _createClass$2o(e,[{key:"save",value:function(e,t,r){var n=this.sheet,o=n.matrix,i=n.dataProvider,a=[];arrayEach(o.data,(function(n){var o=n.row,s=n.column;if(n[e]<t||n[e]>t+(r-1)){var l=i.getSourceDataAtCell(o,s);a.push({row:o,column:s,value:l})}})),this.stack.push({axis:e,index:t,amount:r,changes:a})}},{key:"restore",value:function(){var e=this.sheet,t=e.matrix,r=e.dataProvider,n=this.stack.pop(),o=n.axis,i=n.index,a=n.amount,s=n.changes;s&&arrayEach(s,(function(e){e[o]>i+(a-1)&&(e[o]-=a);var n=e.row,s=e.column,l=e.value;r.getSourceDataAtCell(n,s)!==l&&(r.updateSourceData(n,s,l),t.getCellAt(n,s).setState(CellValue.STATE_OUT_OFF_DATE))}))}},{key:"destroy",value:function(){this.sheet=null,this.stack=null}}]),e}();function _typeof$1o(e){return(_typeof$1o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _slicedToArray$E(e,t){return _arrayWithHoles$G(e)||_iterableToArrayLimit$E(e,t)||_unsupportedIterableToArray$U(e,t)||_nonIterableRest$G()}function _nonIterableRest$G(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$U(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$U(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$U(e,t):void 0}}function _arrayLikeToArray$U(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$E(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$G(e){if(Array.isArray(e))return e}function _classCallCheck$2w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2p(e,t,r){return t&&_defineProperties$2p(e.prototype,t),r&&_defineProperties$2p(e,r),e}function _get$M(e,t,r){return(_get$M="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$M(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$M(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1e(e)););return e}function _inherits$1e(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$1f(e,t)}function _setPrototypeOf$1f(e,t){return(_setPrototypeOf$1f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$1e(e){var t=_isNativeReflectConstruct$1f();return function(){var r,n=_getPrototypeOf$1e(e);if(t){var o=_getPrototypeOf$1e(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$1e(this,r)}}function _possibleConstructorReturn$1e(e,t){return!t||"object"!==_typeof$1o(t)&&"function"!=typeof t?_assertThisInitialized$1e(e):t}function _assertThisInitialized$1e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$1e(e){return(_getPrototypeOf$1e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Formulas=function(e){_inherits$1e(r,e);var t=_createSuper$1e(r);function r(e){var n;return _classCallCheck$2w(this,r),(n=t.call(this,e)).eventManager=new EventManager(_assertThisInitialized$1e(n)),n.dataProvider=new DataProvider$1(n.hot),n.sheet=new Sheet(n.hot,n.dataProvider),n.undoRedoSnapshot=new UndoRedoSnapshot(n.sheet),n._skipRendering=!1,n}return _createClass$2p(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().formulas}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().formulas;isObject$1(t)&&isObject$1(t.variables)&&objectEach(t.variables,(function(t,r){return e.setVariable(r,t)})),this.addHook("afterColumnSort",(function(){return e.onAfterColumnSort.apply(e,arguments)})),this.addHook("afterCreateCol",(function(){return e.onAfterCreateCol.apply(e,arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow.apply(e,arguments)})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData()})),this.addHook("afterRemoveCol",(function(){return e.onAfterRemoveCol.apply(e,arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow.apply(e,arguments)})),this.addHook("afterSetDataAtCell",(function(){return e.onAfterSetDataAtCell.apply(e,arguments)})),this.addHook("afterSetDataAtRowProp",(function(){return e.onAfterSetDataAtCell.apply(e,arguments)})),this.addHook("beforeColumnSort",(function(){return e.onBeforeColumnSort.apply(e,arguments)})),this.addHook("beforeCreateCol",(function(){return e.onBeforeCreateCol.apply(e,arguments)})),this.addHook("beforeCreateRow",(function(){return e.onBeforeCreateRow.apply(e,arguments)})),this.addHook("beforeRemoveCol",(function(){return e.onBeforeRemoveCol.apply(e,arguments)})),this.addHook("beforeRemoveRow",(function(){return e.onBeforeRemoveRow.apply(e,arguments)})),this.addHook("beforeValidate",(function(){return e.onBeforeValidate.apply(e,arguments)})),this.addHook("beforeValueRender",(function(){return e.onBeforeValueRender.apply(e,arguments)})),this.addHook("modifyData",(function(){return e.onModifyData.apply(e,arguments)})),this.sheet.addLocalHook("afterRecalculate",(function(){return e.onSheetAfterRecalculate.apply(e,arguments)})),_get$M(_getPrototypeOf$1e(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){_get$M(_getPrototypeOf$1e(r.prototype),"disablePlugin",this).call(this)}},{key:"getCellValue",value:function(e,t){var r=this.sheet.getCellAt(e,t);return r?r.getError()||r.getValue():void 0}},{key:"hasComputedCellValue",value:function(e,t){return null!==this.sheet.getCellAt(e,t)}},{key:"recalculate",value:function(){this.sheet.recalculate()}},{key:"recalculateFull",value:function(){this.sheet.recalculateFull()}},{key:"recalculateOptimized",value:function(){this.sheet.recalculateOptimized()}},{key:"setVariable",value:function(e,t){this.sheet.setVariable(e,t)}},{key:"getVariable",value:function(e){return this.sheet.getVariable(e)}},{key:"onSheetAfterRecalculate",value:function(e){if(this._skipRendering)this._skipRendering=!1;else{var t=this.hot;arrayEach(e,(function(e){if(e instanceof CellValue){var r=e.row,n=e.column;t.validateCell(t.getDataAtCell(r,n),t.getCellMeta(r,n),(function(){}))}})),t.render()}}},{key:"onModifyData",value:function(e,t,r,n){"get"===n&&this.hasComputedCellValue(e,t)?r.value=this.getCellValue(e,t):"set"===n&&isFormulaExpression(r.value)&&(r.value=toUpperCaseFormula(r.value))}},{key:"onBeforeValueRender",value:function(e){var t=e;return isFormulaExpressionEscaped(t)&&(t=unescapeFormulaExpression(t)),t}},{key:"onBeforeValidate",value:function(e,t,r){var n=this.hot.propToCol(r),o=e;return this.hasComputedCellValue(t,n)&&(o=this.getCellValue(t,n)),o}},{key:"onAfterSetDataAtCell",value:function(e,t){var r=this;"loadData"!==t&&(this.dataProvider.clearChanges(),arrayEach(e,(function(e){var t=_slicedToArray$E(e,4),n=t[0],o=t[1],i=t[2],a=t[3],s=r.hot.propToCol(o),l=r.hot.toPhysicalRow(n),u=a;isFormulaExpression(u)&&(u=toUpperCaseFormula(u)),r.dataProvider.collectChanges(l,s,u),i!==u&&r.sheet.applyChanges(l,s,u)})),this.recalculate())}},{key:"onBeforeCreateRow",value:function(e,t,r){"UndoRedo.undo"===r&&this.undoRedoSnapshot.restore()}},{key:"onAfterCreateRow",value:function(e,t,r){this.sheet.alterManager.triggerAlter("insert_row",e,t,"UndoRedo.undo"!==r)}},{key:"onBeforeRemoveRow",value:function(e,t){this.undoRedoSnapshot.save("row",e,t)}},{key:"onAfterRemoveRow",value:function(e,t){this.sheet.alterManager.triggerAlter("remove_row",e,t)}},{key:"onBeforeCreateCol",value:function(e,t,r){"UndoRedo.undo"===r&&this.undoRedoSnapshot.restore()}},{key:"onAfterCreateCol",value:function(e,t,r){this.sheet.alterManager.triggerAlter("insert_column",e,t,"UndoRedo.undo"!==r)}},{key:"onBeforeRemoveCol",value:function(e,t){this.undoRedoSnapshot.save("column",e,t)}},{key:"onAfterRemoveCol",value:function(e,t){this.sheet.alterManager.triggerAlter("remove_column",e,t)}},{key:"onBeforeColumnSort",value:function(e,t){this.sheet.alterManager.prepareAlter("column_sorting",e,t)}},{key:"onAfterColumnSort",value:function(e,t){this.sheet.alterManager.triggerAlter("column_sorting",e,t)}},{key:"onAfterLoadData",value:function(){this._skipRendering=!0,this.recalculateFull()}},{key:"destroy",value:function(){this.dataProvider.destroy(),this.dataProvider=null,this.sheet.destroy(),this.sheet=null,_get$M(_getPrototypeOf$1e(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);function _typeof$1p(e){return(_typeof$1p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$2x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2q(e,t,r){return t&&_defineProperties$2q(e.prototype,t),r&&_defineProperties$2q(e,r),e}function _get$N(e,t,r){return(_get$N="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$N(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$N(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1f(e)););return e}function _inherits$1f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$1g(e,t)}function _setPrototypeOf$1g(e,t){return(_setPrototypeOf$1g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$1f(e){var t=_isNativeReflectConstruct$1g();return function(){var r,n=_getPrototypeOf$1f(e);if(t){var o=_getPrototypeOf$1f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$1f(this,r)}}function _possibleConstructorReturn$1f(e,t){return!t||"object"!==_typeof$1p(t)&&"function"!=typeof t?_assertThisInitialized$1f(e):t}function _assertThisInitialized$1f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$1f(e){return(_getPrototypeOf$1f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}registerPlugin("formulas",Formulas);var isDeprecationMessageShowed=!1,HeaderTooltips=function(e){_inherits$1f(r,e);var t=_createSuper$1f(r);function r(e){var n;return _classCallCheck$2x(this,r),(n=t.call(this,e)).settings=null,n}return _createClass$2q(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().headerTooltips}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(isDeprecationMessageShowed||(isDeprecationMessageShowed=!0,warn("The Header Tooltips plugin is deprecated and will be removed in the next major release")),this.settings=this.hot.getSettings().headerTooltips,this.parseSettings(),this.addHook("afterGetColHeader",(function(t,r){return e.onAfterGetHeader(t,r)})),this.addHook("afterGetRowHeader",(function(t,r){return e.onAfterGetHeader(t,r)})),_get$N(_getPrototypeOf$1f(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.settings=null,this.clearTitleAttributes(),_get$N(_getPrototypeOf$1f(r.prototype),"disablePlugin",this).call(this)}},{key:"parseSettings",value:function(){"boolean"==typeof this.settings&&(this.settings={rows:!0,columns:!0,onlyTrimmed:!1})}},{key:"clearTitleAttributes",value:function(){var e=this.hot.view.wt.getSetting("columnHeaders").length,t=this.hot.view.wt.wtTable.THEAD,r=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topLeftCornerOverlay,o=n?n.clone.wtTable.THEAD:null;rangeEach(0,e-1,(function(e){var n=t.childNodes[e],i=r.childNodes[e],a=o?o.childNodes[e]:null;rangeEach(0,n.childNodes.length-1,(function(e){n.childNodes[e].removeAttribute("title"),i&&i.childNodes[e]&&i.childNodes[e].removeAttribute("title"),o&&a&&a.childNodes[e]&&a.childNodes[e].removeAttribute("title")}))}))}},{key:"onAfterGetHeader",value:function(e,t){var r=t.querySelector("span"),n="THEAD"===t.parentNode.parentNode.nodeName;(n&&this.settings.columns||!n&&this.settings.rows)&&(this.settings.onlyTrimmed?outerWidth(r)>=outerWidth(t)&&0!==outerWidth(r)&&t.setAttribute("title",r.textContent):t.setAttribute("title",r.textContent))}},{key:"destroy",value:function(){this.settings=null,_get$N(_getPrototypeOf$1f(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);registerPlugin("headerTooltips",HeaderTooltips);var HEADER_DEFAULT_SETTINGS={label:"",colspan:1,origColspan:1,collapsible:!1,isCollapsed:!1,isHidden:!1,isBlank:!1},HEADER_CONFIGURABLE_PROPS=["label","collapsible"];function _toConsumableArray$k(e){return _arrayWithoutHoles$k(e)||_iterableToArray$m(e)||_unsupportedIterableToArray$V(e)||_nonIterableSpread$k()}function _nonIterableSpread$k(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$V(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$V(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$V(e,t):void 0}}function _iterableToArray$m(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$k(e){if(Array.isArray(e))return _arrayLikeToArray$V(e)}function _arrayLikeToArray$V(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ownKeys$a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$9(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$a(Object(r),!0).forEach((function(t){_defineProperty$j(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$j(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function normalizeSettings(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,r=[];if(0===t)return r;arrayEach(e,(function(e){var n=[],o=0;r.push(n),arrayEach(e,(function(e){var r=_objectSpread$9({},HEADER_DEFAULT_SETTINGS);if(isObject$1(e)){var i=e.label,a=e.colspan;r.label=stringify(i),"number"==typeof a&&a>1&&(r.colspan=a,r.origColspan=a)}else r.label=stringify(e);var s=!1;if((o+=r.origColspan)>=t&&(r.colspan=r.origColspan-(o-t),r.origColspan=r.colspan,s=!0),n.push(r),r.colspan>1)for(var l=0;l<r.colspan-1;l++)n.push(_objectSpread$9(_objectSpread$9({},HEADER_DEFAULT_SETTINGS),{},{isHidden:!0,isBlank:!0}));return!s}))}));var n=Math.max.apply(Math,_toConsumableArray$k(arrayMap(r,(function(e){return e.length}))));return arrayEach(r,(function(e){if(e.length<n){var t=arrayMap(new Array(n-e.length),(function(){return _objectSpread$9({},HEADER_DEFAULT_SETTINGS)}));e.splice.apply(e,[e.length,0].concat(_toConsumableArray$k(t)))}})),r}function ownKeys$b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$b(Object(r),!0).forEach((function(t){_defineProperty$k(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$k(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectWithoutProperties$6(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose$6(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _objectWithoutPropertiesLoose$6(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}function _classCallCheck$2y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2r(e,t,r){return t&&_defineProperties$2r(e.prototype,t),r&&_defineProperties$2r(e,r),e}function _classPrivateFieldGet(e,t){var r=t.get(e);if(!r)throw new TypeError("attempted to get private field on non-instance");return r.get?r.get.call(e):r.value}function _classPrivateFieldSet(e,t,r){var n=t.get(e);if(!n)throw new TypeError("attempted to set private field on non-instance");if(n.set)n.set.call(e,r);else{if(!n.writable)throw new TypeError("attempted to set read only private field");n.value=r}return r}var _data=new WeakMap,_dataLength=new WeakMap,_columnsLimit=new WeakMap,SourceSettings=function(){function e(){_classCallCheck$2y(this,e),_data.set(this,{writable:!0,value:[]}),_dataLength.set(this,{writable:!0,value:0}),_columnsLimit.set(this,{writable:!0,value:1/0})}return _createClass$2r(e,[{key:"setColumnsLimit",value:function(e){_classPrivateFieldSet(this,_columnsLimit,e)}},{key:"setData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_classPrivateFieldSet(this,_data,normalizeSettings(e,_classPrivateFieldGet(this,_columnsLimit))),_classPrivateFieldSet(this,_dataLength,_classPrivateFieldGet(this,_data).length)}},{key:"getData",value:function(){return _classPrivateFieldGet(this,_data)}},{key:"mergeWith",value:function(e){var t=this;arrayEach(e,(function(e){var r=e.row,n=e.col,o=_objectWithoutProperties$6(e,["row","col"]),i=t.getHeaderSettings(r,n);null!==i&&extend(i,o,HEADER_CONFIGURABLE_PROPS)}))}},{key:"map",value:function(e){arrayEach(_classPrivateFieldGet(this,_data),(function(t){arrayEach(t,(function(t){var r=e(_objectSpread$a({},t));isObject$1(r)&&extend(t,r,HEADER_CONFIGURABLE_PROPS)}))}))}},{key:"getHeaderSettings",value:function(e,t){var r;if(e>=_classPrivateFieldGet(this,_dataLength)||e<0)return null;var n=_classPrivateFieldGet(this,_data)[e];return t>=n.length?null:null!==(r=n[t])&&void 0!==r?r:null}},{key:"getHeadersSettings",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=[];if(e>=_classPrivateFieldGet(this,_dataLength)||e<0)return n;for(var o=_classPrivateFieldGet(this,_data)[e],i=0,a=t;a<o.length;a++){var s=o[a];if(!0===s.isHidden)throw new Error("The first column settings cannot overlap the other header layers");if(i+=s.colspan,n.push(s),s.colspan>1&&(a+=s.colspan-1),i===r)break;if(i>r)throw new Error("The last column settings cannot overlap the other header layers")}return n}},{key:"getLayersCount",value:function(){return _classPrivateFieldGet(this,_dataLength)}},{key:"getColumnsCount",value:function(){return _classPrivateFieldGet(this,_dataLength)>0?_classPrivateFieldGet(this,_data)[0].length:0}},{key:"clear",value:function(){_classPrivateFieldSet(this,_data,[]),_classPrivateFieldSet(this,_dataLength,0)}}]),e}();function ownKeys$c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$c(Object(r),!0).forEach((function(t){_defineProperty$l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _classCallCheck$2z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2s(e,t,r){return t&&_defineProperties$2s(e.prototype,t),r&&_defineProperties$2s(e,r),e}function _defineProperty$l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toConsumableArray$l(e){return _arrayWithoutHoles$l(e)||_iterableToArray$n(e)||_unsupportedIterableToArray$W(e)||_nonIterableSpread$l()}function _nonIterableSpread$l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$W(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$W(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$W(e,t):void 0}}function _iterableToArray$n(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$l(e){if(Array.isArray(e))return _arrayLikeToArray$W(e)}function _arrayLikeToArray$W(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var TRAVERSAL_DF_PRE="DF-pre-order";function depthFirstPreOrder(e,t){for(var r=e.call(t,this),n=0;n<this.childs.length;n++){if(!1===r)return!1;r=depthFirstPreOrder.call(this.childs[n],e,t)}return r}var TRAVERSAL_DF_POST="DF-post-order";function depthFirstPostOrder(e,t){for(var r=0;r<this.childs.length;r++){if(!1===depthFirstPostOrder.call(this.childs[r],e,t))return!1}return e.call(t,this)}var TRAVERSAL_BF="BF";function breadthFirst(e,t){var r=[this];!function n(){if(0!==r.length){var o=r.shift();r.push.apply(r,_toConsumableArray$l(o.childs)),!1!==e.call(t,o)&&n()}}()}var DEFAULT_TRAVERSAL_STRATEGY=TRAVERSAL_BF,TRAVERSAL_STRATEGIES=new Map([[TRAVERSAL_DF_PRE,depthFirstPreOrder],[TRAVERSAL_DF_POST,depthFirstPostOrder],[TRAVERSAL_BF,breadthFirst]]),TreeNode=function(){function e(t){_classCallCheck$2z(this,e),_defineProperty$l(this,"data",{}),_defineProperty$l(this,"parent",null),_defineProperty$l(this,"childs",[]),this.data=t}return _createClass$2s(e,[{key:"addChild",value:function(e){e.parent=this,this.childs.push(e)}},{key:"cloneTree",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,r=new e(_objectSpread$b({},t.data)),n=0;n<t.childs.length;n++)r.addChild(this.cloneTree(t.childs[n]));return r}},{key:"replaceTreeWith",value:function(e){this.data=_objectSpread$b({},e.data),this.childs=[];for(var t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}},{key:"walkDown",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:DEFAULT_TRAVERSAL_STRATEGY;if(!TRAVERSAL_STRATEGIES.has(t))throw new Error('Traversal strategy "'.concat(t,'" does not exist'));TRAVERSAL_STRATEGIES.get(t).call(this,e,this)}},{key:"walkUp",value:function(e){var t=this;!function r(n){!1!==e.call(t,n)&&null!==n.parent&&r(n.parent)}(this)}}]),e}();function ownKeys$d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$d(Object(r),!0).forEach((function(t){_defineProperty$m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _slicedToArray$F(e,t){return _arrayWithHoles$H(e)||_iterableToArrayLimit$F(e,t)||_unsupportedIterableToArray$X(e,t)||_nonIterableRest$H()}function _nonIterableRest$H(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$X(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$X(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$X(e,t):void 0}}function _arrayLikeToArray$X(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$F(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$H(e){if(Array.isArray(e))return e}function _classCallCheck$2A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2t(e,t,r){return t&&_defineProperties$2t(e.prototype,t),r&&_defineProperties$2t(e,r),e}function _classPrivateFieldGet$1(e,t){var r=t.get(e);if(!r)throw new TypeError("attempted to get private field on non-instance");return r.get?r.get.call(e):r.value}function _classPrivateFieldSet$1(e,t,r){var n=t.get(e);if(!n)throw new TypeError("attempted to set private field on non-instance");if(n.set)n.set.call(e,r);else{if(!n.writable)throw new TypeError("attempted to set read only private field");n.value=r}return r}var _rootNodes=new WeakMap,_rootsIndex=new WeakMap,_sourceSettings=new WeakMap,HeadersTree=function(){function e(t){_classCallCheck$2A(this,e),_rootNodes.set(this,{writable:!0,value:new Map}),_rootsIndex.set(this,{writable:!0,value:new Map}),_sourceSettings.set(this,{writable:!0,value:null}),_classPrivateFieldSet$1(this,_sourceSettings,t)}return _createClass$2t(e,[{key:"getRoots",value:function(){return Array.from(_classPrivateFieldGet$1(this,_rootNodes).values())}},{key:"getRootByColumn",value:function(e){var t;return _classPrivateFieldGet$1(this,_rootsIndex).has(e)&&(t=_classPrivateFieldGet$1(this,_rootNodes).get(_classPrivateFieldGet$1(this,_rootsIndex).get(e))),t}},{key:"getNode",value:function(e,t){var r=this.getRootByColumn(t);if(r){var n,o=t-_classPrivateFieldGet$1(this,_rootsIndex).get(t),i=0;return r.walkDown((function(t){var r=t.data,a=r.origColspan,s=r.headerLevel;if(e===s){if(o>=i&&o<=i+a-1)return n=t,!1;i+=a}})),n}}},{key:"rebuildTreeIndex",value:function(){var e=this,t=0;_classPrivateFieldGet$1(this,_rootsIndex).clear(),arrayEach(_classPrivateFieldGet$1(this,_rootNodes),(function(r){for(var n=_slicedToArray$F(r,2)[1].data.colspan,o=t;o<t+n;o++)_classPrivateFieldGet$1(e,_rootsIndex).set(o,t);t+=n}))}},{key:"buildTree",value:function(){this.clear();for(var e=_classPrivateFieldGet$1(this,_sourceSettings).getColumnsCount(),t=0;t<e;){var r=_classPrivateFieldGet$1(this,_sourceSettings).getHeaderSettings(0,t),n=new TreeNode;_classPrivateFieldGet$1(this,_rootNodes).set(t,n),this.buildLeaves(n,t,0,r.origColspan),t+=r.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(e,t,r){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=_classPrivateFieldGet$1(this,_sourceSettings).getHeadersSettings(r,t,o);r+=1,arrayEach(i,(function(o){var i,a=_objectSpread$c(_objectSpread$c({},o),{},{headerLevel:r-1,columnIndex:t});1===r?(e.data=a,i=e):(i=new TreeNode(a),e.addChild(i)),r<_classPrivateFieldGet$1(n,_sourceSettings).getLayersCount()&&n.buildLeaves(i,t,r,o.origColspan),t+=o.origColspan}))}},{key:"clear",value:function(){_classPrivateFieldGet$1(this,_rootNodes).clear(),_classPrivateFieldGet$1(this,_rootsIndex).clear()}}]),e}();function _classCallCheck$2B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2u(e,t,r){return t&&_defineProperties$2u(e.prototype,t),r&&_defineProperties$2u(e,r),e}function _defineProperty$n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var NodeModifiers=function(){function e(){_classCallCheck$2B(this,e)}return _createClass$2u(e,[{key:"collapseNode",value:function(e){var t,r=this,n=e.data,o=e.childs;if(!0===n.isCollapsed||!0===n.isHidden||n.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};if(isNodeReflectsFirstChildColspan(e))return this.collapseNode(o[0]);n.isCollapsed=!0;var i=o.slice(1),a=new Set;if(i.length>0)arrayEach(i,(function(e){traverseHiddenNodeColumnIndexes(e,(function(e){a.add(e)})),e.data.clonedTree=e.cloneTree(),e.walkDown((function(e){e.data.isHidden=!0}))}));else for(var s=1;s<n.origColspan;s++)a.add(n.columnIndex+s);var l=n.colspan-(null!==(t=getFirstChildProperty(e,"colspan"))&&void 0!==t?t:1);return e.walkUp((function(e){var t=e.data;t.colspan-=l,t.colspan<=1?(t.colspan=1,t.isCollapsed=!0):isNodeReflectsFirstChildColspan(e)&&(t.isCollapsed=getFirstChildProperty(e,"isCollapsed"))})),{rollbackModification:function(){return r.expandNode(e)},affectedColumns:Array.from(a),colspanCompensation:l}}},{key:"expandNode",value:function(e){var t=this,r=e.data,n=e.childs;if(!1===r.isCollapsed||!0===r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};if(isNodeReflectsFirstChildColspan(e))return this.expandNode(n[0]);r.isCollapsed=!1;var o=n.slice(1),i=new Set,a=0;if(o.length>0)arrayEach(o,(function(e){e.replaceTreeWith(e.data.clonedTree),e.data.clonedTree=null;var t=e.data;a+=t.colspan,traverseHiddenNodeColumnIndexes(e,(function(e){i.add(e)}))}));else{var s=r.colspan,l=r.origColspan,u=r.columnIndex;a=l-s;for(var c=1;c<l;c++)i.add(u+c)}return e.walkUp((function(e){var t=e.data;t.colspan+=a,t.colspan>=t.origColspan?(t.colspan=t.origColspan,t.isCollapsed=!1):isNodeReflectsFirstChildColspan(e)&&(t.isCollapsed=getFirstChildProperty(e,"isCollapsed"))})),{rollbackModification:function(){return t.collapseNode(e)},affectedColumns:Array.from(i),colspanCompensation:a}}},{key:"triggerAction",value:function(t,r){if(!e.AVAILABLE_ACTIONS.includes(t))throw new Error('The node modifier action ("'.concat(t,'") does not exist.'));return this["".concat(t,"Node")](r)}}]),e}();function traverseHiddenNodeColumnIndexes(e,t){e.walkDown((function(e){var r=e.data,n=e.childs;if(!r.isHidden&&(t(r.columnIndex),0===n.length))for(var o=1;o<r.colspan;o++)t(r.columnIndex+o)}))}function getFirstChildProperty(e,t){var r=e.childs;if(0!==r.length)return r[0].data[t]}function isNodeReflectsFirstChildColspan(e){return getFirstChildProperty(e,"origColspan")===e.data.origColspan}function ownKeys$e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$e(Object(r),!0).forEach((function(t){_defineProperty$o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$e(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function generateMatrix(e){var t=[];return arrayEach(e,(function(e){e.walkDown((function(e){var r=e.data,n=r.colspan,o=r.origColspan,i=r.label,a=r.isHidden,s=r.headerLevel,l=r.collapsible,u=r.isCollapsed,c=createNestedArrayIfNecessary(t,s);if(c.push({label:i,colspan:n,origColspan:o,collapsible:l,isCollapsed:u,isHidden:a,isBlank:!1}),o>1)for(var f=0;f<o-1;f++)c.push(_objectSpread$d(_objectSpread$d({},HEADER_DEFAULT_SETTINGS),{},{origColspan:o,isHidden:!0,isBlank:!0}))}))})),t}function createNestedArrayIfNecessary(e,t){var r;return Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r),r}function ownKeys$f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread$e(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$f(Object(r),!0).forEach((function(t){_defineProperty$p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys$f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty$p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _objectWithoutProperties$7(e,t){if(null==e)return{};var r,n,o=_objectWithoutPropertiesLoose$7(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _objectWithoutPropertiesLoose$7(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}function _classCallCheck$2C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2v(e,t,r){return t&&_defineProperties$2v(e.prototype,t),r&&_defineProperties$2v(e,r),e}function _classPrivateFieldSet$2(e,t,r){var n=t.get(e);if(!n)throw new TypeError("attempted to set private field on non-instance");if(n.set)n.set.call(e,r);else{if(!n.writable)throw new TypeError("attempted to set read only private field");n.value=r}return r}function _classPrivateFieldGet$2(e,t){var r=t.get(e);if(!r)throw new TypeError("attempted to get private field on non-instance");return r.get?r.get.call(e):r.value}_defineProperty$n(NodeModifiers,"AVAILABLE_ACTIONS",["collapse","expand"]);var _sourceSettings$1=new WeakMap,_nodeModifiers=new WeakMap,_headersTree=new WeakMap,_stateMatrix=new WeakMap,StateManager=function(){function e(){_classCallCheck$2C(this,e),_sourceSettings$1.set(this,{writable:!0,value:new SourceSettings}),_nodeModifiers.set(this,{writable:!0,value:new NodeModifiers}),_headersTree.set(this,{writable:!0,value:new HeadersTree(_classPrivateFieldGet$2(this,_sourceSettings$1))}),_stateMatrix.set(this,{writable:!0,value:[[]]})}return _createClass$2v(e,[{key:"setState",value:function(e){_classPrivateFieldGet$2(this,_sourceSettings$1).setData(e);var t=!1;try{_classPrivateFieldGet$2(this,_headersTree).buildTree()}catch(e){_classPrivateFieldGet$2(this,_headersTree).clear(),_classPrivateFieldGet$2(this,_sourceSettings$1).clear(),t=!0}return _classPrivateFieldSet$2(this,_stateMatrix,generateMatrix(_classPrivateFieldGet$2(this,_headersTree).getRoots())),t}},{key:"setColumnsLimit",value:function(e){_classPrivateFieldGet$2(this,_sourceSettings$1).setColumnsLimit(e)}},{key:"mergeStateWith",value:function(e){var t=this,r=arrayMap(e,(function(e){var r=e.row,n=_objectWithoutProperties$7(e,["row"]);return _objectSpread$e({row:r<0?t.rowCoordsToLevel(r):r},n)}));_classPrivateFieldGet$2(this,_sourceSettings$1).mergeWith(r),_classPrivateFieldGet$2(this,_headersTree).buildTree(),_classPrivateFieldSet$2(this,_stateMatrix,generateMatrix(_classPrivateFieldGet$2(this,_headersTree).getRoots()))}},{key:"mapState",value:function(e){_classPrivateFieldGet$2(this,_sourceSettings$1).map(e),_classPrivateFieldGet$2(this,_headersTree).buildTree(),_classPrivateFieldSet$2(this,_stateMatrix,generateMatrix(_classPrivateFieldGet$2(this,_headersTree).getRoots()))}},{key:"mapNodes",value:function(e){return arrayReduce(_classPrivateFieldGet$2(this,_headersTree).getRoots(),(function(t,r){return r.walkDown((function(r){var n=e(r.data);void 0!==n&&t.push(n)})),t}),[])}},{key:"triggerNodeModification",value:function(e,t,r){t<0&&(t=this.rowCoordsToLevel(t));var n,o=_classPrivateFieldGet$2(this,_headersTree).getNode(t,r);return o&&(n=_classPrivateFieldGet$2(this,_nodeModifiers).triggerAction(e,o),_classPrivateFieldSet$2(this,_stateMatrix,generateMatrix(_classPrivateFieldGet$2(this,_headersTree).getRoots()))),n}},{key:"rowCoordsToLevel",value:function(e){var t=Math.max(this.getLayersCount(),1),r=t-1;return Math.min(Math.max(e+t,0),r)}},{key:"levelToRowCoords",value:function(e){var t=Math.max(this.getLayersCount(),1),r=-t;return Math.min(Math.max(e-t,r),-1)}},{key:"getHeaderSettings",value:function(e,t){var r,n;return e<0&&(e=this.rowCoordsToLevel(e)),e>=this.getLayersCount()?_objectSpread$e({},HEADER_DEFAULT_SETTINGS):null!==(r=null===(n=_classPrivateFieldGet$2(this,_stateMatrix)[e])||void 0===n?void 0:n[t])&&void 0!==r?r:_objectSpread$e({},HEADER_DEFAULT_SETTINGS)}},{key:"findLeftMostColumnIndex",value:function(e,t){if(!1===this.getHeaderSettings(e,t).isBlank)return t;var r=t-1;do{if(!1===this.getHeaderSettings(e,r).isBlank)break;r-=1}while(t>=0);return r}},{key:"getLayersCount",value:function(){return _classPrivateFieldGet$2(this,_sourceSettings$1).getLayersCount()}},{key:"getColumnsCount",value:function(){return _classPrivateFieldGet$2(this,_sourceSettings$1).getColumnsCount()}},{key:"clear",value:function(){_classPrivateFieldSet$2(this,_stateMatrix,[]),_classPrivateFieldGet$2(this,_sourceSettings$1).clear(),_classPrivateFieldGet$2(this,_headersTree).clear()}}]),e}();function _classCallCheck$2D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2w(e,t,r){return t&&_defineProperties$2w(e.prototype,t),r&&_defineProperties$2w(e,r),e}var GhostTable$1=function(){function e(t){_classCallCheck$2D(this,e),this.nestedHeaders=t,this.container=void 0,this.widthsCache=[]}return _createClass$2w(e,[{key:"buildWidthsMapper",value:function(){this.container=this.nestedHeaders.hot.rootDocument.createElement("div"),this.buildGhostTable(this.container),this.nestedHeaders.hot.rootElement.appendChild(this.container);var e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsCache.length=0;for(var r=0;r<t;r++)this.widthsCache.push(e[r].offsetWidth);this.container.parentNode.removeChild(this.container),this.container=null,this.nestedHeaders.hot.render()}},{key:"buildGhostTable",value:function(e){for(var t=this.nestedHeaders.hot.rootDocument,r=t.createDocumentFragment(),n=t.createElement("table"),o=!1,i=!!this.nestedHeaders.hot.getSettings().dropdownMenu,a=this.nestedHeaders.getLayersCount(),s=this.nestedHeaders.hot.countCols(),l=a-1,u=0;u<a;u++){var c=t.createElement("tr");o=!1;for(var f=0;f<s;f++){var h=t.createElement("th"),d=clone(this.nestedHeaders.getHeaderSettings(u,f));d&&!d.isHidden&&(u===l&&(d.colspan>1&&(o=!0),i&&(d.label+='<button class="changeType"></button>')),fastInnerHTML(h,d.label),h.colSpan=d.colspan,c.appendChild(h))}n.appendChild(c)}if(o){for(var p=t.createElement("tr"),y=0;y<s;y++){var g=t.createElement("th");p.appendChild(g)}n.appendChild(p)}r.appendChild(n),e.appendChild(r)}},{key:"clear",value:function(){this.container=null,this.widthsCache.length=0}}]),e}();function _typeof$1q(e){return(_typeof$1q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _slicedToArray$G(e,t){return _arrayWithHoles$I(e)||_iterableToArrayLimit$G(e,t)||_unsupportedIterableToArray$Y(e,t)||_nonIterableRest$I()}function _nonIterableRest$I(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$Y(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$Y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$Y(e,t):void 0}}function _arrayLikeToArray$Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$G(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$I(e){if(Array.isArray(e))return e}function _templateObject2$3(){var e=_taggedTemplateLiteral$b(["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration \n                        is currently not supported."],["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20\n                        is currently not supported."]);return _templateObject2$3=function(){return e},e}function _templateObject$b(){var e=_taggedTemplateLiteral$b(["Your Nested Headers plugin configuration is invalid. The settings has to be \n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]"],["Your Nested Headers plugin configuration is invalid. The settings has to be\\x20\n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]"]);return _templateObject$b=function(){return e},e}function _taggedTemplateLiteral$b(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _classCallCheck$2E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2x(e,t,r){return t&&_defineProperties$2x(e.prototype,t),r&&_defineProperties$2x(e,r),e}function _get$O(e,t,r){return(_get$O="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$O(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$O(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1g(e)););return e}function _inherits$1g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$1h(e,t)}function _setPrototypeOf$1h(e,t){return(_setPrototypeOf$1h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$1g(e){var t=_isNativeReflectConstruct$1h();return function(){var r,n=_getPrototypeOf$1g(e);if(t){var o=_getPrototypeOf$1g(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$1g(this,r)}}function _possibleConstructorReturn$1g(e,t){return!t||"object"!==_typeof$1q(t)&&"function"!=typeof t?_assertThisInitialized$1g(e):t}function _assertThisInitialized$1g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$1g(e){return(_getPrototypeOf$1g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _defineProperty$q(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classPrivateFieldSet$3(e,t,r){var n=t.get(e);if(!n)throw new TypeError("attempted to set private field on non-instance");if(n.set)n.set.call(e,r);else{if(!n.writable)throw new TypeError("attempted to set read only private field");n.value=r}return r}function _classPrivateFieldGet$3(e,t){var r=t.get(e);if(!r)throw new TypeError("attempted to get private field on non-instance");return r.get?r.get.call(e):r.value}var _stateManager=new WeakMap,NestedHeaders=function(e){_inherits$1g(r,e);var t=_createSuper$1g(r);function r(){var e;_classCallCheck$2E(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),_stateManager.set(_assertThisInitialized$1g(e),{writable:!0,value:new StateManager}),_defineProperty$q(_assertThisInitialized$1g(e),"ghostTable",new GhostTable$1(_assertThisInitialized$1g(e))),_defineProperty$q(_assertThisInitialized$1g(e),"detectedOverlappedHeaders",!1),e}return _createClass$2x(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().nestedHeaders}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().nestedHeaders;Array.isArray(t)&&Array.isArray(t[0])||warn(toSingleLine(_templateObject$b())),this.addHook("init",(function(){return e.onInit()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("afterOnCellMouseDown",(function(t,r){return e.onAfterOnCellMouseDown(t,r)})),this.addHook("beforeOnCellMouseOver",(function(t,r,n,o){return e.onBeforeOnCellMouseOver(t,r,n,o)})),this.addHook("afterGetColumnHeaderRenderers",(function(t){return e.onAfterGetColumnHeaderRenderers(t)})),this.addHook("modifyColWidth",(function(t,r){return e.onModifyColWidth(t,r)})),this.addHook("afterViewportColumnCalculatorOverride",(function(t){return e.onAfterViewportColumnCalculatorOverride(t)})),_get$O(_getPrototypeOf$1g(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){var e=this.hot.getSettings().nestedHeaders;_classPrivateFieldGet$3(this,_stateManager).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=_classPrivateFieldGet$3(this,_stateManager).setState(e)),this.detectedOverlappedHeaders&&warn(toSingleLine(_templateObject2$3())),this.ghostTable.buildWidthsMapper(),_get$O(_getPrototypeOf$1g(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),_classPrivateFieldGet$3(this,_stateManager).clear(),this.ghostTable.clear(),_get$O(_getPrototypeOf$1g(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return _classPrivateFieldGet$3(this,_stateManager)}},{key:"getLayersCount",value:function(){return _classPrivateFieldGet$3(this,_stateManager).getLayersCount()}},{key:"getHeaderSettings",value:function(e,t){return _classPrivateFieldGet$3(this,_stateManager).getHeaderSettings(e,t)}},{key:"getColumnHeaders",value:function(e,t){var r=this.hot.view.wt.wtOverlays,n=this.hot.columnIndexMapper.getRenderableFromVisualIndex(e),o=[];return null!==n&&(r.topOverlay&&o.push(r.topOverlay.clone.wtTable.getColumnHeader(n,t)),r.topLeftCornerOverlay&&o.push(r.topLeftCornerOverlay.clone.wtTable.getColumnHeader(n,t))),o}},{key:"clearColspans",value:function(){if(this.hot.view)for(var e=this.hot.view.wt,t=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,n=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topLeftCornerOverlay?e.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,i=0;i<t;i++){var a=r.childNodes[i];if(!a)break;for(var s=n.childNodes[i],l=o?o.childNodes[i]:null,u=0,c=a.childNodes.length;u<c;u++)a.childNodes[u].removeAttribute("colspan"),removeClass(a.childNodes[u],"hiddenHeader"),s&&s.childNodes[u]&&(s.childNodes[u].removeAttribute("colspan"),removeClass(s.childNodes[u],"hiddenHeader")),o&&l&&l.childNodes[u]&&(l.childNodes[u].removeAttribute("colspan"),removeClass(l.childNodes[u],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(e){var t=this,r=this.hot.getSettings().fixedColumnsLeft||0;return function(n,o){var i=t.hot,a=i.rootDocument,s=i.columnIndexMapper,l=i.view,u=s.getVisualFromRenderableIndex(n);null===u&&(u=n),o.removeAttribute("colspan"),removeClass(o,"hiddenHeader");var c=_classPrivateFieldGet$3(t,_stateManager).getHeaderSettings(e,u),f=c.colspan,h=c.label;if(!0===c.isHidden)addClass(o,"hiddenHeader");else if(f>1){var d,p,y=null===(d=l.wt.wtOverlays.topLeftCornerOverlay)||void 0===d?void 0:d.clone.wtTable.THEAD.contains(o),g=null===(p=l.wt.wtOverlays.leftOverlay)||void 0===p?void 0:p.clone.wtTable.THEAD.contains(o),m=y||g?Math.min(f,r-u):f;m>1&&o.setAttribute("colspan",m)}var v=a.createElement("div"),_=a.createElement("span");addClass(v,"relative"),addClass(_,"colHeader"),fastInnerHTML(_,h),v.appendChild(_),empty$1(o),o.appendChild(v),t.hot.runHooks("afterGetColHeader",u,o)}}},{key:"updateHeadersHighlight",value:function(){var e=this,t=this.hot,r=t.getSelectedRange();if(void 0!==r){var n=this.hot.getSettings(),o=function(e){return function(t,r){return function(){return t?r(t,e):null}}},i=o(n.currentHeaderClassName),a=o(n.activeHeaderClassName),s=t.selection.isSelectedByColumnHeader()||t.selection.isSelectedByCorner(),l=_classPrivateFieldGet$3(this,_stateManager).getLayersCount(),u=new Map,c=new Map;arrayEach(r,(function(t){for(var r=t.getTopLeftCorner(),n=t.getTopRightCorner(),o=_classPrivateFieldGet$3(e,_stateManager).findLeftMostColumnIndex(-1,r.col),f=n.col,h=f-o+1,d=0,p=o;p<=f;p++){for(var y=function(t){var r=_classPrivateFieldGet$3(e,_stateManager).getHeaderSettings(t,p),n=r.colspan,o=r.isHidden,f=t===l-1,y=!f&&d+n>h;arrayEach(e.getColumnHeaders(p,t),(function(e){y||o?(u.set(e,a(e,removeClass)),c.set(e,i(e,removeClass))):s?(u.set(e,a(e,addClass)),c.set(e,i(e,addClass))):f?c.set(e,i(e,addClass)):c.set(e,i(e,removeClass))}))},g=l-1;g>-1;g--)y(g);d+=1}})),arrayEach(u,(function(e){(0,_slicedToArray$G(e,2)[1])()})),arrayEach(c,(function(e){(0,_slicedToArray$G(e,2)[1])()})),u.clear(),c.clear()}}},{key:"onAfterOnCellMouseDown",value:function(e,t){if(t.row<0){var r=_classPrivateFieldGet$3(this,_stateManager).getHeaderSettings(t.row,t.col).origColspan;r>1&&this.hot.selection.selectColumns(t.col,t.col+r-1)}}},{key:"onBeforeOnCellMouseOver",value:function(e,t,r,n){if(!(t.row>=0||t.col<0)&&this.hot.view.isMouseDown()){var o=this.hot.getSelectedRangeLast(),i=o.from,a=o.to,s=_classPrivateFieldGet$3(this,_stateManager).getHeaderSettings(t.row,t.col).origColspan,l=t.col+s-1,u=!1;if(i.col<=a.col?(t.col<i.col&&l===a.col||t.col<i.col&&l<i.col||t.col<i.col&&l>=i.col&&l<a.col)&&(u=!0):(t.col<a.col&&l>i.col||t.col>i.col||t.col<=a.col&&l>i.col||t.col>a.col&&l>i.col)&&(u=!0),u){var c=[a.col,i.col];i.col=c[0],a.col=c[1]}if(s>1){var f;n.column=!0,n.cell=!0;var h=[];i.col===a.col&&(l<=i.col&&t.col<i.col?h.push(a.col,t.col):h.push(t.col<i.col?t.col:i.col,l>a.col?l:a.col)),i.col<a.col&&h.push(t.col<i.col?t.col:i.col,l),i.col>a.col&&h.push(i.col,t.col),(f=this.hot).selectColumns.apply(f,h)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(e){if(e){e.length=0;for(var t=0;t<_classPrivateFieldGet$3(this,_stateManager).getLayersCount();t++)e.push(this.headerRendererFactory(t))}this.updateHeadersHighlight()}},{key:"onAfterViewportColumnCalculatorOverride",value:function(e){for(var t=e.startColumn,r=0;r<_classPrivateFieldGet$3(this,_stateManager).getLayersCount();r++){var n=_classPrivateFieldGet$3(this,_stateManager).findLeftMostColumnIndex(r,e.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(n);if(o<e.startColumn){t=o;break}}e.startColumn=t}},{key:"onModifyColWidth",value:function(e,t){var r=this.ghostTable.widthsCache[t];return e>r?e:r}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(e,t){t||this.updatePlugin()}},{key:"destroy",value:function(){_classPrivateFieldSet$3(this,_stateManager,null),_get$O(_getPrototypeOf$1g(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);function _typeof$1r(e){return(_typeof$1r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray$m(e){return _arrayWithoutHoles$m(e)||_iterableToArray$o(e)||_unsupportedIterableToArray$Z(e)||_nonIterableSpread$m()}function _nonIterableSpread$m(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$Z(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$Z(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$Z(e,t):void 0}}function _iterableToArray$o(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$m(e){if(Array.isArray(e))return _arrayLikeToArray$Z(e)}function _arrayLikeToArray$Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$2F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2y(e,t,r){return t&&_defineProperties$2y(e.prototype,t),r&&_defineProperties$2y(e,r),e}function _get$P(e,t,r){return(_get$P="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$P(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$P(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1h(e)););return e}function _inherits$1h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$1i(e,t)}function _setPrototypeOf$1i(e,t){return(_setPrototypeOf$1i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$1h(e){var t=_isNativeReflectConstruct$1i();return function(){var r,n=_getPrototypeOf$1h(e);if(t){var o=_getPrototypeOf$1h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$1h(this,r)}}function _possibleConstructorReturn$1h(e,t){return!t||"object"!==_typeof$1r(t)&&"function"!=typeof t?_assertThisInitialized$1h(e):t}function _assertThisInitialized$1h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$1h(e){return(_getPrototypeOf$1h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _defineProperty$r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classPrivateFieldGet$4(e,t){var r=t.get(e);if(!r)throw new TypeError("attempted to get private field on non-instance");return r.get?r.get.call(e):r.value}function _classPrivateFieldSet$4(e,t,r){var n=t.get(e);if(!n)throw new TypeError("attempted to set private field on non-instance");if(n.set)n.set.call(e,r);else{if(!n.writable)throw new TypeError("attempted to set read only private field");n.value=r}return r}registerPlugin("nestedHeaders",NestedHeaders);var actionDictionary=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),_collapsedColumnsMap=new WeakMap,CollapsibleColumns=function(e){_inherits$1h(r,e);var t=_createSuper$1h(r);function r(){var e;_classCallCheck$2F(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return _defineProperty$r(_assertThisInitialized$1h(e=t.call.apply(t,[this].concat(o))),"nestedHeadersPlugin",null),_defineProperty$r(_assertThisInitialized$1h(e),"eventManager",new EventManager(_assertThisInitialized$1h(e))),_defineProperty$r(_assertThisInitialized$1h(e),"headerStateManager",null),_collapsedColumnsMap.set(_assertThisInitialized$1h(e),{writable:!0,value:null}),e}return _createClass$2y(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().collapsibleColumns}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.hot.getSettings().nestedHeaders||warn("You need to configure the Nested Headers plugin in order to use collapsible headers."),_classPrivateFieldSet$4(this,_collapsedColumnsMap,new HidingMap),this.hot.columnIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$4(this,_collapsedColumnsMap)),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",(function(){return e.onInit()})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("afterGetColHeader",(function(t,r){return e.onAfterGetColHeader(t,r)})),this.addHook("beforeOnCellMouseDown",(function(t,r,n){return e.onBeforeOnCellMouseDown(t,r,n)})),_get$P(_getPrototypeOf$1h(r.prototype),"enablePlugin",this).call(this),this.updatePlugin())}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var e=this.hot.getSettings().collapsibleColumns;"boolean"==typeof e?this.headerStateManager.mapState((function(e){return{collapsible:e.origColspan>1}})):Array.isArray(e)&&this.headerStateManager.mergeStateWith(e)}_get$P(_getPrototypeOf$1h(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),_classPrivateFieldSet$4(this,_collapsedColumnsMap,null),this.nestedHeadersPlugin=null,this.clearButtons(),_get$P(_getPrototypeOf$1h(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var e=this.hot.view.wt.getSetting("columnHeaders").length,t=this.hot.view.wt.wtTable.THEAD,r=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,o=function(e){e&&e.parentNode.removeChild(e)};rangeEach(0,e-1,(function(e){var i=t.childNodes[e],a=r.childNodes[e],s=n?n.childNodes[e]:null;rangeEach(0,i.childNodes.length-1,(function(e){var t=i.childNodes[e].querySelector(".collapsibleIndicator");o(t),a&&a.childNodes[e]&&(t=a.childNodes[e].querySelector(".collapsibleIndicator"),o(t)),n&&s&&s.childNodes[e]&&(t=s.childNodes[e].querySelector(".collapsibleIndicator"),o(t))}))}))}}},{key:"expandSection",value:function(e){this.toggleCollapsibleSection([e],"expand")}},{key:"collapseSection",value:function(e){this.toggleCollapsibleSection([e],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(e){var t=this,r=this.headerStateManager.mapNodes((function(e){var r=e.collapsible,n=e.origColspan,o=e.headerLevel,i=e.columnIndex;if(!0===r&&n>1)return{row:t.headerStateManager.levelToRowCoords(o),col:i}}));this.toggleCollapsibleSection(r,e)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(e,t){var r=this;if(!actionDictionary.has(t))throw new Error("Unsupported action is passed (".concat(t,")."));if(Array.isArray(e)){var n=arrayFilter(e,(function(e){return e.row<0})),o=n.length>0;arrayEach(n,(function(e){var n=e.row,i=e.col,a=r.headerStateManager.getHeaderSettings(n,i),s=a.collapsible,l=a.isCollapsed;if(!s||l&&"collapse"===t||!l&&"expand"===t)return o=!1,!1}));var i=[],a=[];o&&arrayEach(n,(function(e){var n=e.row,o=e.col,s=r.headerStateManager.triggerNodeModification(t,n,o),l=s.colspanCompensation,u=s.affectedColumns,c=s.rollbackModification;l>0&&(a.push.apply(a,_toConsumableArray$m(u)),i.push(c))}));var s=this.getCollapsedColumns(),l=[];"collapse"===t?l=arrayUnique([].concat(_toConsumableArray$m(s),a)):"expand"===t&&(l=arrayFilter(s,(function(e){return!a.includes(e)})));var u=actionDictionary.get(t);if(!1!==this.hot.runHooks(u.beforeHook,s,l,o)){this.hot.batch((function(){arrayEach(a,(function(e){_classPrivateFieldGet$4(r,_collapsedColumnsMap).setValueAtIndex(r.hot.toPhysicalColumn(e),u.hideColumn)}))}));var c=this.getCollapsedColumns().length!==s.length;this.hot.runHooks(u.afterHook,s,l,o,c),this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize(!0)}else arrayEach(i,(function(e){e()}))}}},{key:"getCollapsedColumns",value:function(){return _classPrivateFieldGet$4(this,_collapsedColumnsMap).getHiddenIndexes()}},{key:"generateIndicator",value:function(e,t){var r=this.hot.rootDocument.createElement("div"),n=this.headerStateManager.getHeaderSettings(e,t);return addClass(r,"collapsibleIndicator"),n.isCollapsed?(addClass(r,"collapsed"),fastInnerText(r,"+")):(addClass(r,"expanded"),fastInnerText(r,"-")),r}},{key:"onAfterGetColHeader",value:function(e,t){var r=t.parentNode,n=r.parentNode,o=-1*n.childNodes.length+Array.prototype.indexOf.call(n.childNodes,r),i=this.headerStateManager.getHeaderSettings(o,e),a=i.collapsible,s=i.origColspan;if(a&&s>1&&e>=this.hot.getSettings().fixedColumnsLeft){var l=this.generateIndicator(o,e);t.querySelector("div:first-child").appendChild(l)}}},{key:"onBeforeOnCellMouseDown",value:function(e,t){hasClass(e.target,"collapsibleIndicator")&&(hasClass(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):hasClass(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),stopImmediatePropagation(e))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(e,t){t||this.updatePlugin()}},{key:"destroy",value:function(){_classPrivateFieldSet$4(this,_collapsedColumnsMap,null),this.hot.columnIndexMapper.unregisterMap(this.pluginName),_get$P(_getPrototypeOf$1h(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);function _toConsumableArray$n(e){return _arrayWithoutHoles$n(e)||_iterableToArray$p(e)||_unsupportedIterableToArray$_(e)||_nonIterableSpread$n()}function _nonIterableSpread$n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$_(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$_(e,t):void 0}}function _iterableToArray$p(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$n(e){if(Array.isArray(e))return _arrayLikeToArray$_(e)}function _arrayLikeToArray$_(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _typeof$1s(e){return(_typeof$1s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$2G(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2z(e,t,r){return t&&_defineProperties$2z(e.prototype,t),r&&_defineProperties$2z(e,r),e}registerPlugin("collapsibleColumns",CollapsibleColumns);var DataManager=function(){function e(t,r){_classCallCheck$2G(this,e),this.hot=r,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return _createClass$2z(e,[{key:"setData",value:function(e){this.data=e}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var e;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}},{key:"updateWithData",value:function(e){this.setData(e),this.rewriteCache()}},{key:"rewriteCache",value:function(){var e=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},rangeEach(0,this.data.length-1,(function(t){e.cacheNode(e.data[t],0,null)}))}},{key:"cacheNode",value:function(e,t,r){var n=this;this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&arrayEach(e.__children,(function(r){n.cacheNode(r,t+1,e)}))}},{key:"getDataObject",value:function(e){return null==e?null:this.cache.rows[e]}},{key:"readTreeNodes",value:function(e,t,r,n){var o=this,i=!1,a=t;if(isNaN(a)&&a.end)return a;var s=e;return s||(s={__children:this.data},i=!0,a-=1),null!=r&&a===r?{result:s,end:!0}:null!=n&&s===n?{result:a,end:!0}:(a+=1,s.__children&&arrayEach(s.__children,(function(e){if(o.parentReference.set(e,i?null:s),a=o.readTreeNodes(e,a,r,n),isNaN(a)&&a.end)return!1})),a)}},{key:"mockParent",value:function(){var e=this.mockNode();return e.__children=this.data,e}},{key:"mockNode",value:function(){var e={};return objectEach(this.data[0],(function(t,r){e[r]=null})),e}},{key:"getRowIndex",value:function(e){return null==e?null:this.cache.nodeInfo.get(e).row}},{key:"getRowIndexWithinParent",value:function(e){var t=null;t=isNaN(e)?e:this.getDataObject(e);var r=this.getRowParent(e);return null==r?this.data.indexOf(t):r.__children.indexOf(t)}},{key:"countAllRows",value:function(){var e={__children:this.data};return this.countChildren(e)}},{key:"countChildren",value:function(e){var t=this,r=0,n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&n.__children?(arrayEach(n.__children,(function(e){r+=1,e.__children&&(r+=t.countChildren(e))})),r):0}},{key:"getRowParent",value:function(e){var t;return t=isNaN(e)?e:this.getDataObject(e),this.getRowObjectParent(t)}},{key:"getRowObjectParent",value:function(e){return e&&"object"===_typeof$1s(e)?this.cache.nodeInfo.get(e).parent:null}},{key:"getRowLevel",value:function(e){var t=null;return(t=isNaN(e)?e:this.getDataObject(e))?this.getRowObjectLevel(t):null}},{key:"getRowObjectLevel",value:function(e){return null==e?null:this.cache.nodeInfo.get(e).level}},{key:"hasChildren",value:function(e){var t=e;return isNaN(t)||(t=this.getDataObject(t)),!(!t.__children||!t.__children.length)}},{key:"isChild",value:function(e){return null!==this.getRowParent(e)}},{key:"isRowHighestLevel",value:function(e){return!this.isChild(e)}},{key:"isParent",value:function(e){var t,r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&0!==(null===(t=r.__children)||void 0===t?void 0:t.length)}},{key:"addChild",value:function(e,t){var r=t;this.hot.runHooks("beforeAddChild",e,r);var n=null;e&&(n=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",n+this.countChildren(e)+1,1);var o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();var i=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(i,1),this.hot.runHooks("afterCreateRow",i,1),this.hot.runHooks("afterAddChild",e,r)}},{key:"addChildAtIndex",value:function(e,t,r){var n=r;n||(n=this.mockNode()),this.hot.runHooks("beforeAddChild",e,n,t),e?(this.hot.runHooks("beforeCreateRow",t,1),e.__children.splice(t,null,n),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",t,1)):(this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers()),this.updateWithData(this.getRawSourceData()),n=this.getDataObject(t),this.hot.runHooks("afterAddChild",e,n,t)}},{key:"addSibling",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below",r=this.translateTrimmedRow(e),n=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(t){case"below":this.addChildAtIndex(n,o+1,null);break;case"above":this.addChildAtIndex(n,o,null)}}},{key:"detachFromParent",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=null,o=[];Array.isArray(e)?(rangeEach(e[0],e[2],(function(e){var r=t.translateTrimmedRow(e);o.push(t.getDataObject(r))})),rangeEach(0,o.length-2,(function(e){t.detachFromParent(o[e],!1)})),n=o[o.length-1]):n=e;var i=this.getRowIndex(n),a=this.getRowIndexWithinParent(n),s=this.getRowParent(n),l=this.getRowParent(s),u=this.getRowIndex(l),c=null;this.hot.runHooks("beforeDetachChild",s,n),null!=a&&(this.hot.runHooks("beforeRemoveRow",i,1,[i],this.plugin.pluginName),s.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,1,[i],this.plugin.pluginName),l?(c=u+this.countChildren(l),this.hot.runHooks("beforeCreateRow",c,1,this.plugin.pluginName),l.__children.push(n)):(c=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",c,1,this.plugin.pluginName),this.data.push(n))),this.rewriteCache(),this.hot.runHooks("afterCreateRow",c,1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",s,n),r&&this.hot.render()}},{key:"filterData",value:function(e,t,r){var n=this,o=[];arrayEach(r,(function(e){o.push(n.getDataObject(e))})),arrayEach(o,(function(e){var t=n.getRowIndexWithinParent(e),r=n.getRowParent(e);null===r?n.data.splice(t,1):r.__children.splice(t,1)})),this.rewriteCache()}},{key:"spliceData",value:function(e,t,r){var n,o=this.getDataObject(e-1),i=null,a=e;if(o&&o.__children&&0===o.__children.length?(i=o,a=0):e<this.countAllRows()&&(i=this.getRowParent(e),a=this.getRowIndexWithinParent(e)),i)r?(n=i.__children).splice.apply(n,[a,t].concat(_toConsumableArray$n(r))):i.__children.splice(a,t);else if(r){var s;(s=this.data).splice.apply(s,[a,t].concat(_toConsumableArray$n(r)))}else this.data.splice(a,t);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(e){var t=e,r=null;do{null!==(r=this.getRowParent(r))&&(t=r)}while(null!==r);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource",!0),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=t===this.hot.countRows(),a=this.getRowParent(e),s=this.getRowIndexWithinParent(e),l=a.__children.slice(s,s+1),u=e>t,c=i?this.getRowParent(t-1):this.getRowParent(t);null==c&&(c=this.getRowParent(t-1)),null==c&&(c=this.getDataObject(t-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(t)).__children=[];var f=i||r||n?c.__children.length:this.getRowIndexWithinParent(t),h=a===c;c.__children.splice(f,0,l[0]),a.__children.splice(s+(u&&h?1:0),1),this.syncRowWithRawSource(a),h||this.syncRowWithRawSource(c),o||this.hot.render()}},{key:"translateTrimmedRow",value:function(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}},{key:"untranslateTrimmedRow",value:function(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}]),e}();function _classCallCheck$2H(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var BaseUI$3=function e(t,r){_classCallCheck$2H(this,e),this.hot=r,this.plugin=t};function _typeof$1t(e){return(_typeof$1t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$2I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2A(e,t,r){return t&&_defineProperties$2A(e.prototype,t),r&&_defineProperties$2A(e,r),e}function _inherits$1i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$1j(e,t)}function _setPrototypeOf$1j(e,t){return(_setPrototypeOf$1j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$1i(e){var t=_isNativeReflectConstruct$1j();return function(){var r,n=_getPrototypeOf$1i(e);if(t){var o=_getPrototypeOf$1i(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$1i(this,r)}}function _possibleConstructorReturn$1i(e,t){return!t||"object"!==_typeof$1t(t)&&"function"!=typeof t?_assertThisInitialized$1i(e):t}function _assertThisInitialized$1i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1j(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$1i(e){return(_getPrototypeOf$1i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var HeadersUI=function(e){_inherits$1i(r,e);var t=_createSuper$1i(r);function r(e,n){var o;return _classCallCheck$2I(this,r),(o=t.call(this,e,n)).dataManager=o.plugin.dataManager,o.collapsingUI=o.plugin.collapsingUI,o.rowHeaderWidthCache=null,o}return _createClass$2A(r,null,[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),_createClass$2A(r,[{key:"appendLevelIndicators",value:function(e,t){var n=this.hot.toPhysicalRow(e),o=this.dataManager.getRowLevel(n),i=this.dataManager.getDataObject(n),a=t.getElementsByTagName("DIV")[0],s=a.querySelector("span.rowHeader");if(arrayEach(a.querySelectorAll('[class^="ht_nesting"]'),(function(e){e&&a.removeChild(e)})),addClass(t,r.CSS_CLASSES.indicatorContainer),o){var l=this.hot.rootDocument,u=s.cloneNode(!0);a.innerHTML="",rangeEach(0,o-1,(function(){var e=l.createElement("SPAN");addClass(e,r.CSS_CLASSES.emptyIndicator),a.appendChild(e)})),a.appendChild(u)}if(this.dataManager.hasChildren(i)){var c=this.hot.rootDocument.createElement("DIV");addClass(t,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?addClass(c,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):addClass(c,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),a.appendChild(c)}}},{key:"updateRowHeaderWidth",value:function(e){var t=e;t||(t=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}}]),r}(BaseUI$3);function _typeof$1u(e){return(_typeof$1u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray$o(e){return _arrayWithoutHoles$o(e)||_iterableToArray$q(e)||_unsupportedIterableToArray$$(e)||_nonIterableSpread$o()}function _nonIterableSpread$o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$$(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$$(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$$(e,t):void 0}}function _iterableToArray$q(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$o(e){if(Array.isArray(e))return _arrayLikeToArray$$(e)}function _arrayLikeToArray$$(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$2J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2B(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2B(e,t,r){return t&&_defineProperties$2B(e.prototype,t),r&&_defineProperties$2B(e,r),e}function _inherits$1j(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$1k(e,t)}function _setPrototypeOf$1k(e,t){return(_setPrototypeOf$1k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$1j(e){var t=_isNativeReflectConstruct$1k();return function(){var r,n=_getPrototypeOf$1j(e);if(t){var o=_getPrototypeOf$1j(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$1j(this,r)}}function _possibleConstructorReturn$1j(e,t){return!t||"object"!==_typeof$1u(t)&&"function"!=typeof t?_assertThisInitialized$1j(e):t}function _assertThisInitialized$1j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1k(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$1j(e){return(_getPrototypeOf$1j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var CollapsingUI=function(e){_inherits$1j(r,e);var t=_createSuper$1j(r);function r(e,n){var o;return _classCallCheck$2J(this,r),(o=t.call(this,e,n)).dataManager=o.plugin.dataManager,o.collapsedRows=[],o.collapsedRowsStash={stash:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];o.lastCollapsedRows=o.collapsedRows.slice(0),o.expandMultipleChildren(o.lastCollapsedRows,e)},shiftStash:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null==t&&(t=1/0),arrayEach(o.lastCollapsedRows,(function(n,i){n>=e&&n<t&&(o.lastCollapsedRows[i]=n+r)}))},applyStash:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];o.collapseMultipleChildren(o.lastCollapsedRows,e),o.lastCollapsedRows=void 0},trimStash:function(e,t){rangeEach(e,e+t-1,(function(e){var t=o.lastCollapsedRows.indexOf(e);t>-1&&o.lastCollapsedRows.splice(t,1)}))}},o}return _createClass$2B(r,[{key:"collapseChildren",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[],i=null,a=null,s=null;return isNaN(e)?(i=e,a=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(e),a=e),this.dataManager.hasChildren(i)&&arrayEach(i.__children,(function(e){o.push(t.dataManager.getRowIndex(e))})),s=this.collapseRows(o,!0,!1),n&&this.trimRows(s),r&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(a)&&this.collapsedRows.push(a),s}},{key:"collapseMultipleChildren",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[];arrayEach(e,(function(e){o.push.apply(o,_toConsumableArray$o(t.collapseChildren(e,!1,!1)))})),n&&this.trimRows(o),r&&this.renderAndAdjust()}},{key:"collapseRow",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([e],t)}},{key:"collapseRows",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];return arrayEach(e,(function(e){o.push(e),r&&t.collapseChildRows(e,o)})),n&&this.trimRows(o),o}},{key:"collapseChildRows",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){var o=this.dataManager.getDataObject(e);arrayEach(o.__children,(function(e){var n=t.dataManager.getRowIndex(e);r.push(n),t.collapseChildRows(n,r)}))}n&&this.trimRows(r)}},{key:"expandRow",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([e],t)}},{key:"expandRows",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];return arrayEach(e,(function(e){o.push(e),r&&t.expandChildRows(e,o)})),n&&this.untrimRows(o),o}},{key:"expandChildRows",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){var o=this.dataManager.getDataObject(e);arrayEach(o.__children,(function(e){if(!t.isAnyParentCollapsed(e)){var n=t.dataManager.getRowIndex(e);r.push(n),t.expandChildRows(n,r)}}))}n&&this.untrimRows(r)}},{key:"expandChildren",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[],i=null,a=null,s=null;return isNaN(e)?(i=e,a=this.dataManager.getRowIndex(e)):(i=this.dataManager.getDataObject(e),a=e),this.collapsedRows.splice(this.collapsedRows.indexOf(a),1),this.dataManager.hasChildren(i)&&arrayEach(i.__children,(function(e){var r=t.dataManager.getRowIndex(e);o.push(r)})),s=this.expandRows(o,!0,!1),n&&this.untrimRows(s),r&&this.renderAndAdjust(),s}},{key:"expandMultipleChildren",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[];arrayEach(e,(function(e){o.push.apply(o,_toConsumableArray$o(t.expandChildren(e,!1,!1)))})),n&&this.untrimRows(o),r&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var e=this,t=this.dataManager.getData(),r=[];arrayEach(t,(function(t){e.dataManager.hasChildren(t)&&r.push(t)})),this.collapseMultipleChildren(r),this.renderAndAdjust()}},{key:"expandAll",value:function(){var e=this,t=this.dataManager.getData(),r=[];arrayEach(t,(function(t){e.dataManager.hasChildren(t)&&r.push(t)})),this.expandMultipleChildren(r),this.renderAndAdjust()}},{key:"trimRows",value:function(e){var t=this;this.hot.batch((function(){arrayEach(e,(function(e){t.plugin.collapsedRowsMap.setValueAtIndex(e,!0)}))}))}},{key:"untrimRows",value:function(e){var t=this;this.hot.batch((function(){arrayEach(e,(function(e){t.plugin.collapsedRowsMap.setValueAtIndex(e,!1)}))}))}},{key:"areChildrenCollapsed",value:function(e){var t=this,r=isNaN(e)?e:this.dataManager.getDataObject(e),n=!0;return null===r&&(r={__children:this.dataManager.data}),this.dataManager.hasChildren(r)&&arrayEach(r.__children,(function(e){var r=t.dataManager.getRowIndex(e);if(!t.plugin.collapsedRowsMap.getValueAtIndex(r))return n=!1,!1})),n}},{key:"isAnyParentCollapsed",value:function(e){for(var t=e;null!==t;){t=this.dataManager.getRowParent(t);var r=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}},{key:"toggleState",value:function(e,t){if(!(t.col>=0)){var r=this.translateTrimmedRow(t.row);hasClass(e.target,HeadersUI.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),stopImmediatePropagation(e))}}},{key:"translateTrimmedRow",value:function(e){return this.hot.toPhysicalRow(e)}},{key:"untranslateTrimmedRow",value:function(e){return this.hot.toVisualRow(e)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize()}}]),r}(BaseUI$3);function _typeof$1v(e){return(_typeof$1v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$2K(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2C(e,t,r){return t&&_defineProperties$2C(e.prototype,t),r&&_defineProperties$2C(e,r),e}function _inherits$1k(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$1l(e,t)}function _setPrototypeOf$1l(e,t){return(_setPrototypeOf$1l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$1k(e){var t=_isNativeReflectConstruct$1l();return function(){var r,n=_getPrototypeOf$1k(e);if(t){var o=_getPrototypeOf$1k(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$1k(this,r)}}function _possibleConstructorReturn$1k(e,t){return!t||"object"!==_typeof$1v(t)&&"function"!=typeof t?_assertThisInitialized$1k(e):t}function _assertThisInitialized$1k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$1k(e){return(_getPrototypeOf$1k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var privatePool$k=new WeakMap,ContextMenuUI=function(e){_inherits$1k(r,e);var t=_createSuper$1k(r);function r(e,n){var o;return _classCallCheck$2K(this,r),o=t.call(this,e,n),privatePool$k.set(_assertThisInitialized$1k(o),{row_above:function(e,t){var r=t[t.length-1];o.dataManager.addSibling(r.start.row,"above")},row_below:function(e,t){var r=t[t.length-1];o.dataManager.addSibling(r.start.row,"below")}}),o.dataManager=o.plugin.dataManager,o}return _createClass$2C(r,[{key:"appendOptions",value:function(e){var t=this,r=[{key:"add_child",name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:function(){var e=t.dataManager.translateTrimmedRow(t.hot.getSelectedLast()[0]),r=t.dataManager.getDataObject(e);t.dataManager.addChild(r)},disabled:function(){var e=t.hot.getSelectedLast();return!e||e[0]<0||t.hot.selection.isSelectedByColumnHeader()||t.hot.countRows()>=t.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:function(){t.dataManager.detachFromParent(t.hot.getSelectedLast())},disabled:function(){var e=t.hot.getSelectedLast(),r=t.dataManager.translateTrimmedRow(e[0]);return!t.dataManager.getRowParent(r)||!e||e[0]<0||t.hot.selection.isSelectedByColumnHeader()||t.hot.countRows()>=t.hot.getSettings().maxRows}},{name:"---------"}];return rangeEach(0,e.items.length-1,(function(t){if(0===t)return arrayEach(r,(function(r,n){e.items.splice(t+n,0,r)})),!1})),this.modifyRowInsertingOptions(e)}},{key:"modifyRowInsertingOptions",value:function(e){var t=privatePool$k.get(this);return rangeEach(0,e.items.length-1,(function(r){var n=t[e.items[r].key];null!=n&&(e.items[r].callback=n)})),e}}]),r}(BaseUI$3);function _toConsumableArray$p(e){return _arrayWithoutHoles$p(e)||_iterableToArray$r(e)||_unsupportedIterableToArray$10(e)||_nonIterableSpread$p()}function _nonIterableSpread$p(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$10(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$10(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$10(e,t):void 0}}function _iterableToArray$r(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$p(e){if(Array.isArray(e))return _arrayLikeToArray$10(e)}function _arrayLikeToArray$10(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _templateObject$c(){var e=_taggedTemplateLiteral$c(["Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows \n      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead."],["Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20\n      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead."]);return _templateObject$c=function(){return e},e}function _taggedTemplateLiteral$c(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _classCallCheck$2L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2D(e,t,r){return t&&_defineProperties$2D(e.prototype,t),r&&_defineProperties$2D(e,r),e}var RowMoveController=function(){function e(t){_classCallCheck$2L(this,e),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}return _createClass$2D(e,[{key:"onBeforeRowMove",value:function(e,t,r,n){var o=this;if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:r,movePossible:n}))return!1;this.movedToCollapsed=!1;var i=r===this.hot.countRows(),a=i?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r),s=!0,l=e.map((function(e){if(!s)return!1;var t=o.dataManager.translateTrimmedRow(e);return s=o.shouldAllowMoving(t,a),t})),u=-1===l.indexOf(a);if(!s||!u)return!1;var c=this.getBaseParent(l),f=this.getTargetParent(i,a),h=c===f;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(f),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(l,a,h),this.moveRows(l,a,f),this.dataManager.updateWithData(this.dataManager.getRawSourceData()),this.moveCellsMeta(l,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,r,n,n&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,r),!1}},{key:"displayAPICompatibilityWarning",value:function(e){var t=e.rows,r=e.finalIndex,n=e.dropIndex,o=e.movePossible,i=!1;return isUndefined(n)&&(warn(toSingleLine(_templateObject$c())),this.hot.runHooks("afterRowMove",t,r,n,o,!1),i=!0),i}},{key:"shouldAllowMoving",value:function(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||0===t)}},{key:"getBaseParent",value:function(e){return this.dataManager.getRowParent(e[0])}},{key:"getTargetParent",value:function(e,t){var r=this.dataManager.getRowParent(e?t-1:t);return null==r&&(r=this.dataManager.getRowParent(t-1)),r}},{key:"shiftCollapsibleParentsLocations",value:function(e,t,r){r||(Math.max.apply(Math,_toConsumableArray$p(e))<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}},{key:"moveRows",value:function(e,t,r){var n=this,o=t===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;e.forEach((function(e){n.dataManager.moveRow(e,t,n.movedToCollapsed,o,!0)}))}},{key:"moveCellsMeta",value:function(e,t){var r,n=this,o=[],i=Math.max.apply(Math,_toConsumableArray$p(e))<t;e.forEach((function(e){o.push(n.hot.getCellMetaAtRow(e))})),this.hot.spliceCellsMeta(e[0],e.length),(r=this.hot).spliceCellsMeta.apply(r,[t-(i?o.length:0),0].concat(o))}},{key:"selectCells",value:function(e,t){var r,n=e.length,o=0,i=0,a=null;if(this.movedToCollapsed){var s=null;s=e[n-1]<t?this.dataManager.translateTrimmedRow(t-n):this.dataManager.translateTrimmedRow(t);var l=this.dataManager.getRowParent(null===s?this.hot.countSourceRows()-1:s-1),u=this.dataManager.getRowIndex(l);i=o=this.dataManager.untranslateTrimmedRow(u)}else e[n-1]<t?o=(i=t-1)-n+1:i=(o=t)+n-1;a=this.hot.selection,r=this.hot.countCols()-1,a.setRangeStart(new CellCoords(o,0)),a.setRangeEnd(new CellCoords(i,r),!0)}},{key:"isRowOrderChanged",value:function(e,t){return e.some((function(e,r){return e-r!==t}))}}]),e}();function _typeof$1w(e){return(_typeof$1w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray$q(e){return _arrayWithoutHoles$q(e)||_iterableToArray$s(e)||_unsupportedIterableToArray$11(e)||_nonIterableSpread$q()}function _nonIterableSpread$q(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$11(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$11(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$11(e,t):void 0}}function _iterableToArray$s(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$q(e){if(Array.isArray(e))return _arrayLikeToArray$11(e)}function _arrayLikeToArray$11(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _classCallCheck$2M(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2E(e,t,r){return t&&_defineProperties$2E(e.prototype,t),r&&_defineProperties$2E(e,r),e}function _get$Q(e,t,r){return(_get$Q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$Q(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$Q(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1l(e)););return e}function _inherits$1l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$1m(e,t)}function _setPrototypeOf$1m(e,t){return(_setPrototypeOf$1m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$1l(e){var t=_isNativeReflectConstruct$1m();return function(){var r,n=_getPrototypeOf$1l(e);if(t){var o=_getPrototypeOf$1l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$1l(this,r)}}function _possibleConstructorReturn$1l(e,t){return!t||"object"!==_typeof$1w(t)&&"function"!=typeof t?_assertThisInitialized$1l(e):t}function _assertThisInitialized$1l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$1l(e){return(_getPrototypeOf$1l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var privatePool$l=new WeakMap,NestedRows=function(e){_inherits$1l(r,e);var t=_createSuper$1l(r);function r(e){var n;return _classCallCheck$2M(this,r),(n=t.call(this,e)).dataManager=null,n.headersUI=null,n.collapsedRowsMap=null,privatePool$l.set(_assertThisInitialized$1l(n),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),n}return _createClass$2E(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().nestedRows}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.bindRowsWithHeadersPlugin=this.hot.getPlugin("bindRowsWithHeaders"),this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new TrimmingMap),this.dataManager=new DataManager(this,this.hot),this.collapsingUI=new CollapsingUI(this,this.hot),this.headersUI=new HeadersUI(this,this.hot),this.contextMenuUI=new ContextMenuUI(this,this.hot),this.rowMoveController=new RowMoveController(this),this.addHook("afterInit",(function(){return e.onAfterInit.apply(e,arguments)})),this.addHook("beforeRender",(function(){return e.onBeforeRender.apply(e,arguments)})),this.addHook("modifyRowData",(function(){return e.onModifyRowData.apply(e,arguments)})),this.addHook("modifySourceLength",(function(){return e.onModifySourceLength.apply(e,arguments)})),this.addHook("beforeDataSplice",(function(){return e.onBeforeDataSplice.apply(e,arguments)})),this.addHook("beforeDataFilter",(function(){return e.onBeforeDataFilter.apply(e,arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return e.onAfterContextMenuDefaultOptions.apply(e,arguments)})),this.addHook("afterGetRowHeader",(function(){return e.onAfterGetRowHeader.apply(e,arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return e.onBeforeOnCellMouseDown.apply(e,arguments)})),this.addHook("beforeRemoveRow",(function(){return e.onBeforeRemoveRow.apply(e,arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow.apply(e,arguments)})),this.addHook("beforeAddChild",(function(){return e.onBeforeAddChild.apply(e,arguments)})),this.addHook("afterAddChild",(function(){return e.onAfterAddChild.apply(e,arguments)})),this.addHook("beforeDetachChild",(function(){return e.onBeforeDetachChild.apply(e,arguments)})),this.addHook("afterDetachChild",(function(){return e.onAfterDetachChild.apply(e,arguments)})),this.addHook("modifyRowHeaderWidth",(function(){return e.onModifyRowHeaderWidth.apply(e,arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow.apply(e,arguments)})),this.addHook("beforeRowMove",(function(){return e.onBeforeRowMove.apply(e,arguments)})),this.addHook("beforeLoadData",(function(t){return e.onBeforeLoadData(t)})),_get$Q(_getPrototypeOf$1l(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),_get$Q(_getPrototypeOf$1l(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var e=this.hot.getSourceData();this.enablePlugin(),this.dataManager.updateWithData(e),_get$Q(_getPrototypeOf$1l(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(e,t,r,n){return this.rowMoveController.onBeforeRowMove(e,t,r,n)}},{key:"disableCoreAPIModifiers",value:function(){privatePool$l.get(this).skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){privatePool$l.get(this).skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(e,t,r){this.collapsingUI.toggleState(e,t,r)}},{key:"onModifyRowData",value:function(e){if(!privatePool$l.get(this).skipCoreAPIModifiers)return this.dataManager.getDataObject(e)}},{key:"onModifySourceLength",value:function(){if(!privatePool$l.get(this).skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(e,t,r){return!(!privatePool$l.get(this).skipCoreAPIModifiers&&!this.dataManager.isRowHighestLevel(e))||(this.dataManager.spliceData(e,t,r),!1)}},{key:"onBeforeDataFilter",value:function(e,t,r){var n=privatePool$l.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(r[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(r[0],null,-1*t),this.dataManager.filterData(e,t,r),n.skipRender=!0,!1}},{key:"onAfterContextMenuDefaultOptions",value:function(e){return this.contextMenuUI.appendOptions(e)}},{key:"onAfterGetRowHeader",value:function(e,t){this.headersUI.appendLevelIndicators(e,t)}},{key:"onModifyRowHeaderWidth",value:function(e){return this.headersUI.rowHeaderWidthCache||e}},{key:"onAfterRemoveRow",value:function(e,t,r,n){var o=this;if(n!==this.pluginName){var i=privatePool$l.get(this);setTimeout((function(){i.skipRender=null,o.headersUI.updateRowHeaderWidth(),o.collapsingUI.collapsedRowsStash.applyStash()}),0)}}},{key:"onBeforeRemoveRow",value:function(e,t,r){var n=this,o=Array.from(r.reduce((function(e,t){if(n.dataManager.isParent(t)){var r=n.dataManager.getDataObject(t).__children;return e.add(t),Array.isArray(r)&&r.forEach((function(t){return e.add(n.dataManager.getRowIndex(t))})),e}return e.add(t)}),new Set));r.length=0,r.push.apply(r,_toConsumableArray$q(o))}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t),null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(e,t,r){r!==this.pluginName&&this.dataManager.updateWithData(this.dataManager.getRawSourceData())}},{key:"onAfterInit",value:function(){var e=Math.max.apply(Math,_toConsumableArray$q(this.dataManager.cache.levels));e>0&&this.headersUI.updateRowHeaderWidth(e)}},{key:"onBeforeRender",value:function(e,t){privatePool$l.get(this).skipRender&&(t.skipRender=!0)}},{key:"destroy",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),_get$Q(_getPrototypeOf$1l(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(e){this.dataManager.setData(e),this.dataManager.rewriteCache()}}]),r}(BasePlugin);function _slicedToArray$H(e,t){return _arrayWithHoles$J(e)||_iterableToArrayLimit$H(e,t)||_unsupportedIterableToArray$12(e,t)||_nonIterableRest$J()}function _nonIterableRest$J(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$12(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$12(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$12(e,t):void 0}}function _arrayLikeToArray$12(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$H(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$J(e){if(Array.isArray(e))return e}function hideColumnItem(e){return{key:"hidden_columns_hide",name:function(){var e=this.getSelectedLast(),t=0;if(Array.isArray(e)){var r=_slicedToArray$H(e,4);r[1]-r[3]!=0&&(t=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_HIDE_COLUMN,t)},callback:function(){for(var t=this.getSelectedRangeLast(),r=t.from,n=t.to,o=Math.max(Math.min(r.col,n.col),0),i=Math.max(r.col,n.col),a=[],s=o;s<=i;s+=1)a.push(s);var l=a[0],u=a[a.length-1],c=this.columnIndexMapper.getFirstNotHiddenIndex(u+1,1,!0,l-1);e.hideColumns(a),Number.isInteger(c)&&c>=0?this.selectColumns(c):this.deselectCell(),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function _toConsumableArray$r(e){return _arrayWithoutHoles$r(e)||_iterableToArray$t(e)||_unsupportedIterableToArray$13(e)||_nonIterableSpread$r()}function _nonIterableSpread$r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$13(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$13(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$13(e,t):void 0}}function _iterableToArray$t(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$r(e){if(Array.isArray(e))return _arrayLikeToArray$13(e)}function _arrayLikeToArray$13(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function showColumnItem(e){var t=[];return{key:"hidden_columns_show",name:function(){var e=t.length>1?1:0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_SHOW_COLUMN,e)},callback:function(){var r,n;if(0!==t.length){var o=t[0],i=t[t.length-1];o=null!==(r=this.columnIndexMapper.getFirstNotHiddenIndex(o-1,-1))&&void 0!==r?r:0,i=null!==(n=this.columnIndexMapper.getFirstNotHiddenIndex(i+1,1))&&void 0!==n?n:this.countCols()-1,e.showColumns(t),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0),i-o+1===this.countCols()||this.selectColumns(o,i)}},disabled:!1,hidden:function(){var r=this,n=arrayMap(e.getHiddenColumns(),(function(e){return r.toPhysicalColumn(e)}));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||n.length<1)return!0;t.length=0;var o=this.getSelectedRangeLast(),i=o.getTopLeftCorner().col,a=o.getBottomRightCorner().col,s=this.columnIndexMapper,l=s.getRenderableFromVisualIndex(i),u=s.getRenderableFromVisualIndex(a),c=s.getNotTrimmedIndexes(),f=[];if(i!==a){if(a-i+1>u-l+1){var h=c.slice(i,a+1);f.push.apply(f,_toConsumableArray$r(h.filter((function(e){return n.includes(e)}))))}}else if(0===l&&l<i)f.push.apply(f,_toConsumableArray$r(c.slice(0,i)));else if(null===l)f.push.apply(f,_toConsumableArray$r(c.slice(0,this.countCols())));else{var d=this.countCols()-1;u===s.getRenderableFromVisualIndex(s.getFirstNotHiddenIndex(d,-1))&&d>a&&f.push.apply(f,_toConsumableArray$r(c.slice(a+1)))}return arrayEach(f,(function(e){t.push(r.toVisualColumn(e))})),0===t.length}}}function _typeof$1x(e){return(_typeof$1x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$2N(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2F(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2F(e,t,r){return t&&_defineProperties$2F(e.prototype,t),r&&_defineProperties$2F(e,r),e}function _get$R(e,t,r){return(_get$R="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$R(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$R(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1m(e)););return e}function _inherits$1m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$1n(e,t)}function _setPrototypeOf$1n(e,t){return(_setPrototypeOf$1n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$1m(e){var t=_isNativeReflectConstruct$1n();return function(){var r,n=_getPrototypeOf$1m(e);if(t){var o=_getPrototypeOf$1m(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$1m(this,r)}}function _possibleConstructorReturn$1m(e,t){return!t||"object"!==_typeof$1x(t)&&"function"!=typeof t?_assertThisInitialized$1m(e):t}function _assertThisInitialized$1m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$1m(e){return(_getPrototypeOf$1m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classPrivateFieldGet$5(e,t){var r=t.get(e);if(!r)throw new TypeError("attempted to get private field on non-instance");return r.get?r.get.call(e):r.value}function _classPrivateFieldSet$5(e,t,r){var n=t.get(e);if(!n)throw new TypeError("attempted to set private field on non-instance");if(n.set)n.set.call(e,r);else{if(!n.writable)throw new TypeError("attempted to set read only private field");n.value=r}return r}registerPlugin("nestedRows",NestedRows),Hooks.getSingleton().register("beforeHideColumns"),Hooks.getSingleton().register("afterHideColumns"),Hooks.getSingleton().register("beforeUnhideColumns"),Hooks.getSingleton().register("afterUnhideColumns");var _settings=new WeakMap,_hiddenColumnsMap=new WeakMap,HiddenColumns=function(e){_inherits$1m(r,e);var t=_createSuper$1m(r);function r(){var e;_classCallCheck$2N(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),_settings.set(_assertThisInitialized$1m(e),{writable:!0,value:{}}),_hiddenColumnsMap.set(_assertThisInitialized$1m(e),{writable:!0,value:null}),e}return _createClass$2F(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().hiddenColumns}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().hiddenColumns;isObject$1(t)&&(_classPrivateFieldSet$5(this,_settings,t),isUndefined(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),_classPrivateFieldSet$5(this,_hiddenColumnsMap,new HidingMap),_classPrivateFieldGet$5(this,_hiddenColumnsMap).addLocalHook("init",(function(){return e.onMapInit()})),this.hot.columnIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$5(this,_hiddenColumnsMap)),this.addHook("afterContextMenuDefaultOptions",(function(){return e.onAfterContextMenuDefaultOptions.apply(e,arguments)})),this.addHook("afterGetCellMeta",(function(t,r,n){return e.onAfterGetCellMeta(t,r,n)})),this.addHook("modifyColWidth",(function(t,r){return e.onModifyColWidth(t,r)})),this.addHook("afterGetColHeader",(function(){return e.onAfterGetColHeader.apply(e,arguments)})),this.addHook("modifyCopyableRange",(function(t){return e.onModifyCopyableRange(t)})),_get$R(_getPrototypeOf$1m(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$R(_getPrototypeOf$1m(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),_classPrivateFieldSet$5(this,_settings,{}),_get$R(_getPrototypeOf$1m(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(e){var t=this,r=this.getHiddenColumns(),n=this.isValidConfig(e),o=r,i=_classPrivateFieldGet$5(this,_hiddenColumnsMap).getValues().slice(),a=e.length>0;n&&a&&(arrayEach(e.map((function(e){return t.hot.toPhysicalColumn(e)})),(function(e){i[e]=!1})),o=arrayReduce(i,(function(e,r,n){return r&&e.push(t.hot.toVisualColumn(n)),e}),[]));!1!==this.hot.runHooks("beforeUnhideColumns",r,o,n&&a)&&(n&&a&&_classPrivateFieldGet$5(this,_hiddenColumnsMap).setValues(i),this.hot.view.wt.wtOverlays.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",r,o,n&&a,n&&o.length<r.length))}},{key:"showColumn",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.showColumns(t)}},{key:"hideColumns",value:function(e){var t=this,r=this.getHiddenColumns(),n=this.isValidConfig(e),o=r;n&&(o=Array.from(new Set(r.concat(e)))),!1!==this.hot.runHooks("beforeHideColumns",r,o,n)&&(n&&this.hot.batch((function(){arrayEach(e,(function(e){_classPrivateFieldGet$5(t,_hiddenColumnsMap).setValueAtIndex(t.hot.toPhysicalColumn(e),!0)}))})),this.hot.runHooks("afterHideColumns",r,o,n,n&&o.length>r.length))}},{key:"hideColumn",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.hideColumns(t)}},{key:"getHiddenColumns",value:function(){var e=this;return arrayMap(_classPrivateFieldGet$5(this,_hiddenColumnsMap).getHiddenIndexes(),(function(t){return e.hot.toVisualColumn(t)}))}},{key:"isHidden",value:function(e){return _classPrivateFieldGet$5(this,_hiddenColumnsMap).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}},{key:"isValidConfig",value:function(e){var t=this.hot.countCols();return!!(Array.isArray(e)&&e.length>0)&&e.every((function(e){return Number.isInteger(e)&&e>=0&&e<t}))}},{key:"resetCellsMeta",value:function(){arrayEach(this.hot.getCellsMeta(),(function(e){e&&(e.skipColumnOnPaste=!1)}))}},{key:"onModifyColWidth",value:function(e,t){return this.isHidden(t)?0:_classPrivateFieldGet$5(this,_settings).indicators&&(this.isHidden(t+1)||this.isHidden(t-1))&&"number"==typeof e&&this.hot.hasColHeaders()?e+15:void 0}},{key:"onAfterGetCellMeta",value:function(e,t,r){if(!1===_classPrivateFieldGet$5(this,_settings).copyPasteEnabled&&this.isHidden(t)&&(r.skipColumnOnPaste=!0),this.isHidden(t-1))r.className=r.className||"",-1===r.className.indexOf("afterHiddenColumn")&&(r.className+=" afterHiddenColumn");else if(r.className){var n=r.className.split(" ");if(n.length>0){var o=n.indexOf("afterHiddenColumn");o>-1&&n.splice(o,1),r.className=n.join(" ")}}}},{key:"onModifyCopyableRange",value:function(e){var t=this;if(_classPrivateFieldGet$5(this,_settings).copyPasteEnabled)return e;var r=[],n=function(e,t,n,o){r.push({startRow:e,endRow:t,startCol:n,endCol:o})};return arrayEach(e,(function(e){var r=!0,o=0;rangeEach(e.startCol,e.endCol,(function(i){t.isHidden(i)?(r||n(e.startRow,e.endRow,o,i-1),r=!0):(r&&(o=i),i===e.endCol&&n(e.startRow,e.endRow,o,i),r=!1)}))})),r}},{key:"onAfterGetColHeader",value:function(e,t){if(_classPrivateFieldGet$5(this,_settings).indicators&&!(e<0)){var r=[];e>=1&&this.isHidden(e-1)&&r.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&r.push("beforeHiddenColumn"),addClass(t,r)}}},{key:"onAfterContextMenuDefaultOptions",value:function(e){e.items.push({name:KEY},hideColumnItem(this),showColumnItem(this))}},{key:"onMapInit",value:function(){Array.isArray(_classPrivateFieldGet$5(this,_settings).columns)&&this.hideColumns(_classPrivateFieldGet$5(this,_settings).columns)}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),_classPrivateFieldSet$5(this,_settings,null),_classPrivateFieldSet$5(this,_hiddenColumnsMap,null),_get$R(_getPrototypeOf$1m(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);function _slicedToArray$I(e,t){return _arrayWithHoles$K(e)||_iterableToArrayLimit$I(e,t)||_unsupportedIterableToArray$14(e,t)||_nonIterableRest$K()}function _nonIterableRest$K(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$14(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$14(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$14(e,t):void 0}}function _arrayLikeToArray$14(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit$I(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _arrayWithHoles$K(e){if(Array.isArray(e))return e}function hideRowItem(e){return{key:"hidden_rows_hide",name:function(){var e=this.getSelectedLast(),t=0;if(Array.isArray(e)){var r=_slicedToArray$I(e,3);r[0]-r[2]!=0&&(t=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_HIDE_ROW,t)},callback:function(){for(var t=this.getSelectedRangeLast(),r=t.from,n=t.to,o=Math.max(Math.min(r.row,n.row),0),i=Math.max(r.row,n.row),a=[],s=o;s<=i;s+=1)a.push(s);var l=a[0],u=a[a.length-1],c=this.rowIndexMapper.getFirstNotHiddenIndex(u+1,1,!0,l-1);e.hideRows(a),Number.isInteger(c)&&c>=0?this.selectRows(c):this.deselectCell(),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function _toConsumableArray$s(e){return _arrayWithoutHoles$s(e)||_iterableToArray$u(e)||_unsupportedIterableToArray$15(e)||_nonIterableSpread$s()}function _nonIterableSpread$s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$15(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$15(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray$15(e,t):void 0}}function _iterableToArray$u(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles$s(e){if(Array.isArray(e))return _arrayLikeToArray$15(e)}function _arrayLikeToArray$15(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function showRowItem(e){var t=[];return{key:"hidden_rows_show",name:function(){var e=t.length>1?1:0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_SHOW_ROW,e)},callback:function(){var r,n;if(0!==t.length){var o=t[0],i=t[t.length-1];o=null!==(r=this.rowIndexMapper.getFirstNotHiddenIndex(o-1,-1))&&void 0!==r?r:0,i=null!==(n=this.rowIndexMapper.getFirstNotHiddenIndex(i+1,1))&&void 0!==n?n:this.countRows()-1,e.showRows(t),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0),i-o+1===this.countRows()||this.selectRows(o,i)}},disabled:!1,hidden:function(){var r=this,n=arrayMap(e.getHiddenRows(),(function(e){return r.toPhysicalRow(e)}));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||n.length<1)return!0;t.length=0;var o=this.getSelectedRangeLast(),i=o.getTopLeftCorner().row,a=o.getBottomRightCorner().row,s=this.rowIndexMapper,l=s.getRenderableFromVisualIndex(i),u=s.getRenderableFromVisualIndex(a),c=s.getNotTrimmedIndexes(),f=[];if(i!==a){if(a-i+1>u-l+1){var h=c.slice(i,a+1);f.push.apply(f,_toConsumableArray$s(h.filter((function(e){return n.includes(e)}))))}}else if(0===l&&l<i)f.push.apply(f,_toConsumableArray$s(c.slice(0,i)));else if(null===l)f.push.apply(f,_toConsumableArray$s(c.slice(0,this.countRows())));else{var d=this.countRows()-1;u===s.getRenderableFromVisualIndex(s.getFirstNotHiddenIndex(d,-1))&&d>a&&f.push.apply(f,_toConsumableArray$s(c.slice(a+1)))}return arrayEach(f,(function(e){t.push(r.toVisualRow(e))})),0===t.length}}}function _typeof$1y(e){return(_typeof$1y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$2O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2G(e,t,r){return t&&_defineProperties$2G(e.prototype,t),r&&_defineProperties$2G(e,r),e}function _get$S(e,t,r){return(_get$S="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$S(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$S(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1n(e)););return e}function _inherits$1n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$1o(e,t)}function _setPrototypeOf$1o(e,t){return(_setPrototypeOf$1o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$1n(e){var t=_isNativeReflectConstruct$1o();return function(){var r,n=_getPrototypeOf$1n(e);if(t){var o=_getPrototypeOf$1n(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$1n(this,r)}}function _possibleConstructorReturn$1n(e,t){return!t||"object"!==_typeof$1y(t)&&"function"!=typeof t?_assertThisInitialized$1n(e):t}function _assertThisInitialized$1n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1o(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$1n(e){return(_getPrototypeOf$1n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classPrivateFieldGet$6(e,t){var r=t.get(e);if(!r)throw new TypeError("attempted to get private field on non-instance");return r.get?r.get.call(e):r.value}function _classPrivateFieldSet$6(e,t,r){var n=t.get(e);if(!n)throw new TypeError("attempted to set private field on non-instance");if(n.set)n.set.call(e,r);else{if(!n.writable)throw new TypeError("attempted to set read only private field");n.value=r}return r}registerPlugin("hiddenColumns",HiddenColumns),Hooks.getSingleton().register("beforeHideRows"),Hooks.getSingleton().register("afterHideRows"),Hooks.getSingleton().register("beforeUnhideRows"),Hooks.getSingleton().register("afterUnhideRows");var _settings$1=new WeakMap,_hiddenRowsMap=new WeakMap,HiddenRows=function(e){_inherits$1n(r,e);var t=_createSuper$1n(r);function r(){var e;_classCallCheck$2O(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),_settings$1.set(_assertThisInitialized$1n(e),{writable:!0,value:{}}),_hiddenRowsMap.set(_assertThisInitialized$1n(e),{writable:!0,value:null}),e}return _createClass$2G(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().hiddenRows}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().hiddenRows;isObject$1(t)&&(_classPrivateFieldSet$6(this,_settings$1,t),isUndefined(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),_classPrivateFieldSet$6(this,_hiddenRowsMap,new HidingMap),_classPrivateFieldGet$6(this,_hiddenRowsMap).addLocalHook("init",(function(){return e.onMapInit()})),this.hot.rowIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$6(this,_hiddenRowsMap)),this.addHook("afterContextMenuDefaultOptions",(function(){return e.onAfterContextMenuDefaultOptions.apply(e,arguments)})),this.addHook("afterGetCellMeta",(function(t,r,n){return e.onAfterGetCellMeta(t,r,n)})),this.addHook("modifyRowHeight",(function(t,r){return e.onModifyRowHeight(t,r)})),this.addHook("afterGetRowHeader",(function(){return e.onAfterGetRowHeader.apply(e,arguments)})),this.addHook("modifyCopyableRange",(function(t){return e.onModifyCopyableRange(t)})),_get$S(_getPrototypeOf$1n(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),_get$S(_getPrototypeOf$1n(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),_classPrivateFieldSet$6(this,_settings$1,{}),_get$S(_getPrototypeOf$1n(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(e){var t=this,r=this.getHiddenRows(),n=this.isValidConfig(e),o=r,i=_classPrivateFieldGet$6(this,_hiddenRowsMap).getValues().slice(),a=e.length>0;n&&a&&(arrayEach(e.map((function(e){return t.hot.toPhysicalRow(e)})),(function(e){i[e]=!1})),o=arrayReduce(i,(function(e,r,n){return r&&e.push(t.hot.toVisualRow(n)),e}),[]));!1!==this.hot.runHooks("beforeUnhideRows",r,o,n&&a)&&(n&&a&&_classPrivateFieldGet$6(this,_hiddenRowsMap).setValues(i),this.hot.runHooks("afterUnhideRows",r,o,n&&a,n&&o.length<r.length))}},{key:"showRow",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.showRows(t)}},{key:"hideRows",value:function(e){var t=this,r=this.getHiddenRows(),n=this.isValidConfig(e),o=r;n&&(o=Array.from(new Set(r.concat(e)))),!1!==this.hot.runHooks("beforeHideRows",r,o,n)&&(n&&this.hot.batch((function(){arrayEach(e,(function(e){_classPrivateFieldGet$6(t,_hiddenRowsMap).setValueAtIndex(t.hot.toPhysicalRow(e),!0)}))})),this.hot.runHooks("afterHideRows",r,o,n,n&&o.length>r.length))}},{key:"hideRow",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.hideRows(t)}},{key:"getHiddenRows",value:function(){var e=this;return arrayMap(_classPrivateFieldGet$6(this,_hiddenRowsMap).getHiddenIndexes(),(function(t){return e.hot.toVisualRow(t)}))}},{key:"isHidden",value:function(e){return _classPrivateFieldGet$6(this,_hiddenRowsMap).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}},{key:"isValidConfig",value:function(e){var t=this.hot.countRows();return!!(Array.isArray(e)&&e.length>0)&&e.every((function(e){return Number.isInteger(e)&&e>=0&&e<t}))}},{key:"resetCellsMeta",value:function(){arrayEach(this.hot.getCellsMeta(),(function(e){e&&(e.skipRowOnPaste=!1)}))}},{key:"onModifyRowHeight",value:function(e,t){return this.isHidden(t)?0:e}},{key:"onAfterGetCellMeta",value:function(e,t,r){if(!1===_classPrivateFieldGet$6(this,_settings$1).copyPasteEnabled&&this.isHidden(e)&&(r.skipRowOnPaste=!0),this.isHidden(e-1))r.className=r.className||"",-1===r.className.indexOf("afterHiddenRow")&&(r.className+=" afterHiddenRow");else if(r.className){var n=r.className.split(" ");if(n.length>0){var o=n.indexOf("afterHiddenRow");o>-1&&n.splice(o,1),r.className=n.join(" ")}}}},{key:"onModifyCopyableRange",value:function(e){var t=this;if(_classPrivateFieldGet$6(this,_settings$1).copyPasteEnabled)return e;var r=[],n=function(e,t,n,o){r.push({startRow:e,endRow:t,startCol:n,endCol:o})};return arrayEach(e,(function(e){var r=!0,o=0;rangeEach(e.startRow,e.endRow,(function(i){t.isHidden(i)?(r||n(o,i-1,e.startCol,e.endCol),r=!0):(r&&(o=i),i===e.endRow&&n(o,i,e.startCol,e.endCol),r=!1)}))})),r}},{key:"onAfterGetRowHeader",value:function(e,t){if(_classPrivateFieldGet$6(this,_settings$1).indicators&&!(e<0)){var r=[];e>=1&&this.isHidden(e-1)&&r.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&r.push("beforeHiddenRow"),addClass(t,r)}}},{key:"onAfterContextMenuDefaultOptions",value:function(e){e.items.push({name:KEY},hideRowItem(this),showRowItem(this))}},{key:"onMapInit",value:function(){Array.isArray(_classPrivateFieldGet$6(this,_settings$1).rows)&&this.hideRows(_classPrivateFieldGet$6(this,_settings$1).rows)}},{key:"destroy",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),_classPrivateFieldSet$6(this,_settings$1,null),_classPrivateFieldSet$6(this,_hiddenRowsMap,null),_get$S(_getPrototypeOf$1n(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);function _typeof$1z(e){return(_typeof$1z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$2P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass$2H(e,t,r){return t&&_defineProperties$2H(e.prototype,t),r&&_defineProperties$2H(e,r),e}function _get$T(e,t,r){return(_get$T="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase$T(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function _superPropBase$T(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf$1o(e)););return e}function _inherits$1o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$1p(e,t)}function _setPrototypeOf$1p(e,t){return(_setPrototypeOf$1p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper$1o(e){var t=_isNativeReflectConstruct$1p();return function(){var r,n=_getPrototypeOf$1o(e);if(t){var o=_getPrototypeOf$1o(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn$1o(this,r)}}function _possibleConstructorReturn$1o(e,t){return!t||"object"!==_typeof$1z(t)&&"function"!=typeof t?_assertThisInitialized$1o(e):t}function _assertThisInitialized$1o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct$1p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf$1o(e){return(_getPrototypeOf$1o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}registerPlugin("hiddenRows",HiddenRows);var TrimRows=function(e){_inherits$1o(r,e);var t=_createSuper$1o(r);function r(e){var n;return _classCallCheck$2P(this,r),(n=t.call(this,e)).trimmedRowsMap=null,n}return _createClass$2H(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings().trimRows}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new TrimmingMap),this.trimmedRowsMap.addLocalHook("init",(function(){return e.onMapInit()})),_get$T(_getPrototypeOf$1o(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var e=this,t=this.hot.getSettings().trimRows;Array.isArray(t)&&this.hot.batch((function(){e.trimmedRowsMap.clear(),arrayEach(t,(function(t){e.trimmedRowsMap.setValueAtIndex(t,!0)}))})),_get$T(_getPrototypeOf$1o(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),_get$T(_getPrototypeOf$1o(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(e){var t=this,r=this.getTrimmedRows(),n=this.isValidConfig(e),o=r;n&&(o=Array.from(new Set(r.concat(e)))),!1!==this.hot.runHooks("beforeTrimRow",r,o,n)&&(n&&this.hot.batch((function(){arrayEach(e,(function(e){t.trimmedRowsMap.setValueAtIndex(e,!0)}))})),this.hot.runHooks("afterTrimRow",r,o,n,n&&o.length>r.length))}},{key:"trimRow",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.trimRows(t)}},{key:"untrimRows",value:function(e){var t=this.getTrimmedRows(),r=this.isValidConfig(e),n=t,o=this.trimmedRowsMap.getValues().slice(),i=e.length>0;r&&i&&(arrayEach(e,(function(e){o[e]=!1})),n=arrayReduce(o,(function(e,t,r){return t&&e.push(r),e}),[])),!1!==this.hot.runHooks("beforeUntrimRow",t,n,r&&i)&&(r&&i&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",t,n,r&&i,r&&n.length<t.length))}},{key:"untrimRow",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.untrimRows(t)}},{key:"isTrimmed",value:function(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(e){var t=this.hot.countSourceRows();return e.every((function(e){return Number.isInteger(e)&&e>=0&&e<t}))}},{key:"onMapInit",value:function(){var e=this,t=this.hot.getSettings().trimRows;Array.isArray(t)&&this.hot.batch((function(){arrayEach(t,(function(t){e.trimmedRowsMap.setValueAtIndex(t,!0)}))}))}},{key:"destroy",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),_get$T(_getPrototypeOf$1o(r.prototype),"destroy",this).call(this)}}]),r}(BasePlugin);registerPlugin("trimRows",TrimRows);var plugins=Object.freeze({__proto__:null,AutoColumnSize:AutoColumnSize,AutoFill:Autofill,AutoRowSize:AutoRowSize,Base:BasePlugin,BindRowsWithHeaders:BindRowsWithHeaders,CollapsibleColumns:CollapsibleColumns,ColumnSorting:ColumnSorting,ColumnSummary:ColumnSummary,Comments:Comments,ContextMenu:ContextMenu,CopyPaste:CopyPaste,CustomBorders:CustomBorders,DragToScroll:DragToScroll,DropdownMenu:DropdownMenu,ExportFile:ExportFile,Filters:Filters,Formulas:Formulas,HeaderTooltips:HeaderTooltips,HiddenColumns:HiddenColumns,HiddenRows:HiddenRows,ManualColumnFreeze:ManualColumnFreeze,ManualColumnMove:ManualColumnMove,ManualColumnResize:ManualColumnResize,ManualRowMove:ManualRowMove,ManualRowResize:ManualRowResize,MergeCells:MergeCells,MultiColumnSorting:MultiColumnSorting,MultipleSelectionHandles:MultipleSelectionHandles,NestedHeaders:NestedHeaders,NestedRows:NestedRows,ObserveChanges:ObserveChanges,PersistentState:PersistentState,Search:Search,TouchScroll:TouchScroll,TrimRows:TrimRows,UndoRedo:UndoRedo});function Handsontable(e,t){var r=new Core(e,t||{},rootInstanceSymbol);return r.init(),r}jQueryWrapper(Handsontable),Handsontable.Core=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Core(e,t,rootInstanceSymbol)},Handsontable.DefaultSettings=metaSchemaFactory(),Handsontable.EventManager=EventManager,Handsontable._getListenersCounter=getListenersCounter,Handsontable._getRegisteredMapsCounter=getRegisteredMapsCounter,Handsontable.packageName="handsontable",Handsontable.buildDate="01/10/2020 12:41:54",Handsontable.version="8.1.0",Handsontable.hooks=Hooks.getSingleton(),Handsontable.__GhostTable=GhostTable;var HELPERS=[arrayHelpers,browserHelpers,dataHelpers,dateHelpers,featureHelpers,functionHelpers,mixedHelpers,numberHelpers,objectHelpers,stringHelpers,unicodeHelpers,parseTableHelpers],DOM=[domHelpers,domEventHelpers];function get_each_context(e,t,r){const n=e.slice();return n[7]=t[r],n}function create_else_block(e){let t,r,n,o,i,a,s,l,u,c,f=e[7].label+"";return a=new PageNav({props:{pageDirStructure:e[7],pageRoot:e[1]+e[7].label,lastPage:e[2],clickEvt:e[3]}}),{c(){t=element("div"),r=element("span"),n=text(f),o=space(),i=element("div"),create_component(a.$$.fragment),s=space(),attr(r,"class","svelte-12w1bny"),attr(i,"class","nav-dir-links svelte-12w1bny"),set_style(i,"max-height",25*e[4](e[7])+"px"),attr(t,"class","nav-dir-header active svelte-12w1bny")},m(e,f){insert(e,t,f),append(t,r),append(r,n),append(t,o),append(t,i),mount_component(a,i,null),append(t,s),l=!0,u||(c=listen(t,"click",click_handler_1),u=!0)},p(e,t){(!l||1&t)&&f!==(f=e[7].label+"")&&set_data(n,f);const r={};1&t&&(r.pageDirStructure=e[7]),3&t&&(r.pageRoot=e[1]+e[7].label),4&t&&(r.lastPage=e[2]),8&t&&(r.clickEvt=e[3]),a.$set(r),(!l||1&t)&&set_style(i,"max-height",25*e[4](e[7])+"px")},i(e){l||(transition_in(a.$$.fragment,e),l=!0)},o(e){transition_out(a.$$.fragment,e),l=!1},d(e){e&&detach(t),destroy_component(a),u=!1,c()}}}function create_if_block(e){let t,r,n,o,i,a,s=e[7].replace(/_/g," ")+"";function l(...t){return e[5](e[7],...t)}return{c(){t=element("div"),r=text(s),n=space(),attr(t,"class",o="nav-link "+(e[2]===e[1]+e[7]?"current":"")+" svelte-12w1bny")},m(e,o){insert(e,t,o),append(t,r),append(t,n),i||(a=listen(t,"click",l),i=!0)},p(n,i){e=n,1&i&&s!==(s=e[7].replace(/_/g," ")+"")&&set_data(r,s),7&i&&o!==(o="nav-link "+(e[2]===e[1]+e[7]?"current":"")+" svelte-12w1bny")&&attr(t,"class",o)},i:noop,o:noop,d(e){e&&detach(t),i=!1,a()}}}function create_each_block(e){let t,r,n,o;const i=[create_if_block,create_else_block],a=[];function s(e,t){return"string"==typeof e[7]?0:1}return t=s(e),r=a[t]=i[t](e),{c(){r.c(),n=empty()},m(e,r){a[t].m(e,r),insert(e,n,r),o=!0},p(e,o){let l=t;t=s(e),t===l?a[t].p(e,o):(group_outros(),transition_out(a[l],1,1,(()=>{a[l]=null})),check_outros(),r=a[t],r||(r=a[t]=i[t](e),r.c()),transition_in(r,1),r.m(n.parentNode,n))},i(e){o||(transition_in(r),o=!0)},o(e){transition_out(r),o=!1},d(e){a[t].d(e),e&&detach(n)}}}function create_fragment(e){let t,r,n=e[0].children,o=[];for(let t=0;t<n.length;t+=1)o[t]=create_each_block(get_each_context(e,n,t));const i=e=>transition_out(o[e],1,1,(()=>{o[e]=null}));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=empty()},m(e,n){for(let t=0;t<o.length;t+=1)o[t].m(e,n);insert(e,t,n),r=!0},p(e,[r]){if(31&r){let a;for(n=e[0].children,a=0;a<n.length;a+=1){const i=get_each_context(e,n,a);o[a]?(o[a].p(i,r),transition_in(o[a],1)):(o[a]=create_each_block(i),o[a].c(),transition_in(o[a],1),o[a].m(t.parentNode,t))}for(group_outros(),a=n.length;a<o.length;a+=1)i(a);check_outros()}},i(e){if(!r){for(let e=0;e<n.length;e+=1)transition_in(o[e]);r=!0}},o(e){o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)transition_out(o[e]);r=!1},d(e){destroy_each(o,e),e&&detach(t)}}}Handsontable.helper={},Handsontable.dom={},arrayEach(HELPERS,(function(e){arrayEach(Object.getOwnPropertyNames(e),(function(t){"_"!==t.charAt(0)&&(Handsontable.helper[t]=e[t])}))})),arrayEach(DOM,(function(e){arrayEach(Object.getOwnPropertyNames(e),(function(t){"_"!==t.charAt(0)&&(Handsontable.dom[t]=e[t])}))})),Handsontable.cellTypes={},arrayEach(getNames$3(),(function(e){Handsontable.cellTypes[e]=_getItem$3(e)})),Handsontable.cellTypes.registerCellType=_register$1,Handsontable.cellTypes.getCellType=_getItem$3,Handsontable.editors={},arrayEach(getNames$1(),(function(e){Handsontable.editors["".concat(toUpperCaseFirst(e),"Editor")]=_getItem$1(e)})),Handsontable.editors.registerEditor=_register,Handsontable.editors.getEditor=_getItem$1,Handsontable.renderers={},arrayEach(getNames(),(function(e){var t=_getItem(e);"base"===e&&(Handsontable.renderers.cellDecorator=t),Handsontable.renderers["".concat(toUpperCaseFirst(e),"Renderer")]=t})),Handsontable.renderers.registerRenderer=register,Handsontable.renderers.getRenderer=_getItem,Handsontable.validators={},arrayEach(getNames$2(),(function(e){Handsontable.validators["".concat(toUpperCaseFirst(e),"Validator")]=_getItem$2(e)})),Handsontable.validators.registerValidator=register$2,Handsontable.validators.getValidator=_getItem$2,Handsontable.plugins={},arrayEach(Object.getOwnPropertyNames(plugins),(function(e){var t=plugins[e];"Base"===e?Handsontable.plugins["".concat(e,"Plugin")]=t:Handsontable.plugins[e]=t})),Handsontable.plugins.registerPlugin=registerPlugin,Handsontable.languages={},Handsontable.languages.dictionaryKeys=constants,Handsontable.languages.getLanguageDictionary=getLanguage,Handsontable.languages.getLanguagesDictionaries=getLanguages,Handsontable.languages.registerLanguageDictionary=registerLanguage,Handsontable.languages.getTranslatedPhrase=function(){return getTranslatedPhrase.apply(void 0,arguments)};const click_handler_1=function(e){e.stopPropagation(),this.classList.toggle("active")};function instance(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{l(n.next(e))}catch(e){i(e)}}function s(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))};let{pageDirStructure:o={label:"_",children:[]}}=t,{pageRoot:i=""}=t,{lastPage:a=""}=t,{clickEvt:s=(()=>n(void 0,void 0,void 0,(function*(){})))}=t;const l=e=>{let t=0;for(const r of e.children)"string"!=typeof r&&(t+=l(r)),t++;return t};return e.$$set=e=>{"pageDirStructure"in e&&r(0,o=e.pageDirStructure),"pageRoot"in e&&r(1,i=e.pageRoot),"lastPage"in e&&r(2,a=e.lastPage),"clickEvt"in e&&r(3,s=e.clickEvt)},[o,i,a,s,l,(e,t)=>{t.stopPropagation(),s(i+e)}]}class PageNav extends SvelteComponent{constructor(e){super(),init(this,e,instance,create_fragment,safe_not_equal,{pageDirStructure:0,pageRoot:1,lastPage:2,clickEvt:3})}}function get_each_context$1(e,t,r){const n=e.slice();return n[18]=t[r],n}function create_each_block$1(e){let t,r,n,o,i=e[18].text+"";return{c(){t=element("li"),r=element("a"),n=text(i),attr(r,"href",o="#"+e[18].id),set_style(t,"margin-left",10*(e[18].level-1)+"px"),attr(t,"class","svelte-13cgnfx")},m(e,o){insert(e,t,o),append(t,r),append(r,n)},p(e,a){1&a&&i!==(i=e[18].text+"")&&set_data(n,i),1&a&&o!==(o="#"+e[18].id)&&attr(r,"href",o),1&a&&set_style(t,"margin-left",10*(e[18].level-1)+"px")},d(e){e&&detach(t)}}}function create_fragment$1(e){let t,r,n,o,i,a,s,l,u,c,f,h,d,p,y,g,m,v,_,b,C,w;h=new PageNav({props:{pageDirStructure:e[5],clickEvt:e[6],lastPage:e[3]}});let E=e[0],S=[];for(let t=0;t<E.length;t+=1)S[t]=create_each_block$1(get_each_context$1(e,E,t));return{c(){t=element("header"),r=element("button"),r.textContent="pages",n=space(),o=element("button"),o.textContent="content",i=space(),a=element("div"),l=space(),u=element("main"),c=element("div"),f=element("div"),create_component(h.$$.fragment),p=space(),y=element("div"),g=space(),m=element("div"),v=element("ul");for(let e=0;e<S.length;e+=1)S[e].c();attr(r,"class","sidebarButton svelte-13cgnfx"),attr(o,"class","navButton svelte-13cgnfx"),attr(t,"class","svelte-13cgnfx"),attr(a,"class",s="offToggle "+(e[2]||e[1]?"active":"")+" svelte-13cgnfx"),attr(f,"class","list svelte-13cgnfx"),attr(c,"class",d="sidebar "+(e[2]?"active":"")+" svelte-13cgnfx"),attr(y,"class","content svelte-13cgnfx"),attr(v,"class","svelte-13cgnfx"),attr(m,"class",_="TOC "+(e[1]?"active":"")+" svelte-13cgnfx"),attr(u,"class","svelte-13cgnfx")},m(s,d){insert(s,t,d),append(t,r),append(t,n),append(t,o),insert(s,i,d),insert(s,a,d),insert(s,l,d),insert(s,u,d),append(u,c),append(c,f),mount_component(h,f,null),append(u,p),append(u,y),y.innerHTML=e[4],append(u,g),append(u,m),append(m,v);for(let e=0;e<S.length;e+=1)S[e].m(v,null);b=!0,C||(w=[listen(r,"click",e[7]),listen(o,"click",e[8]),listen(a,"click",e[9])],C=!0)},p(e,[t]){(!b||6&t&&s!==(s="offToggle "+(e[2]||e[1]?"active":"")+" svelte-13cgnfx"))&&attr(a,"class",s);const r={};if(32&t&&(r.pageDirStructure=e[5]),8&t&&(r.lastPage=e[3]),h.$set(r),(!b||4&t&&d!==(d="sidebar "+(e[2]?"active":"")+" svelte-13cgnfx"))&&attr(c,"class",d),(!b||16&t)&&(y.innerHTML=e[4]),1&t){let r;for(E=e[0],r=0;r<E.length;r+=1){const n=get_each_context$1(e,E,r);S[r]?S[r].p(n,t):(S[r]=create_each_block$1(n),S[r].c(),S[r].m(v,null))}for(;r<S.length;r+=1)S[r].d(1);S.length=E.length}(!b||2&t&&_!==(_="TOC "+(e[1]?"active":"")+" svelte-13cgnfx"))&&attr(m,"class",_)},i(e){b||(transition_in(h.$$.fragment,e),b=!0)},o(e){transition_out(h.$$.fragment,e),b=!1},d(e){e&&detach(t),e&&detach(i),e&&detach(a),e&&detach(l),e&&detach(u),destroy_component(h),destroy_each(S,e),C=!1,run_all(w)}}}function instance$1($$self,$$props,$$invalidate){var __awaiter=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{l(n.next(e))}catch(e){i(e)}}function s(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))};const copyToClipboard=e=>{const t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)};Handsontable.renderers.registerRenderer("hex",((e,t,r,n,o,i,a)=>(t.style.fontFamily="monospace",t.style.fontWeight="bold",t.style.textAlign="center",t.innerText="string"==typeof i?"0x"+(i.startsWith("0x")?parseInt(i,16):parseInt(i)).toString(16).toUpperCase():"number"==typeof i?"0x"+i.toString(16).toUpperCase():"NaN",a.readOnly&&(t.className="htDimmed"),t)));const tables=[];let TOC=[],TOCIsActive=!1,sidebarIsActive=!1,lastPage=localStorage.getItem("lastPage"),pageScripts=[];const renderer={code(e,t,r){if("handsontable"!==t)return!1;const n={nestedHeaders:[[]],data:[],columns:[],manualColumnResize:!0,licenseKey:"non-commercial-and-evaluation",mergeCells:[],height:"auto",readOnly:!0,modifyColWidth:(e,t)=>e>300?300:e};let o=null,i={},a=0,s=[],l=()=>{for(const[e,t]of n.nestedHeaders.entries())if(s[e])s[e].colspan++;else{const e=t.reduce(((e,t)=>e+(["undefined","string"].includes(typeof t)?1:t.colspan)),0);a>e&&t.push(...new Array(a-e))}};for(const t of e.split("\n"))if(t.startsWith("# OPTIONS"))o="options";else if(t.startsWith("# COLUMNS"))o="columns";else if(t.startsWith("# DATA"))o="data";else switch(o){case"options":{const e=t.split(":").map((e=>e.trim()));["true","false"].includes(e[1])?n[e[0]]="true"===e[1]:n[e[0]]=e[1];continue}case"columns.options":{if("}"===t.trim()){n.columns.push(i),i={},o="columns";continue}const e=t.split(":").map((e=>e.trim()));["true","false"].includes(e[1])?i[e[0]]="true"===e[1]:i[e[0]]=e[1];continue}case"columns":if(t.endsWith("[")){if(s.push({label:t.substr(0,t.length-2).trim(),colspan:0}),n.nestedHeaders.length<=s.length){const e=[];a>0&&e.push(...new Array(a)),n.nestedHeaders.push(e)}}else if("]"===t.trim()){const e=s.pop();n.nestedHeaders[s.length].push(e)}else t.endsWith("{")?(n.nestedHeaders[s.length].push(t.substr(0,t.length-2).trim()),o="columns.options",a++,l()):(n.columns.push({}),n.nestedHeaders[s.length].push(t.trim()),a++,l());continue;case"data":{const e=t.split("|").map((e=>e.trim().replace(/\\n/g,"\n")));for(const[t,r]of e.entries()){const o=/^<\$(?:w(?<width>\d+))?\s?(?:h(?<height>\d+))?\s?(?:s"(?<styling>.+?)")?\>/gm.exec(r);if(o){if(o.groups.height||o.groups.width){const e=parseInt(o.groups.height)||1,r=parseInt(o.groups.width)||1,i=n.data.length;n.mergeCells.push({col:t,row:i,colspan:r,rowspan:e})}e[t]=e[t].substring(o[0].length)}}n.data.push(e);continue}default:continue}const u=`<div id="HOTable-${tables.length}"></div>`;return tables.push(n),u},heading:(e,t,r,n)=>($$invalidate(0,TOC=[...TOC,{text:r,level:t,id:n.slug(r,{dryrun:!0})}]),!1),link(e,t,r){if(e.startsWith("/")){const t=-1==e.indexOf("#")?void 0:e.indexOf("#");return pages.includes(e.substring(1,t))?`<a href="${window.location.origin}${window.location.pathname}?page=${e.substring(1,t)}&location=${(new marked.Slugger).slug(e.substr(e.indexOf("#")),{dryrun:!0})}">${r}</a>`:`<span class="invalid-link" data-targetpage="${e.substring(1,t)}">${r}</span>`}if(e.startsWith("#"))return`<a href="${window.location.origin}${window.location.pathname}?page=${localStorage.getItem("lastPage")}&location=${(new marked.Slugger).slug(e.substr(1),{dryrun:!0})}">${r}</a>`;if(e.includes("localhost")||e.includes("brawlre.github.io")){const t=new URLSearchParams(e.substring(e.indexOf("?"))).get("page");return pages.includes(t)?`<a href="${window.location.origin}${window.location.pathname}${e.replace(/https?:\/\/(?:localhost:\d{4}|brawlre\.github\.io)/g,"")}">${r}</a>`:`<span class="invalid-link" data-targetpage="${t}">${r}</span>`}return!1},image(e,t,r){if(console.log(e,t,r),"SCRIPT"===r)return"localhost"===window.location.hostname?pageScripts=[...pageScripts,`${window.location.origin}${window.location.pathname}docs/${e.substring(1)}.js`]:"https://brawlre.github.io"===window.location.origin&&(pageScripts=[...pageScripts,`https://raw.githubusercontent.com/BrawlRE/BrawlRE.github.io/main/public/docs/${e.substring(1)}.js`]),""}};marked.use({renderer:renderer});const serializeHOTable=e=>{const t=e.getData(),r=e.getSettings().nestedHeaders,n=e.getSettings().mergeCells,o=e.getSettings().columns,i=Object.entries(Object.getPrototypeOf(e.getSettings()));console.log(o);const a={};for(const[e,t]of i)"boolean"==typeof t&&t!==Handsontable.DefaultSettings[e]&&(a[e]=t);delete a.contextMenu,delete a.manualColumnResize;let s="```handsontable\n";s+="# OPTIONS\n";for(const[e,t]of Object.entries(a))s+=`${e}: ${t}\n`;s+="# COLUMNS\n";const l=new Array(r.length).fill(0),u=(e,t)=>{let n=l[e],i=0;for(;n<r[e].length&&!["string","object"].includes(typeof r[e][n]);)n++;for(;i<t&&n<r[e].length;){if("object"==typeof r[e][n])s+=`${"".padStart(2*e," ")}${r[e][n].label} [\n`,u(e+1,r[e][n].colspan),i+=r[e][n].colspan;else if("string"==typeof r[e][n]){s+=`${"".padStart(2*e," ")}${r[e][n]}`;let t=0;for(let o=0;o<n;o++)t+=["undefined","string"].includes(typeof r[e][o])?1:r[e][o].colspan;if(Object.keys(o[t]).length>0){s+=" {\n";for(const[t,r]of Object.entries(o[i]))s+=`${"".padStart(2*(e+1)," ")}${t}: ${r}\n`;s+="".padStart(2*e," ")+"}\n"}else s+="\n";i+=1}else i+=1;n++}0!==e&&(s+="".padStart(2*(e-1)," ")+"]\n"),l[e]=n};u(0,r[0].reduce(((e,t)=>e+(["undefined","string"].includes(typeof t)?1:t.colspan)),0)),s+="# DATA\n";for(const e of n)t[e.row][e.col]=`<$w${e.colspan}h${e.rowspan}>`+t[e.row][e.col];for(let e=0;e<t.length;e++)t[e]=t[e].join("|").replace(/\r?\n/g,"\\n");return s+=t.join("\n"),s+="\n```",s};let markedHTMLOut="";const updatePageContent=contentName=>__awaiter(void 0,void 0,void 0,(function*(){localStorage.setItem("lastPage",contentName),$$invalidate(3,lastPage=contentName),tables.length=0,$$invalidate(0,TOC.length=0,TOC),"localhost"===window.location.hostname?$$invalidate(4,markedHTMLOut=marked(yield(yield fetch("./docs/"+contentName+".md")).text())):$$invalidate(4,markedHTMLOut=marked(yield(yield fetch("https://raw.githubusercontent.com/BrawlRE/BrawlRE.github.io/main/public/docs/"+contentName+".md")).text()));for(const src of pageScripts)console.log(src),eval(yield(yield fetch(src)).text());if(pageScripts=[],yield tick(),tables.length>10)for(const[e,t]of tables.entries()){const r=document.createElement("button");r.innerText="show table",r.onclick=()=>{const r=document.getElementById("HOTable-"+e);r.innerHTML="";const n=document.createElement("button");n.innerText="hide table";const o=document.createElement("button");o.innerText="edit table";const i=document.createElement("div"),a=()=>{n.innerText=("none"===i.style.display?"hide":"show")+" table",o.style.display="none"===i.style.display?"inline-block":"none",i.style.display="none"===i.style.display?"inline-block":"none"};n.onclick=a,r.appendChild(n),r.appendChild(o),r.appendChild(i);const s=new Handsontable(i,t),l=()=>{s.updateSettings({readOnly:!1,contextMenu:!0,allowInsertColumn:!0,allowInsertRow:!0}),o.innerText="copy as markdown",n.onclick=()=>{s.updateSettings({readOnly:!0,contextMenu:!1}),n.onclick=a,n.innerText="hide table",o.innerText="edit table",o.onclick=l},n.innerText="stop editing",o.onclick=()=>{copyToClipboard(serializeHOTable(s))}};o.onclick=l},document.getElementById("HOTable-"+e).appendChild(r)}else for(const[e,t]of tables.entries()){const r=document.getElementById("HOTable-"+e),n=document.createElement("button");n.innerText="hide table";const o=document.createElement("button");o.innerText="edit table";const i=document.createElement("div"),a=()=>{n.innerText=("none"===i.style.display?"hide":"show")+" table",o.style.display="none"===i.style.display?"inline-block":"none",i.style.display="none"===i.style.display?"inline-block":"none"};n.onclick=a,r.appendChild(n),r.appendChild(o),r.appendChild(i);const s=new Handsontable(i,t),l=()=>{s.updateSettings({readOnly:!1,contextMenu:!0,allowInsertColumn:!0,allowInsertRow:!0}),o.innerText="copy as markdown",n.onclick=()=>{s.updateSettings({readOnly:!0,contextMenu:!1}),n.onclick=a,n.innerText="hide table",o.innerText="edit table",o.onclick=l},n.innerText="stop editing",o.onclick=()=>{copyToClipboard(serializeHOTable(s))}};o.onclick=l}for(const e of document.querySelectorAll("h1, h2, h3, h4, h5, h6"))e.addEventListener("click",(()=>{copyToClipboard(`${window.location.origin}${window.location.pathname}?page=${contentName}&location=${e.id}`)}))}));let pages=[],pageDirStructure={label:"_root",children:[]};__awaiter(void 0,void 0,void 0,(function*(){let e;e="localhost"===window.location.hostname?(yield(yield fetch("./docs/_pages.txt")).text()).replace(/\r/g,"").split("\n"):(yield(yield fetch("https://raw.githubusercontent.com/BrawlRE/BrawlRE.github.io/main/public/docs/_pages.txt")).text()).replace(/\r/g,"").split("\n");const t=[],r=[pageDirStructure];let n=0;for(const o of e){const e=o.search(/\S/);if(e<n){const o=(n-e)/2;for(let e=0;e<o;e++)t.pop();r.length=t.length+1,n=e}else n=e;pages=[...pages,t.join("")+o.trim()],o.endsWith("/")?(t.push(o.trim()),r[r.length-1].children.push({label:o.trim(),children:[]}),r.push(r[r.length-1].children.slice(-1)[0]),n+=2):r[r.length-1].children.push(o.trim())}$$invalidate(5,pageDirStructure);const o=new URLSearchParams(window.location.search),i=o.get("page"),a=o.get("location");yield updatePageContent(i||localStorage.getItem("lastPage")||"index"),a&&document.getElementById((new marked.Slugger).slug(a,{dryrun:!0})).scrollIntoView()}));const click_handler=()=>$$invalidate(2,sidebarIsActive=!0),click_handler_1=()=>$$invalidate(1,TOCIsActive=!0),click_handler_2=()=>{$$invalidate(1,TOCIsActive=!1),$$invalidate(2,sidebarIsActive=!1)};return[TOC,TOCIsActive,sidebarIsActive,lastPage,markedHTMLOut,pageDirStructure,updatePageContent,click_handler,click_handler_1,click_handler_2]}class App extends SvelteComponent{constructor(e){super(),init(this,e,instance$1,create_fragment$1,safe_not_equal,{})}}const app=new App({target:document.body});return app}();
//# sourceMappingURL=bundle.js.map
